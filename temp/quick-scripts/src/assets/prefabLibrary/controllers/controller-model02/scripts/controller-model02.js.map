{"version":3,"sources":["assets\\prefabLibrary\\controllers\\controller-model02\\scripts\\controller-model02.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["/*\r\n * @Descripttion: \r\n * @version: \r\n * @Author: ydlx\r\n * @Date: 2020-12-22 11:02:45\r\n * @LastEditors: ydlx\r\n * @LastEditTime: 2021-04-09 20:09:19\r\n */\r\nconst { ccclass, property } = cc._decorator;\r\n\r\nconst { gameData, monitorMessage } = window['GlobalData'];\r\nconst { loadPrefab, loadBundle} = window['GlobalData'].sample;\r\n\r\nimport { sendMessage } from \"./controller-model02-sendMessage\";\r\nimport { getMessage } from \"./controller-model02-getMessage\";\r\n\r\n@ccclass\r\nexport default class controller_model02 extends cc.Component {\r\n    private _configJson: any;     // 配置json\r\n    private _panel:any;           // 面板\r\n    private _resourceBundle:any;  // fairygui 素材资源\r\n    public _toPage = null;\r\n\r\n    onLoad() { }\r\n\r\n    async init(data: any) {\r\n        // 身份识别 全局变量\r\n        this.identification();\r\n\r\n        // 时间戳 标记\r\n        window['GlobalData'].courseData.timestamp = this.getTimestamp();\r\n\r\n        // 临时\r\n        // 因客户端(electron) 下，globalThis为 undefined\r\n        if (!window.globalThis) {\r\n            window.globalThis = {};\r\n            window.globalThis._ = window._;\r\n        }\r\n\r\n        this._configJson = data;\r\n        fgui.GRoot.create();\r\n        // 生成面板\r\n        let panelPath: any = `${this._configJson.pathConfig.remoteUrl}${this._configJson.pathConfig.panelBundlePath}${this._configJson.pathConfig.panelName}`;\r\n        let panelBundle: any = await loadBundle(panelPath);\r\n        let panelPrefab: any = await loadPrefab(panelBundle, panelBundle.name);\r\n        let panelNode: any = cc.instantiate(panelPrefab);\r\n        panelNode.parent = cc.find(\"Canvas\").parent;\r\n        panelNode.x = 960;\r\n        panelNode.y = 540;\r\n        this._panel = panelNode;\r\n        \r\n        // 临时\r\n        // 面板 显示\r\n        // 如果是学生 面板隐藏\r\n        if (window['GlobalData'].courseData.role == 2) {\r\n            if (this._panel) this._panel.opacity = 0;\r\n        }\r\n\r\n        // 获取素材资源bundle\r\n        if (this._configJson.pathConfig.resourceName) {\r\n            let resourcePath: any = `${this._configJson.pathConfig.remoteUrl}${this._configJson.pathConfig.resourceBundlePath}${this._configJson.pathConfig.resourceName}`;\r\n            this._resourceBundle = await loadBundle(resourcePath);\r\n        }\r\n\r\n        // 注册 发送信令的出口 逻辑\r\n        if (window['GlobalData'].sample.registerSendMessage){\r\n            window['GlobalData'].sample.registerSendMessage(sendMessage.bind(this));\r\n        } \r\n\r\n        // 拓课云 初始化\r\n        this.platformConfig(this._configJson.totalPages);\r\n\r\n        \r\n        console.log(this.node);\r\n        \r\n        fgui.UIPackage.loadPackage(this._resourceBundle, this._configJson.pathConfig.packageName, this.onUILoaded.bind(this));\r\n    }\r\n\r\n    private _view: fgui.GComponent;\r\n    private _currentDemo:any;\r\n\r\n    // 页面跳转 配置\r\n    async onJumpConfig(toPage: any) {\r\n        let page: number = toPage - 1;\r\n        let chapter: any = this._configJson.chapters[page];\r\n\r\n        fgui.GRoot.inst.removeChildren(0, -1, true);\r\n        if (this._currentDemo) {\r\n            this.node.removeComponent(this._currentDemo); \r\n        }\r\n        // this._view = fgui.UIPackage.createObject(\"t1-01\", \"static-model01-v1-p1\").asCom;\r\n        // this._view.makeFullScreen();\r\n        // fgui.GRoot.inst.addChild(this._view);\r\n\r\n        let bundle01: any = await loadBundle(chapter.modelBundle);\r\n        let prefab:any = await loadPrefab(bundle01,chapter.prefabName);\r\n        let node:any = cc.instantiate(prefab);\r\n        let nodeJs = node.getComponent(cc.Component);\r\n        let js:any = nodeJs.constructor;\r\n        this.addComponent(js);\r\n        this._currentDemo = js;\r\n        // // 临时\r\n        // // 跳转页面 重置 面板状态\r\n        // this.resetPanel();\r\n        // this._toPage = toPage;\r\n        // // 跳转页面\r\n        // let bool: any = await this.onJumpPage(toPage);\r\n        // if (bool) {\r\n        //     // 当前页面 state 快照\r\n        //     window['GlobalData'].courseData.stateShoot = globalThis._.cloneDeep(window['GlobalData'].stateProxy[\"state\"]);\r\n        //     // 预加载下一页\r\n        //     this.preloadPage(toPage);\r\n        //     // 老师退出重进，加载本地历史数据\r\n        //     this.recoverState();\r\n        // }\r\n    }\r\n\r\n    onUILoaded() {\r\n        this.onJumpConfig(1);\r\n        // // 这里不需要再调用addPackage了，直接可以开始创建界面了\r\n        // this._view = fgui.UIPackage.createObject(\"t1-01\", \"radioSwitch-model01-v1-p2\").asCom;\r\n        // this._view.setSize(fgui.GRoot.inst.width, fgui.GRoot.inst.height);\r\n\r\n        // // 以下几种方式都可以将view显示出来：\r\n        // // 1，直接加到GRoot显示出来\r\n        // fgui.GRoot.inst.addChild(this._view);\r\n\r\n        // this._triggerGroup = this._view.getChild(\"triggerGroup\").asGroup;\r\n        // // console.log(this._triggerGroup);\r\n\r\n        // let cnt = this._view.numChildren;\r\n        // for (let i = 0; i < cnt; i++) {\r\n        //     if (this._view.getChildAt(i).group == this._triggerGroup) {\r\n        //         this._view.getChildAt(i).onClick(this.switchShow, this);\r\n        //     }\r\n        // }\r\n\r\n        // this._radioSwitch1 = this._view.getController(\"radioSwitch1\");\r\n        // this._radioSwitch1.on(fgui.Event.STATUS_CHANGED, this.onChanged, this);\r\n        // this._radioSwitch1.selectedIndex = 2;\r\n    }\r\n\r\n\r\n    // 身份识别\r\n    identification() {\r\n        let parseURL = window['GlobalData'].utils.parseURL;\r\n        let urlObj = parseURL(window.location.href);\r\n        for (const key in urlObj) {\r\n            if (window['GlobalData'].courseData.hasOwnProperty(key)) {\r\n                window['GlobalData'].courseData[key] = urlObj[key];\r\n            }\r\n        }\r\n        // 临时\r\n        // 安卓ipad 部分账户 无法获取userid 用name替代\r\n        if (!urlObj[\"userid\"]) {\r\n            window['GlobalData'].courseData[\"userid\"] = urlObj[\"name\"];\r\n        }\r\n    }\r\n\r\n    // 依赖平台 配置设置\r\n    platformConfig(totalPages: number) {\r\n        // 端对端通信 监听\r\n        monitorMessage(getMessage.bind(this));\r\n        // 设置总页面\r\n        window.parent.postMessage(\r\n            JSON.stringify({ method: 'onPagenum', totalPages: totalPages }),\r\n            '*'\r\n        );\r\n        // 设置屏幕分辨率\r\n        window.parent.postMessage(\r\n            JSON.stringify({\r\n                method: 'onLoadComplete',\r\n                coursewareRatio: 16 / 9,\r\n            }),\r\n            '*'\r\n        );\r\n    }\r\n\r\n    // // 页面跳转 配置\r\n    // async onJumpConfig(toPage: any) {\r\n    //     // 临时\r\n    //     // 跳转页面 重置 面板状态\r\n    //     this.resetPanel();\r\n    //     this._toPage = toPage;\r\n    //     // 跳转页面\r\n    //     let bool: any = await this.onJumpPage(toPage);\r\n    //     if (bool) {\r\n    //         // 当前页面 state 快照\r\n    //         window['GlobalData'].courseData.stateShoot = globalThis._.cloneDeep(window['GlobalData'].stateProxy[\"state\"]);\r\n    //         // 预加载下一页\r\n    //         this.preloadPage(toPage);\r\n    //         // 老师退出重进，加载本地历史数据\r\n    //         this.recoverState();\r\n    //     }\r\n    // }\r\n\r\n    // 临时\r\n    // 跳转页面  短时间跳转多页 => 页面错位\r\n    async onJumpPage(index: number) {\r\n        let page: number = index - 1;\r\n        let chapter: any = this._configJson.chapters[page];\r\n        if (!chapter) return false;\r\n\r\n        let node: any = await this.creatPage(page);\r\n        if (this._toPage != index) return false;\r\n        this.container.destroyAllChildren();\r\n        node.parent = this.container;\r\n        let bool: any = await this.hasRegister(node.children[0].name);\r\n        if (this._toPage != index) return false;\r\n        return bool;\r\n    }\r\n\r\n    // 重置面板\r\n    resetPanel() {\r\n        let panel: any = this.node.parent.children[0].getChildByName('formal-panle-model02');\r\n        if (panel) {\r\n            let panelJs: any = panel.getComponent(cc.Component);\r\n            // 更新面板 ui 但不传信令\r\n            window['GlobalData'].stateProxy['formal-panle-model02'] = \"\";\r\n            panelJs.reset();\r\n        }\r\n    }\r\n\r\n    // 预加载 下一页 资源\r\n    // preload 仅预加载配置文件\r\n    // load 加载资源到内存(如图片等)\r\n    async preloadPage(index: number) {\r\n        let nextChapter: any = this._configJson.chapters[index];\r\n        if (!nextChapter) return;\r\n\r\n        let { model, components, pathConfig } = { model: nextChapter.model, components: nextChapter.components, pathConfig: this._configJson.pathConfig };\r\n\r\n        if (model) {\r\n            let modelPath: any = `${pathConfig.remoteUrl}${pathConfig.modelBundlePath}${model.path}`;\r\n            let modelBundle: any = await loadBundle(modelPath);\r\n            modelBundle['preload'](modelBundle.name, cc.Prefab);\r\n\r\n            if (model.resource) {\r\n                for (let j = 0; j < model.resource.length; j++) {\r\n                    let cfg: any = model.resource[j].cfg;\r\n                    if (Array.isArray(cfg)) {\r\n                        for (let i = 0; i < cfg.length; i++) {\r\n                            let imgPath: any = cfg[i].imgPath;\r\n                            window['GlobalData'].gameData.resourceBundle['load'](imgPath, cc.SpriteFrame);\r\n                        }\r\n                    } else {\r\n                        let imgPath: any = cfg.imgPath;\r\n                        window['GlobalData'].gameData.resourceBundle['load'](imgPath, cc.SpriteFrame);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (components) {\r\n            for (let i = 0; i < components.length; i++) {\r\n                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[i].path}`;\r\n                let componentBundle: any = await loadBundle(componentPath);\r\n                componentBundle['preload'](componentBundle.name, cc.Prefab);\r\n                if (components[i].resource) {\r\n                    for (let j = 0; j < components[i].resource.length; j++) {\r\n                        let imgPath: any = components[i].resource[j].cfg.imgPath\r\n                        window['GlobalData'].gameData.resourceBundle['load'](imgPath, cc.SpriteFrame);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // 臨時方案\r\n    // 頁面初始化狀態 拷貝\r\n    hasRegister(name: any) {\r\n        return new Promise((resolve, reject) => {\r\n            let nIntervId = setInterval(() => {\r\n                if (window['GlobalData'].stateProxy[name]) {\r\n                    clearInterval(nIntervId)\r\n                    resolve(true);\r\n                }\r\n            }, 30);\r\n        });\r\n    }\r\n\r\n    // 创建页面\r\n    async creatPage(index: number) {\r\n        let chapter: any = this._configJson.chapters[index];\r\n        let node = new cc.Node('box');\r\n        let modelPath: any = `${this._configJson.pathConfig.remoteUrl}${this._configJson.pathConfig.modelBundlePath}${chapter.model.path}`;\r\n        let bundle: any = await loadBundle(modelPath);\r\n        let prefab: any = await loadPrefab(bundle, bundle.name);\r\n        let prefabNode: any = cc.instantiate(prefab);\r\n        let Js: any = prefabNode.getComponent(cc.Component);\r\n        if (Js.init) {\r\n            await Js.init({ \"model\": chapter.model, \"components\": chapter.components, \"pathConfig\": this._configJson.pathConfig });\r\n        }\r\n        // 因历史原因 最外层分辨率可能不一致 \r\n        // 保持模型 和外层分辨率一致\r\n        if (chapter.model.scale) prefabNode.scale = chapter.model.scale;\r\n        prefabNode.parent = node;\r\n        return node;\r\n    }\r\n\r\n    // 老师恢复退出时状态\r\n    recoverState() {\r\n        if (window['GlobalData'].courseData.firstLoad) {\r\n            let db: any = cc.sys.localStorage.getItem('COURSE_SIGNALING_DB');\r\n            if (!db) return;\r\n            let signalingDB = JSON.parse(db);\r\n            // 老师 数据缓存\r\n            if (signalingDB && window['GlobalData'].courseData.role == 0) {\r\n                let curStamp = parseInt(this.getTimestamp());\r\n                let preStamp = parseInt(signalingDB.timestamp);\r\n\r\n                if ((curStamp - preStamp) / 60 < 35) {\r\n                    window['GlobalData'].courseData.timestamp = signalingDB.timestamp;\r\n                    let prevState = globalThis._.cloneDeep(window['GlobalData'].stateProxy[\"state\"]);\r\n\r\n                    Object.keys(prevState).forEach((v) => {\r\n                        if (!(globalThis._.isEqual(prevState[v], signalingDB.state[v]))) {\r\n                            // state 流转 临时\r\n                            window['GlobalData'].stateProxy[v] = \"\";\r\n                            window['GlobalData'].pubSub.emit(signalingDB.state[v], v);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            window['GlobalData'].courseData.firstLoad = false;\r\n        }\r\n    }\r\n\r\n    // 获取当前时间戳 前十位 秒\r\n    getTimestamp() {\r\n        return (+new Date()).toString().substr(0, 10);\r\n    }\r\n\r\n    // 同步 倒计时\r\n    countDown(user: any) {\r\n        let count = 6;\r\n        // 以秒为单位的时间间隔\r\n        let interval = 1;\r\n        // 重复次数\r\n        let repeat = 5;\r\n        // 开始延时\r\n        let delay = 0;\r\n        this.schedule(() => {\r\n            count--;\r\n            if (count == 1) {\r\n                this.sendInfo(user);\r\n            }\r\n        }, interval, repeat, delay);\r\n    }\r\n\r\n    sendInfo(user: any) {\r\n        let state = globalThis._.cloneDeep(window['GlobalData'].stateProxy[\"state\"]);\r\n        sendMessage(state, user);\r\n    }\r\n\r\n}\r\n"]}