{"version":3,"sources":["assets\\entrances\\javascripts\\t3-courseware.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;GAOG;AACH,IAAM,QAAQ,GAAG,MAAM,CAAC,YAAY,CAAC,CAAC,QAAQ,CAAC;AACzC,IAAA,KAAmC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,EAA5D,UAAU,gBAAA,EAAE,UAAU,gBAAA,EAAE,IAAI,UAAgC,CAAC;AAC7D,IAAA,QAAQ,GAAK,MAAM,CAAC,YAAY,CAAC,CAAC,KAAK,SAA/B,CAAgC;AAC1C,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAA2C,iCAAY;IAAvD;QAAA,qEA+CC;QA1CG,UAAI,GAAG,KAAK,CAAC;QAMb,gBAAU,GAAiB,IAAI,CAAC;;IAoCpC,CAAC;IAhCS,8BAAM,GAAZ;;;;;;6BAEQ,IAAI,CAAC,IAAI,EAAT,wBAAS;wBACT,OAAO;wBACP,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC;;;wBAG5B,UAAU,GAAK,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAnC,CAAoC;wBACpD,IAAI,CAAC,UAAU,EAAE;4BACb,sBAAO;yBACV;wBACG,GAAG,GAAQ,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC;wBACvD,qBAAM,IAAI,CAAC,KAAK,EAAK,QAAQ,CAAC,SAAS,mCAA6B,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,EAAE,cAAQ,GAAK,CAAC,EAAA;;wBAAxI,IAAI,GAAQ,SAA4H;wBAC5I,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;;;wBAG9B,aAAa,GAAQ,KAAG,UAAU,CAAC,UAAU,CAAC,SAAS,GAAG,UAAU,CAAC,UAAU,CAAC,oBAAoB,GAAG,UAAU,CAAC,UAAU,CAAC,cAAgB,CAAC;wBACvH,qBAAM,UAAU,CAAC,aAAa,CAAC,EAAA;;wBAAtD,eAAe,GAAQ,SAA+B;wBAC/B,qBAAM,UAAU,CAAC,eAAe,EAAE,eAAe,CAAC,IAAI,CAAC,EAAA;;wBAA9E,eAAe,GAAQ,SAAuD;wBAC9E,aAAa,GAAQ,EAAE,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC;wBACzD,aAAa,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;wBACxC,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;wBAC9D,qBAAM,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,EAAA;;wBAAzC,SAAyC,CAAC;wBAE1C,IAAI,IAAI,CAAC,IAAI,EAAE;4BACX,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;yBACtC;;;;;KACJ;IAED,kCAAU,GAAV,UAAW,CAAM,EAAE,GAAQ;QACvB,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;IACzC,CAAC;IAzCD;QAHC,QAAQ,CAAC;YACN,WAAW,EAAE,MAAM;SACtB,CAAC;+CACW;IAMb;QAJC,QAAQ,CAAC;YACN,IAAI,EAAE,EAAE,CAAC,SAAS;YAClB,WAAW,EAAE,OAAO;SACvB,CAAC;qDAC8B;IAXf,aAAa;QADjC,OAAO;OACa,aAAa,CA+CjC;IAAD,oBAAC;CA/CD,AA+CC,CA/C0C,EAAE,CAAC,SAAS,GA+CtD;kBA/CoB,aAAa","file":"","sourceRoot":"/","sourcesContent":["/*\r\n * @Descripttion: \r\n * @version: \r\n * @Author: ydlx\r\n * @Date: 2021-03-26 18:05:12\r\n * @LastEditors: ydlx\r\n * @LastEditTime: 2021-04-27 11:32:03\r\n */\r\nconst gameData = window['GlobalData'].gameData;\r\nconst { loadBundle, loadPrefab, ajax } = window['GlobalData'].sample;\r\nconst { parseURL } = window['GlobalData'].utils;\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class t3_courseware extends cc.Component {\r\n\r\n    @property({\r\n        displayName: '本地测试'\r\n    })\r\n    test = false;\r\n\r\n    @property({\r\n        type: cc.JsonAsset,\r\n        displayName: '配置 文件'\r\n    })\r\n    configJson: cc.JsonAsset = null;\r\n\r\n    private _controllerJs: any;\r\n\r\n    async onLoad() {\r\n        let configJson: any;\r\n        if (this.test) {\r\n            // 本地测试\r\n            configJson = this.configJson.json;\r\n        } else {\r\n            // 获取配置文件\r\n            let { courseName } = parseURL(window.location.href);\r\n            if (!courseName) {\r\n                return;\r\n            }\r\n            let env: any = window.location.href.includes('test') ? 'test' : 'prod';\r\n            let json: any = await ajax(\"GET\", `${gameData.apiOrigin}/getConfigJson?courseName=${courseName ? courseName.toLowerCase() : ''}&env=${env}`);\r\n            configJson = JSON.parse(json);\r\n        }\r\n        // 生成控制器\r\n        let contrllerPath: any = `${configJson.pathConfig.remoteUrl}${configJson.pathConfig.controllerBundlePath}${configJson.pathConfig.controllerName}`;\r\n        let contrllerBundle: any = await loadBundle(contrllerPath);\r\n        let contrllerPrefab: any = await loadPrefab(contrllerBundle, contrllerBundle.name);\r\n        let contrllerNode: any = cc.instantiate(contrllerPrefab);\r\n        contrllerNode.parent = this.node.parent;\r\n        this._controllerJs = contrllerNode.getComponent(cc.Component);\r\n        await this._controllerJs.init(configJson);\r\n\r\n        if (this.test) {\r\n            this._controllerJs.onJumpConfig(1);\r\n        }\r\n    }\r\n\r\n    choosePage(e: any, ced: any) {\r\n        this._controllerJs.onJumpConfig(ced);\r\n    }\r\n}\r\n"]}