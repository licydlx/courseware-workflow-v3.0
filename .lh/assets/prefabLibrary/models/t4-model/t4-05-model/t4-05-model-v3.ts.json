{
    "sourceFile": "assets/prefabLibrary/models/t4-model/t4-05-model/t4-05-model-v3.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 595,
            "patches": [
                {
                    "date": 1625119227755,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1625119238440,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,9 +10,9 @@\n const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n const { ccclass, property } = cc._decorator;\r\n \r\n @ccclass\r\n-export default class t4_05_model_v2 extends cc.Component {\r\n+export default class t4_05_model_v3 extends cc.Component {\r\n     private _worldRoot: cc.Node;\r\n \r\n     private _view: fgui.GComponent;\r\n \r\n"
                },
                {
                    "date": 1625119562351,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -126,24 +126,17 @@\n         fgui.GRoot.inst.addChild(this._view);\r\n \r\n         this._c1 = this._view.getController(\"c1\");\r\n \r\n-        this._drawLan = this._view.getChild('lan').asImage;\r\n-        this._drawRed = this._view.getChild('red').asImage;\r\n \r\n-        this._lanRect = new cc.Rect(this._drawLan.x, this._drawLan.y, this._drawLan.width, this._drawLan.height);\r\n-        this._redRect = new cc.Rect(this._drawRed.x, this._drawRed.y, this._drawRed.width, this._drawRed.height);\r\n \r\n         // 臨時\r\n         // bug 初始设置不播放不生效\r\n         if (this._c1) {\r\n             this._c1.selectedIndex = 1;\r\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n-        this._maskBg = this._view.getChild(\"maskBg\").asGraph;\r\n-        this._maskBg.visible = true;\r\n-\r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n         this._title = this._view.getChild(\"title\").asButton;\r\n@@ -153,16 +146,12 @@\n \r\n         this._startBtn = this._view.getChild(\"start\").asButton;\r\n         this._startBtn.on(fgui.Event.CLICK, this._clickStart, this);\r\n \r\n-        this._player = this._view.getChild('player').asImage;\r\n-        this._player.x = this._view.width;\r\n-        this._playerRect = new cc.Rect(this._player.x - 36, this._player.y + 10, 25, this._player.height);\r\n+        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n-        this._view.off(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        this._view.off(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n-\r\n         let huiNode = new cc.Node('huiNode');\r\n         huiNode.parent = this._worldRoot;\r\n \r\n         this.graphics = huiNode.addComponent(cc.Graphics);\r\n"
                },
                {
                    "date": 1625119591172,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -153,9 +153,9 @@\n \r\n         let huiNode = new cc.Node('huiNode');\r\n         huiNode.parent = this._worldRoot;\r\n \r\n-        this.graphics = huiNode.addComponent(cc.Graphics);\r\n+        this.graphics = this._view.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n         this.graphics.strokeColor = cc.color(255, 0, 0);\r\n         this.graphics.fillColor = cc.color(255, 0, 0);\r\n"
                },
                {
                    "date": 1625119599508,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -153,9 +153,9 @@\n \r\n         let huiNode = new cc.Node('huiNode');\r\n         huiNode.parent = this._worldRoot;\r\n \r\n-        this.graphics = this._view.addComponent(cc.Graphics);\r\n+        this.graphics = this.node.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n         this.graphics.strokeColor = cc.color(255, 0, 0);\r\n         this.graphics.fillColor = cc.color(255, 0, 0);\r\n"
                },
                {
                    "date": 1625119683176,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,43 +27,10 @@\n     private _package: any;\r\n \r\n     private _touchesPos: cc.Vec2[] = [];\r\n \r\n-    private _touchXMax: number = 0;\r\n-\r\n-    private _touchXMin: number = 0;\r\n-\r\n     private graphics: cc.Graphics = null;\r\n \r\n-    private _zhiLine: fgui.GObject;\r\n-\r\n-    private _drawLan: fgui.GImage;\r\n-\r\n-    private _moveMinX: number = 430;\r\n-\r\n-    private _lanRect: cc.Rect;\r\n-    private _redRect: cc.Rect;\r\n-    private _playerRect: cc.Rect;\r\n-    private _drawLineRect: cc.Rect;\r\n-\r\n-    private _drawRed: fgui.GImage;\r\n-\r\n-    private _maskBg: fgui.GGraph;\r\n-\r\n-    private _player: fgui.GImage;\r\n-\r\n-    private _moveSpeed: number = 1;\r\n-\r\n-    private _gameTime: number = 0;\r\n-\r\n-    private _defaultMinX: number = 550;\r\n-\r\n-    private _defaultMaxX: number = 1290;\r\n-\r\n-    private _defaultMidPosY: number = 635;\r\n-\r\n-    private _framesSecond: number = 20; //1秒钟运行20帧（次）\r\n-\r\n     private _dragging = false;\r\n \r\n     private _scheduleTime = 0.01;\r\n \r\n@@ -164,12 +131,9 @@\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n-            gameStart: false,\r\n-            gameOver: this.gameResult.No,\r\n             touch: \"end\",\r\n-            touchesPos: []\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n"
                },
                {
                    "date": 1625119721979,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,42 +33,16 @@\n     private _dragging = false;\r\n \r\n     private _scheduleTime = 0.01;\r\n \r\n-    private _showPosArr: any = [\r\n-        { 'line': { x: 25, y: 250 }, 'lan': { x: 16, y: 218 }, 'red': { x: 472, y: 218 } },\r\n-        { 'line': { x: 25, y: 345 }, 'lan': { x: 16, y: 312 }, 'red': { x: 472, y: 312 } },\r\n-        { 'line': { x: 25, y: 438 }, 'lan': { x: 16, y: 404 }, 'red': { x: 472, y: 404 } }];\r\n-\r\n-    private _showLines: any = [];\r\n-\r\n-    private _showLinesObj: any = [];\r\n-\r\n-    private _startBtn: fgui.GButton;\r\n-\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n         WrongFeed: 2,\r\n         RightFeed: 3\r\n     });\r\n \r\n-    private gameResult: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        Fail: 2,\r\n-        Success: 3\r\n-    });\r\n-\r\n-    private lineType: any = cc.Enum({\r\n-\r\n-        StraightLine: 0,\r\n-        LineSegment: 1,\r\n-        LeftLanRays: 2,\r\n-        RightRedRays: 3\r\n-    });\r\n-\r\n     // 远程动态组件\r\n     private feedback: any;\r\n \r\n     private _state = {};\r\n"
                },
                {
                    "date": 1625119732919,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -67,10 +67,8 @@\n         fgui.GRoot.inst.addChild(this._view);\r\n \r\n         this._c1 = this._view.getController(\"c1\");\r\n \r\n-\r\n-\r\n         // 臨時\r\n         // bug 初始设置不播放不生效\r\n         if (this._c1) {\r\n             this._c1.selectedIndex = 1;\r\n"
                },
                {
                    "date": 1625119744321,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -82,9 +82,9 @@\n \r\n         this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n         if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n \r\n-        this._startBtn = this._view.getChild(\"start\").asButton;\r\n+        this._startBtn = this._view.getChild(\"restart\").asButton;\r\n         this._startBtn.on(fgui.Event.CLICK, this._clickStart, this);\r\n \r\n         this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n"
                },
                {
                    "date": 1625119761793,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -82,10 +82,10 @@\n \r\n         this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n         if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n \r\n-        this._startBtn = this._view.getChild(\"restart\").asButton;\r\n-        this._startBtn.on(fgui.Event.CLICK, this._clickStart, this);\r\n+        this._restartBtn = this._view.getChild(\"restart\").asButton;\r\n+        this._restartBtn.on(fgui.Event.CLICK, this._clickStart, this);\r\n \r\n         this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n"
                },
                {
                    "date": 1625119771758,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,8 +23,11 @@\n     private _titleTrigger: fgui.GLoader;\r\n \r\n     private _submitBtn: fgui.GButton;\r\n \r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    _restartBtn\r\n     private _package: any;\r\n \r\n     private _touchesPos: cc.Vec2[] = [];\r\n \r\n"
                },
                {
                    "date": 1625119777290,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,11 +23,10 @@\n     private _titleTrigger: fgui.GLoader;\r\n \r\n     private _submitBtn: fgui.GButton;\r\n \r\n-    private _submitBtn: fgui.GButton;\r\n+    private _restartBtn: fgui.GButton;\r\n \r\n-    _restartBtn\r\n     private _package: any;\r\n \r\n     private _touchesPos: cc.Vec2[] = [];\r\n \r\n"
                },
                {
                    "date": 1625119811740,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -85,9 +85,9 @@\n         this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n         if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n \r\n         this._restartBtn = this._view.getChild(\"restart\").asButton;\r\n-        this._restartBtn.on(fgui.Event.CLICK, this._clickStart, this);\r\n+        this._restartBtn.on(fgui.Event.CLICK, this._clickReStart, this);\r\n \r\n         this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n@@ -250,9 +250,9 @@\n             return value1 - value2;\r\n         }\r\n     }\r\n \r\n-    private _clickStart(evt: any) {\r\n+    private _clickReStart(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.gameStart = true;\r\n         this.updateState(state);\r\n \r\n"
                },
                {
                    "date": 1625119858653,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,9 +23,9 @@\n     private _titleTrigger: fgui.GLoader;\r\n \r\n     private _submitBtn: fgui.GButton;\r\n \r\n-    private _restartBtn: fgui.GButton;\r\n+    private _resetBtn: fgui.GButton;\r\n \r\n     private _package: any;\r\n \r\n     private _touchesPos: cc.Vec2[] = [];\r\n@@ -84,10 +84,10 @@\n \r\n         this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n         if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n \r\n-        this._restartBtn = this._view.getChild(\"restart\").asButton;\r\n-        this._restartBtn.on(fgui.Event.CLICK, this._clickReStart, this);\r\n+        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n+        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n \r\n         this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n@@ -250,9 +250,9 @@\n             return value1 - value2;\r\n         }\r\n     }\r\n \r\n-    private _clickReStart(evt: any) {\r\n+    private _clickReset(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.gameStart = true;\r\n         this.updateState(state);\r\n \r\n"
                },
                {
                    "date": 1625119931322,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,9 +33,9 @@\n     private graphics: cc.Graphics = null;\r\n \r\n     private _dragging = false;\r\n \r\n-    private _scheduleTime = 0.01;\r\n+    private _scheduleTime = 0.02;\r\n \r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n@@ -180,69 +180,9 @@\n         state.touch = 'end';\r\n         this.updateState(state);\r\n     }\r\n \r\n-    updatePlayerMove(dt) {\r\n \r\n-        // this.dragSchedule();\r\n-        this._gameTime++;\r\n-        console.log(this._gameTime);\r\n-        if (this._gameTime >= this._framesSecond * 9) {\r\n-\r\n-\r\n-            this._playerRect.x = this._player.x - 36;\r\n-            if (this._drawLineRect.intersects(this._playerRect)) {\r\n-\r\n-                this._moveSpeed = 6;\r\n-                if (this._player.x <= this._moveMinX) {\r\n-                    this._gameTime = 0;\r\n-                    this.unschedule(this.updatePlayerMove);\r\n-                    let state: any = globalThis._.cloneDeep(this._state);\r\n-                    state.gameOver = this.gameResult.Success;\r\n-                    this.updateState(state);\r\n-                }\r\n-\r\n-            } else {\r\n-\r\n-                console.log('===== _player.x ====' + this._player.x);\r\n-                console.log('===== _touchXMin ====' + this._touchXMin);\r\n-                console.log('===== _moveMinX ====' + this._moveMinX);\r\n-\r\n-                console.log(this._drawLineRect);\r\n-                console.log(this._playerRect);\r\n-\r\n-                if (this._player.x > this._touchXMin) {\r\n-\r\n-                    this._gameTime = 0;\r\n-                    this.unschedule(this.updatePlayerMove);\r\n-\r\n-                    //游戏结束\r\n-                    let state: any = globalThis._.cloneDeep(this._state);\r\n-                    state.gameOver = this.gameResult.Fail;\r\n-                    this.updateState(state);\r\n-\r\n-                    return;\r\n-\r\n-                } else if (this._player.x <= this._touchXMin && this._player.x <= this._moveMinX) {\r\n-\r\n-                    this._gameTime = 0;\r\n-                    this.unschedule(this.updatePlayerMove);\r\n-\r\n-                    let state: any = globalThis._.cloneDeep(this._state);\r\n-                    state.gameOver = this.gameResult.Success;\r\n-                    this.updateState(state);\r\n-                    return;\r\n-\r\n-                }\r\n-\r\n-\r\n-\r\n-            }\r\n-        }\r\n-\r\n-        this._player.x -= 4.2 * this._moveSpeed;\r\n-    }\r\n-\r\n     // 排序方法\r\n     comparePos() {\r\n         return function (a, b) {\r\n             var value1 = a.x;\r\n@@ -252,9 +192,9 @@\n     }\r\n \r\n     private _clickReset(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.gameStart = true;\r\n+        state.reset = true;\r\n         this.updateState(state);\r\n \r\n     }\r\n \r\n"
                },
                {
                    "date": 1625120073100,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,9 +94,9 @@\n \r\n         let huiNode = new cc.Node('huiNode');\r\n         huiNode.parent = this._worldRoot;\r\n \r\n-        this.graphics = this.node.addComponent(cc.Graphics);\r\n+        this.graphics = this.huiNode.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n         this.graphics.strokeColor = cc.color(255, 0, 0);\r\n         this.graphics.fillColor = cc.color(255, 0, 0);\r\n"
                },
                {
                    "date": 1625120084234,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -106,8 +106,9 @@\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n             touch: \"end\",\r\n+            reset: false,\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n"
                },
                {
                    "date": 1625120147741,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -107,8 +107,9 @@\n             title: false,\r\n             submit: this.submitType.No,\r\n             touch: \"end\",\r\n             reset: false,\r\n+            touchesPos: [],\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n@@ -120,21 +121,11 @@\n         this._package = Package;\r\n \r\n         this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n \r\n-        this._zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-        this._view.addChild(this._zhiLine);\r\n-        this._drawLineRect = new cc.Rect(this._zhiLine.x, this._zhiLine.y, this._zhiLine.width, this._zhiLine.height);\r\n+        // this._zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+        // this._view.addChild(this._zhiLine);\r\n \r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n         if (components) {\r\n             for (const key in components) {\r\n                 let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n                 let componentBundle: any = await loadBundle(componentPath);\r\n"
                },
                {
                    "date": 1625120217855,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,9 +94,9 @@\n \r\n         let huiNode = new cc.Node('huiNode');\r\n         huiNode.parent = this._worldRoot;\r\n \r\n-        this.graphics = this.huiNode.addComponent(cc.Graphics);\r\n+        this.graphics = huiNode.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n         this.graphics.strokeColor = cc.color(255, 0, 0);\r\n         this.graphics.fillColor = cc.color(255, 0, 0);\r\n"
                },
                {
                    "date": 1625120357065,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -121,11 +121,8 @@\n         this._package = Package;\r\n \r\n         this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n \r\n-        // this._zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-        // this._view.addChild(this._zhiLine);\r\n-\r\n         if (components) {\r\n             for (const key in components) {\r\n                 let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n                 let componentBundle: any = await loadBundle(componentPath);\r\n@@ -232,9 +229,8 @@\n         if (state.touch == \"start\") {\r\n \r\n             this._touchesPos = state.touchesPos;\r\n             this.graphics.clear();\r\n-            this._zhiLine.visible = false;\r\n             this._touchesPos.length = 0;\r\n \r\n         } else if (state.touch == \"move\") {\r\n \r\n@@ -245,9 +241,10 @@\n             this.graphics.clear();\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n-                this._zhiLine.visible = true;\r\n+                // this._zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                // this._view.addChild(this._zhiLine);\r\n                 this._zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 this._zhiLine.x = this._touchesPos[0].x;\r\n                 this._zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 //this._zhiLine.y = 635;\r\n"
                },
                {
                    "date": 1625120362772,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -241,10 +241,10 @@\n             this.graphics.clear();\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n-                // this._zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                // this._view.addChild(this._zhiLine);\r\n+                this._zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                this._view.addChild(this._zhiLine);\r\n                 this._zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 this._zhiLine.x = this._touchesPos[0].x;\r\n                 this._zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 //this._zhiLine.y = 635;\r\n"
                },
                {
                    "date": 1625120386045,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -241,9 +241,9 @@\n             this.graphics.clear();\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n-                this._zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(this._zhiLine);\r\n                 this._zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 this._zhiLine.x = this._touchesPos[0].x;\r\n                 this._zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n"
                },
                {
                    "date": 1625120391689,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -242,9 +242,9 @@\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                this._view.addChild(this._zhiLine);\r\n+                this._view.addChild(zhiLine);\r\n                 this._zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 this._zhiLine.x = this._touchesPos[0].x;\r\n                 this._zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 //this._zhiLine.y = 635;\r\n"
                },
                {
                    "date": 1625120399851,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -243,11 +243,11 @@\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n-                this._zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n-                this._zhiLine.x = this._touchesPos[0].x;\r\n-                this._zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n+                zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n+                zhiLine.x = this._touchesPos[0].x;\r\n+                zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 //this._zhiLine.y = 635;\r\n                 this._zhiLine.sortingOrder = 0;\r\n                 this._drawLan.sortingOrder = 1;\r\n                 this._drawRed.sortingOrder = 1;\r\n"
                },
                {
                    "date": 1625120528515,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -247,65 +247,18 @@\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 //this._zhiLine.y = 635;\r\n-                this._zhiLine.sortingOrder = 0;\r\n-                this._drawLan.sortingOrder = 1;\r\n-                this._drawRed.sortingOrder = 1;\r\n-                this._drawLineRect.y = this._zhiLine.y;\r\n-                this._drawLineRect.width = this._zhiLine.width;\r\n+                zhiLine.sortingOrder = 0;\r\n \r\n-                // 直线 线段 左蓝射线 右红射线\r\n-\r\n                 this._touchesPos.sort(this.comparePos());\r\n \r\n-                let tempPos0 = new cc.Vec2(this._touchesPos[0].x, this._view.height - this._touchesPos[0].y);\r\n-                let tempPos1 = new cc.Vec2(this._touchesPos[this._touchesPos.length - 1].x, this._view.height - this._touchesPos[this._touchesPos.length - 1].y);\r\n \r\n-                if (this._lanRect.contains(tempPos0)) {\r\n-                    console.log('==== 333 ====');\r\n-                    this._touchesPos[0].x = this._defaultMinX;\r\n-                }\r\n-                if (this._redRect.contains(tempPos1)) {\r\n-                    console.log('==== 444 ====');\r\n-                    this._touchesPos[this._touchesPos.length - 1].x = this._defaultMaxX;\r\n-                }\r\n-\r\n-                this._touchXMax = this._touchesPos[this._touchesPos.length - 1].x;\r\n-                this._touchXMin = this._touchesPos[0].x;\r\n-\r\n-                this._drawLineRect.x = this._touchesPos[0].x;\r\n-                this._drawLineRect.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n-\r\n             }\r\n \r\n         }\r\n \r\n \r\n-        if (!globalThis._.isEqual(oldState.gameOver, state.gameOver)) {\r\n-\r\n-            if (state.gameOver === this.gameResult.Success) {\r\n-\r\n-                this.unschedule(this.updatePlayerMove);\r\n-                this.rightLineFly();\r\n-\r\n-            } else if (state.gameOver === this.gameResult.Fail) {\r\n-\r\n-                this.unschedule(this.updatePlayerMove);\r\n-                //重新开始\r\n-                cc.tween(this._player)\r\n-                    .to(0.03, { y: this._player.y + 400 })\r\n-                    .call(() => {\r\n-                        let state: any = globalThis._.cloneDeep(this._state);\r\n-                        state.gameStart = false;\r\n-                        state.gameOver = this.gameResult.No;\r\n-                        this.updateState(state);\r\n-\r\n-                    })\r\n-                    .start()\r\n-            }\r\n-        }\r\n-\r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n             if (state.submit === this.submitType.RightFeed) {\r\n \r\n@@ -321,176 +274,14 @@\n                 this.handTips2(keyBtn);\r\n             }\r\n         }\r\n \r\n-        if (!globalThis._.isEqual(oldState.gameStart, state.gameStart)) {\r\n \r\n-            if (state.gameStart) {\r\n-\r\n-                // 游戏开始\r\n-                this._zhiLine.visible = false;\r\n-                this.graphics.clear();\r\n-                this._touchesPos.length = 0;\r\n-                this._player.x = this._view.width;\r\n-                this._player.y = 635;\r\n-                this._moveSpeed = 1;\r\n-                this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-                this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-                this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n-\r\n-                this.graphics.enabled = true;\r\n-\r\n-                this._startBtn.visible = false;\r\n-                this._maskBg.visible = false;\r\n-\r\n-                this.schedule(this.updatePlayerMove, 0.05);\r\n-\r\n-            } else {\r\n-\r\n-                this._view.off(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-                this._view.off(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-                this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n-\r\n-                this._startBtn.visible = true;\r\n-                this._maskBg.visible = true;\r\n-                this.graphics.enabled = false;\r\n-\r\n-                this._zhiLine.visible = false;\r\n-                this._zhiLine.width = 0;\r\n-                this.graphics.clear();\r\n-                this._touchesPos.length = 0;\r\n-\r\n-                this.unschedule(this.updatePlayerMove);\r\n-            }\r\n-        }\r\n-\r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n             this.playTitle(state.title);\r\n         }\r\n     }\r\n \r\n-    rightLineFly() {\r\n-\r\n-        let len = this._showLinesObj.length;\r\n-\r\n-        if (len >= 3) {\r\n-\r\n-            return;\r\n-\r\n-        }\r\n-\r\n-        this._zhiLine.visible = false;\r\n-        this._drawLan.visible = false;\r\n-        this._drawRed.visible = false;\r\n-\r\n-        let dianLeftMin = this._drawLan.x;\r\n-        let dianLeftMax = this._drawLan.x + this._drawLan.width;\r\n-\r\n-        let dianRightMax = this._drawRed.x + this._drawRed.width;\r\n-        let dianRightMin = this._drawRed.x;\r\n-\r\n-        let cha = 5;\r\n-        let tempLineData = {};\r\n-\r\n-        // 1、直线\r\n-        if ((this._touchesPos[0].x - dianLeftMin) < -cha && (this._touchesPos[this._touchesPos.length - 1].x - dianRightMax) > cha) {\r\n-\r\n-            // 直线\r\n-            tempLineData['type'] = this.lineType.StraightLine\r\n-\r\n-        } else if (this._touchesPos[0].x >= dianLeftMin &&\r\n-            this._touchesPos[0].x <= dianLeftMax && this._touchesPos[this._touchesPos.length - 1].x >= dianRightMin && this._touchesPos[this._touchesPos.length - 1].x <= dianRightMax) {\r\n-\r\n-            //线段\r\n-            tempLineData['type'] = this.lineType.LineSegment;\r\n-\r\n-        } else if (this._touchesPos[0].x >= dianLeftMin &&\r\n-            this._touchesPos[0].x <= dianLeftMax && (this._touchesPos[this._touchesPos.length - 1].x - dianRightMax) > cha) {\r\n-\r\n-            // 左蓝射线\r\n-            tempLineData['type'] = this.lineType.LeftLanRays;\r\n-\r\n-        } else if (this._touchesPos[this._touchesPos.length - 1].x >= dianRightMin &&\r\n-            this._touchesPos[this._touchesPos.length - 1].x <= dianRightMax && (this._touchesPos[0].x - dianLeftMin) < -cha) {\r\n-\r\n-            // 右红射线\r\n-            tempLineData['type'] = this.lineType.RightRedRays;\r\n-\r\n-        }\r\n-\r\n-        this._showLines.push(tempLineData);\r\n-\r\n-        console.log('==== type 111 ====' + tempLineData['type']);\r\n-\r\n-        let lineW = Math.abs(this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x);\r\n-\r\n-        let leftLan = null;\r\n-        let rightRed = null;\r\n-\r\n-        let lineObj = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-        this._view.addChild(lineObj);\r\n-        lineObj.width = lineW;\r\n-        lineObj.x = this._touchesPos[0].x;\r\n-        lineObj.y = this._touchesPos[0].y;\r\n-\r\n-        if (tempLineData['type'] === this.lineType.LineSegment) {\r\n-\r\n-            leftLan = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox27');\r\n-            this._view.addChild(leftLan);\r\n-            leftLan.x = this._touchesPos[0].x;\r\n-            leftLan.y = this._drawLan.y;\r\n-\r\n-            rightRed = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox26');\r\n-            this._view.addChild(rightRed);\r\n-            rightRed.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n-            rightRed.y = this._drawRed.y;\r\n-\r\n-        } else if (tempLineData['type'] === this.lineType.LeftLanRays) {\r\n-\r\n-            leftLan = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox27');\r\n-            this._view.addChild(leftLan);\r\n-            leftLan.x = this._touchesPos[0].x;\r\n-            leftLan.y = this._drawLan.y;\r\n-\r\n-        } else if (tempLineData['type'] === this.lineType.RightRedRays) {\r\n-\r\n-            rightRed = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox26');\r\n-            this._view.addChild(rightRed);\r\n-            rightRed.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n-            rightRed.y = this._drawRed.y;\r\n-        }\r\n-\r\n-        cc.tween(lineObj)\r\n-            .to(0.15, { x: this._showPosArr[len].line.x, y: this._showPosArr[len].line.y })\r\n-            .to(0.15, { scaleX: 0.7, scaleY: 0.7 })\r\n-            .call(() => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.gameStart = false;\r\n-                state.gameOver = this.gameResult.No;\r\n-                this.updateState(state);\r\n-\r\n-                lineObj.width = 710;\r\n-                this._showLinesObj.push(lineObj);\r\n-                this._zhiLine.visible = true;\r\n-                this._drawLan.visible = true;\r\n-                this._drawRed.visible = true;\r\n-                this._zhiLine.width = 0;\r\n-            })\r\n-            .start()\r\n-\r\n-        cc.tween(leftLan)\r\n-            .to(0.15, { x: this._showPosArr[len].lan.x, y: this._showPosArr[len].lan.y })\r\n-            .to(0.15, { scaleX: 0.7, scaleY: 0.7 })\r\n-            .start()\r\n-\r\n-        cc.tween(rightRed)\r\n-            .to(0.15, { x: this._showPosArr[len].red.x, y: this._showPosArr[len].red.y })\r\n-            .to(0.15, { scaleX: 0.7, scaleY: 0.7 })\r\n-            .start()\r\n-\r\n-\r\n-    }\r\n-\r\n     async playTitle(bool: boolean) {\r\n         this._c1.selectedIndex = bool ? 1 : 0;\r\n         if (bool) {\r\n             cc.audioEngine.stopAll();\r\n@@ -597,9 +388,9 @@\n     }\r\n \r\n     onEnable() {\r\n         this.registerState();\r\n-        // this.schedule(this.dragSchedule, this._scheduleTime);\r\n+        this.schedule(this.dragSchedule, this._scheduleTime);\r\n     }\r\n \r\n     onDisable() {\r\n         this.relieveState();\r\n"
                },
                {
                    "date": 1625120549291,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,9 +91,9 @@\n         this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n-        let huiNode = new cc.Node('huiNode');\r\n+        let huiNode = this._view.parent;\r\n         huiNode.parent = this._worldRoot;\r\n \r\n         this.graphics = huiNode.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n"
                },
                {
                    "date": 1625120555275,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,9 +92,8 @@\n         this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n         let huiNode = this._view.parent;\r\n-        huiNode.parent = this._worldRoot;\r\n \r\n         this.graphics = huiNode.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n"
                },
                {
                    "date": 1625120573818,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,9 +91,9 @@\n         this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n-        let huiNode = this._view.parent;\r\n+        let huiNode = this._view.parent.node;\r\n \r\n         this.graphics = huiNode.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n"
                },
                {
                    "date": 1625120622269,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,9 +91,10 @@\n         this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n-        let huiNode = this._view.parent.node;\r\n+        let huiNode = new cc.Node('huiNode');\r\n+        huiNode.parent = this._worldRoot;\r\n \r\n         this.graphics = huiNode.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n"
                },
                {
                    "date": 1625120679333,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -237,9 +237,9 @@\n             this._touchesPos = state.touchesPos;\r\n \r\n         } else if (state.touch == \"end\") {\r\n \r\n-            this.graphics.clear();\r\n+            // this.graphics.clear();\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n"
                },
                {
                    "date": 1625120698686,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -99,9 +99,8 @@\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n         this.graphics.strokeColor = cc.color(255, 0, 0);\r\n         this.graphics.fillColor = cc.color(255, 0, 0);\r\n-        this.graphics.enabled = false;\r\n \r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n"
                },
                {
                    "date": 1625120717231,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -236,9 +236,9 @@\n             this._touchesPos = state.touchesPos;\r\n \r\n         } else if (state.touch == \"end\") {\r\n \r\n-            // this.graphics.clear();\r\n+            this.graphics.clear();\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n"
                },
                {
                    "date": 1625120761333,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,9 +94,9 @@\n \r\n         let huiNode = new cc.Node('huiNode');\r\n         huiNode.parent = this._worldRoot;\r\n \r\n-        this.graphics = huiNode.addComponent(cc.Graphics);\r\n+        this.graphics = this.node.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n         this.graphics.strokeColor = cc.color(255, 0, 0);\r\n         this.graphics.fillColor = cc.color(255, 0, 0);\r\n"
                },
                {
                    "date": 1625120784132,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,8 +94,9 @@\n \r\n         let huiNode = new cc.Node('huiNode');\r\n         huiNode.parent = this._worldRoot;\r\n \r\n+\r\n         this.graphics = this.node.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n         this.graphics.strokeColor = cc.color(255, 0, 0);\r\n"
                },
                {
                    "date": 1625120789805,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -95,9 +95,9 @@\n         let huiNode = new cc.Node('huiNode');\r\n         huiNode.parent = this._worldRoot;\r\n \r\n \r\n-        this.graphics = this.node.addComponent(cc.Graphics);\r\n+        this.graphics = huiNode.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n         this.graphics.strokeColor = cc.color(255, 0, 0);\r\n         this.graphics.fillColor = cc.color(255, 0, 0);\r\n"
                },
                {
                    "date": 1625120839817,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,9 +94,8 @@\n \r\n         let huiNode = new cc.Node('huiNode');\r\n         huiNode.parent = this._worldRoot;\r\n \r\n-\r\n         this.graphics = huiNode.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n         this.graphics.strokeColor = cc.color(255, 0, 0);\r\n"
                },
                {
                    "date": 1625120981125,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,9 +94,9 @@\n \r\n         let huiNode = new cc.Node('huiNode');\r\n         huiNode.parent = this._worldRoot;\r\n \r\n-        this.graphics = huiNode.addComponent(cc.Graphics);\r\n+        this.graphics = this.node.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n         this.graphics.strokeColor = cc.color(255, 0, 0);\r\n         this.graphics.fillColor = cc.color(255, 0, 0);\r\n"
                },
                {
                    "date": 1625121019972,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,9 +92,9 @@\n         this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n         let huiNode = new cc.Node('huiNode');\r\n-        huiNode.parent = this._worldRoot;\r\n+        huiNode.parent = this.node\r\n \r\n         this.graphics = this.node.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n"
                },
                {
                    "date": 1625121027027,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,11 +92,11 @@\n         this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n         let huiNode = new cc.Node('huiNode');\r\n-        huiNode.parent = this.node\r\n+        huiNode.parent = this.node;\r\n \r\n-        this.graphics = this.node.addComponent(cc.Graphics);\r\n+        this.graphics = huiNode.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n         this.graphics.strokeColor = cc.color(255, 0, 0);\r\n         this.graphics.fillColor = cc.color(255, 0, 0);\r\n"
                },
                {
                    "date": 1625121067157,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -93,8 +93,9 @@\n         this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n         let huiNode = new cc.Node('huiNode');\r\n         huiNode.parent = this.node;\r\n+        huiNode.zIndex = 9999;\r\n \r\n         this.graphics = huiNode.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n"
                },
                {
                    "date": 1625121119133,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,10 +92,9 @@\n         this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n         this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n         let huiNode = new cc.Node('huiNode');\r\n-        huiNode.parent = this.node;\r\n-        huiNode.zIndex = 9999;\r\n+        huiNode.parent = this._worldRoot;\r\n \r\n         this.graphics = huiNode.addComponent(cc.Graphics);\r\n         this.graphics.lineWidth = 20;\r\n         this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n"
                },
                {
                    "date": 1625121271019,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -144,21 +144,9 @@\n \r\n         this._dragging = true;\r\n         this._touchesPos.push(event.touch.getLocation());\r\n \r\n-        const MIN_POINT_DISTANCE = 4;\r\n \r\n-        let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n-        this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n-        let lastIndex = 0;\r\n-        for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n-            if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n-                continue;\r\n-            }\r\n-            lastIndex = i;\r\n-            this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n-        }\r\n-        this.graphics.stroke();\r\n     }\r\n \r\n     _onDrawEnd(event) {\r\n \r\n@@ -233,9 +221,22 @@\n \r\n         } else if (state.touch == \"move\") {\r\n \r\n             this._touchesPos = state.touchesPos;\r\n+            const MIN_POINT_DISTANCE = 4;\r\n \r\n+            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n+            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n+            let lastIndex = 0;\r\n+            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n+                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n+                    continue;\r\n+                }\r\n+                lastIndex = i;\r\n+                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n+            }\r\n+            this.graphics.stroke();\r\n+\r\n         } else if (state.touch == \"end\") {\r\n \r\n             this.graphics.clear();\r\n \r\n"
                },
                {
                    "date": 1625121314072,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -220,8 +220,10 @@\n             this._touchesPos.length = 0;\r\n \r\n         } else if (state.touch == \"move\") {\r\n \r\n+            console.log('==== 3333333 拖拽定时器 ======');\r\n+\r\n             this._touchesPos = state.touchesPos;\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n             let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n"
                },
                {
                    "date": 1625121327601,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -220,9 +220,9 @@\n             this._touchesPos.length = 0;\r\n \r\n         } else if (state.touch == \"move\") {\r\n \r\n-            console.log('==== 3333333 拖拽定时器 ======');\r\n+            console.log('==== 44444 拖拽更新 ======');\r\n \r\n             this._touchesPos = state.touchesPos;\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n"
                },
                {
                    "date": 1625121367867,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,9 +33,9 @@\n     private graphics: cc.Graphics = null;\r\n \r\n     private _dragging = false;\r\n \r\n-    private _scheduleTime = 0.02;\r\n+    private _scheduleTime = 0.05;\r\n \r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n"
                },
                {
                    "date": 1625121442606,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,4 +1,5 @@\n+import { PrivateNode } from '../../../../../creator';\r\n \r\n /*\r\n  * @Descripttion: \r\n  * @version: \r\n@@ -29,8 +30,10 @@\n     private _package: any;\r\n \r\n     private _touchesPos: cc.Vec2[] = [];\r\n \r\n+    private _temoPos: cc.Vec2\r\n+\r\n     private graphics: cc.Graphics = null;\r\n \r\n     private _dragging = false;\r\n \r\n"
                },
                {
                    "date": 1625121454016,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,11 +28,10 @@\n     private _resetBtn: fgui.GButton;\r\n \r\n     private _package: any;\r\n \r\n-    private _touchesPos: cc.Vec2[] = [];\r\n+    private _touchesPos: [],\r\n \r\n-    private _temoPos: cc.Vec2\r\n \r\n     private graphics: cc.Graphics = null;\r\n \r\n     private _dragging = false;\r\n"
                },
                {
                    "date": 1625121455432,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n     private _resetBtn: fgui.GButton;\r\n \r\n     private _package: any;\r\n \r\n-    private _touchesPos: [],\r\n+    private _touchesPos: [];\r\n \r\n \r\n     private graphics: cc.Graphics = null;\r\n \r\n"
                },
                {
                    "date": 1625121461108,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n     private _resetBtn: fgui.GButton;\r\n \r\n     private _package: any;\r\n \r\n-    private _touchesPos: [];\r\n+    private _touchesPos: any = [];\r\n \r\n \r\n     private graphics: cc.Graphics = null;\r\n \r\n"
                },
                {
                    "date": 1625121496578,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -144,8 +144,9 @@\n \r\n     _onDrawMove(event) {\r\n \r\n         this._dragging = true;\r\n+        let tempPos = { x: , y: };\r\n         this._touchesPos.push(event.touch.getLocation());\r\n \r\n \r\n     }\r\n"
                },
                {
                    "date": 1625121508503,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -144,10 +144,10 @@\n \r\n     _onDrawMove(event) {\r\n \r\n         this._dragging = true;\r\n-        let tempPos = { x: , y: };\r\n-        this._touchesPos.push(event.touch.getLocation());\r\n+        let tempPos = { x: event.touch.getLocation().x, y: event.touch.getLocation().x };\r\n+        this._touchesPos.push();\r\n \r\n \r\n     }\r\n \r\n"
                },
                {
                    "date": 1625121515147,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -144,10 +144,10 @@\n \r\n     _onDrawMove(event) {\r\n \r\n         this._dragging = true;\r\n-        let tempPos = { x: event.touch.getLocation().x, y: event.touch.getLocation().x };\r\n-        this._touchesPos.push();\r\n+        let tempPos = { x: event.touch.getLocation().x, y: event.touch.getLocation().y };\r\n+        this._touchesPos.push(tempPos);\r\n \r\n \r\n     }\r\n \r\n"
                },
                {
                    "date": 1625121583886,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -137,19 +137,18 @@\n         console.log('===== start 111 ====' + event.touch.getLocation());\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.touch = 'start';\r\n-        state.touchesPos.push(event.touch.getLocation());\r\n+        let tempPos = { x: event.touch.getLocation().x, y: event.touch.getLocation().y };\r\n+        state.touchesPos.push(tempPos);\r\n         this.updateState(state);\r\n     }\r\n \r\n     _onDrawMove(event) {\r\n \r\n         this._dragging = true;\r\n         let tempPos = { x: event.touch.getLocation().x, y: event.touch.getLocation().y };\r\n         this._touchesPos.push(tempPos);\r\n-\r\n-\r\n     }\r\n \r\n     _onDrawEnd(event) {\r\n \r\n"
                },
                {
                    "date": 1625121628780,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n     private _package: any;\r\n \r\n     private _touchesPos: any = [];\r\n \r\n-\r\n+    private _moveCurPos: {};\r\n     private graphics: cc.Graphics = null;\r\n \r\n     private _dragging = false;\r\n \r\n"
                },
                {
                    "date": 1625121642425,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,8 +31,9 @@\n \r\n     private _touchesPos: any = [];\r\n \r\n     private _moveCurPos: {};\r\n+\r\n     private graphics: cc.Graphics = null;\r\n \r\n     private _dragging = false;\r\n \r\n@@ -146,9 +147,9 @@\n     _onDrawMove(event) {\r\n \r\n         this._dragging = true;\r\n         let tempPos = { x: event.touch.getLocation().x, y: event.touch.getLocation().y };\r\n-        this._touchesPos.push(tempPos);\r\n+        this._moveCurPos.push(tempPos);\r\n     }\r\n \r\n     _onDrawEnd(event) {\r\n \r\n"
                },
                {
                    "date": 1625121650767,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -146,9 +146,9 @@\n \r\n     _onDrawMove(event) {\r\n \r\n         this._dragging = true;\r\n-        let tempPos = { x: event.touch.getLocation().x, y: event.touch.getLocation().y };\r\n+        this._moveCurPos = { x: event.touch.getLocation().x, y: event.touch.getLocation().y };\r\n         this._moveCurPos.push(tempPos);\r\n     }\r\n \r\n     _onDrawEnd(event) {\r\n"
                },
                {
                    "date": 1625121685674,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -147,9 +147,8 @@\n     _onDrawMove(event) {\r\n \r\n         this._dragging = true;\r\n         this._moveCurPos = { x: event.touch.getLocation().x, y: event.touch.getLocation().y };\r\n-        this._moveCurPos.push(tempPos);\r\n     }\r\n \r\n     _onDrawEnd(event) {\r\n \r\n@@ -193,11 +192,11 @@\n     dragSchedule() {\r\n         if (this._dragging) {\r\n \r\n             console.log('==== 3333333 拖拽定时器 ======');\r\n-\r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.touchesPos = this._touchesPos;\r\n+            this._moveCurPos\r\n+            state.touchesPos.push();\r\n             state.touch = \"move\";\r\n             this.updateState(state);\r\n         }\r\n     }\r\n"
                },
                {
                    "date": 1625121691472,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -193,10 +193,9 @@\n         if (this._dragging) {\r\n \r\n             console.log('==== 3333333 拖拽定时器 ======');\r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n-            this._moveCurPos\r\n-            state.touchesPos.push();\r\n+            state.touchesPos.push(this._moveCurPos);\r\n             state.touch = \"move\";\r\n             this.updateState(state);\r\n         }\r\n     }\r\n"
                },
                {
                    "date": 1625121766372,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n     private _package: any;\r\n \r\n     private _touchesPos: any = [];\r\n \r\n-    private _moveCurPos: {};\r\n+    private _moveCurPos: cc.Vec2;\r\n \r\n     private graphics: cc.Graphics = null;\r\n \r\n     private _dragging = false;\r\n"
                },
                {
                    "date": 1625121832454,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -138,9 +138,9 @@\n         console.log('===== start 111 ====' + event.touch.getLocation());\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.touch = 'start';\r\n-        let tempPos = { x: event.touch.getLocation().x, y: event.touch.getLocation().y };\r\n+        let tempPos = cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y); { x: , y: event.touch.getLocation().y };\r\n         state.touchesPos.push(tempPos);\r\n         this.updateState(state);\r\n     }\r\n \r\n"
                },
                {
                    "date": 1625121850477,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -138,9 +138,9 @@\n         console.log('===== start 111 ====' + event.touch.getLocation());\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.touch = 'start';\r\n-        let tempPos = cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y); { x: , y: event.touch.getLocation().y };\r\n+        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n         state.touchesPos.push(tempPos);\r\n         this.updateState(state);\r\n     }\r\n \r\n"
                },
                {
                    "date": 1625121859346,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -146,9 +146,9 @@\n \r\n     _onDrawMove(event) {\r\n \r\n         this._dragging = true;\r\n-        this._moveCurPos = { x: event.touch.getLocation().x, y: event.touch.getLocation().y };\r\n+        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n     }\r\n \r\n     _onDrawEnd(event) {\r\n \r\n"
                },
                {
                    "date": 1625122025752,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,9 +36,9 @@\n     private graphics: cc.Graphics = null;\r\n \r\n     private _dragging = false;\r\n \r\n-    private _scheduleTime = 0.05;\r\n+    private _scheduleTime = 0.03;\r\n \r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n"
                },
                {
                    "date": 1625122124572,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,4 @@\n-import { PrivateNode } from '../../../../../creator';\r\n \r\n /*\r\n  * @Descripttion: \r\n  * @version: \r\n"
                },
                {
                    "date": 1625122762211,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -220,10 +220,8 @@\n             this._touchesPos.length = 0;\r\n \r\n         } else if (state.touch == \"move\") {\r\n \r\n-            console.log('==== 44444 拖拽更新 ======');\r\n-\r\n             this._touchesPos = state.touchesPos;\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n             let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n@@ -248,8 +246,10 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n+\r\n+\r\n                 //this._zhiLine.y = 635;\r\n                 zhiLine.sortingOrder = 0;\r\n \r\n                 this._touchesPos.sort(this.comparePos());\r\n"
                },
                {
                    "date": 1625123064289,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -247,9 +247,8 @@\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n \r\n-\r\n                 //this._zhiLine.y = 635;\r\n                 zhiLine.sortingOrder = 0;\r\n \r\n                 this._touchesPos.sort(this.comparePos());\r\n"
                },
                {
                    "date": 1625123315231,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -281,120 +281,131 @@\n             this.playTitle(state.title);\r\n         }\r\n     }\r\n \r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n+    function angle(start, end) {\r\n+    var diff_x = end.x - start.x,\r\n+        diff_y = end.y - start.y;\r\n+    //返回角度,不是弧度\r\n+    return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n+}\r\n \r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n+————————————————\r\n+版权声明：本文为CSDN博主「I - T枭」的原创文章，遵循CC 4.0 BY - SA版权协议，转载请附上原文出处链接及本声明。\r\n+原文链接：https://blog.csdn.net/hahahhahahahha123456/article/details/96750558\r\n \r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n+async playTitle(bool: boolean) {\r\n+    this._c1.selectedIndex = bool ? 1 : 0;\r\n+    if (bool) {\r\n+        cc.audioEngine.stopAll();\r\n+        this.forbidHandle();\r\n+        let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+        let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+        let audioId = cc.audioEngine.play(audio, false, 1);\r\n+        cc.audioEngine.setFinishCallback(audioId, () => {\r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n+            state.title = false;\r\n             this.updateState(state);\r\n-        }, 2000);\r\n+        });\r\n+    } else {\r\n+        this.disableForbidHandle();\r\n     }\r\n+}\r\n \r\n+answerFeedback(bool: boolean) {\r\n+    if (!this.feedback) return;\r\n+    let feedback: any = cc.instantiate(this.feedback);\r\n+    feedback.x = 960;\r\n+    feedback.y = 540;\r\n+    let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+    feedbackJs.init(bool);\r\n+    feedback.parent = cc.find(\"Canvas\").parent;\r\n \r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n+    setTimeout(() => {\r\n+        feedback.destroy();\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.No;\r\n+        this.updateState(state);\r\n+    }, 2000);\r\n+}\r\n \r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n \r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n+/**\r\n+ * 点击指引\r\n+ * @param obj 点击对象\r\n+ */\r\n+handTips2(obj: fgui.GObject) {\r\n+    let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+    this._view.addChild(hand);\r\n+    let tempX = obj.x;\r\n+    let tempY = obj.y;\r\n \r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n+    hand.x = tempX;\r\n+    hand.y = tempY;\r\n \r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n+    cc.tween(hand).to(0.3, {\r\n+        x: tempX - 30,\r\n+        y: tempY - 30\r\n+    }).to(0.3, {\r\n+        x: tempX,\r\n+        y: tempY\r\n+    }).to(0.3, {\r\n+        x: tempX - 30,\r\n+        y: tempY - 30\r\n+    }).to(0.3, {\r\n+        x: tempX,\r\n+        y: tempY\r\n+    }).call(() => {\r\n+        this._view.removeChild(hand);\r\n+        hand = null;\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.No;\r\n+        this.updateState(state)\r\n+    }).start();\r\n+}\r\n \r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+// 运行时 禁止操作\r\n+forbidHandle() {\r\n+    console.log('===  运行时 禁止操作 =====');\r\n+    let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+    if (!handleMask) {\r\n+        let handleMask = new cc.Node('handleMask');\r\n+        handleMask.addComponent(cc.BlockInputEvents);\r\n+        handleMask.parent = this._worldRoot;\r\n+        handleMask.width = 1920;\r\n+        handleMask.height = 1080;\r\n+        handleMask.x = 960;\r\n+        handleMask.y = 540;\r\n     }\r\n+}\r\n \r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n+// 消除禁止\r\n+disableForbidHandle() {\r\n+    let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+    if (handleMask) handleMask.destroy();\r\n+}\r\n \r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n+// 注册状态，及获取状态的方法\r\n+registerState() {\r\n+    if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+}\r\n \r\n-    onEnable() {\r\n-        this.registerState();\r\n-        this.schedule(this.dragSchedule, this._scheduleTime);\r\n-    }\r\n+// 解除状态，及获取状态的方法\r\n+relieveState() {\r\n+    if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+}\r\n \r\n-    onDisable() {\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n+// 本组件状态合并到全局\r\n+mergeState() {\r\n+    if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n }\r\n+\r\n+onEnable() {\r\n+    this.registerState();\r\n+    this.schedule(this.dragSchedule, this._scheduleTime);\r\n+}\r\n+\r\n+onDisable() {\r\n+    this.relieveState();\r\n+    cc.audioEngine.stopAll();\r\n+}\r\n+}\r\n"
                },
                {
                    "date": 1625123322914,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -288,11 +288,8 @@\n     //返回角度,不是弧度\r\n     return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n }\r\n \r\n-————————————————\r\n-版权声明：本文为CSDN博主「I - T枭」的原创文章，遵循CC 4.0 BY - SA版权协议，转载请附上原文出处链接及本声明。\r\n-原文链接：https://blog.csdn.net/hahahhahahahha123456/article/details/96750558\r\n \r\n async playTitle(bool: boolean) {\r\n     this._c1.selectedIndex = bool ? 1 : 0;\r\n     if (bool) {\r\n"
                },
                {
                    "date": 1625123332459,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -281,128 +281,128 @@\n             this.playTitle(state.title);\r\n         }\r\n     }\r\n \r\n-    function angle(start, end) {\r\n-    var diff_x = end.x - start.x,\r\n-        diff_y = end.y - start.y;\r\n-    //返回角度,不是弧度\r\n-    return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n-}\r\n+    angle(start, end) {\r\n+        var diff_x = end.x - start.x,\r\n+            diff_y = end.y - start.y;\r\n+        //返回角度,不是弧度\r\n+        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n+    }\r\n \r\n \r\n-async playTitle(bool: boolean) {\r\n-    this._c1.selectedIndex = bool ? 1 : 0;\r\n-    if (bool) {\r\n-        cc.audioEngine.stopAll();\r\n-        this.forbidHandle();\r\n-        let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-        let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-        let audioId = cc.audioEngine.play(audio, false, 1);\r\n-        cc.audioEngine.setFinishCallback(audioId, () => {\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.title = false;\r\n+            state.submit = this.submitType.No;\r\n             this.updateState(state);\r\n-        });\r\n-    } else {\r\n-        this.disableForbidHandle();\r\n+        }, 2000);\r\n     }\r\n-}\r\n \r\n-answerFeedback(bool: boolean) {\r\n-    if (!this.feedback) return;\r\n-    let feedback: any = cc.instantiate(this.feedback);\r\n-    feedback.x = 960;\r\n-    feedback.y = 540;\r\n-    let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-    feedbackJs.init(bool);\r\n-    feedback.parent = cc.find(\"Canvas\").parent;\r\n \r\n-    setTimeout(() => {\r\n-        feedback.destroy();\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.No;\r\n-        this.updateState(state);\r\n-    }, 2000);\r\n-}\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n \r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n \r\n-/**\r\n- * 点击指引\r\n- * @param obj 点击对象\r\n- */\r\n-handTips2(obj: fgui.GObject) {\r\n-    let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-    this._view.addChild(hand);\r\n-    let tempX = obj.x;\r\n-    let tempY = obj.y;\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n \r\n-    hand.x = tempX;\r\n-    hand.y = tempY;\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n \r\n-    cc.tween(hand).to(0.3, {\r\n-        x: tempX - 30,\r\n-        y: tempY - 30\r\n-    }).to(0.3, {\r\n-        x: tempX,\r\n-        y: tempY\r\n-    }).to(0.3, {\r\n-        x: tempX - 30,\r\n-        y: tempY - 30\r\n-    }).to(0.3, {\r\n-        x: tempX,\r\n-        y: tempY\r\n-    }).call(() => {\r\n-        this._view.removeChild(hand);\r\n-        hand = null;\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.No;\r\n-        this.updateState(state)\r\n-    }).start();\r\n-}\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n \r\n-// 运行时 禁止操作\r\n-forbidHandle() {\r\n-    console.log('===  运行时 禁止操作 =====');\r\n-    let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-    if (!handleMask) {\r\n-        let handleMask = new cc.Node('handleMask');\r\n-        handleMask.addComponent(cc.BlockInputEvents);\r\n-        handleMask.parent = this._worldRoot;\r\n-        handleMask.width = 1920;\r\n-        handleMask.height = 1080;\r\n-        handleMask.x = 960;\r\n-        handleMask.y = 540;\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n     }\r\n-}\r\n \r\n-// 消除禁止\r\n-disableForbidHandle() {\r\n-    let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-    if (handleMask) handleMask.destroy();\r\n-}\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n \r\n-// 注册状态，及获取状态的方法\r\n-registerState() {\r\n-    if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-}\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n \r\n-// 解除状态，及获取状态的方法\r\n-relieveState() {\r\n-    if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-}\r\n+    onEnable() {\r\n+        this.registerState();\r\n+        this.schedule(this.dragSchedule, this._scheduleTime);\r\n+    }\r\n \r\n-// 本组件状态合并到全局\r\n-mergeState() {\r\n-    if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    onDisable() {\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n }\r\n-\r\n-onEnable() {\r\n-    this.registerState();\r\n-    this.schedule(this.dragSchedule, this._scheduleTime);\r\n-}\r\n-\r\n-onDisable() {\r\n-    this.relieveState();\r\n-    cc.audioEngine.stopAll();\r\n-}\r\n-}\r\n"
                },
                {
                    "date": 1625123361067,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -241,8 +241,10 @@\n             this.graphics.clear();\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n+                let angle = this.angle\r\n+\r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n"
                },
                {
                    "date": 1625123366694,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -241,9 +241,9 @@\n             this.graphics.clear();\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n-                let angle = this.angle\r\n+                let angle = this.angle();\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n"
                },
                {
                    "date": 1625123394899,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -241,9 +241,9 @@\n             this.graphics.clear();\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n-                let angle = this.angle();\r\n+                let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n"
                },
                {
                    "date": 1625123443530,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -248,9 +248,9 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n-\r\n+                zhiLine.skewX\r\n                 //this._zhiLine.y = 635;\r\n                 zhiLine.sortingOrder = 0;\r\n \r\n                 this._touchesPos.sort(this.comparePos());\r\n"
                },
                {
                    "date": 1625123450278,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -248,9 +248,9 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n-                zhiLine.skewX\r\n+                zhiLine.skewX = angle\r\n                 //this._zhiLine.y = 635;\r\n                 zhiLine.sortingOrder = 0;\r\n \r\n                 this._touchesPos.sort(this.comparePos());\r\n"
                },
                {
                    "date": 1625123459351,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -248,9 +248,10 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n-                zhiLine.skewX = angle\r\n+                zhiLine.skewX = -angle;\r\n+                zhiLine.skewX = -angle;\r\n                 //this._zhiLine.y = 635;\r\n                 zhiLine.sortingOrder = 0;\r\n \r\n                 this._touchesPos.sort(this.comparePos());\r\n"
                },
                {
                    "date": 1625123465948,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -249,9 +249,9 @@\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 zhiLine.skewX = -angle;\r\n-                zhiLine.skewX = -angle;\r\n+                zhiLine.skewY = -angle;\r\n                 //this._zhiLine.y = 635;\r\n                 zhiLine.sortingOrder = 0;\r\n \r\n                 this._touchesPos.sort(this.comparePos());\r\n"
                },
                {
                    "date": 1625123577480,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -241,9 +241,9 @@\n             this.graphics.clear();\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n-                let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length]);\r\n+                let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n"
                },
                {
                    "date": 1625123616648,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -248,10 +248,10 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n-                zhiLine.skewX = -angle;\r\n-                zhiLine.skewY = -angle;\r\n+                zhiLine.skewX = angle;\r\n+                zhiLine.skewY = angle;\r\n                 //this._zhiLine.y = 635;\r\n                 zhiLine.sortingOrder = 0;\r\n \r\n                 this._touchesPos.sort(this.comparePos());\r\n"
                },
                {
                    "date": 1625123629491,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -243,8 +243,10 @@\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n+                console.log('===== ===' = );\r\n+\r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n"
                },
                {
                    "date": 1625123634699,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -243,9 +243,9 @@\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n-                console.log('===== ===' = );\r\n+                console.log('===== ===' + angle);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n"
                },
                {
                    "date": 1625123639859,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -243,9 +243,9 @@\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n-                console.log('===== ===' + angle);\r\n+                console.log('===== angle 333 ===' + angle);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n"
                },
                {
                    "date": 1625123645548,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -243,9 +243,9 @@\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n-                console.log('===== angle 333 ===' + angle);\r\n+                console.log('===== angle 333 === ' + angle);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n"
                },
                {
                    "date": 1625123731316,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -250,10 +250,10 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n-                zhiLine.skewX = angle;\r\n-                zhiLine.skewY = angle;\r\n+                zhiLine.rotation = angle;\r\n+\r\n                 //this._zhiLine.y = 635;\r\n                 zhiLine.sortingOrder = 0;\r\n \r\n                 this._touchesPos.sort(this.comparePos());\r\n"
                },
                {
                    "date": 1625123763501,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -243,16 +243,16 @@\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n-                console.log('===== angle 333 === ' + angle);\r\n+                console.log('===== angle 999999 === ' + angle);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n-                zhiLine.rotation = angle;\r\n+                zhiLine.rotation = -angle;\r\n \r\n                 //this._zhiLine.y = 635;\r\n                 zhiLine.sortingOrder = 0;\r\n \r\n"
                },
                {
                    "date": 1625124105712,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -247,9 +247,9 @@\n                 console.log('===== angle 999999 === ' + angle);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n-                zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n+                zhiLine.width = this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag()\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 zhiLine.rotation = -angle;\r\n \r\n"
                },
                {
                    "date": 1625124110754,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -247,9 +247,9 @@\n                 console.log('===== angle 999999 === ' + angle);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n-                zhiLine.width = this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag()\r\n+                zhiLine.width = this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag();\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 zhiLine.rotation = -angle;\r\n \r\n"
                },
                {
                    "date": 1625124135040,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -247,9 +247,9 @@\n                 console.log('===== angle 999999 === ' + angle);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n-                zhiLine.width = this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag();\r\n+                zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 zhiLine.rotation = -angle;\r\n \r\n"
                },
                {
                    "date": 1625124458526,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -252,9 +252,8 @@\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 zhiLine.rotation = -angle;\r\n \r\n-                //this._zhiLine.y = 635;\r\n                 zhiLine.sortingOrder = 0;\r\n \r\n                 this._touchesPos.sort(this.comparePos());\r\n \r\n"
                },
                {
                    "date": 1625192839355,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -221,8 +221,9 @@\n \r\n         } else if (state.touch == \"move\") {\r\n \r\n             this._touchesPos = state.touchesPos;\r\n+\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n             let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n             this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n@@ -239,8 +240,10 @@\n         } else if (state.touch == \"end\") {\r\n \r\n             this.graphics.clear();\r\n \r\n+            this._touchesPos.sort(this.comparePos());\r\n+\r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n@@ -254,11 +257,11 @@\n                 zhiLine.rotation = -angle;\r\n \r\n                 zhiLine.sortingOrder = 0;\r\n \r\n-                this._touchesPos.sort(this.comparePos());\r\n \r\n \r\n+\r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1625194324553,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -256,12 +256,8 @@\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 zhiLine.rotation = -angle;\r\n \r\n                 zhiLine.sortingOrder = 0;\r\n-\r\n-\r\n-\r\n-\r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1625194398159,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,8 +37,10 @@\n     private _dragging = false;\r\n \r\n     private _scheduleTime = 0.03;\r\n \r\n+    private\r\n+\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n"
                },
                {
                    "date": 1625194415959,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,9 +37,9 @@\n     private _dragging = false;\r\n \r\n     private _scheduleTime = 0.03;\r\n \r\n-    private\r\n+    private _selflLines\r\n \r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n"
                },
                {
                    "date": 1625194436879,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,9 +37,9 @@\n     private _dragging = false;\r\n \r\n     private _scheduleTime = 0.03;\r\n \r\n-    private _selflLines\r\n+    private _selflLines = {};\r\n \r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n"
                },
                {
                    "date": 1625194480700,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -258,8 +258,10 @@\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 zhiLine.rotation = -angle;\r\n \r\n                 zhiLine.sortingOrder = 0;\r\n+\r\n+                _selflLines\r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1625194497053,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -259,9 +259,9 @@\n                 zhiLine.rotation = -angle;\r\n \r\n                 zhiLine.sortingOrder = 0;\r\n \r\n-                _selflLines\r\n+                this._selflLines\r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1625194540083,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,9 +37,9 @@\n     private _dragging = false;\r\n \r\n     private _scheduleTime = 0.03;\r\n \r\n-    private _selflLines = {};\r\n+    private _selflLines = [];\r\n \r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n"
                },
                {
                    "date": 1625194555764,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -259,9 +259,9 @@\n                 zhiLine.rotation = -angle;\r\n \r\n                 zhiLine.sortingOrder = 0;\r\n \r\n-                this._selflLines\r\n+                this._selflLines.push();\r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1625194561074,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -259,9 +259,9 @@\n                 zhiLine.rotation = -angle;\r\n \r\n                 zhiLine.sortingOrder = 0;\r\n \r\n-                this._selflLines.push();\r\n+                this._selflLines.push(zhiLine);\r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1625194592394,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -258,8 +258,9 @@\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 zhiLine.rotation = -angle;\r\n \r\n                 zhiLine.sortingOrder = 0;\r\n+                zhiLine.data = { index: this._selflLines };\r\n \r\n                 this._selflLines.push(zhiLine);\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625194677351,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -258,9 +258,9 @@\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 zhiLine.rotation = -angle;\r\n \r\n                 zhiLine.sortingOrder = 0;\r\n-                zhiLine.data = { index: this._selflLines };\r\n+                zhiLine.data = { index: this._selflLines.length };\r\n \r\n                 this._selflLines.push(zhiLine);\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625194739287,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -258,10 +258,11 @@\n                 zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                 zhiLine.rotation = -angle;\r\n \r\n                 zhiLine.sortingOrder = 0;\r\n-                zhiLine.data = { index: this._selflLines.length };\r\n \r\n+                zhiLine.data = { index: this._selflLines.length, type: };\r\n+\r\n                 this._selflLines.push(zhiLine);\r\n             }\r\n \r\n         }\r\n"
                },
                {
                    "date": 1625194760153,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,8 +47,14 @@\n         WrongFeed: 2,\r\n         RightFeed: 3\r\n     });\r\n \r\n+    private gameResult: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        Fail: 2,\r\n+        Success: 3\r\n+    });\r\n     // 远程动态组件\r\n     private feedback: any;\r\n \r\n     private _state = {};\r\n"
                },
                {
                    "date": 1625194781948,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,14 +47,16 @@\n         WrongFeed: 2,\r\n         RightFeed: 3\r\n     });\r\n \r\n-    private gameResult: any = cc.Enum({\r\n+    private lineType: any = cc.Enum({\r\n \r\n-        No: 0,\r\n-        Fail: 2,\r\n-        Success: 3\r\n+        StraightLine: 0,\r\n+        LineSegment: 1,\r\n+        LeftLanRays: 2,\r\n+        RightRedRays: 3\r\n     });\r\n+\r\n     // 远程动态组件\r\n     private feedback: any;\r\n \r\n     private _state = {};\r\n"
                },
                {
                    "date": 1625194798398,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -50,11 +50,9 @@\n \r\n     private lineType: any = cc.Enum({\r\n \r\n         StraightLine: 0,\r\n-        LineSegment: 1,\r\n-        LeftLanRays: 2,\r\n-        RightRedRays: 3\r\n+        LineSegment: 1\r\n     });\r\n \r\n     // 远程动态组件\r\n     private feedback: any;\r\n"
                },
                {
                    "date": 1625194865656,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -265,16 +265,14 @@\n                 zhiLine.rotation = -angle;\r\n \r\n                 zhiLine.sortingOrder = 0;\r\n \r\n-                zhiLine.data = { index: this._selflLines.length, type: };\r\n+                zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n \r\n                 this._selflLines.push(zhiLine);\r\n             }\r\n-\r\n         }\r\n \r\n-\r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n             if (state.submit === this.submitType.RightFeed) {\r\n \r\n"
                },
                {
                    "date": 1625194880446,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,8 +39,9 @@\n     private _scheduleTime = 0.03;\r\n \r\n     private _selflLines = [];\r\n \r\n+\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n"
                },
                {
                    "date": 1625194904917,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,9 +39,9 @@\n     private _scheduleTime = 0.03;\r\n \r\n     private _selflLines = [];\r\n \r\n-\r\n+    private _allDian\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n"
                },
                {
                    "date": 1625194911926,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,9 +39,9 @@\n     private _scheduleTime = 0.03;\r\n \r\n     private _selflLines = [];\r\n \r\n-    private _allDian\r\n+    private _allSpot\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n"
                },
                {
                    "date": 1625194943982,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,9 +39,9 @@\n     private _scheduleTime = 0.03;\r\n \r\n     private _selflLines = [];\r\n \r\n-    private _allSpot\r\n+    private _allPoint\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n"
                },
                {
                    "date": 1625194952597,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,9 +39,10 @@\n     private _scheduleTime = 0.03;\r\n \r\n     private _selflLines = [];\r\n \r\n-    private _allPoint\r\n+    private _allPointRect = [];\r\n+\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n"
                },
                {
                    "date": 1625195034347,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -88,8 +88,9 @@\n             this._c1.selectedIndex = 1;\r\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n+        this._allPointRect\r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n         this._title = this._view.getChild(\"title\").asButton;\r\n@@ -290,9 +291,8 @@\n                 this.handTips2(keyBtn);\r\n             }\r\n         }\r\n \r\n-\r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n             this.playTitle(state.title);\r\n         }\r\n     }\r\n"
                },
                {
                    "date": 1625195070084,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -88,9 +88,9 @@\n             this._c1.selectedIndex = 1;\r\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n-        this._allPointRect\r\n+        this._allPointRect = [];\r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n         this._title = this._view.getChild(\"title\").asButton;\r\n"
                },
                {
                    "date": 1625195249538,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -88,9 +88,11 @@\n             this._c1.selectedIndex = 1;\r\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n-        this._allPointRect = [];\r\n+\r\n+        this._allPointRect = [new cc.Rect(610, 614, 80, 80), new cc.Rect(610, 614, 80, 80), new cc.Rect(610, 614, 80, 80), new cc.Rect(610, 614, 80, 80)];\r\n+\r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n         this._title = this._view.getChild(\"title\").asButton;\r\n"
                },
                {
                    "date": 1625195266444,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -89,9 +89,9 @@\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n \r\n-        this._allPointRect = [new cc.Rect(610, 614, 80, 80), new cc.Rect(610, 614, 80, 80), new cc.Rect(610, 614, 80, 80), new cc.Rect(610, 614, 80, 80)];\r\n+        this._allPointRect = [new cc.Rect(610, 614, 80, 80), new cc.Rect(1204, 610, 80, 80), new cc.Rect(610, 614, 80, 80), new cc.Rect(610, 614, 80, 80)];\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n"
                },
                {
                    "date": 1625195289354,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -89,9 +89,9 @@\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n \r\n-        this._allPointRect = [new cc.Rect(610, 614, 80, 80), new cc.Rect(1204, 610, 80, 80), new cc.Rect(610, 614, 80, 80), new cc.Rect(610, 614, 80, 80)];\r\n+        this._allPointRect = [new cc.Rect(610, 614, 80, 80), new cc.Rect(1204, 610, 80, 80), new cc.Rect(1205, 240, 80, 80), new cc.Rect(610, 240, 80, 80)];\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n"
                },
                {
                    "date": 1625195373358,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -255,8 +255,9 @@\n             this.graphics.clear();\r\n \r\n             this._touchesPos.sort(this.comparePos());\r\n \r\n+\r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625195429465,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -255,9 +255,11 @@\n             this.graphics.clear();\r\n \r\n             this._touchesPos.sort(this.comparePos());\r\n \r\n+            for (let i = 0; i < this._touchesPos) {\r\n \r\n+            }\r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625195445874,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -255,9 +255,9 @@\n             this.graphics.clear();\r\n \r\n             this._touchesPos.sort(this.comparePos());\r\n \r\n-            for (let i = 0; i < this._touchesPos) {\r\n+            for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n             }\r\n             if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625195464708,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -258,8 +258,9 @@\n \r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n             }\r\n+\r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625195493703,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -257,8 +257,9 @@\n             this._touchesPos.sort(this.comparePos());\r\n \r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n+                let tempPos = this._touchesPos[i];\r\n             }\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625195505869,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -258,8 +258,9 @@\n \r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n+                tempPos.y = \r\n             }\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625195520077,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -258,9 +258,9 @@\n \r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n-                tempPos.y = \r\n+                tempPos.y = this._view.height - this._touchesPos[0].y;\r\n             }\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625195534803,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -258,9 +258,9 @@\n \r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n-                tempPos.y = this._view.height - this._touchesPos[0].y;\r\n+                tempPos.y = this._view.height - tempPos.y\r\n             }\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625195540194,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -258,9 +258,10 @@\n \r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n-                tempPos.y = this._view.height - tempPos.y\r\n+                tempPos.y = this._view.height - tempPos.y;\r\n+\r\n             }\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625195663630,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -259,9 +259,11 @@\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n                 tempPos.y = this._view.height - tempPos.y;\r\n+                if (this._allPointRect[0].contains) {\r\n \r\n+                }\r\n             }\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625195669308,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -259,9 +259,9 @@\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n                 tempPos.y = this._view.height - tempPos.y;\r\n-                if (this._allPointRect[0].contains) {\r\n+                if (this._allPointRect[0].contains(tempPos)) {\r\n \r\n                 }\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625195702455,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -259,8 +259,9 @@\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n                 tempPos.y = this._view.height - tempPos.y;\r\n+                //是否包含红点\r\n                 if (this._allPointRect[0].contains(tempPos)) {\r\n \r\n                 }\r\n             }\r\n"
                },
                {
                    "date": 1625195757897,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -262,8 +262,9 @@\n                 tempPos.y = this._view.height - tempPos.y;\r\n                 //是否包含红点\r\n                 if (this._allPointRect[0].contains(tempPos)) {\r\n \r\n+\r\n                 }\r\n             }\r\n \r\n             if (this._touchesPos.length > 0) {\r\n"
                },
                {
                    "date": 1625195775241,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -262,9 +262,8 @@\n                 tempPos.y = this._view.height - tempPos.y;\r\n                 //是否包含红点\r\n                 if (this._allPointRect[0].contains(tempPos)) {\r\n \r\n-\r\n                 }\r\n             }\r\n \r\n             if (this._touchesPos.length > 0) {\r\n"
                },
                {
                    "date": 1625195828719,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -255,8 +255,9 @@\n             this.graphics.clear();\r\n \r\n             this._touchesPos.sort(this.comparePos());\r\n \r\n+            let isHave\r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n                 tempPos.y = this._view.height - tempPos.y;\r\n"
                },
                {
                    "date": 1625195847754,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -255,9 +255,9 @@\n             this.graphics.clear();\r\n \r\n             this._touchesPos.sort(this.comparePos());\r\n \r\n-            let isHave\r\n+            let pointNumber = 0;\r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n                 tempPos.y = this._view.height - tempPos.y;\r\n"
                },
                {
                    "date": 1625195916501,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -89,9 +89,9 @@\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n \r\n-        this._allPointRect = [new cc.Rect(610, 614, 80, 80), new cc.Rect(1204, 610, 80, 80), new cc.Rect(1205, 240, 80, 80), new cc.Rect(610, 240, 80, 80)];\r\n+        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80) }, new cc.Rect(1204, 610, 80, 80), new cc.Rect(1205, 240, 80, 80), new cc.Rect(610, 240, 80, 80)];\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n"
                },
                {
                    "date": 1625195940727,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -89,9 +89,9 @@\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n \r\n-        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80) }, new cc.Rect(1204, 610, 80, 80), new cc.Rect(1205, 240, 80, 80), new cc.Rect(610, 240, 80, 80)];\r\n+        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'isContaint'}, new cc.Rect(1204, 610, 80, 80), new cc.Rect(1205, 240, 80, 80), new cc.Rect(610, 240, 80, 80)];\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n"
                },
                {
                    "date": 1625195956204,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -89,9 +89,9 @@\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n \r\n-        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'isContaint'}, new cc.Rect(1204, 610, 80, 80), new cc.Rect(1205, 240, 80, 80), new cc.Rect(610, 240, 80, 80)];\r\n+        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'contains'}, new cc.Rect(1204, 610, 80, 80), new cc.Rect(1205, 240, 80, 80), new cc.Rect(610, 240, 80, 80)];\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n"
                },
                {
                    "date": 1625195961625,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -89,9 +89,9 @@\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n \r\n-        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'contains'}, new cc.Rect(1204, 610, 80, 80), new cc.Rect(1205, 240, 80, 80), new cc.Rect(610, 240, 80, 80)];\r\n+        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'contains': false }, new cc.Rect(1204, 610, 80, 80), new cc.Rect(1205, 240, 80, 80), new cc.Rect(610, 240, 80, 80)];\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n"
                },
                {
                    "date": 1625196008964,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -89,9 +89,12 @@\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n \r\n-        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'contains': false }, new cc.Rect(1204, 610, 80, 80), new cc.Rect(1205, 240, 80, 80), new cc.Rect(610, 240, 80, 80)];\r\n+        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'isContains': false },\r\n+        { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false },\r\n+        new cc.Rect(1205, 240, 80, 80),\r\n+        new cc.Rect(610, 240, 80, 80)];\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n"
                },
                {
                    "date": 1625196065254,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,10 +91,11 @@\n \r\n \r\n         this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'isContains': false },\r\n         { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false },\r\n-        new cc.Rect(1205, 240, 80, 80),\r\n-        new cc.Rect(610, 240, 80, 80)];\r\n+        { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false },\r\n+        { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false }\r\n+        ];\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n"
                },
                {
                    "date": 1625196107501,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -267,8 +267,9 @@\n                 tempPos.y = this._view.height - tempPos.y;\r\n                 //是否包含红点\r\n                 if (this._allPointRect[0].contains(tempPos)) {\r\n \r\n+\r\n                 }\r\n             }\r\n \r\n             if (this._touchesPos.length > 0) {\r\n"
                },
                {
                    "date": 1625196151329,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -264,12 +264,17 @@\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n                 tempPos.y = this._view.height - tempPos.y;\r\n+\r\n+                for (let j = 0; j < this._allPointRect.length; j++) {\r\n+\r\n+                }\r\n                 //是否包含红点\r\n-                if (this._allPointRect[0].contains(tempPos)) {\r\n+                if (this._allPointRect[0].rect.contains(tempPos)) {\r\n \r\n \r\n+\r\n                 }\r\n             }\r\n \r\n             if (this._touchesPos.length > 0) {\r\n"
                },
                {
                    "date": 1625196157192,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -267,15 +267,16 @@\n                 tempPos.y = this._view.height - tempPos.y;\r\n \r\n                 for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n-                }\r\n-                //是否包含红点\r\n-                if (this._allPointRect[0].rect.contains(tempPos)) {\r\n+                    //是否包含红点\r\n+                    if (this._allPointRect[0].rect.contains(tempPos)) {\r\n \r\n \r\n \r\n+                    }\r\n                 }\r\n+\r\n             }\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625196164168,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -268,9 +268,9 @@\n \r\n                 for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n                     //是否包含红点\r\n-                    if (this._allPointRect[0].rect.contains(tempPos)) {\r\n+                    if (this._allPointRect[j].rect.contains(tempPos)) {\r\n \r\n \r\n \r\n                     }\r\n"
                },
                {
                    "date": 1625196169477,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -264,9 +264,8 @@\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n                 tempPos.y = this._view.height - tempPos.y;\r\n-\r\n                 for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n                     //是否包含红点\r\n                     if (this._allPointRect[j].rect.contains(tempPos)) {\r\n"
                },
                {
                    "date": 1625196175507,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -269,10 +269,8 @@\n \r\n                     //是否包含红点\r\n                     if (this._allPointRect[j].rect.contains(tempPos)) {\r\n \r\n-\r\n-\r\n                     }\r\n                 }\r\n \r\n             }\r\n"
                },
                {
                    "date": 1625196202565,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -268,9 +268,9 @@\n                 for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n                     //是否包含红点\r\n                     if (this._allPointRect[j].rect.contains(tempPos)) {\r\n-\r\n+                        this._allPointRect[j].isContains();\r\n                     }\r\n                 }\r\n \r\n             }\r\n"
                },
                {
                    "date": 1625196211376,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -268,9 +268,9 @@\n                 for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n                     //是否包含红点\r\n                     if (this._allPointRect[j].rect.contains(tempPos)) {\r\n-                        this._allPointRect[j].isContains();\r\n+                        this._allPointRect[j].isContains = true;\r\n                     }\r\n                 }\r\n \r\n             }\r\n"
                },
                {
                    "date": 1625196216940,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -269,8 +269,9 @@\n \r\n                     //是否包含红点\r\n                     if (this._allPointRect[j].rect.contains(tempPos)) {\r\n                         this._allPointRect[j].isContains = true;\r\n+                        break;\r\n                     }\r\n                 }\r\n \r\n             }\r\n"
                },
                {
                    "date": 1625196250777,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,4 +1,5 @@\n+import chooseAnswer_model0403_v2 from '../../numberPatterns/chooseAnswer-model0403-v2';\r\n \r\n /*\r\n  * @Descripttion: \r\n  * @version: \r\n@@ -272,11 +273,11 @@\n                         this._allPointRect[j].isContains = true;\r\n                         break;\r\n                     }\r\n                 }\r\n-\r\n             }\r\n \r\n+            console.log('===== ====');\r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625196261221,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -275,9 +275,10 @@\n                     }\r\n                 }\r\n             }\r\n \r\n-            console.log('===== ====');\r\n+            console.log('===== ====' + );\r\n+\r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625196286922,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -260,9 +260,8 @@\n             this.graphics.clear();\r\n \r\n             this._touchesPos.sort(this.comparePos());\r\n \r\n-            let pointNumber = 0;\r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n                 tempPos.y = this._view.height - tempPos.y;\r\n@@ -275,9 +274,9 @@\n                     }\r\n                 }\r\n             }\r\n \r\n-            console.log('===== ====' + );\r\n+            console.log('===== 是否包含点的判断 ====' + );\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n"
                },
                {
                    "date": 1625196297630,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -274,9 +274,10 @@\n                     }\r\n                 }\r\n             }\r\n \r\n-            console.log('===== 是否包含点的判断 ====' + );\r\n+            console.log('===== 是否包含点的判断 ====');\r\n+            console.log();\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n"
                },
                {
                    "date": 1625196302938,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -275,9 +275,9 @@\n                 }\r\n             }\r\n \r\n             console.log('===== 是否包含点的判断 ====');\r\n-            console.log();\r\n+            console.log(this._allPointRect);\r\n \r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n"
                },
                {
                    "date": 1625196337773,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -287,9 +287,9 @@\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n-                zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n+                zhiLine.y = this._touchesPos[0].y;\r\n                 zhiLine.rotation = -angle;\r\n \r\n                 zhiLine.sortingOrder = 0;\r\n \r\n"
                },
                {
                    "date": 1625196425315,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -260,8 +260,17 @@\n             this.graphics.clear();\r\n \r\n             this._touchesPos.sort(this.comparePos());\r\n \r\n+            for (let j = 0; j < this._allPointRect.length; j++) {\r\n+\r\n+                //是否包含红点\r\n+                if (this._allPointRect[j].rect.contains(tempPos)) {\r\n+                    this._allPointRect[j].isContains = true;\r\n+                    break;\r\n+                }\r\n+            }\r\n+\r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n                 tempPos.y = this._view.height - tempPos.y;\r\n"
                },
                {
                    "date": 1625196441356,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -260,9 +260,9 @@\n             this.graphics.clear();\r\n \r\n             this._touchesPos.sort(this.comparePos());\r\n \r\n-            for (let j = 0; j < this._allPointRect.length; j++) {\r\n+            for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                 //是否包含红点\r\n                 if (this._allPointRect[j].rect.contains(tempPos)) {\r\n                     this._allPointRect[j].isContains = true;\r\n"
                },
                {
                    "date": 1625196448419,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -263,10 +263,10 @@\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                 //是否包含红点\r\n-                if (this._allPointRect[j].rect.contains(tempPos)) {\r\n-                    this._allPointRect[j].isContains = true;\r\n+                if (this._allPointRect[i].rect.contains(tempPos)) {\r\n+                    this._allPointRect[i].isContains = true;\r\n                     break;\r\n                 }\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625196457293,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -262,13 +262,9 @@\n             this._touchesPos.sort(this.comparePos());\r\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                //是否包含红点\r\n-                if (this._allPointRect[i].rect.contains(tempPos)) {\r\n-                    this._allPointRect[i].isContains = true;\r\n-                    break;\r\n-                }\r\n+                this._allPointRect[i].isContains = true;\r\n             }\r\n \r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n"
                },
                {
                    "date": 1625196465609,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -262,9 +262,9 @@\n             this._touchesPos.sort(this.comparePos());\r\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                this._allPointRect[i].isContains = true;\r\n+                this._allPointRect[i].isContains = false;\r\n             }\r\n \r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n"
                },
                {
                    "date": 1625196550844,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -293,9 +293,9 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n                 zhiLine.x = this._touchesPos[0].x;\r\n                 zhiLine.y = this._touchesPos[0].y;\r\n-                zhiLine.rotation = -angle;\r\n+                zhiLine.rotation = angle;\r\n \r\n                 zhiLine.sortingOrder = 0;\r\n \r\n                 zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n"
                },
                {
                    "date": 1625196603067,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -124,9 +124,9 @@\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n-            touch: \"end\",\r\n+            touch: \"no\",\r\n             reset: false,\r\n             touchesPos: [],\r\n         }\r\n     }\r\n"
                },
                {
                    "date": 1625196619407,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -301,8 +301,10 @@\n                 zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n \r\n                 this._selflLines.push(zhiLine);\r\n             }\r\n+\r\n+\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n"
                },
                {
                    "date": 1625196631669,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -302,9 +302,11 @@\n \r\n                 this._selflLines.push(zhiLine);\r\n             }\r\n \r\n+            setTimeout(() => {\r\n \r\n+            });\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n"
                },
                {
                    "date": 1625196639263,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -304,8 +304,10 @@\n             }\r\n \r\n             setTimeout(() => {\r\n \r\n+\r\n+\r\n             });\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n"
                },
                {
                    "date": 1625196651953,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -304,10 +304,12 @@\n             }\r\n \r\n             setTimeout(() => {\r\n \r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n \r\n-\r\n             });\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n"
                },
                {
                    "date": 1625196658677,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -305,9 +305,9 @@\n \r\n             setTimeout(() => {\r\n \r\n                 let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n+                state.touch = false;\r\n                 this.updateState(state);\r\n \r\n             });\r\n         }\r\n"
                },
                {
                    "date": 1625196665667,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -305,9 +305,9 @@\n \r\n             setTimeout(() => {\r\n \r\n                 let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.touch = false;\r\n+                state.touch = 'no';\r\n                 this.updateState(state);\r\n \r\n             });\r\n         }\r\n"
                },
                {
                    "date": 1625196687019,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -271,9 +271,8 @@\n                 let tempPos = this._touchesPos[i];\r\n                 tempPos.y = this._view.height - tempPos.y;\r\n                 for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n-                    //是否包含红点\r\n                     if (this._allPointRect[j].rect.contains(tempPos)) {\r\n                         this._allPointRect[j].isContains = true;\r\n                         break;\r\n                     }\r\n"
                },
                {
                    "date": 1625196723003,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -265,8 +265,9 @@\n \r\n                 this._allPointRect[i].isContains = false;\r\n             }\r\n \r\n+            let pointNums = 0;\r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n                 tempPos.y = this._view.height - tempPos.y;\r\n@@ -281,8 +282,9 @@\n \r\n             console.log('===== 是否包含点的判断 ====');\r\n             console.log(this._allPointRect);\r\n \r\n+\r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625196733822,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -274,8 +274,9 @@\n                 for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n                     if (this._allPointRect[j].rect.contains(tempPos)) {\r\n                         this._allPointRect[j].isContains = true;\r\n+                        pointNums++;\r\n                         break;\r\n                     }\r\n                 }\r\n             }\r\n"
                },
                {
                    "date": 1625196756732,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -283,9 +283,8 @@\n \r\n             console.log('===== 是否包含点的判断 ====');\r\n             console.log(this._allPointRect);\r\n \r\n-\r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625196811501,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -283,8 +283,11 @@\n \r\n             console.log('===== 是否包含点的判断 ====');\r\n             console.log(this._allPointRect);\r\n \r\n+            if (pointNums < 2) {\r\n+\r\n+            }\r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625196818843,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -283,10 +283,11 @@\n \r\n             console.log('===== 是否包含点的判断 ====');\r\n             console.log(this._allPointRect);\r\n \r\n-            if (pointNums < 2) {\r\n+            if (pointNums >= 2) {\r\n \r\n+\r\n             }\r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n"
                },
                {
                    "date": 1625196827764,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -286,29 +286,30 @@\n \r\n             if (pointNums >= 2) {\r\n \r\n \r\n-            }\r\n-            if (this._touchesPos.length > 0) {\r\n+                if (this._touchesPos.length > 0) {\r\n \r\n-                let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n+                    let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n-                console.log('===== angle 999999 === ' + angle);\r\n+                    console.log('===== angle 999999 === ' + angle);\r\n \r\n-                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                this._view.addChild(zhiLine);\r\n-                zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n-                zhiLine.x = this._touchesPos[0].x;\r\n-                zhiLine.y = this._touchesPos[0].y;\r\n-                zhiLine.rotation = angle;\r\n+                    let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                    this._view.addChild(zhiLine);\r\n+                    zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n+                    zhiLine.x = this._touchesPos[0].x;\r\n+                    zhiLine.y = this._touchesPos[0].y;\r\n+                    zhiLine.rotation = angle;\r\n \r\n-                zhiLine.sortingOrder = 0;\r\n+                    zhiLine.sortingOrder = 0;\r\n \r\n-                zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n+                    zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n \r\n-                this._selflLines.push(zhiLine);\r\n+                    this._selflLines.push(zhiLine);\r\n+                }\r\n             }\r\n \r\n+\r\n             setTimeout(() => {\r\n \r\n                 let state: any = globalThis._.cloneDeep(this._state);\r\n                 state.touch = 'no';\r\n"
                },
                {
                    "date": 1625196833538,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -285,9 +285,8 @@\n             console.log(this._allPointRect);\r\n \r\n             if (pointNums >= 2) {\r\n \r\n-\r\n                 if (this._touchesPos.length > 0) {\r\n \r\n                     let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625196881354,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -274,9 +274,8 @@\n                 for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n                     if (this._allPointRect[j].rect.contains(tempPos)) {\r\n                         this._allPointRect[j].isContains = true;\r\n-                        pointNums++;\r\n                         break;\r\n                     }\r\n                 }\r\n             }\r\n"
                },
                {
                    "date": 1625196895675,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -279,8 +279,16 @@\n                     }\r\n                 }\r\n             }\r\n \r\n+            for (let j = 0; j < this._allPointRect.length; j++) {\r\n+\r\n+                if (this._allPointRect[j].rect.contains(tempPos)) {\r\n+                    this._allPointRect[j].isContains = true;\r\n+                    break;\r\n+                }\r\n+            }\r\n+\r\n             console.log('===== 是否包含点的判断 ====');\r\n             console.log(this._allPointRect);\r\n \r\n             if (pointNums >= 2) {\r\n"
                },
                {
                    "date": 1625196901017,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -279,9 +279,9 @@\n                     }\r\n                 }\r\n             }\r\n \r\n-            for (let j = 0; j < this._allPointRect.length; j++) {\r\n+            for (let i = 0; i < this._allPointRect.length; j++) {\r\n \r\n                 if (this._allPointRect[j].rect.contains(tempPos)) {\r\n                     this._allPointRect[j].isContains = true;\r\n                     break;\r\n"
                },
                {
                    "date": 1625196913884,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -279,12 +279,12 @@\n                     }\r\n                 }\r\n             }\r\n \r\n-            for (let i = 0; i < this._allPointRect.length; j++) {\r\n+            for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                if (this._allPointRect[j].rect.contains(tempPos)) {\r\n-                    this._allPointRect[j].isContains = true;\r\n+                if (this._allPointRect[j].isContains) {\r\n+                     = true;\r\n                     break;\r\n                 }\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625196920374,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -282,10 +282,9 @@\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                 if (this._allPointRect[j].isContains) {\r\n-                     = true;\r\n-                    break;\r\n+\r\n                 }\r\n             }\r\n \r\n             console.log('===== 是否包含点的判断 ====');\r\n"
                },
                {
                    "date": 1625196928372,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -281,10 +281,10 @@\n             }\r\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                if (this._allPointRect[j].isContains) {\r\n-\r\n+                if (this._allPointRect[i].isContains) {\r\n+                    pointNums++;\r\n                 }\r\n             }\r\n \r\n             console.log('===== 是否包含点的判断 ====');\r\n"
                },
                {
                    "date": 1625198916539,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,9 +90,9 @@\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n \r\n-        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'isContains': false },\r\n+        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'isContains': false, },\r\n         { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false },\r\n         { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false },\r\n         { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false }\r\n         ];\r\n"
                },
                {
                    "date": 1625199102370,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,9 +90,9 @@\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n \r\n-        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'isContains': false, },\r\n+        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 },\r\n         { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false },\r\n         { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false },\r\n         { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false }\r\n         ];\r\n"
                },
                {
                    "date": 1625199114443,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,11 +91,11 @@\n         }\r\n \r\n \r\n         this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 },\r\n-        { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false },\r\n-        { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false },\r\n-        { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false }\r\n+        { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 },\r\n+        { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 },\r\n+        { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 }\r\n         ];\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n"
                },
                {
                    "date": 1625199172949,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,9 +91,9 @@\n         }\r\n \r\n \r\n         this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 },\r\n-        { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 },\r\n+        { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690 },\r\n         { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 },\r\n         { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 }\r\n         ];\r\n \r\n"
                },
                {
                    "date": 1625199269433,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,9 +92,9 @@\n \r\n \r\n         this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 },\r\n         { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690 },\r\n-        { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 },\r\n+        { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320 },\r\n         { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 }\r\n         ];\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n"
                },
                {
                    "date": 1625199372822,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -93,9 +93,9 @@\n \r\n         this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 },\r\n         { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690 },\r\n         { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320 },\r\n-        { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 }\r\n+        { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320 }\r\n         ];\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n"
                },
                {
                    "date": 1625199538571,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -291,8 +291,10 @@\n             console.log(this._allPointRect);\r\n \r\n             if (pointNums >= 2) {\r\n \r\n+\r\n+\r\n                 if (this._touchesPos.length > 0) {\r\n \r\n                     let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625199561334,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -293,8 +293,9 @@\n             if (pointNums >= 2) {\r\n \r\n \r\n \r\n+\r\n                 if (this._touchesPos.length > 0) {\r\n \r\n                     let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625199626094,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -293,9 +293,8 @@\n             if (pointNums >= 2) {\r\n \r\n \r\n \r\n-\r\n                 if (this._touchesPos.length > 0) {\r\n \r\n                     let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625199754848,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,9 +90,18 @@\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n \r\n-        this._allPointRect = [{ 'rect': new cc.Rect(610, 614, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 614, 'maxy': 694 },\r\n+        this._allPointRect = [{\r\n+            'rect': new cc.Rect(610, 614, 80, 80),\r\n+            'isContains': false,\r\n+            'minx': 610,\r\n+            'maxx': 690,\r\n+            'miny': 614,\r\n+            'maxy': 694,\r\n+            'limitMinx': false,\r\n+            'limitmMaxx': false,\r\n+        },\r\n         { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690 },\r\n         { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320 },\r\n         { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320 }\r\n         ];\r\n"
                },
                {
                    "date": 1625199788887,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -98,9 +98,10 @@\n             'maxx': 690,\r\n             'miny': 614,\r\n             'maxy': 694,\r\n             'limitMinx': false,\r\n-            'limitmMaxx': false,\r\n+            'limitMaxx': false,\r\n+            'limitMiny': false,\r\n         },\r\n         { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690 },\r\n         { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320 },\r\n         { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320 }\r\n"
                },
                {
                    "date": 1625199796067,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -100,8 +100,9 @@\n             'maxy': 694,\r\n             'limitMinx': false,\r\n             'limitMaxx': false,\r\n             'limitMiny': false,\r\n+            'limitMiny': false,\r\n         },\r\n         { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690 },\r\n         { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320 },\r\n         { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320 }\r\n"
                },
                {
                    "date": 1625199804038,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -100,9 +100,9 @@\n             'maxy': 694,\r\n             'limitMinx': false,\r\n             'limitMaxx': false,\r\n             'limitMiny': false,\r\n-            'limitMiny': false,\r\n+            'limitMaxy': false,\r\n         },\r\n         { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690 },\r\n         { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320 },\r\n         { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320 }\r\n"
                },
                {
                    "date": 1625199822931,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -102,11 +102,29 @@\n             'limitMaxx': false,\r\n             'limitMiny': false,\r\n             'limitMaxy': false,\r\n         },\r\n-        { 'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690 },\r\n-        { 'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320 },\r\n-        { 'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320 }\r\n+        {\r\n+            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n+            'limitMinx': false,\r\n+            'limitMaxx': false,\r\n+            'limitMiny': false,\r\n+            'limitMaxy': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n+            'limitMinx': false,\r\n+            'limitMaxx': false,\r\n+            'limitMiny': false,\r\n+            'limitMaxy': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n+            'limitMinx': false,\r\n+            'limitMaxx': false,\r\n+            'limitMiny': false,\r\n+            'limitMaxy': false,\r\n+        }\r\n         ];\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n"
                },
                {
                    "date": 1625199907096,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -89,9 +89,8 @@\n             this._c1.selectedIndex = 1;\r\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n-\r\n         this._allPointRect = [{\r\n             'rect': new cc.Rect(610, 614, 80, 80),\r\n             'isContains': false,\r\n             'minx': 610,\r\n@@ -321,9 +320,12 @@\n \r\n             if (pointNums >= 2) {\r\n \r\n \r\n+                for (let i = 0; i < ) {\r\n \r\n+                }\r\n+\r\n                 if (this._touchesPos.length > 0) {\r\n \r\n                     let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625199917337,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -319,9 +319,8 @@\n             console.log(this._allPointRect);\r\n \r\n             if (pointNums >= 2) {\r\n \r\n-\r\n                 for (let i = 0; i < ) {\r\n \r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625199924375,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -319,9 +319,9 @@\n             console.log(this._allPointRect);\r\n \r\n             if (pointNums >= 2) {\r\n \r\n-                for (let i = 0; i < ) {\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                 }\r\n \r\n                 if (this._touchesPos.length > 0) {\r\n"
                },
                {
                    "date": 1625199932537,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -321,8 +321,9 @@\n             if (pointNums >= 2) {\r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n+\r\n                 }\r\n \r\n                 if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625199963064,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -322,8 +322,9 @@\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n \r\n+\r\n                 }\r\n \r\n                 if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625200001893,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -321,9 +321,11 @@\n             if (pointNums >= 2) {\r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n+                    if (i === 0 && this._allPointRect) {\r\n \r\n+                    }\r\n \r\n                 }\r\n \r\n                 if (this._touchesPos.length > 0) {\r\n"
                },
                {
                    "date": 1625200012568,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -321,9 +321,9 @@\n             if (pointNums >= 2) {\r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                    if (i === 0 && this._allPointRect) {\r\n+                    if (i === 0 && this._allPointRect[0].) {\r\n \r\n                     }\r\n \r\n                 }\r\n"
                },
                {
                    "date": 1625200018939,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -321,9 +321,9 @@\n             if (pointNums >= 2) {\r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                    if (i === 0 && this._allPointRect[0].) {\r\n+                    if (i === 0 && this._allPointRect[0].isContains) {\r\n \r\n                     }\r\n \r\n                 }\r\n"
                },
                {
                    "date": 1625206751862,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -205,9 +205,9 @@\n     }\r\n \r\n \r\n     // 排序方法\r\n-    comparePos() {\r\n+    comparePosX() {\r\n         return function (a, b) {\r\n             var value1 = a.x;\r\n             var value2 = b.x;\r\n             return value1 - value2;\r\n"
                },
                {
                    "date": 1625206757846,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -286,9 +286,9 @@\n         } else if (state.touch == \"end\") {\r\n \r\n             this.graphics.clear();\r\n \r\n-            this._touchesPos.sort(this.comparePos());\r\n+            this._touchesPos.sort(this.comparePosX());\r\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                 this._allPointRect[i].isContains = false;\r\n"
                },
                {
                    "date": 1625206763921,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -213,8 +213,17 @@\n             return value1 - value2;\r\n         }\r\n     }\r\n \r\n+    // 排序方法\r\n+    comparePosX() {\r\n+        return function (a, b) {\r\n+            var value1 = a.x;\r\n+            var value2 = b.x;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n     private _clickReset(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.reset = true;\r\n         this.updateState(state);\r\n"
                },
                {
                    "date": 1625206773576,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -214,12 +214,12 @@\n         }\r\n     }\r\n \r\n     // 排序方法\r\n-    comparePosX() {\r\n+    comparePosY() {\r\n         return function (a, b) {\r\n-            var value1 = a.x;\r\n-            var value2 = b.x;\r\n+            var value1 = a.y;\r\n+            var value2 = b.y;\r\n             return value1 - value2;\r\n         }\r\n     }\r\n \r\n"
                },
                {
                    "date": 1625206797038,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -295,8 +295,9 @@\n         } else if (state.touch == \"end\") {\r\n \r\n             this.graphics.clear();\r\n \r\n+\r\n             this._touchesPos.sort(this.comparePosX());\r\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n"
                },
                {
                    "date": 1625206802164,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -296,8 +296,9 @@\n \r\n             this.graphics.clear();\r\n \r\n \r\n+\r\n             this._touchesPos.sort(this.comparePosX());\r\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n"
                },
                {
                    "date": 1625206897909,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -295,12 +295,13 @@\n         } else if (state.touch == \"end\") {\r\n \r\n             this.graphics.clear();\r\n \r\n+            let tempArrX = [];\r\n+            tempArrX =\r\n \r\n+                this._touchesPos.sort(this.comparePosX());\r\n \r\n-            this._touchesPos.sort(this.comparePosX());\r\n-\r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                 this._allPointRect[i].isContains = false;\r\n             }\r\n"
                },
                {
                    "date": 1625206905063,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -296,11 +296,11 @@\n \r\n             this.graphics.clear();\r\n \r\n             let tempArrX = [];\r\n-            tempArrX =\r\n+            tempArrX = this._touchesPos\r\n \r\n-                this._touchesPos.sort(this.comparePosX());\r\n+            this._touchesPos.sort(this.comparePosX());\r\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                 this._allPointRect[i].isContains = false;\r\n"
                },
                {
                    "date": 1625206918539,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -296,9 +296,9 @@\n \r\n             this.graphics.clear();\r\n \r\n             let tempArrX = [];\r\n-            tempArrX = this._touchesPos\r\n+            tempArrX = this._touchesPos;\r\n \r\n             this._touchesPos.sort(this.comparePosX());\r\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n"
                },
                {
                    "date": 1625206936855,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -297,8 +297,10 @@\n             this.graphics.clear();\r\n \r\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n+            let tempArrY = [];\r\n+            tempArrY = this._touchesPos;\r\n \r\n             this._touchesPos.sort(this.comparePosX());\r\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n"
                },
                {
                    "date": 1625206961443,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -297,8 +297,9 @@\n             this.graphics.clear();\r\n \r\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n+            tempArrX.sort()\r\n             let tempArrY = [];\r\n             tempArrY = this._touchesPos;\r\n \r\n             this._touchesPos.sort(this.comparePosX());\r\n"
                },
                {
                    "date": 1625206966514,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -297,9 +297,9 @@\n             this.graphics.clear();\r\n \r\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n-            tempArrX.sort()\r\n+            tempArrX.sort(this.comparePosX())\r\n             let tempArrY = [];\r\n             tempArrY = this._touchesPos;\r\n \r\n             this._touchesPos.sort(this.comparePosX());\r\n"
                },
                {
                    "date": 1625206974111,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -297,11 +297,13 @@\n             this.graphics.clear();\r\n \r\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n-            tempArrX.sort(this.comparePosX())\r\n+            tempArrX.sort(this.comparePosX());\r\n+\r\n             let tempArrY = [];\r\n             tempArrY = this._touchesPos;\r\n+            tempArrX.sort(this.comparePosX());\r\n \r\n             this._touchesPos.sort(this.comparePosX());\r\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n"
                },
                {
                    "date": 1625206980878,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -301,9 +301,9 @@\n             tempArrX.sort(this.comparePosX());\r\n \r\n             let tempArrY = [];\r\n             tempArrY = this._touchesPos;\r\n-            tempArrX.sort(this.comparePosX());\r\n+            tempArrY.sort(this.comparePosY());\r\n \r\n             this._touchesPos.sort(this.comparePosX());\r\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n"
                },
                {
                    "date": 1625207034878,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -299,8 +299,9 @@\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n \r\n+            console.log('=== ====');\r\n             let tempArrY = [];\r\n             tempArrY = this._touchesPos;\r\n             tempArrY.sort(this.comparePosY());\r\n \r\n"
                },
                {
                    "date": 1625207040968,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -299,9 +299,9 @@\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n \r\n-            console.log('=== ====');\r\n+            console.log('=== 111 ====');\r\n             let tempArrY = [];\r\n             tempArrY = this._touchesPos;\r\n             tempArrY.sort(this.comparePosY());\r\n \r\n"
                },
                {
                    "date": 1625207048033,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -299,9 +299,9 @@\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n \r\n-            console.log('=== 111 ====');\r\n+            console.log('=== tempArrX ====');\r\n             let tempArrY = [];\r\n             tempArrY = this._touchesPos;\r\n             tempArrY.sort(this.comparePosY());\r\n \r\n"
                },
                {
                    "date": 1625207063364,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -300,8 +300,9 @@\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n \r\n             console.log('=== tempArrX ====');\r\n+            console.log(this._touchesPos);\r\n             let tempArrY = [];\r\n             tempArrY = this._touchesPos;\r\n             tempArrY.sort(this.comparePosY());\r\n \r\n"
                },
                {
                    "date": 1625207070255,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -304,8 +304,10 @@\n             console.log(this._touchesPos);\r\n             let tempArrY = [];\r\n             tempArrY = this._touchesPos;\r\n             tempArrY.sort(this.comparePosY());\r\n+            console.log('=== tempArrY ====');\r\n+            console.log(this._touchesPos);\r\n \r\n             this._touchesPos.sort(this.comparePosX());\r\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n"
                },
                {
                    "date": 1625207309186,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -299,15 +299,15 @@\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n \r\n-            console.log('=== tempArrX ====');\r\n-            console.log(this._touchesPos);\r\n+            // console.log('=== tempArrX ====');\r\n+            // console.log(this._touchesPos);\r\n             let tempArrY = [];\r\n             tempArrY = this._touchesPos;\r\n             tempArrY.sort(this.comparePosY());\r\n-            console.log('=== tempArrY ====');\r\n-            console.log(this._touchesPos);\r\n+            // console.log('=== tempArrY ====');\r\n+            // console.log(this._touchesPos);\r\n \r\n             this._touchesPos.sort(this.comparePosX());\r\n \r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n"
                },
                {
                    "date": 1625207337086,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -299,8 +299,11 @@\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n \r\n+            if () {\r\n+\r\n+            }\r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n             let tempArrY = [];\r\n             tempArrY = this._touchesPos;\r\n"
                },
                {
                    "date": 1625207404683,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -299,9 +299,9 @@\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n \r\n-            if () {\r\n+            if (tempArrX[tempArrX.length - 1].x - tempArrX[0].x) {\r\n \r\n             }\r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n"
                },
                {
                    "date": 1625208312577,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -299,9 +299,10 @@\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n \r\n-            if (tempArrX[tempArrX.length - 1].x - tempArrX[0].x) {\r\n+            let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x\r\n+            if ( > ) {\r\n \r\n             }\r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n"
                },
                {
                    "date": 1625208317976,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -299,12 +299,10 @@\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n \r\n-            let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x\r\n-            if ( > ) {\r\n+            let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n \r\n-            }\r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n             let tempArrY = [];\r\n             tempArrY = this._touchesPos;\r\n"
                },
                {
                    "date": 1625208329280,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -299,15 +299,17 @@\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n \r\n+            let tempArrY = [];\r\n+            tempArrY = this._touchesPos;\r\n+            tempArrY.sort(this.comparePosY());\r\n+\r\n             let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n \r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n-            let tempArrY = [];\r\n-            tempArrY = this._touchesPos;\r\n-            tempArrY.sort(this.comparePosY());\r\n+\r\n             // console.log('=== tempArrY ====');\r\n             // console.log(this._touchesPos);\r\n \r\n             this._touchesPos.sort(this.comparePosX());\r\n"
                },
                {
                    "date": 1625208336719,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -304,8 +304,9 @@\n             tempArrY = this._touchesPos;\r\n             tempArrY.sort(this.comparePosY());\r\n \r\n             let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n+            let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n \r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n \r\n"
                },
                {
                    "date": 1625208343235,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -304,9 +304,9 @@\n             tempArrY = this._touchesPos;\r\n             tempArrY.sort(this.comparePosY());\r\n \r\n             let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n-            let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n+            let chaY = tempArrY[tempArrX.length - 1].x - tempArrX[0].x;\r\n \r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n \r\n"
                },
                {
                    "date": 1625208348408,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -304,9 +304,9 @@\n             tempArrY = this._touchesPos;\r\n             tempArrY.sort(this.comparePosY());\r\n \r\n             let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n-            let chaY = tempArrY[tempArrX.length - 1].x - tempArrX[0].x;\r\n+            let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n \r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n \r\n"
                },
                {
                    "date": 1625208355216,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -306,8 +306,11 @@\n \r\n             let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n             let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n \r\n+            if () {\r\n+\r\n+            }\r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n \r\n             // console.log('=== tempArrY ====');\r\n"
                },
                {
                    "date": 1625208484812,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -306,9 +306,9 @@\n \r\n             let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n             let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n \r\n-            if () {\r\n+            if (chaX <) {\r\n \r\n             }\r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n"
                },
                {
                    "date": 1625208507234,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -306,9 +306,9 @@\n \r\n             let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n             let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n \r\n-            if (chaX <) {\r\n+            if (chaX < 250) {\r\n \r\n             }\r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n"
                },
                {
                    "date": 1625208545027,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -306,9 +306,9 @@\n \r\n             let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n             let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n \r\n-            if (chaX < 250) {\r\n+            if (chaX < 250 && chaY > 400) {\r\n \r\n             }\r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n"
                },
                {
                    "date": 1625208554717,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,536 @@\n+import chooseAnswer_model0403_v2 from '../../numberPatterns/chooseAnswer-model0403-v2';\r\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v3 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _resetBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _touchesPos: any = [];\r\n+\r\n+    private _moveCurPos: cc.Vec2;\r\n+\r\n+    private graphics: cc.Graphics = null;\r\n+\r\n+    private _dragging = false;\r\n+\r\n+    private _scheduleTime = 0.03;\r\n+\r\n+    private _selflLines = [];\r\n+\r\n+    private _allPointRect = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    private lineType: any = cc.Enum({\r\n+\r\n+        StraightLine: 0,\r\n+        LineSegment: 1\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._allPointRect = [{\r\n+            'rect': new cc.Rect(610, 614, 80, 80),\r\n+            'isContains': false,\r\n+            'minx': 610,\r\n+            'maxx': 690,\r\n+            'miny': 614,\r\n+            'maxy': 694,\r\n+            'limitMinx': false,\r\n+            'limitMaxx': false,\r\n+            'limitMiny': false,\r\n+            'limitMaxy': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n+            'limitMinx': false,\r\n+            'limitMaxx': false,\r\n+            'limitMiny': false,\r\n+            'limitMaxy': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n+            'limitMinx': false,\r\n+            'limitMaxx': false,\r\n+            'limitMiny': false,\r\n+            'limitMaxy': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n+            'limitMinx': false,\r\n+            'limitMaxx': false,\r\n+            'limitMiny': false,\r\n+            'limitMaxy': false,\r\n+        }\r\n+        ];\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n+        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n+\r\n+        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+\r\n+        let huiNode = new cc.Node('huiNode');\r\n+        huiNode.parent = this._worldRoot;\r\n+\r\n+        this.graphics = huiNode.addComponent(cc.Graphics);\r\n+        this.graphics.lineWidth = 20;\r\n+        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n+        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n+        this.graphics.fillColor = cc.color(255, 0, 0);\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            touch: \"no\",\r\n+            reset: false,\r\n+            touchesPos: [],\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    _onDrawStart(event) {\r\n+        console.log('===== start 111 ====' + event.touch.getLocation());\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.touch = 'start';\r\n+        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+        state.touchesPos.push(tempPos);\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    _onDrawMove(event) {\r\n+\r\n+        this._dragging = true;\r\n+        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+    }\r\n+\r\n+    _onDrawEnd(event) {\r\n+\r\n+        this._dragging = false;\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.touch = 'end';\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 排序方法\r\n+    comparePosX() {\r\n+        return function (a, b) {\r\n+            var value1 = a.x;\r\n+            var value2 = b.x;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n+    // 排序方法\r\n+    comparePosY() {\r\n+        return function (a, b) {\r\n+            var value1 = a.y;\r\n+            var value2 = b.y;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n+    private _clickReset(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.reset = true;\r\n+        this.updateState(state);\r\n+\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    // 临时\r\n+    // 拖拽定时器\r\n+    dragSchedule() {\r\n+        if (this._dragging) {\r\n+\r\n+            console.log('==== 3333333 拖拽定时器 ======');\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.touchesPos.push(this._moveCurPos);\r\n+            state.touch = \"move\";\r\n+            this.updateState(state);\r\n+        }\r\n+    }\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (state.touch == \"start\") {\r\n+\r\n+            this._touchesPos = state.touchesPos;\r\n+            this.graphics.clear();\r\n+            this._touchesPos.length = 0;\r\n+\r\n+        } else if (state.touch == \"move\") {\r\n+\r\n+            this._touchesPos = state.touchesPos;\r\n+\r\n+            const MIN_POINT_DISTANCE = 4;\r\n+\r\n+            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n+            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n+            let lastIndex = 0;\r\n+            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n+                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n+                    continue;\r\n+                }\r\n+                lastIndex = i;\r\n+                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n+            }\r\n+            this.graphics.stroke();\r\n+\r\n+        } else if (state.touch == \"end\") {\r\n+\r\n+            this.graphics.clear();\r\n+\r\n+            let tempArrX = [];\r\n+            tempArrX = this._touchesPos;\r\n+            tempArrX.sort(this.comparePosX());\r\n+\r\n+            let tempArrY = [];\r\n+            tempArrY = this._touchesPos;\r\n+            tempArrY.sort(this.comparePosY());\r\n+\r\n+            let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n+            let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n+\r\n+            if (chaX < 250 && chaY > 400) {\r\n+\r\n+            }\r\n+            // console.log('=== tempArrX ====');\r\n+            // console.log(this._touchesPos);\r\n+\r\n+            // console.log('=== tempArrY ====');\r\n+            // console.log(this._touchesPos);\r\n+\r\n+            this._touchesPos.sort(this.comparePosX());\r\n+\r\n+            for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                this._allPointRect[i].isContains = false;\r\n+            }\r\n+\r\n+            let pointNums = 0;\r\n+            for (let i = 0; i < this._touchesPos.length; i++) {\r\n+\r\n+                let tempPos = this._touchesPos[i];\r\n+                tempPos.y = this._view.height - tempPos.y;\r\n+                for (let j = 0; j < this._allPointRect.length; j++) {\r\n+\r\n+                    if (this._allPointRect[j].rect.contains(tempPos)) {\r\n+                        this._allPointRect[j].isContains = true;\r\n+                        break;\r\n+                    }\r\n+                }\r\n+            }\r\n+\r\n+            for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                if (this._allPointRect[i].isContains) {\r\n+                    pointNums++;\r\n+                }\r\n+            }\r\n+\r\n+            console.log('===== 是否包含点的判断 ====');\r\n+            console.log(this._allPointRect);\r\n+\r\n+            if (pointNums >= 2) {\r\n+\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                    if (i === 0 && this._allPointRect[0].isContains) {\r\n+\r\n+                    }\r\n+\r\n+                }\r\n+\r\n+                if (this._touchesPos.length > 0) {\r\n+\r\n+                    let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n+\r\n+                    console.log('===== angle 999999 === ' + angle);\r\n+\r\n+                    let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                    this._view.addChild(zhiLine);\r\n+                    zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n+                    zhiLine.x = this._touchesPos[0].x;\r\n+                    zhiLine.y = this._touchesPos[0].y;\r\n+                    zhiLine.rotation = angle;\r\n+\r\n+                    zhiLine.sortingOrder = 0;\r\n+\r\n+                    zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n+\r\n+                    this._selflLines.push(zhiLine);\r\n+                }\r\n+            }\r\n+\r\n+\r\n+            setTimeout(() => {\r\n+\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.touch = 'no';\r\n+                this.updateState(state);\r\n+\r\n+            });\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+                let keyBtn = this._view.getChild('input1').asButton;\r\n+                this.handTips2(keyBtn);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+    angle(start, end) {\r\n+        var diff_x = end.x - start.x,\r\n+            diff_y = end.y - start.y;\r\n+        //返回角度,不是弧度\r\n+        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+        this.schedule(this.dragSchedule, this._scheduleTime);\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1625208562627,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -306,9 +306,9 @@\n \r\n             let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n             let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n \r\n-            if (chaX < 250 && chaY > 400) {\r\n+            if (chaX < 200 && chaY > 400) {\r\n \r\n             }\r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n@@ -533,540 +533,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-import chooseAnswer_model0403_v2 from '../../numberPatterns/chooseAnswer-model0403-v2';\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v3 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _resetBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _touchesPos: any = [];\r\n-\r\n-    private _moveCurPos: cc.Vec2;\r\n-\r\n-    private graphics: cc.Graphics = null;\r\n-\r\n-    private _dragging = false;\r\n-\r\n-    private _scheduleTime = 0.03;\r\n-\r\n-    private _selflLines = [];\r\n-\r\n-    private _allPointRect = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    private lineType: any = cc.Enum({\r\n-\r\n-        StraightLine: 0,\r\n-        LineSegment: 1\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._allPointRect = [{\r\n-            'rect': new cc.Rect(610, 614, 80, 80),\r\n-            'isContains': false,\r\n-            'minx': 610,\r\n-            'maxx': 690,\r\n-            'miny': 614,\r\n-            'maxy': 694,\r\n-            'limitMinx': false,\r\n-            'limitMaxx': false,\r\n-            'limitMiny': false,\r\n-            'limitMaxy': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n-            'limitMinx': false,\r\n-            'limitMaxx': false,\r\n-            'limitMiny': false,\r\n-            'limitMaxy': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n-            'limitMinx': false,\r\n-            'limitMaxx': false,\r\n-            'limitMiny': false,\r\n-            'limitMaxy': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n-            'limitMinx': false,\r\n-            'limitMaxx': false,\r\n-            'limitMiny': false,\r\n-            'limitMaxy': false,\r\n-        }\r\n-        ];\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n-        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n-\r\n-        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n-\r\n-        let huiNode = new cc.Node('huiNode');\r\n-        huiNode.parent = this._worldRoot;\r\n-\r\n-        this.graphics = huiNode.addComponent(cc.Graphics);\r\n-        this.graphics.lineWidth = 20;\r\n-        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n-        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n-        this.graphics.fillColor = cc.color(255, 0, 0);\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            touch: \"no\",\r\n-            reset: false,\r\n-            touchesPos: [],\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    _onDrawStart(event) {\r\n-        console.log('===== start 111 ====' + event.touch.getLocation());\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.touch = 'start';\r\n-        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-        state.touchesPos.push(tempPos);\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    _onDrawMove(event) {\r\n-\r\n-        this._dragging = true;\r\n-        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-    }\r\n-\r\n-    _onDrawEnd(event) {\r\n-\r\n-        this._dragging = false;\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.touch = 'end';\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 排序方法\r\n-    comparePosX() {\r\n-        return function (a, b) {\r\n-            var value1 = a.x;\r\n-            var value2 = b.x;\r\n-            return value1 - value2;\r\n-        }\r\n-    }\r\n-\r\n-    // 排序方法\r\n-    comparePosY() {\r\n-        return function (a, b) {\r\n-            var value1 = a.y;\r\n-            var value2 = b.y;\r\n-            return value1 - value2;\r\n-        }\r\n-    }\r\n-\r\n-    private _clickReset(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.reset = true;\r\n-        this.updateState(state);\r\n-\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    // 临时\r\n-    // 拖拽定时器\r\n-    dragSchedule() {\r\n-        if (this._dragging) {\r\n-\r\n-            console.log('==== 3333333 拖拽定时器 ======');\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.touchesPos.push(this._moveCurPos);\r\n-            state.touch = \"move\";\r\n-            this.updateState(state);\r\n-        }\r\n-    }\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (state.touch == \"start\") {\r\n-\r\n-            this._touchesPos = state.touchesPos;\r\n-            this.graphics.clear();\r\n-            this._touchesPos.length = 0;\r\n-\r\n-        } else if (state.touch == \"move\") {\r\n-\r\n-            this._touchesPos = state.touchesPos;\r\n-\r\n-            const MIN_POINT_DISTANCE = 4;\r\n-\r\n-            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n-            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n-            let lastIndex = 0;\r\n-            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n-                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n-                    continue;\r\n-                }\r\n-                lastIndex = i;\r\n-                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n-            }\r\n-            this.graphics.stroke();\r\n-\r\n-        } else if (state.touch == \"end\") {\r\n-\r\n-            this.graphics.clear();\r\n-\r\n-            let tempArrX = [];\r\n-            tempArrX = this._touchesPos;\r\n-            tempArrX.sort(this.comparePosX());\r\n-\r\n-            let tempArrY = [];\r\n-            tempArrY = this._touchesPos;\r\n-            tempArrY.sort(this.comparePosY());\r\n-\r\n-            let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n-            let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n-\r\n-            if (chaX < 250 && chaY > 400) {\r\n-\r\n-            }\r\n-            // console.log('=== tempArrX ====');\r\n-            // console.log(this._touchesPos);\r\n-\r\n-            // console.log('=== tempArrY ====');\r\n-            // console.log(this._touchesPos);\r\n-\r\n-            this._touchesPos.sort(this.comparePosX());\r\n-\r\n-            for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                this._allPointRect[i].isContains = false;\r\n-            }\r\n-\r\n-            let pointNums = 0;\r\n-            for (let i = 0; i < this._touchesPos.length; i++) {\r\n-\r\n-                let tempPos = this._touchesPos[i];\r\n-                tempPos.y = this._view.height - tempPos.y;\r\n-                for (let j = 0; j < this._allPointRect.length; j++) {\r\n-\r\n-                    if (this._allPointRect[j].rect.contains(tempPos)) {\r\n-                        this._allPointRect[j].isContains = true;\r\n-                        break;\r\n-                    }\r\n-                }\r\n-            }\r\n-\r\n-            for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                if (this._allPointRect[i].isContains) {\r\n-                    pointNums++;\r\n-                }\r\n-            }\r\n-\r\n-            console.log('===== 是否包含点的判断 ====');\r\n-            console.log(this._allPointRect);\r\n-\r\n-            if (pointNums >= 2) {\r\n-\r\n-                for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                    if (i === 0 && this._allPointRect[0].isContains) {\r\n-\r\n-                    }\r\n-\r\n-                }\r\n-\r\n-                if (this._touchesPos.length > 0) {\r\n-\r\n-                    let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n-\r\n-                    console.log('===== angle 999999 === ' + angle);\r\n-\r\n-                    let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                    this._view.addChild(zhiLine);\r\n-                    zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n-                    zhiLine.x = this._touchesPos[0].x;\r\n-                    zhiLine.y = this._touchesPos[0].y;\r\n-                    zhiLine.rotation = angle;\r\n-\r\n-                    zhiLine.sortingOrder = 0;\r\n-\r\n-                    zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n-\r\n-                    this._selflLines.push(zhiLine);\r\n-                }\r\n-            }\r\n-\r\n-\r\n-            setTimeout(() => {\r\n-\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.touch = 'no';\r\n-                this.updateState(state);\r\n-\r\n-            });\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-                let keyBtn = this._view.getChild('input1').asButton;\r\n-                this.handTips2(keyBtn);\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-    angle(start, end) {\r\n-        var diff_x = end.x - start.x,\r\n-            diff_y = end.y - start.y;\r\n-        //返回角度,不是弧度\r\n-        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-        this.schedule(this.dragSchedule, this._scheduleTime);\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1625208571199,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -306,9 +306,9 @@\n \r\n             let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n             let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n \r\n-            if (chaX < 200 && chaY > 400) {\r\n+            if (chaX < 200) {\r\n \r\n             }\r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n"
                },
                {
                    "date": 1625208589252,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -308,8 +308,10 @@\n             let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n \r\n             if (chaX < 200) {\r\n \r\n+            } else {\r\n+\r\n             }\r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n \r\n"
                },
                {
                    "date": 1625208596248,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -308,19 +308,21 @@\n             let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n \r\n             if (chaX < 200) {\r\n \r\n+                this._touchesPos.sort(this.comparePosX());\r\n+\r\n             } else {\r\n-\r\n+                this._touchesPos.sort(this.comparePosX());\r\n             }\r\n             // console.log('=== tempArrX ====');\r\n             // console.log(this._touchesPos);\r\n \r\n             // console.log('=== tempArrY ====');\r\n             // console.log(this._touchesPos);\r\n \r\n-            this._touchesPos.sort(this.comparePosX());\r\n \r\n+\r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                 this._allPointRect[i].isContains = false;\r\n             }\r\n"
                },
                {
                    "date": 1625208604786,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -308,21 +308,14 @@\n             let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n \r\n             if (chaX < 200) {\r\n \r\n-                this._touchesPos.sort(this.comparePosX());\r\n+                this._touchesPos.sort(this.comparePosY());\r\n \r\n             } else {\r\n                 this._touchesPos.sort(this.comparePosX());\r\n             }\r\n-            // console.log('=== tempArrX ====');\r\n-            // console.log(this._touchesPos);\r\n \r\n-            // console.log('=== tempArrY ====');\r\n-            // console.log(this._touchesPos);\r\n-\r\n-\r\n-\r\n             for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                 this._allPointRect[i].isContains = false;\r\n             }\r\n"
                },
                {
                    "date": 1625208729892,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -349,8 +349,9 @@\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                     if (i === 0 && this._allPointRect[0].isContains) {\r\n \r\n+\r\n                     }\r\n \r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625208816603,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -349,9 +349,12 @@\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                     if (i === 0 && this._allPointRect[0].isContains) {\r\n \r\n+                        if (this._touchesPos[i]) {\r\n \r\n+                        }\r\n+\r\n                     }\r\n \r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625208838420,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -349,9 +349,9 @@\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                     if (i === 0 && this._allPointRect[0].isContains) {\r\n \r\n-                        if (this._touchesPos[i]) {\r\n+                        if (this._touchesPos[0]) {\r\n \r\n                         }\r\n \r\n                     }\r\n"
                },
                {
                    "date": 1625209026423,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -349,10 +349,11 @@\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                     if (i === 0 && this._allPointRect[0].isContains) {\r\n \r\n-                        if (this._touchesPos[0]) {\r\n+                        if (this._touchesPos[0].minx) {\r\n \r\n+\r\n                         }\r\n \r\n                     }\r\n \r\n"
                },
                {
                    "date": 1625209060090,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -349,9 +349,9 @@\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                     if (i === 0 && this._allPointRect[0].isContains) {\r\n \r\n-                        if (this._touchesPos[0].minx) {\r\n+                        if (this._touchesPos[0].x > this._touchesPos[0].minx) {\r\n \r\n \r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625209237675,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -349,9 +349,9 @@\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                     if (i === 0 && this._allPointRect[0].isContains) {\r\n \r\n-                        if (this._touchesPos[0].x > this._touchesPos[0].minx) {\r\n+                        if (this._touchesPos[0].x < this._touchesPos[0].minx) {\r\n \r\n \r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625209269397,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -352,8 +352,9 @@\n \r\n                         if (this._touchesPos[0].x < this._touchesPos[0].minx) {\r\n \r\n \r\n+\r\n                         }\r\n \r\n                     }\r\n \r\n"
                },
                {
                    "date": 1625209277487,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -352,9 +352,8 @@\n \r\n                         if (this._touchesPos[0].x < this._touchesPos[0].minx) {\r\n \r\n \r\n-\r\n                         }\r\n \r\n                     }\r\n \r\n"
                },
                {
                    "date": 1625209286795,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -351,9 +351,9 @@\n                     if (i === 0 && this._allPointRect[0].isContains) {\r\n \r\n                         if (this._touchesPos[0].x < this._touchesPos[0].minx) {\r\n \r\n-\r\n+                            this._allPointRect[0]\r\n                         }\r\n \r\n                     }\r\n \r\n"
                },
                {
                    "date": 1625209362970,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -351,9 +351,9 @@\n                     if (i === 0 && this._allPointRect[0].isContains) {\r\n \r\n                         if (this._touchesPos[0].x < this._touchesPos[0].minx) {\r\n \r\n-                            this._allPointRect[0]\r\n+                            this._allPointRect[0].limitMinx = true;\r\n                         }\r\n \r\n                     }\r\n \r\n"
                },
                {
                    "date": 1625209385114,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,8 +354,12 @@\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n \r\n+                        if () {\r\n+\r\n+                        }\r\n+\r\n                     }\r\n \r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625209406530,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,10 +354,11 @@\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n \r\n-                        if () {\r\n+                        if (this._touchesPos[0].x < this._touchesPos[0].minx) {\r\n \r\n+                            this._allPointRect[0].limitMinx = true;\r\n                         }\r\n \r\n                     }\r\n \r\n"
                },
                {
                    "date": 1625209418862,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,9 +354,9 @@\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n \r\n-                        if (this._touchesPos[0].x < this._touchesPos[0].minx) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].x < this._touchesPos[0].minx) {\r\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625209425506,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,9 +354,9 @@\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].x < this._touchesPos[0].minx) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].y < this._touchesPos[0].minx) {\r\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625209449277,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,9 +354,9 @@\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].y < this._touchesPos[0].minx) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].y < this._touchesPos[0].maxy) {\r\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625209724821,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -358,9 +358,8 @@\n                         if (this._touchesPos[this._touchesPos.length - 1].y < this._touchesPos[0].maxy) {\r\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n-\r\n                     }\r\n \r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625209776271,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -358,8 +358,11 @@\n                         if (this._touchesPos[this._touchesPos.length - 1].y < this._touchesPos[0].maxy) {\r\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n+\r\n+                    } else if () {\r\n+\r\n                     }\r\n \r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625209783578,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -359,9 +359,9 @@\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n \r\n-                    } else if () {\r\n+                    } else if (i === 1 && ) {\r\n \r\n                     }\r\n \r\n                 }\r\n"
                },
                {
                    "date": 1625209790523,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -359,9 +359,9 @@\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n \r\n-                    } else if (i === 1 && ) {\r\n+                    } else if (i === 1 && this._allPointRect[1].isContains) {\r\n \r\n                     }\r\n \r\n                 }\r\n"
                },
                {
                    "date": 1625209796619,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -361,8 +361,9 @@\n                         }\r\n \r\n                     } else if (i === 1 && this._allPointRect[1].isContains) {\r\n \r\n+\r\n                     }\r\n \r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625209803719,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -362,8 +362,9 @@\n \r\n                     } else if (i === 1 && this._allPointRect[1].isContains) {\r\n \r\n \r\n+\r\n                     }\r\n \r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625209823039,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -361,9 +361,12 @@\n                         }\r\n \r\n                     } else if (i === 1 && this._allPointRect[1].isContains) {\r\n \r\n+                        if (this._touchesPos[this._touchesPos.length - 1].y < this._touchesPos[0].maxy) {\r\n \r\n+                            this._allPointRect[0].limitMinx = true;\r\n+                        }\r\n \r\n                     }\r\n \r\n                 }\r\n"
                },
                {
                    "date": 1625209829988,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -361,13 +361,9 @@\n                         }\r\n \r\n                     } else if (i === 1 && this._allPointRect[1].isContains) {\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].y < this._touchesPos[0].maxy) {\r\n \r\n-                            this._allPointRect[0].limitMinx = true;\r\n-                        }\r\n-\r\n                     }\r\n \r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625209916494,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -361,9 +361,12 @@\n                         }\r\n \r\n                     } else if (i === 1 && this._allPointRect[1].isContains) {\r\n \r\n+                        if (this._touchesPos[0].x < this._touchesPos[0].minx) {\r\n \r\n+                            this._allPointRect[0].limitMinx = true;\r\n+                        }\r\n                     }\r\n \r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625209958003,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -361,9 +361,9 @@\n                         }\r\n \r\n                     } else if (i === 1 && this._allPointRect[1].isContains) {\r\n \r\n-                        if (this._touchesPos[0].x < this._touchesPos[0].minx) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].x < this._touchesPos[0].minx) {\r\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625209972002,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -361,9 +361,9 @@\n                         }\r\n \r\n                     } else if (i === 1 && this._allPointRect[1].isContains) {\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].x < this._touchesPos[0].minx) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].x > this._touchesPos[0].minx) {\r\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625210055989,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -347,25 +347,25 @@\n             if (pointNums >= 2) {\r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                    if (i === 0 && this._allPointRect[0].isContains) {\r\n+                    if (i === 0 && this._allPointRect[i].isContains) {\r\n \r\n-                        if (this._touchesPos[0].x < this._touchesPos[0].minx) {\r\n+                        if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n-                            this._allPointRect[0].limitMinx = true;\r\n+                            this._allPointRect[i].limitMinx = true;\r\n                         }\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].y < this._touchesPos[0].maxy) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].y < this._allPointRect[i].maxy) {\r\n \r\n-                            this._allPointRect[0].limitMinx = true;\r\n+                            this._allPointRect[i].limitMinx = true;\r\n                         }\r\n \r\n-                    } else if (i === 1 && this._allPointRect[1].isContains) {\r\n+                    } else if (i === 1 && this._allPointRect[i].isContains) {\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].x > this._touchesPos[0].minx) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].minx) {\r\n \r\n-                            this._allPointRect[0].limitMinx = true;\r\n+                            this._allPointRect[i].limitMinx = true;\r\n                         }\r\n                     }\r\n \r\n                 }\r\n"
                },
                {
                    "date": 1625210099079,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -356,9 +356,9 @@\n                         }\r\n \r\n                         if (this._touchesPos[this._touchesPos.length - 1].y < this._allPointRect[i].maxy) {\r\n \r\n-                            this._allPointRect[i].limitMinx = true;\r\n+                            this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n \r\n                     } else if (i === 1 && this._allPointRect[i].isContains) {\r\n \r\n"
                },
                {
                    "date": 1625210112830,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,9 +354,9 @@\n \r\n                             this._allPointRect[i].limitMinx = true;\r\n                         }\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].y < this._allPointRect[i].maxy) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625210166756,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -361,9 +361,9 @@\n                         }\r\n \r\n                     } else if (i === 1 && this._allPointRect[i].isContains) {\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].minx) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                             this._allPointRect[i].limitMinx = true;\r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625210173938,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -363,9 +363,9 @@\n                     } else if (i === 1 && this._allPointRect[i].isContains) {\r\n \r\n                         if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n-                            this._allPointRect[i].limitMinx = true;\r\n+                            this._allPointRect[i].limitMaxx = true;\r\n                         }\r\n                     }\r\n \r\n                 }\r\n"
                },
                {
                    "date": 1625210259422,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -359,9 +359,9 @@\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n \r\n-                    } else if (i === 1 && this._allPointRect[i].isContains) {\r\n+                    } else if (i === 1 && this._allPointRect[i].isContains || i === 1 && this._allPointRect[i].isContains) {\r\n \r\n                         if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                             this._allPointRect[i].limitMaxx = true;\r\n"
                },
                {
                    "date": 1625210273516,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -359,9 +359,9 @@\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n \r\n-                    } else if (i === 1 && this._allPointRect[i].isContains || i === 1 && this._allPointRect[i].isContains) {\r\n+                    } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n \r\n                         if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                             this._allPointRect[i].limitMaxx = true;\r\n"
                },
                {
                    "date": 1625210284623,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -365,8 +365,10 @@\n                         if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                             this._allPointRect[i].limitMaxx = true;\r\n                         }\r\n+                    } else if () {\r\n+\r\n                     }\r\n \r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625210290713,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -365,9 +365,9 @@\n                         if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                             this._allPointRect[i].limitMaxx = true;\r\n                         }\r\n-                    } else if () {\r\n+                    } else if (i === 0 && this._allPointRect[i].isContains) {\r\n \r\n                     }\r\n \r\n                 }\r\n"
                },
                {
                    "date": 1625210295866,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -365,9 +365,9 @@\n                         if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                             this._allPointRect[i].limitMaxx = true;\r\n                         }\r\n-                    } else if (i === 0 && this._allPointRect[i].isContains) {\r\n+                    } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n                     }\r\n \r\n                 }\r\n"
                },
                {
                    "date": 1625210310676,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -365,10 +365,15 @@\n                         if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                             this._allPointRect[i].limitMaxx = true;\r\n                         }\r\n+\r\n                     } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n+                        if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n+\r\n+                            this._allPointRect[i].limitMaxy = true;\r\n+                        }\r\n                     }\r\n \r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625210437302,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -368,9 +368,9 @@\n                         }\r\n \r\n                     } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n+                        if (this._touchesPos[0].y > this._allPointRect[i].miny) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625210444605,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -368,9 +368,9 @@\n                         }\r\n \r\n                     } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                        if (this._touchesPos[0].y > this._allPointRect[i].miny) {\r\n+                        if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625210594000,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,9 +354,9 @@\n \r\n                             this._allPointRect[i].limitMinx = true;\r\n                         }\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n+                        if (this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625210616769,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,9 +90,9 @@\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n         this._allPointRect = [{\r\n-            'rect': new cc.Rect(610, 614, 80, 80),\r\n+            'rect': new cc.Rect(610, 1080 - 614, 80, 80),\r\n             'isContains': false,\r\n             'minx': 610,\r\n             'maxx': 690,\r\n             'miny': 614,\r\n"
                },
                {
                    "date": 1625210623348,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -102,9 +102,9 @@\n             'limitMiny': false,\r\n             'limitMaxy': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n+            'rect': new cc.Rect(1204, 1080 - 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n             'limitMinx': false,\r\n             'limitMaxx': false,\r\n             'limitMiny': false,\r\n             'limitMaxy': false,\r\n"
                },
                {
                    "date": 1625210628584,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -109,9 +109,9 @@\n             'limitMiny': false,\r\n             'limitMaxy': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n+            'rect': new cc.Rect(1205, 1080 - 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n             'limitMinx': false,\r\n             'limitMaxx': false,\r\n             'limitMiny': false,\r\n             'limitMaxy': false,\r\n"
                },
                {
                    "date": 1625210676384,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -116,9 +116,9 @@\n             'limitMiny': false,\r\n             'limitMaxy': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n+            'rect': new cc.Rect(610, 1080 - 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n             'limitMinx': false,\r\n             'limitMaxx': false,\r\n             'limitMiny': false,\r\n             'limitMaxy': false,\r\n"
                },
                {
                    "date": 1625210771769,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,9 +90,9 @@\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n         this._allPointRect = [{\r\n-            'rect': new cc.Rect(610, 1080 - 614, 80, 80),\r\n+            'rect': new cc.Rect(610, 614, 80, 80),\r\n             'isContains': false,\r\n             'minx': 610,\r\n             'maxx': 690,\r\n             'miny': 614,\r\n@@ -102,23 +102,23 @@\n             'limitMiny': false,\r\n             'limitMaxy': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(1204, 1080 - 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n+            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n             'limitMinx': false,\r\n             'limitMaxx': false,\r\n             'limitMiny': false,\r\n             'limitMaxy': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(1205, 1080 - 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n+            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n             'limitMinx': false,\r\n             'limitMaxx': false,\r\n             'limitMiny': false,\r\n             'limitMaxy': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(610, 1080 - 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n+            'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n             'limitMinx': false,\r\n             'limitMaxx': false,\r\n             'limitMiny': false,\r\n             'limitMaxy': false,\r\n"
                },
                {
                    "date": 1625210802213,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -295,8 +295,11 @@\n         } else if (state.touch == \"end\") {\r\n \r\n             this.graphics.clear();\r\n \r\n+            for (let i = 0; i < this._touchesPos.length; i++) {\r\n+\r\n+            }\r\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n \r\n"
                },
                {
                    "date": 1625210812605,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -296,8 +296,9 @@\n \r\n             this.graphics.clear();\r\n \r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n+                this._touchesPos\r\n \r\n             }\r\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n"
                },
                {
                    "date": 1625210821875,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -296,10 +296,11 @@\n \r\n             this.graphics.clear();\r\n \r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n-                this._touchesPos\r\n \r\n+                this._touchesPos[i].y = \r\n+\r\n             }\r\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n"
                },
                {
                    "date": 1625210832301,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -297,9 +297,9 @@\n             this.graphics.clear();\r\n \r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n-                this._touchesPos[i].y = \r\n+                this._touchesPos[i].y = 1080 - this._touchesPos[i].y;\r\n \r\n             }\r\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n"
                },
                {
                    "date": 1625210877715,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -328,9 +328,9 @@\n             let pointNums = 0;\r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n-                tempPos.y = this._view.height - tempPos.y;\r\n+                //tempPos.y = this._view.height - tempPos.y;\r\n                 for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n                     if (this._allPointRect[j].rect.contains(tempPos)) {\r\n                         this._allPointRect[j].isContains = true;\r\n"
                },
                {
                    "date": 1625210950014,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -359,9 +359,9 @@\n \r\n                             this._allPointRect[i].limitMinx = true;\r\n                         }\r\n \r\n-                        if (this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625211226619,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -97,32 +97,21 @@\n             'maxx': 690,\r\n             'miny': 614,\r\n             'maxy': 694,\r\n             'limitMinx': false,\r\n-            'limitMaxx': false,\r\n-            'limitMiny': false,\r\n             'limitMaxy': false,\r\n         },\r\n         {\r\n             'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n-            'limitMinx': false,\r\n             'limitMaxx': false,\r\n-            'limitMiny': false,\r\n-            'limitMaxy': false,\r\n         },\r\n         {\r\n             'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n-            'limitMinx': false,\r\n             'limitMaxx': false,\r\n-            'limitMiny': false,\r\n-            'limitMaxy': false,\r\n         },\r\n         {\r\n             'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n-            'limitMinx': false,\r\n-            'limitMaxx': false,\r\n             'limitMiny': false,\r\n-            'limitMaxy': false,\r\n         }\r\n         ];\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n"
                },
                {
                    "date": 1625211262683,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -334,11 +334,8 @@\n                     pointNums++;\r\n                 }\r\n             }\r\n \r\n-            console.log('===== 是否包含点的判断 ====');\r\n-            console.log(this._allPointRect);\r\n-\r\n             if (pointNums >= 2) {\r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n@@ -374,10 +371,8 @@\n                 if (this._touchesPos.length > 0) {\r\n \r\n                     let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n-                    console.log('===== angle 999999 === ' + angle);\r\n-\r\n                     let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                     this._view.addChild(zhiLine);\r\n                     zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n                     zhiLine.x = this._touchesPos[0].x;\r\n"
                },
                {
                    "date": 1625211320553,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -376,9 +376,9 @@\n                     this._view.addChild(zhiLine);\r\n                     zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n                     zhiLine.x = this._touchesPos[0].x;\r\n                     zhiLine.y = this._touchesPos[0].y;\r\n-                    zhiLine.rotation = angle;\r\n+                    zhiLine.rotation = -angle;\r\n \r\n                     zhiLine.sortingOrder = 0;\r\n \r\n                     zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n"
                },
                {
                    "date": 1625211401127,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -286,9 +286,9 @@\n             this.graphics.clear();\r\n \r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n-                this._touchesPos[i].y = 1080 - this._touchesPos[i].y;\r\n+                this._touchesPos[i].y = this._touchesPos[i].y;\r\n \r\n             }\r\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n"
                },
                {
                    "date": 1625211406916,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -284,13 +284,8 @@\n         } else if (state.touch == \"end\") {\r\n \r\n             this.graphics.clear();\r\n \r\n-            for (let i = 0; i < this._touchesPos.length; i++) {\r\n-\r\n-                this._touchesPos[i].y = this._touchesPos[i].y;\r\n-\r\n-            }\r\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n \r\n"
                },
                {
                    "date": 1625211415302,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -312,9 +312,9 @@\n             let pointNums = 0;\r\n             for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 let tempPos = this._touchesPos[i];\r\n-                //tempPos.y = this._view.height - tempPos.y;\r\n+                tempPos.y = this._view.height - tempPos.y;\r\n                 for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n                     if (this._allPointRect[j].rect.contains(tempPos)) {\r\n                         this._allPointRect[j].isContains = true;\r\n@@ -371,9 +371,9 @@\n                     this._view.addChild(zhiLine);\r\n                     zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n                     zhiLine.x = this._touchesPos[0].x;\r\n                     zhiLine.y = this._touchesPos[0].y;\r\n-                    zhiLine.rotation = -angle;\r\n+                    zhiLine.rotation = angle;\r\n \r\n                     zhiLine.sortingOrder = 0;\r\n \r\n                     zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n"
                },
                {
                    "date": 1625211532766,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -340,9 +340,9 @@\n \r\n                             this._allPointRect[i].limitMinx = true;\r\n                         }\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n+                        if (this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625211542243,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -340,9 +340,9 @@\n \r\n                             this._allPointRect[i].limitMinx = true;\r\n                         }\r\n \r\n-                        if (this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n+                        if (this._touchesPos[0].y > (1080 - this._allPointRect[i].maxy)) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625211561582,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -340,9 +340,9 @@\n \r\n                             this._allPointRect[i].limitMinx = true;\r\n                         }\r\n \r\n-                        if (this._touchesPos[0].y > (1080 - this._allPointRect[i].maxy)) {\r\n+                        if (this._touchesPos[0].y < (1080 - this._allPointRect[i].maxy)) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625211575240,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,9 +354,9 @@\n                         }\r\n \r\n                     } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                        if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].y < this._allPointRect[i].miny) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625211607352,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,9 +354,9 @@\n                         }\r\n \r\n                     } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].y < this._allPointRect[i].miny) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].miny) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625211614258,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,9 +354,9 @@\n                         }\r\n \r\n                     } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].miny) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].y > 1080 - this._allPointRect[i].miny) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625211684260,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,9 +354,9 @@\n                         }\r\n \r\n                     } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].y > 1080 - this._allPointRect[i].miny) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].miny) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625211718148,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,9 +354,9 @@\n                         }\r\n \r\n                     } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].miny) {\r\n+                        if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) > this._allPointRect[i].miny) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625211728321,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,9 +354,9 @@\n                         }\r\n \r\n                     } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                        if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) > this._allPointRect[i].miny) {\r\n+                        if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625211784951,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -356,9 +356,9 @@\n                     } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n                         if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n \r\n-                            this._allPointRect[i].limitMaxy = true;\r\n+                            this._allPointRect[i].limitMiny = true;\r\n                         }\r\n                     }\r\n \r\n                 }\r\n"
                },
                {
                    "date": 1625211818706,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -340,9 +340,9 @@\n \r\n                             this._allPointRect[i].limitMinx = true;\r\n                         }\r\n \r\n-                        if (this._touchesPos[0].y < (1080 - this._allPointRect[i].maxy)) {\r\n+                        if (this._touchesPos[0].y < this._allPointRect[i].maxy) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625211852860,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -340,9 +340,9 @@\n \r\n                             this._allPointRect[i].limitMinx = true;\r\n                         }\r\n \r\n-                        if (this._touchesPos[0].y < this._allPointRect[i].maxy) {\r\n+                        if (1080 - this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n \r\n                             this._allPointRect[i].limitMaxy = true;\r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625212032242,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -362,8 +362,9 @@\n                     }\r\n \r\n                 }\r\n \r\n+\r\n                 if (this._touchesPos.length > 0) {\r\n \r\n                     let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625212091126,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -362,9 +362,8 @@\n                     }\r\n \r\n                 }\r\n \r\n-\r\n                 if (this._touchesPos.length > 0) {\r\n \r\n                     let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625212102485,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -379,8 +379,10 @@\n                     zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n \r\n                     this._selflLines.push(zhiLine);\r\n                 }\r\n+\r\n+\r\n             }\r\n \r\n \r\n             setTimeout(() => {\r\n"
                },
                {
                    "date": 1625212112261,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -381,8 +381,11 @@\n                     this._selflLines.push(zhiLine);\r\n                 }\r\n \r\n \r\n+                for () {\r\n+\r\n+                }\r\n             }\r\n \r\n \r\n             setTimeout(() => {\r\n"
                },
                {
                    "date": 1625212120217,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -381,9 +381,9 @@\n                     this._selflLines.push(zhiLine);\r\n                 }\r\n \r\n \r\n-                for () {\r\n+                for (let i = 0; i < ) {\r\n \r\n                 }\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625212140430,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -381,9 +381,9 @@\n                     this._selflLines.push(zhiLine);\r\n                 }\r\n \r\n \r\n-                for (let i = 0; i < ) {\r\n+                for (let i = 0; i < this._touchesPos. ) {\r\n \r\n                 }\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625212156022,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -381,9 +381,9 @@\n                     this._selflLines.push(zhiLine);\r\n                 }\r\n \r\n \r\n-                for (let i = 0; i < this._touchesPos. ) {\r\n+                for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                 }\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625212170073,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -381,9 +381,9 @@\n                     this._selflLines.push(zhiLine);\r\n                 }\r\n \r\n \r\n-                for (let i = 0; i < this._touchesPos.length; i++) {\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                 }\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625212198524,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -383,8 +383,11 @@\n \r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n+                    if (i === 0 && this._allPointRect[i].isContains) {\r\n+\r\n+                    }\r\n                 }\r\n             }\r\n \r\n \r\n"
                },
                {
                    "date": 1625212235771,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -383,9 +383,9 @@\n \r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                    if (i === 0 && this._allPointRect[i].isContains) {\r\n+                    if (i === 0 && this._allPointRect[i].isContains && i === 1) {\r\n \r\n                     }\r\n                 }\r\n             }\r\n"
                },
                {
                    "date": 1625212242264,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -383,9 +383,9 @@\n \r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                    if (i === 0 && this._allPointRect[i].isContains && i === 1) {\r\n+                    if (i === 0 && this._allPointRect[i].isContains && i === 1 && this._allPointRect[i].isContains) {\r\n \r\n                     }\r\n                 }\r\n             }\r\n"
                },
                {
                    "date": 1625212263775,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -383,9 +383,9 @@\n \r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                    if (i === 0 && this._allPointRect[i].isContains && i === 1 && this._allPointRect[i].isContains) {\r\n+                    if ((i === 0 && this._allPointRect[i].isContains) && (i === 1 && this._allPointRect[i].isContains)) {\r\n \r\n                     }\r\n                 }\r\n             }\r\n"
                },
                {
                    "date": 1625212295230,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -381,13 +381,10 @@\n                     this._selflLines.push(zhiLine);\r\n                 }\r\n \r\n \r\n-                for (let i = 0; i < this._allPointRect.length; i++) {\r\n+                if ((i === 0 && this._allPointRect[i].isContains) && (i === 1 && this._allPointRect[i].isContains)) {\r\n \r\n-                    if ((i === 0 && this._allPointRect[i].isContains) && (i === 1 && this._allPointRect[i].isContains)) {\r\n-\r\n-                    }\r\n                 }\r\n             }\r\n \r\n \r\n"
                },
                {
                    "date": 1625212309307,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -381,9 +381,9 @@\n                     this._selflLines.push(zhiLine);\r\n                 }\r\n \r\n \r\n-                if ((i === 0 && this._allPointRect[i].isContains) && (i === 1 && this._allPointRect[i].isContains)) {\r\n+                if () {\r\n \r\n                 }\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625212324445,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -381,9 +381,9 @@\n                     this._selflLines.push(zhiLine);\r\n                 }\r\n \r\n \r\n-                if () {\r\n+                if (this._allPointRect[0].) {\r\n \r\n                 }\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625212330582,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -381,9 +381,9 @@\n                     this._selflLines.push(zhiLine);\r\n                 }\r\n \r\n \r\n-                if (this._allPointRect[0].) {\r\n+                if (this._allPointRect[0]. ) {\r\n \r\n                 }\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625212336551,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -380,9 +380,8 @@\n \r\n                     this._selflLines.push(zhiLine);\r\n                 }\r\n \r\n-\r\n                 if (this._allPointRect[0]. ) {\r\n \r\n                 }\r\n             }\r\n"
                },
                {
                    "date": 1625212392362,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -380,9 +380,10 @@\n \r\n                     this._selflLines.push(zhiLine);\r\n                 }\r\n \r\n-                if (this._allPointRect[0]. ) {\r\n+                // 判断提交正确还是错误\r\n+                if (this._allPointRect[0].isContains) {\r\n \r\n                 }\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625212453942,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -219,8 +219,14 @@\n \r\n     }\r\n \r\n     private _clickSubmit(evt: any) {\r\n+\r\n+        // 判断提交正确还是错误\r\n+        if (this._allPointRect[0].isContains) {\r\n+\r\n+        }\r\n+\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         this.updateState(state);\r\n     }\r\n \r\n@@ -379,16 +385,10 @@\n                     zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n \r\n                     this._selflLines.push(zhiLine);\r\n                 }\r\n-\r\n-                // 判断提交正确还是错误\r\n-                if (this._allPointRect[0].isContains) {\r\n-\r\n-                }\r\n             }\r\n \r\n-\r\n             setTimeout(() => {\r\n \r\n                 let state: any = globalThis._.cloneDeep(this._state);\r\n                 state.touch = 'no';\r\n"
                },
                {
                    "date": 1625212471907,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -221,9 +221,9 @@\n \r\n     private _clickSubmit(evt: any) {\r\n \r\n         // 判断提交正确还是错误\r\n-        if (this._allPointRect[0].isContains) {\r\n+        if (this._allPointRect[0].isContains && this._allPointRect[0].isContains) {\r\n \r\n         }\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212480658,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -221,9 +221,9 @@\n \r\n     private _clickSubmit(evt: any) {\r\n \r\n         // 判断提交正确还是错误\r\n-        if (this._allPointRect[0].isContains && this._allPointRect[0].isContains) {\r\n+        if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && ) {\r\n \r\n         }\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212488042,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -221,9 +221,9 @@\n \r\n     private _clickSubmit(evt: any) {\r\n \r\n         // 判断提交正确还是错误\r\n-        if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && ) {\r\n+        if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMinx) {\r\n \r\n         }\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212493253,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -221,9 +221,9 @@\n \r\n     private _clickSubmit(evt: any) {\r\n \r\n         // 判断提交正确还是错误\r\n-        if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMinx) {\r\n+        if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy) {\r\n \r\n         }\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212512271,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -221,9 +221,10 @@\n \r\n     private _clickSubmit(evt: any) {\r\n \r\n         // 判断提交正确还是错误\r\n-        if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy) {\r\n+        if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n+            this._allPointRect[1].isContains) {\r\n \r\n         }\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212519416,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -222,9 +222,9 @@\n     private _clickSubmit(evt: any) {\r\n \r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n-            this._allPointRect[1].isContains) {\r\n+            this._allPointRect[1].isContains && ) {\r\n \r\n         }\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212545758,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -222,9 +222,9 @@\n     private _clickSubmit(evt: any) {\r\n \r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n-            this._allPointRect[1].isContains && ) {\r\n+            this._allPointRect[1].isContains && this._allPointRect[0].limitMinx) {\r\n \r\n         }\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212553514,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -222,9 +222,9 @@\n     private _clickSubmit(evt: any) {\r\n \r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n-            this._allPointRect[1].isContains && this._allPointRect[0].limitMinx) {\r\n+            this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx) {\r\n \r\n         }\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212561879,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -222,8 +222,9 @@\n     private _clickSubmit(evt: any) {\r\n \r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n+            this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx) {\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1625212567919,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -223,9 +223,9 @@\n \r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n-            this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx) {\r\n+            this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx) {\r\n \r\n         }\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212573266,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -223,9 +223,10 @@\n \r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n-            this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx) {\r\n+            this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n+            ) {\r\n \r\n         }\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212579171,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -224,9 +224,9 @@\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n             this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n-            ) {\r\n+            this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx) {\r\n \r\n         }\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212586965,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -224,9 +224,9 @@\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n             this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n-            this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx) {\r\n+            this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n \r\n         }\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212665362,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -229,8 +229,9 @@\n \r\n         }\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit\r\n         this.updateState(state);\r\n     }\r\n \r\n     private _clickTitle(evt: any) {\r\n"
                },
                {
                    "date": 1625212672248,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -220,19 +220,20 @@\n     }\r\n \r\n     private _clickSubmit(evt: any) {\r\n \r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n             this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n             this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n \r\n         }\r\n \r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit\r\n-        this.updateState(state);\r\n+\r\n+        state.submit =\r\n+            this.updateState(state);\r\n     }\r\n \r\n     private _clickTitle(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212684828,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -227,13 +227,13 @@\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n             this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n             this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n \r\n+            state.submit = this.submitType.RightFeed\r\n         }\r\n \r\n \r\n-        state.submit =\r\n-            this.updateState(state);\r\n+        this.updateState(state);\r\n     }\r\n \r\n     private _clickTitle(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1625212692762,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -227,9 +227,11 @@\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n             this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n             this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n \r\n-            state.submit = this.submitType.RightFeed\r\n+            state.submit = this.submitType.RightFeed;\r\n+        } else {\r\n+\r\n         }\r\n \r\n \r\n         this.updateState(state);\r\n"
                },
                {
                    "date": 1625212700733,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -228,10 +228,11 @@\n             this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n             this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n \r\n             state.submit = this.submitType.RightFeed;\r\n+\r\n         } else {\r\n-\r\n+            state.submit = this.submitType.RightFeed;\r\n         }\r\n \r\n \r\n         this.updateState(state);\r\n"
                },
                {
                    "date": 1625212706022,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -230,9 +230,9 @@\n \r\n             state.submit = this.submitType.RightFeed;\r\n \r\n         } else {\r\n-            state.submit = this.submitType.RightFeed;\r\n+            state.submit = this.submitType.WrongFeed;\r\n         }\r\n \r\n \r\n         this.updateState(state);\r\n"
                },
                {
                    "date": 1625212714072,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -233,9 +233,8 @@\n         } else {\r\n             state.submit = this.submitType.WrongFeed;\r\n         }\r\n \r\n-\r\n         this.updateState(state);\r\n     }\r\n \r\n     private _clickTitle(evt: any) {\r\n"
                },
                {
                    "date": 1625212804639,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -415,10 +415,10 @@\n                 this.answerFeedback(false);\r\n \r\n             } else if (state.submit === this.submitType.GuideShow) {\r\n \r\n-                let keyBtn = this._view.getChild('input1').asButton;\r\n-                this.handTips2(keyBtn);\r\n+                // let keyBtn = this._view.getChild('input1').asButton;\r\n+                // this.handTips2(keyBtn);\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n"
                },
                {
                    "date": 1625212924044,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -220,8 +220,12 @@\n     }\r\n \r\n     private _clickSubmit(evt: any) {\r\n \r\n+        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n"
                },
                {
                    "date": 1625212932717,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -220,11 +220,11 @@\n     }\r\n \r\n     private _clickSubmit(evt: any) {\r\n \r\n-        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+        this._view.off(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        this._view.off(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n"
                },
                {
                    "date": 1625213070166,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -124,11 +124,11 @@\n \r\n         this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n         this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n \r\n-        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+        // this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        // this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        // this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n         let huiNode = new cc.Node('huiNode');\r\n         huiNode.parent = this._worldRoot;\r\n \r\n"
                },
                {
                    "date": 1625213084824,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -124,11 +124,11 @@\n \r\n         this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n         this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n \r\n-        // this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        // this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        // this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n         let huiNode = new cc.Node('huiNode');\r\n         huiNode.parent = this._worldRoot;\r\n \r\n"
                },
                {
                    "date": 1625213203588,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -300,9 +300,11 @@\n \r\n         } else if (state.touch == \"end\") {\r\n \r\n             this.graphics.clear();\r\n+            if (this._touchesPos > = 0) {\r\n \r\n+            }\r\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n             tempArrX.sort(this.comparePosX());\r\n \r\n"
                },
                {
                    "date": 1625213208749,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -300,9 +300,9 @@\n \r\n         } else if (state.touch == \"end\") {\r\n \r\n             this.graphics.clear();\r\n-            if (this._touchesPos > = 0) {\r\n+            if (this._touchesPos > 0) {\r\n \r\n             }\r\n             let tempArrX = [];\r\n             tempArrX = this._touchesPos;\r\n"
                },
                {
                    "date": 1625213228819,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,560 @@\n+import chooseAnswer_model0403_v2 from '../../numberPatterns/chooseAnswer-model0403-v2';\r\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v3 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _resetBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _touchesPos: any = [];\r\n+\r\n+    private _moveCurPos: cc.Vec2;\r\n+\r\n+    private graphics: cc.Graphics = null;\r\n+\r\n+    private _dragging = false;\r\n+\r\n+    private _scheduleTime = 0.03;\r\n+\r\n+    private _selflLines = [];\r\n+\r\n+    private _allPointRect = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    private lineType: any = cc.Enum({\r\n+\r\n+        StraightLine: 0,\r\n+        LineSegment: 1\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._allPointRect = [{\r\n+            'rect': new cc.Rect(610, 614, 80, 80),\r\n+            'isContains': false,\r\n+            'minx': 610,\r\n+            'maxx': 690,\r\n+            'miny': 614,\r\n+            'maxy': 694,\r\n+            'limitMinx': false,\r\n+            'limitMaxy': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n+            'limitMaxx': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n+            'limitMaxx': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n+            'limitMiny': false,\r\n+        }\r\n+        ];\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n+        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n+\r\n+        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+\r\n+        let huiNode = new cc.Node('huiNode');\r\n+        huiNode.parent = this._worldRoot;\r\n+\r\n+        this.graphics = huiNode.addComponent(cc.Graphics);\r\n+        this.graphics.lineWidth = 20;\r\n+        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n+        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n+        this.graphics.fillColor = cc.color(255, 0, 0);\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            touch: \"no\",\r\n+            reset: false,\r\n+            touchesPos: [],\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    _onDrawStart(event) {\r\n+        console.log('===== start 111 ====' + event.touch.getLocation());\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.touch = 'start';\r\n+        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+        state.touchesPos.push(tempPos);\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    _onDrawMove(event) {\r\n+\r\n+        this._dragging = true;\r\n+        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+    }\r\n+\r\n+    _onDrawEnd(event) {\r\n+\r\n+        this._dragging = false;\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.touch = 'end';\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 排序方法\r\n+    comparePosX() {\r\n+        return function (a, b) {\r\n+            var value1 = a.x;\r\n+            var value2 = b.x;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n+    // 排序方法\r\n+    comparePosY() {\r\n+        return function (a, b) {\r\n+            var value1 = a.y;\r\n+            var value2 = b.y;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n+    private _clickReset(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.reset = true;\r\n+        this.updateState(state);\r\n+\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+\r\n+        this._view.off(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        this._view.off(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        // 判断提交正确还是错误\r\n+        if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n+            this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n+            this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n+            this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n+\r\n+            state.submit = this.submitType.RightFeed;\r\n+\r\n+        } else {\r\n+            state.submit = this.submitType.WrongFeed;\r\n+        }\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    // 临时\r\n+    // 拖拽定时器\r\n+    dragSchedule() {\r\n+        if (this._dragging) {\r\n+\r\n+            console.log('==== 3333333 拖拽定时器 ======');\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.touchesPos.push(this._moveCurPos);\r\n+            state.touch = \"move\";\r\n+            this.updateState(state);\r\n+        }\r\n+    }\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (state.touch == \"start\") {\r\n+\r\n+            this._touchesPos = state.touchesPos;\r\n+            this.graphics.clear();\r\n+            this._touchesPos.length = 0;\r\n+\r\n+        } else if (state.touch == \"move\") {\r\n+\r\n+            this._touchesPos = state.touchesPos;\r\n+\r\n+            const MIN_POINT_DISTANCE = 4;\r\n+\r\n+            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n+            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n+            let lastIndex = 0;\r\n+            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n+                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n+                    continue;\r\n+                }\r\n+                lastIndex = i;\r\n+                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n+            }\r\n+            this.graphics.stroke();\r\n+\r\n+        } else if (state.touch == \"end\") {\r\n+\r\n+            this.graphics.clear();\r\n+            if (this._touchesPos > 0) {\r\n+\r\n+                let tempArrX = [];\r\n+                tempArrX = this._touchesPos;\r\n+                tempArrX.sort(this.comparePosX());\r\n+\r\n+                let tempArrY = [];\r\n+                tempArrY = this._touchesPos;\r\n+                tempArrY.sort(this.comparePosY());\r\n+\r\n+                let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n+                let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n+\r\n+                if (chaX < 200) {\r\n+\r\n+                    this._touchesPos.sort(this.comparePosY());\r\n+\r\n+                } else {\r\n+                    this._touchesPos.sort(this.comparePosX());\r\n+                }\r\n+\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                    this._allPointRect[i].isContains = false;\r\n+                }\r\n+\r\n+                let pointNums = 0;\r\n+                for (let i = 0; i < this._touchesPos.length; i++) {\r\n+\r\n+                    let tempPos = this._touchesPos[i];\r\n+                    tempPos.y = this._view.height - tempPos.y;\r\n+                    for (let j = 0; j < this._allPointRect.length; j++) {\r\n+\r\n+                        if (this._allPointRect[j].rect.contains(tempPos)) {\r\n+                            this._allPointRect[j].isContains = true;\r\n+                            break;\r\n+                        }\r\n+                    }\r\n+                }\r\n+\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                    if (this._allPointRect[i].isContains) {\r\n+                        pointNums++;\r\n+                    }\r\n+                }\r\n+\r\n+                if (pointNums >= 2) {\r\n+\r\n+                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                        if (i === 0 && this._allPointRect[i].isContains) {\r\n+\r\n+                            if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n+\r\n+                                this._allPointRect[i].limitMinx = true;\r\n+                            }\r\n+\r\n+                            if (1080 - this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n+\r\n+                                this._allPointRect[i].limitMaxy = true;\r\n+                            }\r\n+\r\n+                        } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n+\r\n+                            if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n+\r\n+                                this._allPointRect[i].limitMaxx = true;\r\n+                            }\r\n+\r\n+                        } else if (i === 3 && this._allPointRect[i].isContains) {\r\n+\r\n+                            if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n+\r\n+                                this._allPointRect[i].limitMiny = true;\r\n+                            }\r\n+                        }\r\n+\r\n+                    }\r\n+\r\n+                    if (this._touchesPos.length > 0) {\r\n+\r\n+                        let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n+\r\n+                        let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                        this._view.addChild(zhiLine);\r\n+                        zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n+                        zhiLine.x = this._touchesPos[0].x;\r\n+                        zhiLine.y = this._touchesPos[0].y;\r\n+                        zhiLine.rotation = angle;\r\n+\r\n+                        zhiLine.sortingOrder = 0;\r\n+\r\n+                        zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n+\r\n+                        this._selflLines.push(zhiLine);\r\n+                    }\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state: any = globalThis._.cloneDeep(this._state);\r\n+                    state.touch = 'no';\r\n+                    this.updateState(state);\r\n+\r\n+                });\r\n+\r\n+            }\r\n+\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+                // let keyBtn = this._view.getChild('input1').asButton;\r\n+                // this.handTips2(keyBtn);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+    angle(start, end) {\r\n+        var diff_x = end.x - start.x,\r\n+            diff_y = end.y - start.y;\r\n+        //返回角度,不是弧度\r\n+        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+        this.schedule(this.dragSchedule, this._scheduleTime);\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1625213234590,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -406,9 +406,8 @@\n                     state.touch = 'no';\r\n                     this.updateState(state);\r\n \r\n                 });\r\n-\r\n             }\r\n \r\n         }\r\n \r\n@@ -557,562 +556,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-import chooseAnswer_model0403_v2 from '../../numberPatterns/chooseAnswer-model0403-v2';\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v3 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _resetBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _touchesPos: any = [];\r\n-\r\n-    private _moveCurPos: cc.Vec2;\r\n-\r\n-    private graphics: cc.Graphics = null;\r\n-\r\n-    private _dragging = false;\r\n-\r\n-    private _scheduleTime = 0.03;\r\n-\r\n-    private _selflLines = [];\r\n-\r\n-    private _allPointRect = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    private lineType: any = cc.Enum({\r\n-\r\n-        StraightLine: 0,\r\n-        LineSegment: 1\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._allPointRect = [{\r\n-            'rect': new cc.Rect(610, 614, 80, 80),\r\n-            'isContains': false,\r\n-            'minx': 610,\r\n-            'maxx': 690,\r\n-            'miny': 614,\r\n-            'maxy': 694,\r\n-            'limitMinx': false,\r\n-            'limitMaxy': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n-            'limitMaxx': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n-            'limitMaxx': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n-            'limitMiny': false,\r\n-        }\r\n-        ];\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n-        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n-\r\n-        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n-\r\n-        let huiNode = new cc.Node('huiNode');\r\n-        huiNode.parent = this._worldRoot;\r\n-\r\n-        this.graphics = huiNode.addComponent(cc.Graphics);\r\n-        this.graphics.lineWidth = 20;\r\n-        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n-        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n-        this.graphics.fillColor = cc.color(255, 0, 0);\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            touch: \"no\",\r\n-            reset: false,\r\n-            touchesPos: [],\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    _onDrawStart(event) {\r\n-        console.log('===== start 111 ====' + event.touch.getLocation());\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.touch = 'start';\r\n-        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-        state.touchesPos.push(tempPos);\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    _onDrawMove(event) {\r\n-\r\n-        this._dragging = true;\r\n-        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-    }\r\n-\r\n-    _onDrawEnd(event) {\r\n-\r\n-        this._dragging = false;\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.touch = 'end';\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 排序方法\r\n-    comparePosX() {\r\n-        return function (a, b) {\r\n-            var value1 = a.x;\r\n-            var value2 = b.x;\r\n-            return value1 - value2;\r\n-        }\r\n-    }\r\n-\r\n-    // 排序方法\r\n-    comparePosY() {\r\n-        return function (a, b) {\r\n-            var value1 = a.y;\r\n-            var value2 = b.y;\r\n-            return value1 - value2;\r\n-        }\r\n-    }\r\n-\r\n-    private _clickReset(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.reset = true;\r\n-        this.updateState(state);\r\n-\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-\r\n-        this._view.off(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        this._view.off(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        // 判断提交正确还是错误\r\n-        if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n-            this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n-            this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n-            this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n-\r\n-            state.submit = this.submitType.RightFeed;\r\n-\r\n-        } else {\r\n-            state.submit = this.submitType.WrongFeed;\r\n-        }\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    // 临时\r\n-    // 拖拽定时器\r\n-    dragSchedule() {\r\n-        if (this._dragging) {\r\n-\r\n-            console.log('==== 3333333 拖拽定时器 ======');\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.touchesPos.push(this._moveCurPos);\r\n-            state.touch = \"move\";\r\n-            this.updateState(state);\r\n-        }\r\n-    }\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (state.touch == \"start\") {\r\n-\r\n-            this._touchesPos = state.touchesPos;\r\n-            this.graphics.clear();\r\n-            this._touchesPos.length = 0;\r\n-\r\n-        } else if (state.touch == \"move\") {\r\n-\r\n-            this._touchesPos = state.touchesPos;\r\n-\r\n-            const MIN_POINT_DISTANCE = 4;\r\n-\r\n-            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n-            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n-            let lastIndex = 0;\r\n-            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n-                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n-                    continue;\r\n-                }\r\n-                lastIndex = i;\r\n-                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n-            }\r\n-            this.graphics.stroke();\r\n-\r\n-        } else if (state.touch == \"end\") {\r\n-\r\n-            this.graphics.clear();\r\n-            if (this._touchesPos > 0) {\r\n-\r\n-            }\r\n-            let tempArrX = [];\r\n-            tempArrX = this._touchesPos;\r\n-            tempArrX.sort(this.comparePosX());\r\n-\r\n-            let tempArrY = [];\r\n-            tempArrY = this._touchesPos;\r\n-            tempArrY.sort(this.comparePosY());\r\n-\r\n-            let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n-            let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n-\r\n-            if (chaX < 200) {\r\n-\r\n-                this._touchesPos.sort(this.comparePosY());\r\n-\r\n-            } else {\r\n-                this._touchesPos.sort(this.comparePosX());\r\n-            }\r\n-\r\n-            for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                this._allPointRect[i].isContains = false;\r\n-            }\r\n-\r\n-            let pointNums = 0;\r\n-            for (let i = 0; i < this._touchesPos.length; i++) {\r\n-\r\n-                let tempPos = this._touchesPos[i];\r\n-                tempPos.y = this._view.height - tempPos.y;\r\n-                for (let j = 0; j < this._allPointRect.length; j++) {\r\n-\r\n-                    if (this._allPointRect[j].rect.contains(tempPos)) {\r\n-                        this._allPointRect[j].isContains = true;\r\n-                        break;\r\n-                    }\r\n-                }\r\n-            }\r\n-\r\n-            for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                if (this._allPointRect[i].isContains) {\r\n-                    pointNums++;\r\n-                }\r\n-            }\r\n-\r\n-            if (pointNums >= 2) {\r\n-\r\n-                for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                    if (i === 0 && this._allPointRect[i].isContains) {\r\n-\r\n-                        if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n-\r\n-                            this._allPointRect[i].limitMinx = true;\r\n-                        }\r\n-\r\n-                        if (1080 - this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n-\r\n-                            this._allPointRect[i].limitMaxy = true;\r\n-                        }\r\n-\r\n-                    } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n-\r\n-                        if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n-\r\n-                            this._allPointRect[i].limitMaxx = true;\r\n-                        }\r\n-\r\n-                    } else if (i === 3 && this._allPointRect[i].isContains) {\r\n-\r\n-                        if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n-\r\n-                            this._allPointRect[i].limitMiny = true;\r\n-                        }\r\n-                    }\r\n-\r\n-                }\r\n-\r\n-                if (this._touchesPos.length > 0) {\r\n-\r\n-                    let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n-\r\n-                    let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                    this._view.addChild(zhiLine);\r\n-                    zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n-                    zhiLine.x = this._touchesPos[0].x;\r\n-                    zhiLine.y = this._touchesPos[0].y;\r\n-                    zhiLine.rotation = angle;\r\n-\r\n-                    zhiLine.sortingOrder = 0;\r\n-\r\n-                    zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n-\r\n-                    this._selflLines.push(zhiLine);\r\n-                }\r\n-            }\r\n-\r\n-            setTimeout(() => {\r\n-\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.touch = 'no';\r\n-                this.updateState(state);\r\n-\r\n-            });\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-                // let keyBtn = this._view.getChild('input1').asButton;\r\n-                // this.handTips2(keyBtn);\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-    angle(start, end) {\r\n-        var diff_x = end.x - start.x,\r\n-            diff_y = end.y - start.y;\r\n-        //返回角度,不是弧度\r\n-        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-        this.schedule(this.dragSchedule, this._scheduleTime);\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1625213260571,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -300,9 +300,9 @@\n \r\n         } else if (state.touch == \"end\") {\r\n \r\n             this.graphics.clear();\r\n-            if (this._touchesPos > 0) {\r\n+            if (this._touchesPos.length > 0) {\r\n \r\n                 let tempArrX = [];\r\n                 tempArrX = this._touchesPos;\r\n                 tempArrX.sort(this.comparePosX());\r\n"
                },
                {
                    "date": 1625213372097,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -225,8 +225,10 @@\n         this._view.off(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n         this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n+        console.log('====_allPointRect  ====');\r\n+        console.log('====_allPointRect  ====');\r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n             this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n"
                },
                {
                    "date": 1625213380091,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -226,9 +226,9 @@\n         this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         console.log('====_allPointRect  ====');\r\n-        console.log('====_allPointRect  ====');\r\n+        console.log(this._allPointRect);\r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n             this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n"
                },
                {
                    "date": 1625213515138,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,8 +42,10 @@\n     private _selflLines = [];\r\n \r\n     private _allPointRect = [];\r\n \r\n+    this._allPointRect\r\n+\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n@@ -61,501 +63,501 @@\n     private feedback: any;\r\n \r\n     private _state = {};\r\n \r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n+get state(): any {\r\n+    return this._state;\r\n+}\r\n \r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n+set state(v: any) {\r\n+    this.updateUi(this._state, v);\r\n+    this._state = v;\r\n+    this.mergeState();\r\n+}\r\n \r\n-    async onLoad() {\r\n+async onLoad() {\r\n \r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+    this._worldRoot = cc.find(\"Canvas\").parent;\r\n \r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+    this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+    this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n \r\n-        fgui.GRoot.inst.addChild(this._view);\r\n+    fgui.GRoot.inst.addChild(this._view);\r\n \r\n-        this._c1 = this._view.getController(\"c1\");\r\n+    this._c1 = this._view.getController(\"c1\");\r\n \r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n+    // 臨時\r\n+    // bug 初始设置不播放不生效\r\n+    if (this._c1) {\r\n+        this._c1.selectedIndex = 1;\r\n+        this._c1.selectedIndex = 0;\r\n+    }\r\n \r\n-        this._allPointRect = [{\r\n-            'rect': new cc.Rect(610, 614, 80, 80),\r\n-            'isContains': false,\r\n-            'minx': 610,\r\n-            'maxx': 690,\r\n-            'miny': 614,\r\n-            'maxy': 694,\r\n-            'limitMinx': false,\r\n-            'limitMaxy': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n-            'limitMaxx': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n-            'limitMaxx': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n-            'limitMiny': false,\r\n-        }\r\n-        ];\r\n+    this._allPointRect = [{\r\n+        'rect': new cc.Rect(610, 614, 80, 80),\r\n+        'isContains': false,\r\n+        'minx': 610,\r\n+        'maxx': 690,\r\n+        'miny': 614,\r\n+        'maxy': 694,\r\n+        'limitMinx': false,\r\n+        'limitMaxy': false,\r\n+    },\r\n+    {\r\n+        'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n+        'limitMaxx': false,\r\n+    },\r\n+    {\r\n+        'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n+        'limitMaxx': false,\r\n+    },\r\n+    {\r\n+        'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n+        'limitMiny': false,\r\n+    }\r\n+    ];\r\n \r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+    this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+    if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n+    this._title = this._view.getChild(\"title\").asButton;\r\n \r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+    this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+    if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n \r\n-        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n-        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n+    this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n+    this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n \r\n-        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+    this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+    this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+    this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n-        let huiNode = new cc.Node('huiNode');\r\n-        huiNode.parent = this._worldRoot;\r\n+    let huiNode = new cc.Node('huiNode');\r\n+    huiNode.parent = this._worldRoot;\r\n \r\n-        this.graphics = huiNode.addComponent(cc.Graphics);\r\n-        this.graphics.lineWidth = 20;\r\n-        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n-        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n-        this.graphics.fillColor = cc.color(255, 0, 0);\r\n+    this.graphics = huiNode.addComponent(cc.Graphics);\r\n+    this.graphics.lineWidth = 20;\r\n+    this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n+    this.graphics.strokeColor = cc.color(255, 0, 0);\r\n+    this.graphics.fillColor = cc.color(255, 0, 0);\r\n \r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            touch: \"no\",\r\n-            reset: false,\r\n-            touchesPos: [],\r\n-        }\r\n+    // 初始化state\r\n+    this._state = {\r\n+        title: false,\r\n+        submit: this.submitType.No,\r\n+        touch: \"no\",\r\n+        reset: false,\r\n+        touchesPos: [],\r\n     }\r\n+}\r\n \r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n+async init(data: any) {\r\n+    // 临时 model component json 配置加载\r\n+    let { pathConfig, model, components } = data;\r\n+    let Package = pathConfig.packageName;\r\n+    let GComponent = model.uiPath;\r\n+    let { boxSoundUrl, guidIndex } = model.config;\r\n+    this._package = Package;\r\n \r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+    this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n \r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n+    if (components) {\r\n+        for (const key in components) {\r\n+            let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+            let componentBundle: any = await loadBundle(componentPath);\r\n+            let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+            this[key] = componentPrefab;\r\n         }\r\n     }\r\n+}\r\n \r\n-    _onDrawStart(event) {\r\n-        console.log('===== start 111 ====' + event.touch.getLocation());\r\n+_onDrawStart(event) {\r\n+    console.log('===== start 111 ====' + event.touch.getLocation());\r\n \r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.touch = 'start';\r\n-        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-        state.touchesPos.push(tempPos);\r\n-        this.updateState(state);\r\n-    }\r\n+    let state: any = globalThis._.cloneDeep(this._state);\r\n+    state.touch = 'start';\r\n+    let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+    state.touchesPos.push(tempPos);\r\n+    this.updateState(state);\r\n+}\r\n \r\n-    _onDrawMove(event) {\r\n+_onDrawMove(event) {\r\n \r\n-        this._dragging = true;\r\n-        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-    }\r\n+    this._dragging = true;\r\n+    this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+}\r\n \r\n-    _onDrawEnd(event) {\r\n+_onDrawEnd(event) {\r\n \r\n-        this._dragging = false;\r\n+    this._dragging = false;\r\n \r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.touch = 'end';\r\n-        this.updateState(state);\r\n-    }\r\n+    let state: any = globalThis._.cloneDeep(this._state);\r\n+    state.touch = 'end';\r\n+    this.updateState(state);\r\n+}\r\n \r\n \r\n-    // 排序方法\r\n-    comparePosX() {\r\n-        return function (a, b) {\r\n-            var value1 = a.x;\r\n-            var value2 = b.x;\r\n-            return value1 - value2;\r\n-        }\r\n+// 排序方法\r\n+comparePosX() {\r\n+    return function (a, b) {\r\n+        var value1 = a.x;\r\n+        var value2 = b.x;\r\n+        return value1 - value2;\r\n     }\r\n+}\r\n \r\n-    // 排序方法\r\n-    comparePosY() {\r\n-        return function (a, b) {\r\n-            var value1 = a.y;\r\n-            var value2 = b.y;\r\n-            return value1 - value2;\r\n-        }\r\n+// 排序方法\r\n+comparePosY() {\r\n+    return function (a, b) {\r\n+        var value1 = a.y;\r\n+        var value2 = b.y;\r\n+        return value1 - value2;\r\n     }\r\n+}\r\n \r\n     private _clickReset(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.reset = true;\r\n-        this.updateState(state);\r\n+    let state: any = globalThis._.cloneDeep(this._state);\r\n+    state.reset = true;\r\n+    this.updateState(state);\r\n \r\n-    }\r\n+}\r\n \r\n     private _clickSubmit(evt: any) {\r\n \r\n-        this._view.off(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        this._view.off(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+    this._view.off(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+    this._view.off(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+    this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        console.log('====_allPointRect  ====');\r\n-        console.log(this._allPointRect);\r\n-        // 判断提交正确还是错误\r\n-        if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n-            this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n-            this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n-            this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n+    let state: any = globalThis._.cloneDeep(this._state);\r\n+    console.log('====_allPointRect  ====');\r\n+    console.log(this._allPointRect);\r\n+    // 判断提交正确还是错误\r\n+    if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n+        this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n+        this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n+        this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n \r\n-            state.submit = this.submitType.RightFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n \r\n-        } else {\r\n-            state.submit = this.submitType.WrongFeed;\r\n-        }\r\n-\r\n-        this.updateState(state);\r\n+    } else {\r\n+        state.submit = this.submitType.WrongFeed;\r\n     }\r\n \r\n+    this.updateState(state);\r\n+}\r\n+\r\n     private _clickTitle(evt: any) {\r\n+    let state: any = globalThis._.cloneDeep(this._state);\r\n+    state.title = true;\r\n+    this.updateState(state);\r\n+}\r\n+\r\n+// 临时\r\n+// 拖拽定时器\r\n+dragSchedule() {\r\n+    if (this._dragging) {\r\n+\r\n+        console.log('==== 3333333 拖拽定时器 ======');\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n+        state.touchesPos.push(this._moveCurPos);\r\n+        state.touch = \"move\";\r\n         this.updateState(state);\r\n     }\r\n+}\r\n \r\n-    // 临时\r\n-    // 拖拽定时器\r\n-    dragSchedule() {\r\n-        if (this._dragging) {\r\n+// 获取状态\r\n+getState(data: any) {\r\n+    this.updateState(data);\r\n+}\r\n \r\n-            console.log('==== 3333333 拖拽定时器 ======');\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.touchesPos.push(this._moveCurPos);\r\n-            state.touch = \"move\";\r\n-            this.updateState(state);\r\n-        }\r\n-    }\r\n+// 更新状态层\r\n+updateState(curState: any) {\r\n+    if (globalThis._.isEqual(this._state, curState)) return;\r\n+    this.state = curState;\r\n+}\r\n \r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n+// 更新ui层\r\n+updateUi(oldState: any, state: any) {\r\n \r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n+    if (state.touch == \"start\") {\r\n \r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n+        this._touchesPos = state.touchesPos;\r\n+        this.graphics.clear();\r\n+        this._touchesPos.length = 0;\r\n \r\n-        if (state.touch == \"start\") {\r\n+    } else if (state.touch == \"move\") {\r\n \r\n-            this._touchesPos = state.touchesPos;\r\n-            this.graphics.clear();\r\n-            this._touchesPos.length = 0;\r\n+        this._touchesPos = state.touchesPos;\r\n \r\n-        } else if (state.touch == \"move\") {\r\n+        const MIN_POINT_DISTANCE = 4;\r\n \r\n-            this._touchesPos = state.touchesPos;\r\n-\r\n-            const MIN_POINT_DISTANCE = 4;\r\n-\r\n-            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n-            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n-            let lastIndex = 0;\r\n-            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n-                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n-                    continue;\r\n-                }\r\n-                lastIndex = i;\r\n-                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n+        let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n+        this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n+        let lastIndex = 0;\r\n+        for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n+            if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n+                continue;\r\n             }\r\n-            this.graphics.stroke();\r\n+            lastIndex = i;\r\n+            this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n+        }\r\n+        this.graphics.stroke();\r\n \r\n-        } else if (state.touch == \"end\") {\r\n+    } else if (state.touch == \"end\") {\r\n \r\n-            this.graphics.clear();\r\n-            if (this._touchesPos.length > 0) {\r\n+        this.graphics.clear();\r\n+        if (this._touchesPos.length > 0) {\r\n \r\n-                let tempArrX = [];\r\n-                tempArrX = this._touchesPos;\r\n-                tempArrX.sort(this.comparePosX());\r\n+            let tempArrX = [];\r\n+            tempArrX = this._touchesPos;\r\n+            tempArrX.sort(this.comparePosX());\r\n \r\n-                let tempArrY = [];\r\n-                tempArrY = this._touchesPos;\r\n-                tempArrY.sort(this.comparePosY());\r\n+            let tempArrY = [];\r\n+            tempArrY = this._touchesPos;\r\n+            tempArrY.sort(this.comparePosY());\r\n \r\n-                let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n-                let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n+            let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n+            let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n \r\n-                if (chaX < 200) {\r\n+            if (chaX < 200) {\r\n \r\n-                    this._touchesPos.sort(this.comparePosY());\r\n+                this._touchesPos.sort(this.comparePosY());\r\n \r\n-                } else {\r\n-                    this._touchesPos.sort(this.comparePosX());\r\n-                }\r\n+            } else {\r\n+                this._touchesPos.sort(this.comparePosX());\r\n+            }\r\n \r\n-                for (let i = 0; i < this._allPointRect.length; i++) {\r\n+            for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                    this._allPointRect[i].isContains = false;\r\n-                }\r\n+                this._allPointRect[i].isContains = false;\r\n+            }\r\n \r\n-                let pointNums = 0;\r\n-                for (let i = 0; i < this._touchesPos.length; i++) {\r\n+            let pointNums = 0;\r\n+            for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n-                    let tempPos = this._touchesPos[i];\r\n-                    tempPos.y = this._view.height - tempPos.y;\r\n-                    for (let j = 0; j < this._allPointRect.length; j++) {\r\n+                let tempPos = this._touchesPos[i];\r\n+                tempPos.y = this._view.height - tempPos.y;\r\n+                for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n-                        if (this._allPointRect[j].rect.contains(tempPos)) {\r\n-                            this._allPointRect[j].isContains = true;\r\n-                            break;\r\n-                        }\r\n+                    if (this._allPointRect[j].rect.contains(tempPos)) {\r\n+                        this._allPointRect[j].isContains = true;\r\n+                        break;\r\n                     }\r\n                 }\r\n+            }\r\n \r\n-                for (let i = 0; i < this._allPointRect.length; i++) {\r\n+            for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                    if (this._allPointRect[i].isContains) {\r\n-                        pointNums++;\r\n-                    }\r\n+                if (this._allPointRect[i].isContains) {\r\n+                    pointNums++;\r\n                 }\r\n+            }\r\n \r\n-                if (pointNums >= 2) {\r\n+            if (pointNums >= 2) {\r\n \r\n-                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                        if (i === 0 && this._allPointRect[i].isContains) {\r\n+                    if (i === 0 && this._allPointRect[i].isContains) {\r\n \r\n-                            if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n+                        if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n-                                this._allPointRect[i].limitMinx = true;\r\n-                            }\r\n+                            this._allPointRect[i].limitMinx = true;\r\n+                        }\r\n \r\n-                            if (1080 - this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n+                        if (1080 - this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n \r\n-                                this._allPointRect[i].limitMaxy = true;\r\n-                            }\r\n+                            this._allPointRect[i].limitMaxy = true;\r\n+                        }\r\n \r\n-                        } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n+                    } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n \r\n-                            if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n+                        if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n-                                this._allPointRect[i].limitMaxx = true;\r\n-                            }\r\n+                            this._allPointRect[i].limitMaxx = true;\r\n+                        }\r\n \r\n-                        } else if (i === 3 && this._allPointRect[i].isContains) {\r\n+                    } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                            if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n+                        if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n \r\n-                                this._allPointRect[i].limitMiny = true;\r\n-                            }\r\n+                            this._allPointRect[i].limitMiny = true;\r\n                         }\r\n-\r\n                     }\r\n \r\n-                    if (this._touchesPos.length > 0) {\r\n+                }\r\n \r\n-                        let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n+                if (this._touchesPos.length > 0) {\r\n \r\n-                        let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                        this._view.addChild(zhiLine);\r\n-                        zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n-                        zhiLine.x = this._touchesPos[0].x;\r\n-                        zhiLine.y = this._touchesPos[0].y;\r\n-                        zhiLine.rotation = angle;\r\n+                    let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n-                        zhiLine.sortingOrder = 0;\r\n+                    let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                    this._view.addChild(zhiLine);\r\n+                    zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n+                    zhiLine.x = this._touchesPos[0].x;\r\n+                    zhiLine.y = this._touchesPos[0].y;\r\n+                    zhiLine.rotation = angle;\r\n \r\n-                        zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n+                    zhiLine.sortingOrder = 0;\r\n \r\n-                        this._selflLines.push(zhiLine);\r\n-                    }\r\n+                    zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n+\r\n+                    this._selflLines.push(zhiLine);\r\n                 }\r\n+            }\r\n \r\n-                setTimeout(() => {\r\n+            setTimeout(() => {\r\n \r\n-                    let state: any = globalThis._.cloneDeep(this._state);\r\n-                    state.touch = 'no';\r\n-                    this.updateState(state);\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.touch = 'no';\r\n+                this.updateState(state);\r\n \r\n-                });\r\n-            }\r\n-\r\n+            });\r\n         }\r\n \r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+    }\r\n \r\n-            if (state.submit === this.submitType.RightFeed) {\r\n+    if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n-                this.answerFeedback(true);\r\n+        if (state.submit === this.submitType.RightFeed) {\r\n \r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n+            this.answerFeedback(true);\r\n \r\n-                this.answerFeedback(false);\r\n+        } else if (state.submit === this.submitType.WrongFeed) {\r\n \r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n+            this.answerFeedback(false);\r\n \r\n-                // let keyBtn = this._view.getChild('input1').asButton;\r\n-                // this.handTips2(keyBtn);\r\n-            }\r\n-        }\r\n+        } else if (state.submit === this.submitType.GuideShow) {\r\n \r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n+            // let keyBtn = this._view.getChild('input1').asButton;\r\n+            // this.handTips2(keyBtn);\r\n         }\r\n     }\r\n \r\n-    angle(start, end) {\r\n-        var diff_x = end.x - start.x,\r\n-            diff_y = end.y - start.y;\r\n-        //返回角度,不是弧度\r\n-        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n+    if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+        this.playTitle(state.title);\r\n     }\r\n+}\r\n \r\n+angle(start, end) {\r\n+    var diff_x = end.x - start.x,\r\n+        diff_y = end.y - start.y;\r\n+    //返回角度,不是弧度\r\n+    return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n+}\r\n \r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n \r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n+async playTitle(bool: boolean) {\r\n+    this._c1.selectedIndex = bool ? 1 : 0;\r\n+    if (bool) {\r\n+        cc.audioEngine.stopAll();\r\n+        this.forbidHandle();\r\n+        let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+        let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+        let audioId = cc.audioEngine.play(audio, false, 1);\r\n+        cc.audioEngine.setFinishCallback(audioId, () => {\r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n+            state.title = false;\r\n             this.updateState(state);\r\n-        }, 2000);\r\n+        });\r\n+    } else {\r\n+        this.disableForbidHandle();\r\n     }\r\n+}\r\n \r\n+answerFeedback(bool: boolean) {\r\n+    if (!this.feedback) return;\r\n+    let feedback: any = cc.instantiate(this.feedback);\r\n+    feedback.x = 960;\r\n+    feedback.y = 540;\r\n+    let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+    feedbackJs.init(bool);\r\n+    feedback.parent = cc.find(\"Canvas\").parent;\r\n \r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n+    setTimeout(() => {\r\n+        feedback.destroy();\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.No;\r\n+        this.updateState(state);\r\n+    }, 2000);\r\n+}\r\n \r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n \r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n+/**\r\n+ * 点击指引\r\n+ * @param obj 点击对象\r\n+ */\r\n+handTips2(obj: fgui.GObject) {\r\n+    let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+    this._view.addChild(hand);\r\n+    let tempX = obj.x;\r\n+    let tempY = obj.y;\r\n \r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n+    hand.x = tempX;\r\n+    hand.y = tempY;\r\n \r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n+    cc.tween(hand).to(0.3, {\r\n+        x: tempX - 30,\r\n+        y: tempY - 30\r\n+    }).to(0.3, {\r\n+        x: tempX,\r\n+        y: tempY\r\n+    }).to(0.3, {\r\n+        x: tempX - 30,\r\n+        y: tempY - 30\r\n+    }).to(0.3, {\r\n+        x: tempX,\r\n+        y: tempY\r\n+    }).call(() => {\r\n+        this._view.removeChild(hand);\r\n+        hand = null;\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.No;\r\n+        this.updateState(state)\r\n+    }).start();\r\n+}\r\n \r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+// 运行时 禁止操作\r\n+forbidHandle() {\r\n+    console.log('===  运行时 禁止操作 =====');\r\n+    let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+    if (!handleMask) {\r\n+        let handleMask = new cc.Node('handleMask');\r\n+        handleMask.addComponent(cc.BlockInputEvents);\r\n+        handleMask.parent = this._worldRoot;\r\n+        handleMask.width = 1920;\r\n+        handleMask.height = 1080;\r\n+        handleMask.x = 960;\r\n+        handleMask.y = 540;\r\n     }\r\n+}\r\n \r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n+// 消除禁止\r\n+disableForbidHandle() {\r\n+    let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+    if (handleMask) handleMask.destroy();\r\n+}\r\n \r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n+// 注册状态，及获取状态的方法\r\n+registerState() {\r\n+    if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+}\r\n \r\n-    onEnable() {\r\n-        this.registerState();\r\n-        this.schedule(this.dragSchedule, this._scheduleTime);\r\n-    }\r\n+// 解除状态，及获取状态的方法\r\n+relieveState() {\r\n+    if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+}\r\n \r\n-    onDisable() {\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n+// 本组件状态合并到全局\r\n+mergeState() {\r\n+    if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n }\r\n+\r\n+onEnable() {\r\n+    this.registerState();\r\n+    this.schedule(this.dragSchedule, this._scheduleTime);\r\n+}\r\n+\r\n+onDisable() {\r\n+    this.relieveState();\r\n+    cc.audioEngine.stopAll();\r\n+}\r\n+}\r\n"
                },
                {
                    "date": 1625213521152,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,9 +42,9 @@\n     private _selflLines = [];\r\n \r\n     private _allPointRect = [];\r\n \r\n-    this._allPointRect\r\n+    private _allPointRect\r\n \r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n@@ -63,501 +63,501 @@\n     private feedback: any;\r\n \r\n     private _state = {};\r\n \r\n-get state(): any {\r\n-    return this._state;\r\n-}\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n \r\n-set state(v: any) {\r\n-    this.updateUi(this._state, v);\r\n-    this._state = v;\r\n-    this.mergeState();\r\n-}\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n \r\n-async onLoad() {\r\n+    async onLoad() {\r\n \r\n-    this._worldRoot = cc.find(\"Canvas\").parent;\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n \r\n-    this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-    this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n \r\n-    fgui.GRoot.inst.addChild(this._view);\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n \r\n-    this._c1 = this._view.getController(\"c1\");\r\n+        this._c1 = this._view.getController(\"c1\");\r\n \r\n-    // 臨時\r\n-    // bug 初始设置不播放不生效\r\n-    if (this._c1) {\r\n-        this._c1.selectedIndex = 1;\r\n-        this._c1.selectedIndex = 0;\r\n-    }\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n \r\n-    this._allPointRect = [{\r\n-        'rect': new cc.Rect(610, 614, 80, 80),\r\n-        'isContains': false,\r\n-        'minx': 610,\r\n-        'maxx': 690,\r\n-        'miny': 614,\r\n-        'maxy': 694,\r\n-        'limitMinx': false,\r\n-        'limitMaxy': false,\r\n-    },\r\n-    {\r\n-        'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n-        'limitMaxx': false,\r\n-    },\r\n-    {\r\n-        'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n-        'limitMaxx': false,\r\n-    },\r\n-    {\r\n-        'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n-        'limitMiny': false,\r\n-    }\r\n-    ];\r\n+        this._allPointRect = [{\r\n+            'rect': new cc.Rect(610, 614, 80, 80),\r\n+            'isContains': false,\r\n+            'minx': 610,\r\n+            'maxx': 690,\r\n+            'miny': 614,\r\n+            'maxy': 694,\r\n+            'limitMinx': false,\r\n+            'limitMaxy': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n+            'limitMaxx': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n+            'limitMaxx': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n+            'limitMiny': false,\r\n+        }\r\n+        ];\r\n \r\n-    this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-    if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n-    this._title = this._view.getChild(\"title\").asButton;\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n \r\n-    this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-    if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n \r\n-    this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n-    this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n+        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n+        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n \r\n-    this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-    this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-    this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n-    let huiNode = new cc.Node('huiNode');\r\n-    huiNode.parent = this._worldRoot;\r\n+        let huiNode = new cc.Node('huiNode');\r\n+        huiNode.parent = this._worldRoot;\r\n \r\n-    this.graphics = huiNode.addComponent(cc.Graphics);\r\n-    this.graphics.lineWidth = 20;\r\n-    this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n-    this.graphics.strokeColor = cc.color(255, 0, 0);\r\n-    this.graphics.fillColor = cc.color(255, 0, 0);\r\n+        this.graphics = huiNode.addComponent(cc.Graphics);\r\n+        this.graphics.lineWidth = 20;\r\n+        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n+        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n+        this.graphics.fillColor = cc.color(255, 0, 0);\r\n \r\n-    // 初始化state\r\n-    this._state = {\r\n-        title: false,\r\n-        submit: this.submitType.No,\r\n-        touch: \"no\",\r\n-        reset: false,\r\n-        touchesPos: [],\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            touch: \"no\",\r\n+            reset: false,\r\n+            touchesPos: [],\r\n+        }\r\n     }\r\n-}\r\n \r\n-async init(data: any) {\r\n-    // 临时 model component json 配置加载\r\n-    let { pathConfig, model, components } = data;\r\n-    let Package = pathConfig.packageName;\r\n-    let GComponent = model.uiPath;\r\n-    let { boxSoundUrl, guidIndex } = model.config;\r\n-    this._package = Package;\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n \r\n-    this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n \r\n-    if (components) {\r\n-        for (const key in components) {\r\n-            let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-            let componentBundle: any = await loadBundle(componentPath);\r\n-            let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-            this[key] = componentPrefab;\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n         }\r\n     }\r\n-}\r\n \r\n-_onDrawStart(event) {\r\n-    console.log('===== start 111 ====' + event.touch.getLocation());\r\n+    _onDrawStart(event) {\r\n+        console.log('===== start 111 ====' + event.touch.getLocation());\r\n \r\n-    let state: any = globalThis._.cloneDeep(this._state);\r\n-    state.touch = 'start';\r\n-    let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-    state.touchesPos.push(tempPos);\r\n-    this.updateState(state);\r\n-}\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.touch = 'start';\r\n+        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+        state.touchesPos.push(tempPos);\r\n+        this.updateState(state);\r\n+    }\r\n \r\n-_onDrawMove(event) {\r\n+    _onDrawMove(event) {\r\n \r\n-    this._dragging = true;\r\n-    this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-}\r\n+        this._dragging = true;\r\n+        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+    }\r\n \r\n-_onDrawEnd(event) {\r\n+    _onDrawEnd(event) {\r\n \r\n-    this._dragging = false;\r\n+        this._dragging = false;\r\n \r\n-    let state: any = globalThis._.cloneDeep(this._state);\r\n-    state.touch = 'end';\r\n-    this.updateState(state);\r\n-}\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.touch = 'end';\r\n+        this.updateState(state);\r\n+    }\r\n \r\n \r\n-// 排序方法\r\n-comparePosX() {\r\n-    return function (a, b) {\r\n-        var value1 = a.x;\r\n-        var value2 = b.x;\r\n-        return value1 - value2;\r\n+    // 排序方法\r\n+    comparePosX() {\r\n+        return function (a, b) {\r\n+            var value1 = a.x;\r\n+            var value2 = b.x;\r\n+            return value1 - value2;\r\n+        }\r\n     }\r\n-}\r\n \r\n-// 排序方法\r\n-comparePosY() {\r\n-    return function (a, b) {\r\n-        var value1 = a.y;\r\n-        var value2 = b.y;\r\n-        return value1 - value2;\r\n+    // 排序方法\r\n+    comparePosY() {\r\n+        return function (a, b) {\r\n+            var value1 = a.y;\r\n+            var value2 = b.y;\r\n+            return value1 - value2;\r\n+        }\r\n     }\r\n-}\r\n \r\n     private _clickReset(evt: any) {\r\n-    let state: any = globalThis._.cloneDeep(this._state);\r\n-    state.reset = true;\r\n-    this.updateState(state);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.reset = true;\r\n+        this.updateState(state);\r\n \r\n-}\r\n+    }\r\n \r\n     private _clickSubmit(evt: any) {\r\n \r\n-    this._view.off(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-    this._view.off(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-    this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+        this._view.off(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        this._view.off(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n \r\n-    let state: any = globalThis._.cloneDeep(this._state);\r\n-    console.log('====_allPointRect  ====');\r\n-    console.log(this._allPointRect);\r\n-    // 判断提交正确还是错误\r\n-    if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n-        this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n-        this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n-        this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        console.log('====_allPointRect  ====');\r\n+        console.log(this._allPointRect);\r\n+        // 判断提交正确还是错误\r\n+        if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n+            this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n+            this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n+            this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n \r\n-        state.submit = this.submitType.RightFeed;\r\n+            state.submit = this.submitType.RightFeed;\r\n \r\n-    } else {\r\n-        state.submit = this.submitType.WrongFeed;\r\n+        } else {\r\n+            state.submit = this.submitType.WrongFeed;\r\n+        }\r\n+\r\n+        this.updateState(state);\r\n     }\r\n \r\n-    this.updateState(state);\r\n-}\r\n-\r\n     private _clickTitle(evt: any) {\r\n-    let state: any = globalThis._.cloneDeep(this._state);\r\n-    state.title = true;\r\n-    this.updateState(state);\r\n-}\r\n-\r\n-// 临时\r\n-// 拖拽定时器\r\n-dragSchedule() {\r\n-    if (this._dragging) {\r\n-\r\n-        console.log('==== 3333333 拖拽定时器 ======');\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.touchesPos.push(this._moveCurPos);\r\n-        state.touch = \"move\";\r\n+        state.title = true;\r\n         this.updateState(state);\r\n     }\r\n-}\r\n \r\n-// 获取状态\r\n-getState(data: any) {\r\n-    this.updateState(data);\r\n-}\r\n+    // 临时\r\n+    // 拖拽定时器\r\n+    dragSchedule() {\r\n+        if (this._dragging) {\r\n \r\n-// 更新状态层\r\n-updateState(curState: any) {\r\n-    if (globalThis._.isEqual(this._state, curState)) return;\r\n-    this.state = curState;\r\n-}\r\n+            console.log('==== 3333333 拖拽定时器 ======');\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.touchesPos.push(this._moveCurPos);\r\n+            state.touch = \"move\";\r\n+            this.updateState(state);\r\n+        }\r\n+    }\r\n \r\n-// 更新ui层\r\n-updateUi(oldState: any, state: any) {\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n \r\n-    if (state.touch == \"start\") {\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n \r\n-        this._touchesPos = state.touchesPos;\r\n-        this.graphics.clear();\r\n-        this._touchesPos.length = 0;\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n \r\n-    } else if (state.touch == \"move\") {\r\n+        if (state.touch == \"start\") {\r\n \r\n-        this._touchesPos = state.touchesPos;\r\n+            this._touchesPos = state.touchesPos;\r\n+            this.graphics.clear();\r\n+            this._touchesPos.length = 0;\r\n \r\n-        const MIN_POINT_DISTANCE = 4;\r\n+        } else if (state.touch == \"move\") {\r\n \r\n-        let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n-        this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n-        let lastIndex = 0;\r\n-        for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n-            if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n-                continue;\r\n+            this._touchesPos = state.touchesPos;\r\n+\r\n+            const MIN_POINT_DISTANCE = 4;\r\n+\r\n+            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n+            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n+            let lastIndex = 0;\r\n+            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n+                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n+                    continue;\r\n+                }\r\n+                lastIndex = i;\r\n+                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n             }\r\n-            lastIndex = i;\r\n-            this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n-        }\r\n-        this.graphics.stroke();\r\n+            this.graphics.stroke();\r\n \r\n-    } else if (state.touch == \"end\") {\r\n+        } else if (state.touch == \"end\") {\r\n \r\n-        this.graphics.clear();\r\n-        if (this._touchesPos.length > 0) {\r\n+            this.graphics.clear();\r\n+            if (this._touchesPos.length > 0) {\r\n \r\n-            let tempArrX = [];\r\n-            tempArrX = this._touchesPos;\r\n-            tempArrX.sort(this.comparePosX());\r\n+                let tempArrX = [];\r\n+                tempArrX = this._touchesPos;\r\n+                tempArrX.sort(this.comparePosX());\r\n \r\n-            let tempArrY = [];\r\n-            tempArrY = this._touchesPos;\r\n-            tempArrY.sort(this.comparePosY());\r\n+                let tempArrY = [];\r\n+                tempArrY = this._touchesPos;\r\n+                tempArrY.sort(this.comparePosY());\r\n \r\n-            let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n-            let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n+                let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n+                let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n \r\n-            if (chaX < 200) {\r\n+                if (chaX < 200) {\r\n \r\n-                this._touchesPos.sort(this.comparePosY());\r\n+                    this._touchesPos.sort(this.comparePosY());\r\n \r\n-            } else {\r\n-                this._touchesPos.sort(this.comparePosX());\r\n-            }\r\n+                } else {\r\n+                    this._touchesPos.sort(this.comparePosX());\r\n+                }\r\n \r\n-            for (let i = 0; i < this._allPointRect.length; i++) {\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                this._allPointRect[i].isContains = false;\r\n-            }\r\n+                    this._allPointRect[i].isContains = false;\r\n+                }\r\n \r\n-            let pointNums = 0;\r\n-            for (let i = 0; i < this._touchesPos.length; i++) {\r\n+                let pointNums = 0;\r\n+                for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n-                let tempPos = this._touchesPos[i];\r\n-                tempPos.y = this._view.height - tempPos.y;\r\n-                for (let j = 0; j < this._allPointRect.length; j++) {\r\n+                    let tempPos = this._touchesPos[i];\r\n+                    tempPos.y = this._view.height - tempPos.y;\r\n+                    for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n-                    if (this._allPointRect[j].rect.contains(tempPos)) {\r\n-                        this._allPointRect[j].isContains = true;\r\n-                        break;\r\n+                        if (this._allPointRect[j].rect.contains(tempPos)) {\r\n+                            this._allPointRect[j].isContains = true;\r\n+                            break;\r\n+                        }\r\n                     }\r\n                 }\r\n-            }\r\n \r\n-            for (let i = 0; i < this._allPointRect.length; i++) {\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                if (this._allPointRect[i].isContains) {\r\n-                    pointNums++;\r\n+                    if (this._allPointRect[i].isContains) {\r\n+                        pointNums++;\r\n+                    }\r\n                 }\r\n-            }\r\n \r\n-            if (pointNums >= 2) {\r\n+                if (pointNums >= 2) {\r\n \r\n-                for (let i = 0; i < this._allPointRect.length; i++) {\r\n+                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                    if (i === 0 && this._allPointRect[i].isContains) {\r\n+                        if (i === 0 && this._allPointRect[i].isContains) {\r\n \r\n-                        if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n+                            if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n-                            this._allPointRect[i].limitMinx = true;\r\n-                        }\r\n+                                this._allPointRect[i].limitMinx = true;\r\n+                            }\r\n \r\n-                        if (1080 - this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n+                            if (1080 - this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n \r\n-                            this._allPointRect[i].limitMaxy = true;\r\n-                        }\r\n+                                this._allPointRect[i].limitMaxy = true;\r\n+                            }\r\n \r\n-                    } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n+                        } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n \r\n-                        if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n+                            if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n-                            this._allPointRect[i].limitMaxx = true;\r\n-                        }\r\n+                                this._allPointRect[i].limitMaxx = true;\r\n+                            }\r\n \r\n-                    } else if (i === 3 && this._allPointRect[i].isContains) {\r\n+                        } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                        if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n+                            if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n \r\n-                            this._allPointRect[i].limitMiny = true;\r\n+                                this._allPointRect[i].limitMiny = true;\r\n+                            }\r\n                         }\r\n+\r\n                     }\r\n \r\n-                }\r\n+                    if (this._touchesPos.length > 0) {\r\n \r\n-                if (this._touchesPos.length > 0) {\r\n+                        let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n-                    let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n+                        let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                        this._view.addChild(zhiLine);\r\n+                        zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n+                        zhiLine.x = this._touchesPos[0].x;\r\n+                        zhiLine.y = this._touchesPos[0].y;\r\n+                        zhiLine.rotation = angle;\r\n \r\n-                    let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                    this._view.addChild(zhiLine);\r\n-                    zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n-                    zhiLine.x = this._touchesPos[0].x;\r\n-                    zhiLine.y = this._touchesPos[0].y;\r\n-                    zhiLine.rotation = angle;\r\n+                        zhiLine.sortingOrder = 0;\r\n \r\n-                    zhiLine.sortingOrder = 0;\r\n+                        zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n \r\n-                    zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n-\r\n-                    this._selflLines.push(zhiLine);\r\n+                        this._selflLines.push(zhiLine);\r\n+                    }\r\n                 }\r\n-            }\r\n \r\n-            setTimeout(() => {\r\n+                setTimeout(() => {\r\n \r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.touch = 'no';\r\n-                this.updateState(state);\r\n+                    let state: any = globalThis._.cloneDeep(this._state);\r\n+                    state.touch = 'no';\r\n+                    this.updateState(state);\r\n \r\n-            });\r\n+                });\r\n+            }\r\n+\r\n         }\r\n \r\n-    }\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n-    if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n \r\n-        if (state.submit === this.submitType.RightFeed) {\r\n+                this.answerFeedback(true);\r\n \r\n-            this.answerFeedback(true);\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n \r\n-        } else if (state.submit === this.submitType.WrongFeed) {\r\n+                this.answerFeedback(false);\r\n \r\n-            this.answerFeedback(false);\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n \r\n-        } else if (state.submit === this.submitType.GuideShow) {\r\n+                // let keyBtn = this._view.getChild('input1').asButton;\r\n+                // this.handTips2(keyBtn);\r\n+            }\r\n+        }\r\n \r\n-            // let keyBtn = this._view.getChild('input1').asButton;\r\n-            // this.handTips2(keyBtn);\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n         }\r\n     }\r\n \r\n-    if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-        this.playTitle(state.title);\r\n+    angle(start, end) {\r\n+        var diff_x = end.x - start.x,\r\n+            diff_y = end.y - start.y;\r\n+        //返回角度,不是弧度\r\n+        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n     }\r\n-}\r\n \r\n-angle(start, end) {\r\n-    var diff_x = end.x - start.x,\r\n-        diff_y = end.y - start.y;\r\n-    //返回角度,不是弧度\r\n-    return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n-}\r\n \r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n \r\n-async playTitle(bool: boolean) {\r\n-    this._c1.selectedIndex = bool ? 1 : 0;\r\n-    if (bool) {\r\n-        cc.audioEngine.stopAll();\r\n-        this.forbidHandle();\r\n-        let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-        let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-        let audioId = cc.audioEngine.play(audio, false, 1);\r\n-        cc.audioEngine.setFinishCallback(audioId, () => {\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.title = false;\r\n+            state.submit = this.submitType.No;\r\n             this.updateState(state);\r\n-        });\r\n-    } else {\r\n-        this.disableForbidHandle();\r\n+        }, 2000);\r\n     }\r\n-}\r\n \r\n-answerFeedback(bool: boolean) {\r\n-    if (!this.feedback) return;\r\n-    let feedback: any = cc.instantiate(this.feedback);\r\n-    feedback.x = 960;\r\n-    feedback.y = 540;\r\n-    let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-    feedbackJs.init(bool);\r\n-    feedback.parent = cc.find(\"Canvas\").parent;\r\n \r\n-    setTimeout(() => {\r\n-        feedback.destroy();\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.No;\r\n-        this.updateState(state);\r\n-    }, 2000);\r\n-}\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n \r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n \r\n-/**\r\n- * 点击指引\r\n- * @param obj 点击对象\r\n- */\r\n-handTips2(obj: fgui.GObject) {\r\n-    let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-    this._view.addChild(hand);\r\n-    let tempX = obj.x;\r\n-    let tempY = obj.y;\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n \r\n-    hand.x = tempX;\r\n-    hand.y = tempY;\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n \r\n-    cc.tween(hand).to(0.3, {\r\n-        x: tempX - 30,\r\n-        y: tempY - 30\r\n-    }).to(0.3, {\r\n-        x: tempX,\r\n-        y: tempY\r\n-    }).to(0.3, {\r\n-        x: tempX - 30,\r\n-        y: tempY - 30\r\n-    }).to(0.3, {\r\n-        x: tempX,\r\n-        y: tempY\r\n-    }).call(() => {\r\n-        this._view.removeChild(hand);\r\n-        hand = null;\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.No;\r\n-        this.updateState(state)\r\n-    }).start();\r\n-}\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n \r\n-// 运行时 禁止操作\r\n-forbidHandle() {\r\n-    console.log('===  运行时 禁止操作 =====');\r\n-    let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-    if (!handleMask) {\r\n-        let handleMask = new cc.Node('handleMask');\r\n-        handleMask.addComponent(cc.BlockInputEvents);\r\n-        handleMask.parent = this._worldRoot;\r\n-        handleMask.width = 1920;\r\n-        handleMask.height = 1080;\r\n-        handleMask.x = 960;\r\n-        handleMask.y = 540;\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n     }\r\n-}\r\n \r\n-// 消除禁止\r\n-disableForbidHandle() {\r\n-    let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-    if (handleMask) handleMask.destroy();\r\n-}\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n \r\n-// 注册状态，及获取状态的方法\r\n-registerState() {\r\n-    if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-}\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n \r\n-// 解除状态，及获取状态的方法\r\n-relieveState() {\r\n-    if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-}\r\n+    onEnable() {\r\n+        this.registerState();\r\n+        this.schedule(this.dragSchedule, this._scheduleTime);\r\n+    }\r\n \r\n-// 本组件状态合并到全局\r\n-mergeState() {\r\n-    if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    onDisable() {\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n }\r\n-\r\n-onEnable() {\r\n-    this.registerState();\r\n-    this.schedule(this.dragSchedule, this._scheduleTime);\r\n-}\r\n-\r\n-onDisable() {\r\n-    this.relieveState();\r\n-    cc.audioEngine.stopAll();\r\n-}\r\n-}\r\n"
                },
                {
                    "date": 1625213531853,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,9 +42,9 @@\n     private _selflLines = [];\r\n \r\n     private _allPointRect = [];\r\n \r\n-    private _allPointRect\r\n+    private _allPointData = [];\r\n \r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n"
                },
                {
                    "date": 1625213575002,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -384,8 +384,9 @@\n                         }\r\n \r\n                     }\r\n \r\n+                    let temp = {};\r\n                     if (this._touchesPos.length > 0) {\r\n \r\n                         let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625213585297,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -384,9 +384,10 @@\n                         }\r\n \r\n                     }\r\n \r\n-                    let temp = {};\r\n+                    let temp = { isContains };\r\n+\r\n                     if (this._touchesPos.length > 0) {\r\n \r\n                         let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625213590605,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -384,9 +384,8 @@\n                         }\r\n \r\n                     }\r\n \r\n-                    let temp = { isContains };\r\n \r\n                     if (this._touchesPos.length > 0) {\r\n \r\n                         let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n"
                },
                {
                    "date": 1625213637968,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -384,9 +384,9 @@\n                         }\r\n \r\n                     }\r\n \r\n-\r\n+                    let temp = {};\r\n                     if (this._touchesPos.length > 0) {\r\n \r\n                         let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625213680082,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -384,9 +384,11 @@\n                         }\r\n \r\n                     }\r\n \r\n-                    let temp = {};\r\n+                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                    }\r\n                     if (this._touchesPos.length > 0) {\r\n \r\n                         let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625213689491,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -381,14 +381,16 @@\n \r\n                                 this._allPointRect[i].limitMiny = true;\r\n                             }\r\n                         }\r\n-\r\n                     }\r\n \r\n                     for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n+\r\n+\r\n                     }\r\n+\r\n                     if (this._touchesPos.length > 0) {\r\n \r\n                         let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625213690579,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -385,10 +385,10 @@\n                     }\r\n \r\n                     for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n+                        \r\n \r\n-\r\n                     }\r\n \r\n                     if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625213751793,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -385,10 +385,10 @@\n                     }\r\n \r\n                     for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                        \r\n \r\n+\r\n                     }\r\n \r\n                     if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625213818090,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -383,14 +383,11 @@\n                             }\r\n                         }\r\n                     }\r\n \r\n-                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+                    let temp = {};\r\n+                    this._allPointData.push();\r\n \r\n-\r\n-\r\n-                    }\r\n-\r\n                     if (this._touchesPos.length > 0) {\r\n \r\n                         let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625213859961,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -383,9 +383,18 @@\n                             }\r\n                         }\r\n                     }\r\n \r\n-                    let temp = {};\r\n+                    if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n+                        this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n+                        this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n+                        this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n+\r\n+                        state.submit = this.submitType.RightFeed;\r\n+\r\n+                    } else {\r\n+                        state.submit = this.submitType.WrongFeed;\r\n+                    }\r\n                     this._allPointData.push();\r\n \r\n                     if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625213908661,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -383,20 +383,8 @@\n                             }\r\n                         }\r\n                     }\r\n \r\n-                    if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n-                        this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n-                        this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n-                        this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n-\r\n-                        state.submit = this.submitType.RightFeed;\r\n-\r\n-                    } else {\r\n-                        state.submit = this.submitType.WrongFeed;\r\n-                    }\r\n-                    this._allPointData.push();\r\n-\r\n                     if (this._touchesPos.length > 0) {\r\n \r\n                         let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625214369589,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -383,8 +383,19 @@\n                             }\r\n                         }\r\n                     }\r\n \r\n+\r\n+                    if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n+                        this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n+                        this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n+                        this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n+\r\n+                        state.submit = this.submitType.RightFeed;\r\n+\r\n+                    } else {\r\n+                        state.submit = this.submitType.WrongFeed;\r\n+                    }\r\n                     if (this._touchesPos.length > 0) {\r\n \r\n                         let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625214385854,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -384,8 +384,12 @@\n                         }\r\n                     }\r\n \r\n \r\n+                    if () {\r\n+\r\n+                    }\r\n+\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n                         this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n                         this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n                         this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n"
                },
                {
                    "date": 1625214416435,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -384,9 +384,9 @@\n                         }\r\n                     }\r\n \r\n \r\n-                    if () {\r\n+                    if (this._allPointRect[0].isContains &&) {\r\n \r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n"
                },
                {
                    "date": 1625214426587,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -384,9 +384,9 @@\n                         }\r\n                     }\r\n \r\n \r\n-                    if (this._allPointRect[0].isContains &&) {\r\n+                    if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n"
                },
                {
                    "date": 1625214458701,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -384,9 +384,11 @@\n                         }\r\n                     }\r\n \r\n \r\n-                    if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n+                    if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n+                        this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx\r\n+                    ) {\r\n \r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n"
                },
                {
                    "date": 1625214479889,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -385,10 +385,9 @@\n                     }\r\n \r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n-                        this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx\r\n-                    ) {\r\n+                        this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n"
                },
                {
                    "date": 1625214489836,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -387,8 +387,10 @@\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n                         this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n+                    } else if () {\r\n+\r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n                         this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n"
                },
                {
                    "date": 1625214500831,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -387,9 +387,10 @@\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n                         this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n-                    } else if () {\r\n+                    } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n+                        this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n"
                },
                {
                    "date": 1625214517115,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -387,8 +387,10 @@\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n                         this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n+                        this._allPointData.push(true);\r\n+\r\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n                         this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                     }\r\n"
                },
                {
                    "date": 1625214526326,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -391,9 +391,9 @@\n                         this._allPointData.push(true);\r\n \r\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n                         this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n-\r\n+                        this._allPointData.push(true);\r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n                         this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n"
                },
                {
                    "date": 1625214537183,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -392,8 +392,10 @@\n \r\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n                         this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n                         this._allPointData.push(true);\r\n+                    } else if () {\r\n+\r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n                         this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n"
                },
                {
                    "date": 1625214542263,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -392,9 +392,10 @@\n \r\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n                         this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n                         this._allPointData.push(true);\r\n-                    } else if () {\r\n+                    } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n+                        this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n"
                },
                {
                    "date": 1625214549072,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -392,9 +392,9 @@\n \r\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n                         this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n                         this._allPointData.push(true);\r\n-                    } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n+                    } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n                         this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                     }\r\n \r\n"
                },
                {
                    "date": 1625214556050,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -393,9 +393,9 @@\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n                         this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n                         this._allPointData.push(true);\r\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n-                        this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+                        this._allPointRect[0].limitMinx && this._allPointRect[3].limitMiny) {\r\n \r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n"
                },
                {
                    "date": 1625214562075,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -393,9 +393,9 @@\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n                         this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n                         this._allPointData.push(true);\r\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n-                        this._allPointRect[0].limitMinx && this._allPointRect[3].limitMiny) {\r\n+                        this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n \r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n"
                },
                {
                    "date": 1625214571451,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -394,9 +394,9 @@\n                         this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n                         this._allPointData.push(true);\r\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n                         this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n-\r\n+                        this._allPointData.push(true);\r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n                         this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n"
                },
                {
                    "date": 1625214581319,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -395,8 +395,10 @@\n                         this._allPointData.push(true);\r\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n                         this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n                         this._allPointData.push(true);\r\n+                    } else {\r\n+                        this._allPointData.push(true);\r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n                         this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n"
                },
                {
                    "date": 1625214586400,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -396,9 +396,9 @@\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n                         this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n                         this._allPointData.push(true);\r\n                     } else {\r\n-                        this._allPointData.push(true);\r\n+                        this._allPointData.push(false);\r\n                     }\r\n \r\n                     if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n                         this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n"
                },
                {
                    "date": 1625214592391,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -399,18 +399,8 @@\n                     } else {\r\n                         this._allPointData.push(false);\r\n                     }\r\n \r\n-                    if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n-                        this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n-                        this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n-                        this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n-\r\n-                        state.submit = this.submitType.RightFeed;\r\n-\r\n-                    } else {\r\n-                        state.submit = this.submitType.WrongFeed;\r\n-                    }\r\n                     if (this._touchesPos.length > 0) {\r\n \r\n                         let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625214651738,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -222,22 +222,20 @@\n     }\r\n \r\n     private _clickSubmit(evt: any) {\r\n \r\n-        this._view.off(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        this._view.off(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        console.log('====_allPointRect  ====');\r\n-        console.log(this._allPointRect);\r\n+        for (let i = 0; i < this._allPointData.length; i++) {\r\n+\r\n+        }\r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n             this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n             this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n \r\n-            state.submit = this.submitType.RightFeed;\r\n+            _allPointData\r\n \r\n         } else {\r\n             state.submit = this.submitType.WrongFeed;\r\n         }\r\n"
                },
                {
                    "date": 1625214664206,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -224,10 +224,12 @@\n     private _clickSubmit(evt: any) {\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n+        let isAllRight = true;\r\n         for (let i = 0; i < this._allPointData.length; i++) {\r\n \r\n+\r\n         }\r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n"
                },
                {
                    "date": 1625214670149,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -227,9 +227,12 @@\n \r\n         let isAllRight = true;\r\n         for (let i = 0; i < this._allPointData.length; i++) {\r\n \r\n+            if () {\r\n \r\n+            }\r\n+\r\n         }\r\n         // 判断提交正确还是错误\r\n         if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n             this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n"
                },
                {
                    "date": 1625214679784,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -227,9 +227,9 @@\n \r\n         let isAllRight = true;\r\n         for (let i = 0; i < this._allPointData.length; i++) {\r\n \r\n-            if () {\r\n+            if (!this._allPointData[i]) {\r\n \r\n             }\r\n \r\n         }\r\n"
                },
                {
                    "date": 1625214687074,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -228,9 +228,10 @@\n         let isAllRight = true;\r\n         for (let i = 0; i < this._allPointData.length; i++) {\r\n \r\n             if (!this._allPointData[i]) {\r\n-\r\n+                isAllRight = false;\r\n+                break;\r\n             }\r\n \r\n         }\r\n         // 判断提交正确还是错误\r\n"
                },
                {
                    "date": 1625214709156,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -231,20 +231,11 @@\n             if (!this._allPointData[i]) {\r\n                 isAllRight = false;\r\n                 break;\r\n             }\r\n-\r\n         }\r\n-        // 判断提交正确还是错误\r\n-        if (this._allPointRect[0].isContains && this._allPointRect[0].limitMinx && this._allPointRect[0].limitMaxy &&\r\n-            this._allPointRect[1].isContains && this._allPointRect[1].limitMaxx &&\r\n-            this._allPointRect[2].isContains && this._allPointRect[2].limitMaxx &&\r\n-            this._allPointRect[3].isContains && this._allPointRect[2].limitMiny) {\r\n+        if () {\r\n \r\n-            _allPointData\r\n-\r\n-        } else {\r\n-            state.submit = this.submitType.WrongFeed;\r\n         }\r\n \r\n         this.updateState(state);\r\n     }\r\n"
                },
                {
                    "date": 1625214718641,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -232,9 +232,9 @@\n                 isAllRight = false;\r\n                 break;\r\n             }\r\n         }\r\n-        if () {\r\n+        if (this._allPointData.length) {\r\n \r\n         }\r\n \r\n         this.updateState(state);\r\n"
                },
                {
                    "date": 1625214725197,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -232,9 +232,9 @@\n                 isAllRight = false;\r\n                 break;\r\n             }\r\n         }\r\n-        if (this._allPointData.length) {\r\n+        if (this._allPointData.length === 0) {\r\n \r\n         }\r\n \r\n         this.updateState(state);\r\n"
                },
                {
                    "date": 1625214732015,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -234,8 +234,10 @@\n             }\r\n         }\r\n         if (this._allPointData.length === 0) {\r\n \r\n+        } else if () {\r\n+\r\n         }\r\n \r\n         this.updateState(state);\r\n     }\r\n"
                },
                {
                    "date": 1625214741317,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -234,9 +234,9 @@\n             }\r\n         }\r\n         if (this._allPointData.length === 0) {\r\n \r\n-        } else if () {\r\n+        } else if (isAllRight) {\r\n \r\n         }\r\n \r\n         this.updateState(state);\r\n"
                },
                {
                    "date": 1625214761831,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -232,14 +232,10 @@\n                 isAllRight = false;\r\n                 break;\r\n             }\r\n         }\r\n-        if (this._allPointData.length === 0) {\r\n \r\n-        } else if (isAllRight) {\r\n \r\n-        }\r\n-\r\n         this.updateState(state);\r\n     }\r\n \r\n     private _clickTitle(evt: any) {\r\n"
                },
                {
                    "date": 1625214771981,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -224,8 +224,11 @@\n     private _clickSubmit(evt: any) {\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n+        if () {\r\n+\r\n+        }\r\n         let isAllRight = true;\r\n         for (let i = 0; i < this._allPointData.length; i++) {\r\n \r\n             if (!this._allPointData[i]) {\r\n"
                },
                {
                    "date": 1625214778157,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -224,9 +224,9 @@\n     private _clickSubmit(evt: any) {\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n-        if () {\r\n+        if (this._allPointData.length === 0) {\r\n \r\n         }\r\n         let isAllRight = true;\r\n         for (let i = 0; i < this._allPointData.length; i++) {\r\n"
                },
                {
                    "date": 1625214801828,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -225,9 +225,9 @@\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n         if (this._allPointData.length === 0) {\r\n-\r\n+            state.submit\r\n         }\r\n         let isAllRight = true;\r\n         for (let i = 0; i < this._allPointData.length; i++) {\r\n \r\n"
                },
                {
                    "date": 1625214806913,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -225,9 +225,9 @@\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n         if (this._allPointData.length === 0) {\r\n-            state.submit\r\n+            state.submit = false;\r\n         }\r\n         let isAllRight = true;\r\n         for (let i = 0; i < this._allPointData.length; i++) {\r\n \r\n"
                },
                {
                    "date": 1625214814614,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -226,9 +226,10 @@\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n         if (this._allPointData.length === 0) {\r\n             state.submit = false;\r\n-        }\r\n+        } else { }\r\n+\r\n         let isAllRight = true;\r\n         for (let i = 0; i < this._allPointData.length; i++) {\r\n \r\n             if (!this._allPointData[i]) {\r\n"
                },
                {
                    "date": 1625214825619,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -225,9 +225,9 @@\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n         if (this._allPointData.length === 0) {\r\n-            state.submit = false;\r\n+            state.submit = this.submitType.GuideShow;\r\n         } else { }\r\n \r\n         let isAllRight = true;\r\n         for (let i = 0; i < this._allPointData.length; i++) {\r\n"
                },
                {
                    "date": 1625214831684,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -226,10 +226,12 @@\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n         if (this._allPointData.length === 0) {\r\n             state.submit = this.submitType.GuideShow;\r\n-        } else { }\r\n+        } else {\r\n \r\n+        }\r\n+\r\n         let isAllRight = true;\r\n         for (let i = 0; i < this._allPointData.length; i++) {\r\n \r\n             if (!this._allPointData[i]) {\r\n"
                },
                {
                    "date": 1625214841647,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -225,21 +225,23 @@\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n         if (this._allPointData.length === 0) {\r\n+\r\n             state.submit = this.submitType.GuideShow;\r\n+\r\n         } else {\r\n+            let isAllRight = true;\r\n+            for (let i = 0; i < this._allPointData.length; i++) {\r\n \r\n+                if (!this._allPointData[i]) {\r\n+                    isAllRight = false;\r\n+                    break;\r\n+                }\r\n+            }\r\n         }\r\n \r\n-        let isAllRight = true;\r\n-        for (let i = 0; i < this._allPointData.length; i++) {\r\n \r\n-            if (!this._allPointData[i]) {\r\n-                isAllRight = false;\r\n-                break;\r\n-            }\r\n-        }\r\n \r\n \r\n         this.updateState(state);\r\n     }\r\n"
                },
                {
                    "date": 1625214849815,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -237,13 +237,13 @@\n                     isAllRight = false;\r\n                     break;\r\n                 }\r\n             }\r\n+            if () {\r\n+\r\n+            }\r\n         }\r\n \r\n-\r\n-\r\n-\r\n         this.updateState(state);\r\n     }\r\n \r\n     private _clickTitle(evt: any) {\r\n"
                },
                {
                    "date": 1625214855058,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -237,9 +237,9 @@\n                     isAllRight = false;\r\n                     break;\r\n                 }\r\n             }\r\n-            if () {\r\n+            if (isAllRight) {\r\n \r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1625214863019,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -238,9 +238,11 @@\n                     break;\r\n                 }\r\n             }\r\n             if (isAllRight) {\r\n-\r\n+                state.submit = this.submitType.GuideShow;\r\n+            } else {\r\n+                state.submit = this.submitType.GuideShow;\r\n             }\r\n         }\r\n \r\n         this.updateState(state);\r\n"
                },
                {
                    "date": 1625214874265,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -238,11 +238,11 @@\n                     break;\r\n                 }\r\n             }\r\n             if (isAllRight) {\r\n-                state.submit = this.submitType.GuideShow;\r\n+                state.submit = this.submitType.RightFeed;\r\n             } else {\r\n-                state.submit = this.submitType.GuideShow;\r\n+                state.submit = this.submitType.WrongFeed;\r\n             }\r\n         }\r\n \r\n         this.updateState(state);\r\n"
                },
                {
                    "date": 1625214980071,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -402,8 +402,9 @@\n                     } else {\r\n                         this._allPointData.push(false);\r\n                     }\r\n \r\n+                    console.log('===== _allPointData =====');\r\n                     if (this._touchesPos.length > 0) {\r\n \r\n                         let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625214992166,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -403,8 +403,10 @@\n                         this._allPointData.push(false);\r\n                     }\r\n \r\n                     console.log('===== _allPointData =====');\r\n+                    console.log(this._allPointData);\r\n+\r\n                     if (this._touchesPos.length > 0) {\r\n \r\n                         let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625215124966,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -379,8 +379,9 @@\n                             }\r\n \r\n                         } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n+                            console.log('===== ====');\r\n                             if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n \r\n                                 this._allPointRect[i].limitMiny = true;\r\n                             }\r\n"
                },
                {
                    "date": 1625215131745,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -379,9 +379,9 @@\n                             }\r\n \r\n                         } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                            console.log('===== ====');\r\n+                            console.log('===== 3333 ====');\r\n                             if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n \r\n                                 this._allPointRect[i].limitMiny = true;\r\n                             }\r\n"
                },
                {
                    "date": 1625215139808,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -379,9 +379,10 @@\n                             }\r\n \r\n                         } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                            console.log('===== 3333 ====');\r\n+                            console.log('===== 3333 ii ====');\r\n+                            console.log();\r\n                             if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n \r\n                                 this._allPointRect[i].limitMiny = true;\r\n                             }\r\n"
                },
                {
                    "date": 1625215150561,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -380,9 +380,9 @@\n \r\n                         } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n                             console.log('===== 3333 ii ====');\r\n-                            console.log();\r\n+                            console.log(this._touchesPos[this._touchesPos.length - 1].y);\r\n                             if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n \r\n                                 this._allPointRect[i].limitMiny = true;\r\n                             }\r\n"
                },
                {
                    "date": 1625215161068,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -379,10 +379,10 @@\n                             }\r\n \r\n                         } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                            console.log('===== 3333 ii ====');\r\n-                            console.log(this._touchesPos[this._touchesPos.length - 1].y);\r\n+                            console.log('===== 3333 ii ====' + this._touchesPos[this._touchesPos.length - 1].y);\r\n+\r\n                             if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n \r\n                                 this._allPointRect[i].limitMiny = true;\r\n                             }\r\n"
                },
                {
                    "date": 1625215213015,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -379,9 +379,10 @@\n                             }\r\n \r\n                         } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                            console.log('===== 3333 ii ====' + this._touchesPos[this._touchesPos.length - 1].y);\r\n+                            console.log('===== 3333 ii ====');\r\n+                            console.log(this._allPointRect[i]);\r\n \r\n                             if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n \r\n                                 this._allPointRect[i].limitMiny = true;\r\n"
                },
                {
                    "date": 1625215218784,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -380,9 +380,9 @@\n \r\n                         } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n                             console.log('===== 3333 ii ====');\r\n-                            console.log(this._allPointRect[i]);\r\n+                            console.log(this._touchesPos);\r\n \r\n                             if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n \r\n                                 this._allPointRect[i].limitMiny = true;\r\n"
                },
                {
                    "date": 1625215290664,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -382,9 +382,9 @@\n \r\n                             console.log('===== 3333 ii ====');\r\n                             console.log(this._touchesPos);\r\n \r\n-                            if ((1080 - this._touchesPos[this._touchesPos.length - 1].y) < this._allPointRect[i].miny) {\r\n+                            if (this._touchesPos[this._touchesPos.length - 1].y < this._allPointRect[i].miny) {\r\n \r\n                                 this._allPointRect[i].limitMiny = true;\r\n                             }\r\n                         }\r\n"
                },
                {
                    "date": 1625215298784,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -382,9 +382,9 @@\n \r\n                             console.log('===== 3333 ii ====');\r\n                             console.log(this._touchesPos);\r\n \r\n-                            if (this._touchesPos[this._touchesPos.length - 1].y < this._allPointRect[i].miny) {\r\n+                            if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n \r\n                                 this._allPointRect[i].limitMiny = true;\r\n                             }\r\n                         }\r\n"
                },
                {
                    "date": 1625215334665,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -365,9 +365,9 @@\n \r\n                                 this._allPointRect[i].limitMinx = true;\r\n                             }\r\n \r\n-                            if (1080 - this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n+                            if (this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n \r\n                                 this._allPointRect[i].limitMaxy = true;\r\n                             }\r\n \r\n"
                },
                {
                    "date": 1625215372265,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -365,9 +365,9 @@\n \r\n                                 this._allPointRect[i].limitMinx = true;\r\n                             }\r\n \r\n-                            if (this._touchesPos[0].y > this._allPointRect[i].maxy) {\r\n+                            if (this._touchesPos[this._touchesPos.length].y > this._allPointRect[i].maxy) {\r\n \r\n                                 this._allPointRect[i].limitMaxy = true;\r\n                             }\r\n \r\n"
                },
                {
                    "date": 1625215378976,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -365,9 +365,9 @@\n \r\n                                 this._allPointRect[i].limitMinx = true;\r\n                             }\r\n \r\n-                            if (this._touchesPos[this._touchesPos.length].y > this._allPointRect[i].maxy) {\r\n+                            if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n \r\n                                 this._allPointRect[i].limitMaxy = true;\r\n                             }\r\n \r\n"
                },
                {
                    "date": 1625215572177,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -365,9 +365,9 @@\n \r\n                                 this._allPointRect[i].limitMinx = true;\r\n                             }\r\n \r\n-                            if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n+                            if (tempArrY[tempArrY.length - 1].y > this._allPointRect[i].maxy) {\r\n \r\n                                 this._allPointRect[i].limitMaxy = true;\r\n                             }\r\n \r\n@@ -382,9 +382,9 @@\n \r\n                             console.log('===== 3333 ii ====');\r\n                             console.log(this._touchesPos);\r\n \r\n-                            if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n+                            if (tempArrY[0].y < this._allPointRect[i].miny) {\r\n \r\n                                 this._allPointRect[i].limitMiny = true;\r\n                             }\r\n                         }\r\n"
                },
                {
                    "date": 1625215639585,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -365,9 +365,9 @@\n \r\n                                 this._allPointRect[i].limitMinx = true;\r\n                             }\r\n \r\n-                            if (tempArrY[tempArrY.length - 1].y > this._allPointRect[i].maxy) {\r\n+                            if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n \r\n                                 this._allPointRect[i].limitMaxy = true;\r\n                             }\r\n \r\n@@ -382,9 +382,9 @@\n \r\n                             console.log('===== 3333 ii ====');\r\n                             console.log(this._touchesPos);\r\n \r\n-                            if (tempArrY[0].y < this._allPointRect[i].miny) {\r\n+                            if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n \r\n                                 this._allPointRect[i].limitMiny = true;\r\n                             }\r\n                         }\r\n"
                },
                {
                    "date": 1625215691900,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -318,9 +318,9 @@\n                 tempArrY = this._touchesPos;\r\n                 tempArrY.sort(this.comparePosY());\r\n \r\n                 let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n-                let chaY = tempArrY[tempArrY.length - 1].x - tempArrY[0].x;\r\n+                let chaY = tempArrY[tempArrY.length - 1].y - tempArrY[0].y;\r\n \r\n                 if (chaX < 200) {\r\n \r\n                     this._touchesPos.sort(this.comparePosY());\r\n"
                },
                {
                    "date": 1625215711350,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -317,9 +317,9 @@\n                 let tempArrY = [];\r\n                 tempArrY = this._touchesPos;\r\n                 tempArrY.sort(this.comparePosY());\r\n \r\n-                let chaX = tempArrX[tempArrX.length - 1].x - tempArrX[0].x;\r\n+                let chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n                 let chaY = tempArrY[tempArrY.length - 1].y - tempArrY[0].y;\r\n \r\n                 if (chaX < 200) {\r\n \r\n"
                },
                {
                    "date": 1625215725651,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -318,9 +318,9 @@\n                 tempArrY = this._touchesPos;\r\n                 tempArrY.sort(this.comparePosY());\r\n \r\n                 let chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n-                let chaY = tempArrY[tempArrY.length - 1].y - tempArrY[0].y;\r\n+                let chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n \r\n                 if (chaX < 200) {\r\n \r\n                     this._touchesPos.sort(this.comparePosY());\r\n"
                },
                {
                    "date": 1625215793830,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -322,8 +322,9 @@\n                 let chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n \r\n                 if (chaX < 200) {\r\n \r\n+                    console.log('==== ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n \r\n                 } else {\r\n                     this._touchesPos.sort(this.comparePosX());\r\n"
                },
                {
                    "date": 1625215802275,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -322,9 +322,9 @@\n                 let chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n \r\n                 if (chaX < 200) {\r\n \r\n-                    console.log('==== ====');\r\n+                    console.log('==== chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n \r\n                 } else {\r\n                     this._touchesPos.sort(this.comparePosX());\r\n"
                },
                {
                    "date": 1625215809929,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -326,8 +326,9 @@\n                     console.log('==== chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n \r\n                 } else {\r\n+                    console.log('==== chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n                 }\r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n"
                },
                {
                    "date": 1625215816005,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -322,13 +322,13 @@\n                 let chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n \r\n                 if (chaX < 200) {\r\n \r\n-                    console.log('==== chaY ====');\r\n+                    console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n \r\n                 } else {\r\n-                    console.log('==== chaX ====');\r\n+                    console.log('==== sort chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n                 }\r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n"
                },
                {
                    "date": 1625215877654,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -324,8 +324,9 @@\n                 if (chaX < 200) {\r\n \r\n                     console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n+                    console.log('==== sort chaY ====');\r\n \r\n                 } else {\r\n                     console.log('==== sort chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n"
                },
                {
                    "date": 1625215884468,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -324,9 +324,9 @@\n                 if (chaX < 200) {\r\n \r\n                     console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n-                    console.log('==== sort chaY ====');\r\n+                    console.log(this._touchesPos);\r\n \r\n                 } else {\r\n                     console.log('==== sort chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n"
                },
                {
                    "date": 1625216017584,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -209,9 +209,9 @@\n     comparePosY() {\r\n         return function (a, b) {\r\n             var value1 = a.y;\r\n             var value2 = b.y;\r\n-            return value1 - value2;\r\n+            return value2 - value1;\r\n         }\r\n     }\r\n \r\n     private _clickReset(evt: any) {\r\n"
                },
                {
                    "date": 1625216462482,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -329,8 +329,10 @@\n \r\n                 } else {\r\n                     console.log('==== sort chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n+                    console.log(this._touchesPos);\r\n+\r\n                 }\r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n"
                },
                {
                    "date": 1625216619833,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -209,9 +209,9 @@\n     comparePosY() {\r\n         return function (a, b) {\r\n             var value1 = a.y;\r\n             var value2 = b.y;\r\n-            return value2 - value1;\r\n+            return value1 - value2;\r\n         }\r\n     }\r\n \r\n     private _clickReset(evt: any) {\r\n"
                },
                {
                    "date": 1625216672263,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -309,8 +309,21 @@\n \r\n             this.graphics.clear();\r\n             if (this._touchesPos.length > 0) {\r\n \r\n+                for (let i = 0; i < this._touchesPos.length; i++) {\r\n+\r\n+                    let tempPos = this._touchesPos[i];\r\n+                    tempPos.y = this._view.height - tempPos.y;\r\n+                    for (let j = 0; j < this._allPointRect.length; j++) {\r\n+\r\n+                        if (this._allPointRect[j].rect.contains(tempPos)) {\r\n+                            this._allPointRect[j].isContains = true;\r\n+                            break;\r\n+                        }\r\n+                    }\r\n+                }\r\n+\r\n                 let tempArrX = [];\r\n                 tempArrX = this._touchesPos;\r\n                 tempArrX.sort(this.comparePosX());\r\n \r\n"
                },
                {
                    "date": 1625216686737,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -312,9 +312,9 @@\n \r\n                 for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                     let tempPos = this._touchesPos[i];\r\n-                    tempPos.y = this._view.height - tempPos.y;\r\n+                    this._touchesPos[i].y = this._view.height - tempPos.y;\r\n                     for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n                         if (this._allPointRect[j].rect.contains(tempPos)) {\r\n                             this._allPointRect[j].isContains = true;\r\n"
                },
                {
                    "date": 1625216692652,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -311,10 +311,10 @@\n             if (this._touchesPos.length > 0) {\r\n \r\n                 for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n-                    let tempPos = this._touchesPos[i];\r\n-                    this._touchesPos[i].y = this._view.height - tempPos.y;\r\n+\r\n+                    this._touchesPos[i].y = this._view.height - this._touchesPos[i].y;\r\n                     for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n                         if (this._allPointRect[j].rect.contains(tempPos)) {\r\n                             this._allPointRect[j].isContains = true;\r\n"
                },
                {
                    "date": 1625216698432,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -313,15 +313,8 @@\n                 for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n \r\n                     this._touchesPos[i].y = this._view.height - this._touchesPos[i].y;\r\n-                    for (let j = 0; j < this._allPointRect.length; j++) {\r\n-\r\n-                        if (this._allPointRect[j].rect.contains(tempPos)) {\r\n-                            this._allPointRect[j].isContains = true;\r\n-                            break;\r\n-                        }\r\n-                    }\r\n                 }\r\n \r\n                 let tempArrX = [];\r\n                 tempArrX = this._touchesPos;\r\n"
                },
                {
                    "date": 1625216703544,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -311,9 +311,8 @@\n             if (this._touchesPos.length > 0) {\r\n \r\n                 for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n-\r\n                     this._touchesPos[i].y = this._view.height - this._touchesPos[i].y;\r\n                 }\r\n \r\n                 let tempArrX = [];\r\n"
                },
                {
                    "date": 1625216732684,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -335,9 +335,8 @@\n                 } else {\r\n                     console.log('==== sort chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n                     console.log(this._touchesPos);\r\n-\r\n                 }\r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n@@ -346,10 +345,8 @@\n \r\n                 let pointNums = 0;\r\n                 for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n-                    let tempPos = this._touchesPos[i];\r\n-                    tempPos.y = this._view.height - tempPos.y;\r\n                     for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n                         if (this._allPointRect[j].rect.contains(tempPos)) {\r\n                             this._allPointRect[j].isContains = true;\r\n"
                },
                {
                    "date": 1625216738228,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -347,9 +347,9 @@\n                 for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                     for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n-                        if (this._allPointRect[j].rect.contains(tempPos)) {\r\n+                        if (this._allPointRect[j].rect.contains(this._touchesPos)) {\r\n                             this._allPointRect[j].isContains = true;\r\n                             break;\r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625216825829,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -347,9 +347,9 @@\n                 for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n                     for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n-                        if (this._allPointRect[j].rect.contains(this._touchesPos)) {\r\n+                        if (this._allPointRect[j].rect.contains(this._touchesPos[i])) {\r\n                             this._allPointRect[j].isContains = true;\r\n                             break;\r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625217703629,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -412,11 +412,8 @@\n                     } else {\r\n                         this._allPointData.push(false);\r\n                     }\r\n \r\n-                    console.log('===== _allPointData =====');\r\n-                    console.log(this._allPointData);\r\n-\r\n                     if (this._touchesPos.length > 0) {\r\n \r\n                         let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625217714485,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -423,8 +423,9 @@\n                         zhiLine.x = this._touchesPos[0].x;\r\n                         zhiLine.y = this._touchesPos[0].y;\r\n                         zhiLine.rotation = angle;\r\n \r\n+                        console.log('==== ====' + );\r\n                         zhiLine.sortingOrder = 0;\r\n \r\n                         zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n \r\n"
                },
                {
                    "date": 1625217720142,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -423,9 +423,9 @@\n                         zhiLine.x = this._touchesPos[0].x;\r\n                         zhiLine.y = this._touchesPos[0].y;\r\n                         zhiLine.rotation = angle;\r\n \r\n-                        console.log('==== ====' + );\r\n+                        console.log('==== angle ====' + angle);\r\n                         zhiLine.sortingOrder = 0;\r\n \r\n                         zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n \r\n"
                },
                {
                    "date": 1625217730084,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -423,8 +423,9 @@\n                         zhiLine.x = this._touchesPos[0].x;\r\n                         zhiLine.y = this._touchesPos[0].y;\r\n                         zhiLine.rotation = angle;\r\n \r\n+                        console.log();\r\n                         console.log('==== angle ====' + angle);\r\n                         zhiLine.sortingOrder = 0;\r\n \r\n                         zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n"
                },
                {
                    "date": 1625217736012,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -423,9 +423,9 @@\n                         zhiLine.x = this._touchesPos[0].x;\r\n                         zhiLine.y = this._touchesPos[0].y;\r\n                         zhiLine.rotation = angle;\r\n \r\n-                        console.log();\r\n+                        console.log(this._touchesPos);\r\n                         console.log('==== angle ====' + angle);\r\n                         zhiLine.sortingOrder = 0;\r\n \r\n                         zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n"
                },
                {
                    "date": 1625217892611,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -424,9 +424,9 @@\n                         zhiLine.y = this._touchesPos[0].y;\r\n                         zhiLine.rotation = angle;\r\n \r\n                         console.log(this._touchesPos);\r\n-                        console.log('==== angle ====' + angle);\r\n+                        console.log('==== angle ====  ' + angle);\r\n                         zhiLine.sortingOrder = 0;\r\n \r\n                         zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n \r\n"
                },
                {
                    "date": 1625217984363,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -325,9 +325,9 @@\n \r\n                 let chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n                 let chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n \r\n-                if (chaX < 200) {\r\n+                if (chaX < 350) {\r\n \r\n                     console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n                     console.log(this._touchesPos);\r\n"
                },
                {
                    "date": 1625217989705,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -325,9 +325,9 @@\n \r\n                 let chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n                 let chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n \r\n-                if (chaX < 350) {\r\n+                if (chaX < 300) {\r\n \r\n                     console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n                     console.log(this._touchesPos);\r\n"
                },
                {
                    "date": 1625218663001,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -173,8 +173,12 @@\n     _onDrawStart(event) {\r\n         console.log('===== start 111 ====' + event.touch.getLocation());\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n+\r\n+        if () {\r\n+\r\n+        }\r\n         state.touch = 'start';\r\n         let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n         state.touchesPos.push(tempPos);\r\n         this.updateState(state);\r\n"
                },
                {
                    "date": 1625218678692,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -174,9 +174,9 @@\n         console.log('===== start 111 ====' + event.touch.getLocation());\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n-        if () {\r\n+        if (state.touch === 'no') {\r\n \r\n         }\r\n         state.touch = 'start';\r\n         let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n"
                },
                {
                    "date": 1625218685039,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -175,14 +175,14 @@\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n         if (state.touch === 'no') {\r\n+            state.touch = 'start';\r\n+            let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+            state.touchesPos.push(tempPos);\r\n+            this.updateState(state);\r\n+        }\r\n \r\n-        }\r\n-        state.touch = 'start';\r\n-        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-        state.touchesPos.push(tempPos);\r\n-        this.updateState(state);\r\n     }\r\n \r\n     _onDrawMove(event) {\r\n \r\n"
                },
                {
                    "date": 1625218690781,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -173,16 +173,14 @@\n     _onDrawStart(event) {\r\n         console.log('===== start 111 ====' + event.touch.getLocation());\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n-\r\n         if (state.touch === 'no') {\r\n             state.touch = 'start';\r\n             let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n             state.touchesPos.push(tempPos);\r\n             this.updateState(state);\r\n         }\r\n-\r\n     }\r\n \r\n     _onDrawMove(event) {\r\n \r\n"
                },
                {
                    "date": 1625218881187,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -421,14 +421,18 @@\n \r\n                         let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                         this._view.addChild(zhiLine);\r\n                         zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n-                        zhiLine.x = this._touchesPos[0].x;\r\n-                        zhiLine.y = this._touchesPos[0].y;\r\n+                        if (chaX) {\r\n+                            zhiLine.x = this._touchesPos[0].x;\r\n+                            zhiLine.y = this._touchesPos[0].y;\r\n+                        }\r\n+\r\n                         zhiLine.rotation = angle;\r\n \r\n                         console.log(this._touchesPos);\r\n                         console.log('==== angle ====  ' + angle);\r\n+\r\n                         zhiLine.sortingOrder = 0;\r\n \r\n                         zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n \r\n"
                },
                {
                    "date": 1625218901916,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -424,8 +424,11 @@\n                         zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n                         if (chaX) {\r\n                             zhiLine.x = this._touchesPos[0].x;\r\n                             zhiLine.y = this._touchesPos[0].y;\r\n+                        } else {\r\n+                            zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n+                            zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n                         }\r\n \r\n                         zhiLine.rotation = angle;\r\n \r\n"
                },
                {
                    "date": 1625219063599,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -424,15 +424,16 @@\n                         zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n                         if (chaX) {\r\n                             zhiLine.x = this._touchesPos[0].x;\r\n                             zhiLine.y = this._touchesPos[0].y;\r\n+                            zhiLine.rotation = angle;\r\n                         } else {\r\n                             zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n                             zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n                         }\r\n \r\n-                        zhiLine.rotation = angle;\r\n \r\n+\r\n                         console.log(this._touchesPos);\r\n                         console.log('==== angle ====  ' + angle);\r\n \r\n                         zhiLine.sortingOrder = 0;\r\n"
                },
                {
                    "date": 1625219070805,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -428,8 +428,9 @@\n                             zhiLine.rotation = angle;\r\n                         } else {\r\n                             zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n                             zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n+                            zhiLine.rotation = angle;\r\n                         }\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1625219111046,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -428,9 +428,9 @@\n                             zhiLine.rotation = angle;\r\n                         } else {\r\n                             zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n                             zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n-                            zhiLine.rotation = angle;\r\n+                            zhiLine.rotation = Math.abs(angle);\r\n                         }\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1625219117796,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -431,10 +431,8 @@\n                             zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n                             zhiLine.rotation = Math.abs(angle);\r\n                         }\r\n \r\n-\r\n-\r\n                         console.log(this._touchesPos);\r\n                         console.log('==== angle ====  ' + angle);\r\n \r\n                         zhiLine.sortingOrder = 0;\r\n"
                },
                {
                    "date": 1625219206166,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -431,10 +431,10 @@\n                             zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n                             zhiLine.rotation = Math.abs(angle);\r\n                         }\r\n \r\n-                        console.log(this._touchesPos);\r\n                         console.log('==== angle ====  ' + angle);\r\n+                        console.log('==== angle ====  ' + angle);\r\n \r\n                         zhiLine.sortingOrder = 0;\r\n \r\n                         zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n"
                },
                {
                    "date": 1625219213122,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -432,9 +432,9 @@\n                             zhiLine.rotation = Math.abs(angle);\r\n                         }\r\n \r\n                         console.log('==== angle ====  ' + angle);\r\n-                        console.log('==== angle ====  ' + angle);\r\n+                        console.log('==== rotation ====  ' + zhiLine.rotation);\r\n \r\n                         zhiLine.sortingOrder = 0;\r\n \r\n                         zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n"
                },
                {
                    "date": 1625219259861,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -324,10 +324,10 @@\n                 let tempArrY = [];\r\n                 tempArrY = this._touchesPos;\r\n                 tempArrY.sort(this.comparePosY());\r\n \r\n-                let chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n-                let chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n+                var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n+                var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n \r\n                 if (chaX < 300) {\r\n \r\n                     console.log('==== sort chaY ====');\r\n"
                },
                {
                    "date": 1625219331867,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -326,8 +326,9 @@\n                 tempArrY.sort(this.comparePosY());\r\n \r\n                 var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n                 var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n+                let isSortY = false;\r\n \r\n                 if (chaX < 300) {\r\n \r\n                     console.log('==== sort chaY ====');\r\n"
                },
                {
                    "date": 1625219338697,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -329,9 +329,9 @@\n                 var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n                 let isSortY = false;\r\n \r\n                 if (chaX < 300) {\r\n-\r\n+                    isSortY = true;\r\n                     console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n                     console.log(this._touchesPos);\r\n \r\n"
                },
                {
                    "date": 1625219351792,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -422,9 +422,9 @@\n \r\n                         let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                         this._view.addChild(zhiLine);\r\n                         zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n-                        if (chaX) {\r\n+                        if (isSortY) {\r\n                             zhiLine.x = this._touchesPos[0].x;\r\n                             zhiLine.y = this._touchesPos[0].y;\r\n                             zhiLine.rotation = angle;\r\n                         } else {\r\n"
                },
                {
                    "date": 1625219357039,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -422,9 +422,9 @@\n \r\n                         let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                         this._view.addChild(zhiLine);\r\n                         zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n-                        if (isSortY) {\r\n+                        if (!isSortY) {\r\n                             zhiLine.x = this._touchesPos[0].x;\r\n                             zhiLine.y = this._touchesPos[0].y;\r\n                             zhiLine.rotation = angle;\r\n                         } else {\r\n"
                },
                {
                    "date": 1625219418523,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -429,9 +429,9 @@\n                             zhiLine.rotation = angle;\r\n                         } else {\r\n                             zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n                             zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n-                            zhiLine.rotation = Math.abs(angle);\r\n+                            zhiLine.rotation = angle;\r\n                         }\r\n \r\n                         console.log('==== angle ====  ' + angle);\r\n                         console.log('==== rotation ====  ' + zhiLine.rotation);\r\n"
                },
                {
                    "date": 1625219509126,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -429,9 +429,9 @@\n                             zhiLine.rotation = angle;\r\n                         } else {\r\n                             zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n                             zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n-                            zhiLine.rotation = angle;\r\n+                            zhiLine.rotation = -Math.abs(angle);\r\n                         }\r\n \r\n                         console.log('==== angle ====  ' + angle);\r\n                         console.log('==== rotation ====  ' + zhiLine.rotation);\r\n"
                },
                {
                    "date": 1625219632951,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -429,9 +429,9 @@\n                             zhiLine.rotation = angle;\r\n                         } else {\r\n                             zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n                             zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n-                            zhiLine.rotation = -Math.abs(angle);\r\n+                            zhiLine.rotation = angle;\r\n                         }\r\n \r\n                         console.log('==== angle ====  ' + angle);\r\n                         console.log('==== rotation ====  ' + zhiLine.rotation);\r\n"
                },
                {
                    "date": 1625219704541,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -429,9 +429,9 @@\n                             zhiLine.rotation = angle;\r\n                         } else {\r\n                             zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n                             zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n-                            zhiLine.rotation = angle;\r\n+                            zhiLine.rotation = -Math.abs(angle);\r\n                         }\r\n \r\n                         console.log('==== angle ====  ' + angle);\r\n                         console.log('==== rotation ====  ' + zhiLine.rotation);\r\n"
                },
                {
                    "date": 1625219798732,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -328,9 +328,9 @@\n                 var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n                 var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n                 let isSortY = false;\r\n \r\n-                if (chaX < 300) {\r\n+                if (chaX < 250 && chaY > 500) {\r\n                     isSortY = true;\r\n                     console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n                     console.log(this._touchesPos);\r\n"
                },
                {
                    "date": 1625219811537,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -334,9 +334,9 @@\n                     console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n                     console.log(this._touchesPos);\r\n \r\n-                } else {\r\n+                } else if (chaX < 250 && chaY > 500) {\r\n                     console.log('==== sort chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n                     console.log(this._touchesPos);\r\n                 }\r\n"
                },
                {
                    "date": 1625219817154,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -334,9 +334,9 @@\n                     console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n                     console.log(this._touchesPos);\r\n \r\n-                } else if (chaX < 250 && chaY > 500) {\r\n+                } else if (chaX > 500 && chaY > 500) {\r\n                     console.log('==== sort chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n                     console.log(this._touchesPos);\r\n                 }\r\n"
                },
                {
                    "date": 1625219851270,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -328,15 +328,15 @@\n                 var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n                 var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n                 let isSortY = false;\r\n \r\n-                if (chaX < 250 && chaY > 500) {\r\n+                if (chaX < 200 && chaY > 500) {\r\n                     isSortY = true;\r\n                     console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n                     console.log(this._touchesPos);\r\n \r\n-                } else if (chaX > 500 && chaY > 500) {\r\n+                } else if (chaX > 500 && chaY < 200) {\r\n                     console.log('==== sort chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n                     console.log(this._touchesPos);\r\n                 }\r\n"
                },
                {
                    "date": 1625219857035,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -338,8 +338,10 @@\n                 } else if (chaX > 500 && chaY < 200) {\r\n                     console.log('==== sort chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n                     console.log(this._touchesPos);\r\n+                } else {\r\n+\r\n                 }\r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n"
                },
                {
                    "date": 1625219893532,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -328,8 +328,9 @@\n                 var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n                 var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n                 let isSortY = false;\r\n \r\n+                let isVelid\r\n                 if (chaX < 200 && chaY > 500) {\r\n                     isSortY = true;\r\n                     console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n"
                },
                {
                    "date": 1625219904852,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -328,9 +328,9 @@\n                 var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n                 var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n                 let isSortY = false;\r\n \r\n-                let isVelid\r\n+                let isValid = true;\r\n                 if (chaX < 200 && chaY > 500) {\r\n                     isSortY = true;\r\n                     console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n"
                },
                {
                    "date": 1625219911784,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -340,9 +340,9 @@\n                     console.log('==== sort chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n                     console.log(this._touchesPos);\r\n                 } else {\r\n-\r\n+                    isValid = true;\r\n                 }\r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n"
                },
                {
                    "date": 1625219917153,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -340,9 +340,9 @@\n                     console.log('==== sort chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n                     console.log(this._touchesPos);\r\n                 } else {\r\n-                    isValid = true;\r\n+                    isValid = false;\r\n                 }\r\n \r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n"
                },
                {
                    "date": 1625219922341,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -343,8 +343,11 @@\n                 } else {\r\n                     isValid = false;\r\n                 }\r\n \r\n+                if () {\r\n+\r\n+                }\r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                     this._allPointRect[i].isContains = false;\r\n                 }\r\n"
                },
                {
                    "date": 1625219935555,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -343,112 +343,112 @@\n                 } else {\r\n                     isValid = false;\r\n                 }\r\n \r\n-                if () {\r\n+                if (isValid) {\r\n+                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                }\r\n-                for (let i = 0; i < this._allPointRect.length; i++) {\r\n+                        this._allPointRect[i].isContains = false;\r\n+                    }\r\n \r\n-                    this._allPointRect[i].isContains = false;\r\n-                }\r\n+                    let pointNums = 0;\r\n+                    for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n-                let pointNums = 0;\r\n-                for (let i = 0; i < this._touchesPos.length; i++) {\r\n+                        for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n-                    for (let j = 0; j < this._allPointRect.length; j++) {\r\n-\r\n-                        if (this._allPointRect[j].rect.contains(this._touchesPos[i])) {\r\n-                            this._allPointRect[j].isContains = true;\r\n-                            break;\r\n+                            if (this._allPointRect[j].rect.contains(this._touchesPos[i])) {\r\n+                                this._allPointRect[j].isContains = true;\r\n+                                break;\r\n+                            }\r\n                         }\r\n                     }\r\n-                }\r\n \r\n-                for (let i = 0; i < this._allPointRect.length; i++) {\r\n+                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                    if (this._allPointRect[i].isContains) {\r\n-                        pointNums++;\r\n+                        if (this._allPointRect[i].isContains) {\r\n+                            pointNums++;\r\n+                        }\r\n                     }\r\n-                }\r\n \r\n-                if (pointNums >= 2) {\r\n+                    if (pointNums >= 2) {\r\n \r\n-                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+                        for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                        if (i === 0 && this._allPointRect[i].isContains) {\r\n+                            if (i === 0 && this._allPointRect[i].isContains) {\r\n \r\n-                            if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n+                                if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n-                                this._allPointRect[i].limitMinx = true;\r\n-                            }\r\n+                                    this._allPointRect[i].limitMinx = true;\r\n+                                }\r\n \r\n-                            if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n+                                if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n \r\n-                                this._allPointRect[i].limitMaxy = true;\r\n-                            }\r\n+                                    this._allPointRect[i].limitMaxy = true;\r\n+                                }\r\n \r\n-                        } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n+                            } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n \r\n-                            if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n+                                if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n-                                this._allPointRect[i].limitMaxx = true;\r\n-                            }\r\n+                                    this._allPointRect[i].limitMaxx = true;\r\n+                                }\r\n \r\n-                        } else if (i === 3 && this._allPointRect[i].isContains) {\r\n+                            } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                            console.log('===== 3333 ii ====');\r\n-                            console.log(this._touchesPos);\r\n+                                console.log('===== 3333 ii ====');\r\n+                                console.log(this._touchesPos);\r\n \r\n-                            if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n+                                if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n \r\n-                                this._allPointRect[i].limitMiny = true;\r\n+                                    this._allPointRect[i].limitMiny = true;\r\n+                                }\r\n                             }\r\n                         }\r\n-                    }\r\n \r\n \r\n-                    if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n-                        this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+                        if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n+                            this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n-                        this._allPointData.push(true);\r\n+                            this._allPointData.push(true);\r\n \r\n-                    } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n-                        this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n-                        this._allPointData.push(true);\r\n-                    } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n-                        this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n-                        this._allPointData.push(true);\r\n-                    } else {\r\n-                        this._allPointData.push(false);\r\n-                    }\r\n+                        } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n+                            this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+                            this._allPointData.push(true);\r\n+                        } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n+                            this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+                            this._allPointData.push(true);\r\n+                        } else {\r\n+                            this._allPointData.push(false);\r\n+                        }\r\n \r\n-                    if (this._touchesPos.length > 0) {\r\n+                        if (this._touchesPos.length > 0) {\r\n \r\n-                        let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n+                            let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n-                        let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                        this._view.addChild(zhiLine);\r\n-                        zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n-                        if (!isSortY) {\r\n-                            zhiLine.x = this._touchesPos[0].x;\r\n-                            zhiLine.y = this._touchesPos[0].y;\r\n-                            zhiLine.rotation = angle;\r\n-                        } else {\r\n-                            zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n-                            zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n-                            zhiLine.rotation = -Math.abs(angle);\r\n-                        }\r\n+                            let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                            this._view.addChild(zhiLine);\r\n+                            zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n+                            if (!isSortY) {\r\n+                                zhiLine.x = this._touchesPos[0].x;\r\n+                                zhiLine.y = this._touchesPos[0].y;\r\n+                                zhiLine.rotation = angle;\r\n+                            } else {\r\n+                                zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n+                                zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n+                                zhiLine.rotation = -Math.abs(angle);\r\n+                            }\r\n \r\n-                        console.log('==== angle ====  ' + angle);\r\n-                        console.log('==== rotation ====  ' + zhiLine.rotation);\r\n+                            console.log('==== angle ====  ' + angle);\r\n+                            console.log('==== rotation ====  ' + zhiLine.rotation);\r\n \r\n-                        zhiLine.sortingOrder = 0;\r\n+                            zhiLine.sortingOrder = 0;\r\n \r\n-                        zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n+                            zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n \r\n-                        this._selflLines.push(zhiLine);\r\n+                            this._selflLines.push(zhiLine);\r\n+                        }\r\n                     }\r\n+\r\n                 }\r\n \r\n                 setTimeout(() => {\r\n \r\n"
                },
                {
                    "date": 1625220083430,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -335,9 +335,9 @@\n                     console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n                     console.log(this._touchesPos);\r\n \r\n-                } else if (chaX > 500 && chaY < 200) {\r\n+                } else if (chaX > 500) {\r\n                     console.log('==== sort chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n                     console.log(this._touchesPos);\r\n                 } else {\r\n"
                },
                {
                    "date": 1625220222756,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -393,19 +393,15 @@\n                                 }\r\n \r\n                             } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                                console.log('===== 3333 ii ====');\r\n-                                console.log(this._touchesPos);\r\n-\r\n                                 if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n \r\n                                     this._allPointRect[i].limitMiny = true;\r\n                                 }\r\n                             }\r\n                         }\r\n \r\n-\r\n                         if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n                             this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n                             this._allPointData.push(true);\r\n"
                },
                {
                    "date": 1625220242662,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -451,9 +451,9 @@\n                     let state: any = globalThis._.cloneDeep(this._state);\r\n                     state.touch = 'no';\r\n                     this.updateState(state);\r\n \r\n-                });\r\n+                }, 1000);\r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1625220247802,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -451,9 +451,9 @@\n                     let state: any = globalThis._.cloneDeep(this._state);\r\n                     state.touch = 'no';\r\n                     this.updateState(state);\r\n \r\n-                }, 1000);\r\n+                }, 500);\r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1625220620177,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,605 @@\n+import chooseAnswer_model0403_v2 from '../../numberPatterns/chooseAnswer-model0403-v2';\r\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v3 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _resetBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _touchesPos: any = [];\r\n+\r\n+    private _moveCurPos: cc.Vec2;\r\n+\r\n+    private graphics: cc.Graphics = null;\r\n+\r\n+    private _dragging = false;\r\n+\r\n+    private _scheduleTime = 0.03;\r\n+\r\n+    private _selflLines = [];\r\n+\r\n+    private _allPointRect = [];\r\n+\r\n+    private _allPointData = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    private lineType: any = cc.Enum({\r\n+\r\n+        StraightLine: 0,\r\n+        LineSegment: 1\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._allPointRect = [{\r\n+            'rect': new cc.Rect(610, 614, 80, 80),\r\n+            'isContains': false,\r\n+            'minx': 610,\r\n+            'maxx': 690,\r\n+            'miny': 614,\r\n+            'maxy': 694,\r\n+            'limitMinx': false,\r\n+            'limitMaxy': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n+            'limitMaxx': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n+            'limitMaxx': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n+            'limitMiny': false,\r\n+        }\r\n+        ];\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n+        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n+\r\n+        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+\r\n+        let huiNode = new cc.Node('huiNode');\r\n+        huiNode.parent = this._worldRoot;\r\n+\r\n+        this.graphics = huiNode.addComponent(cc.Graphics);\r\n+        this.graphics.lineWidth = 20;\r\n+        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n+        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n+        this.graphics.fillColor = cc.color(255, 0, 0);\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            touch: \"no\",\r\n+            reset: false,\r\n+            touchesPos: [],\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    _onDrawStart(event) {\r\n+        console.log('===== start 111 ====' + event.touch.getLocation());\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        if (state.touch === 'no') {\r\n+            state.touch = 'start';\r\n+            let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+            state.touchesPos.push(tempPos);\r\n+            this.updateState(state);\r\n+        }\r\n+    }\r\n+\r\n+    _onDrawMove(event) {\r\n+\r\n+        this._dragging = true;\r\n+        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+    }\r\n+\r\n+    _onDrawEnd(event) {\r\n+\r\n+        this._dragging = false;\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.touch = 'end';\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 排序方法\r\n+    comparePosX() {\r\n+        return function (a, b) {\r\n+            var value1 = a.x;\r\n+            var value2 = b.x;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n+    // 排序方法\r\n+    comparePosY() {\r\n+        return function (a, b) {\r\n+            var value1 = a.y;\r\n+            var value2 = b.y;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n+    private _clickReset(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.reset = true;\r\n+        this.updateState(state);\r\n+\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+\r\n+        if (this._allPointData.length === 0) {\r\n+\r\n+            state.submit = this.submitType.GuideShow;\r\n+\r\n+        } else {\r\n+            let isAllRight = true;\r\n+            for (let i = 0; i < this._allPointData.length; i++) {\r\n+\r\n+                if (!this._allPointData[i]) {\r\n+                    isAllRight = false;\r\n+                    break;\r\n+                }\r\n+            }\r\n+            if (isAllRight) {\r\n+                state.submit = this.submitType.RightFeed;\r\n+            } else {\r\n+                state.submit = this.submitType.WrongFeed;\r\n+            }\r\n+        }\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    // 临时\r\n+    // 拖拽定时器\r\n+    dragSchedule() {\r\n+        if (this._dragging) {\r\n+\r\n+            console.log('==== 3333333 拖拽定时器 ======');\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.touchesPos.push(this._moveCurPos);\r\n+            state.touch = \"move\";\r\n+            this.updateState(state);\r\n+        }\r\n+    }\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (state.touch == \"start\") {\r\n+\r\n+            this._touchesPos = state.touchesPos;\r\n+            this.graphics.clear();\r\n+            this._touchesPos.length = 0;\r\n+\r\n+        } else if (state.touch == \"move\") {\r\n+\r\n+            this._touchesPos = state.touchesPos;\r\n+\r\n+            const MIN_POINT_DISTANCE = 4;\r\n+\r\n+            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n+            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n+            let lastIndex = 0;\r\n+            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n+                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n+                    continue;\r\n+                }\r\n+                lastIndex = i;\r\n+                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n+            }\r\n+            this.graphics.stroke();\r\n+\r\n+        } else if (state.touch == \"end\") {\r\n+\r\n+            this.graphics.clear();\r\n+            if (this._touchesPos.length > 0) {\r\n+\r\n+                for (let i = 0; i < this._touchesPos.length; i++) {\r\n+\r\n+                    this._touchesPos[i].y = this._view.height - this._touchesPos[i].y;\r\n+                }\r\n+\r\n+                let tempArrX = [];\r\n+                tempArrX = this._touchesPos;\r\n+                tempArrX.sort(this.comparePosX());\r\n+\r\n+                let tempArrY = [];\r\n+                tempArrY = this._touchesPos;\r\n+                tempArrY.sort(this.comparePosY());\r\n+\r\n+                var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n+                var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n+                let isSortY = false;\r\n+\r\n+                let isValid = true;\r\n+                if (chaX < 200 && chaY > 500) {\r\n+                    isSortY = true;\r\n+                    console.log('==== sort chaY ====');\r\n+                    this._touchesPos.sort(this.comparePosY());\r\n+                    console.log(this._touchesPos);\r\n+\r\n+                } else if (chaX > 500) {\r\n+                    console.log('==== sort chaX ====');\r\n+                    this._touchesPos.sort(this.comparePosX());\r\n+                    console.log(this._touchesPos);\r\n+                } else {\r\n+                    isValid = false;\r\n+                }\r\n+\r\n+                if (isValid) {\r\n+                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                        this._allPointRect[i].isContains = false;\r\n+                    }\r\n+\r\n+                    let pointNums = 0;\r\n+                    for (let i = 0; i < this._touchesPos.length; i++) {\r\n+\r\n+                        for (let j = 0; j < this._allPointRect.length; j++) {\r\n+\r\n+                            if (this._allPointRect[j].rect.contains(this._touchesPos[i])) {\r\n+                                this._allPointRect[j].isContains = true;\r\n+                                break;\r\n+                            }\r\n+                        }\r\n+                    }\r\n+\r\n+                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                        if (this._allPointRect[i].isContains) {\r\n+                            pointNums++;\r\n+                        }\r\n+                    }\r\n+\r\n+                    if (pointNums >= 2) {\r\n+\r\n+                        for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                            if (i === 0 && this._allPointRect[i].isContains) {\r\n+\r\n+                                if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n+\r\n+                                    this._allPointRect[i].limitMinx = true;\r\n+                                }\r\n+\r\n+                                if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n+\r\n+                                    this._allPointRect[i].limitMaxy = true;\r\n+                                }\r\n+\r\n+                            } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n+\r\n+                                if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n+\r\n+                                    this._allPointRect[i].limitMaxx = true;\r\n+                                }\r\n+\r\n+                            } else if (i === 3 && this._allPointRect[i].isContains) {\r\n+\r\n+                                if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n+\r\n+                                    this._allPointRect[i].limitMiny = true;\r\n+                                }\r\n+                            }\r\n+                        }\r\n+\r\n+                        if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n+                            this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+\r\n+                            this._allPointData.push(true);\r\n+\r\n+                        } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n+                            this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+                            this._allPointData.push(true);\r\n+                        } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n+                            this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+                            this._allPointData.push(true);\r\n+                        } else {\r\n+                            this._allPointData.push(false);\r\n+                        }\r\n+\r\n+                        if (this._touchesPos.length > 0) {\r\n+\r\n+                            let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n+\r\n+                            let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                            this._view.addChild(zhiLine);\r\n+                            zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n+                            if (!isSortY) {\r\n+                                zhiLine.x = this._touchesPos[0].x;\r\n+                                zhiLine.y = this._touchesPos[0].y;\r\n+                                zhiLine.rotation = angle;\r\n+                            } else {\r\n+                                zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n+                                zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n+                                zhiLine.rotation = -Math.abs(angle);\r\n+                            }\r\n+\r\n+                            console.log('==== angle ====  ' + angle);\r\n+                            console.log('==== rotation ====  ' + zhiLine.rotation);\r\n+\r\n+                            zhiLine.sortingOrder = 0;\r\n+\r\n+                            zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n+\r\n+                            this._selflLines.push(zhiLine);\r\n+                        }\r\n+                    }\r\n+\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state: any = globalThis._.cloneDeep(this._state);\r\n+                    state.touch = 'no';\r\n+                    this.updateState(state);\r\n+\r\n+                }, 500);\r\n+            }\r\n+\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+                // let keyBtn = this._view.getChild('input1').asButton;\r\n+                // this.handTips2(keyBtn);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+    angle(start, end) {\r\n+        var diff_x = end.x - start.x,\r\n+            diff_y = end.y - start.y;\r\n+        //返回角度,不是弧度\r\n+        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+        this.schedule(this.dragSchedule, this._scheduleTime);\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1625220679218,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -435,10 +435,8 @@\n \r\n                             console.log('==== angle ====  ' + angle);\r\n                             console.log('==== rotation ====  ' + zhiLine.rotation);\r\n \r\n-                            zhiLine.sortingOrder = 0;\r\n-\r\n                             zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n \r\n                             this._selflLines.push(zhiLine);\r\n                         }\r\n@@ -602,609 +600,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-import chooseAnswer_model0403_v2 from '../../numberPatterns/chooseAnswer-model0403-v2';\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v3 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _resetBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _touchesPos: any = [];\r\n-\r\n-    private _moveCurPos: cc.Vec2;\r\n-\r\n-    private graphics: cc.Graphics = null;\r\n-\r\n-    private _dragging = false;\r\n-\r\n-    private _scheduleTime = 0.03;\r\n-\r\n-    private _selflLines = [];\r\n-\r\n-    private _allPointRect = [];\r\n-\r\n-    private _allPointData = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    private lineType: any = cc.Enum({\r\n-\r\n-        StraightLine: 0,\r\n-        LineSegment: 1\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._allPointRect = [{\r\n-            'rect': new cc.Rect(610, 614, 80, 80),\r\n-            'isContains': false,\r\n-            'minx': 610,\r\n-            'maxx': 690,\r\n-            'miny': 614,\r\n-            'maxy': 694,\r\n-            'limitMinx': false,\r\n-            'limitMaxy': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n-            'limitMaxx': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n-            'limitMaxx': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n-            'limitMiny': false,\r\n-        }\r\n-        ];\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n-        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n-\r\n-        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n-\r\n-        let huiNode = new cc.Node('huiNode');\r\n-        huiNode.parent = this._worldRoot;\r\n-\r\n-        this.graphics = huiNode.addComponent(cc.Graphics);\r\n-        this.graphics.lineWidth = 20;\r\n-        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n-        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n-        this.graphics.fillColor = cc.color(255, 0, 0);\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            touch: \"no\",\r\n-            reset: false,\r\n-            touchesPos: [],\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    _onDrawStart(event) {\r\n-        console.log('===== start 111 ====' + event.touch.getLocation());\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        if (state.touch === 'no') {\r\n-            state.touch = 'start';\r\n-            let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-            state.touchesPos.push(tempPos);\r\n-            this.updateState(state);\r\n-        }\r\n-    }\r\n-\r\n-    _onDrawMove(event) {\r\n-\r\n-        this._dragging = true;\r\n-        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-    }\r\n-\r\n-    _onDrawEnd(event) {\r\n-\r\n-        this._dragging = false;\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.touch = 'end';\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 排序方法\r\n-    comparePosX() {\r\n-        return function (a, b) {\r\n-            var value1 = a.x;\r\n-            var value2 = b.x;\r\n-            return value1 - value2;\r\n-        }\r\n-    }\r\n-\r\n-    // 排序方法\r\n-    comparePosY() {\r\n-        return function (a, b) {\r\n-            var value1 = a.y;\r\n-            var value2 = b.y;\r\n-            return value1 - value2;\r\n-        }\r\n-    }\r\n-\r\n-    private _clickReset(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.reset = true;\r\n-        this.updateState(state);\r\n-\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-\r\n-        if (this._allPointData.length === 0) {\r\n-\r\n-            state.submit = this.submitType.GuideShow;\r\n-\r\n-        } else {\r\n-            let isAllRight = true;\r\n-            for (let i = 0; i < this._allPointData.length; i++) {\r\n-\r\n-                if (!this._allPointData[i]) {\r\n-                    isAllRight = false;\r\n-                    break;\r\n-                }\r\n-            }\r\n-            if (isAllRight) {\r\n-                state.submit = this.submitType.RightFeed;\r\n-            } else {\r\n-                state.submit = this.submitType.WrongFeed;\r\n-            }\r\n-        }\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    // 临时\r\n-    // 拖拽定时器\r\n-    dragSchedule() {\r\n-        if (this._dragging) {\r\n-\r\n-            console.log('==== 3333333 拖拽定时器 ======');\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.touchesPos.push(this._moveCurPos);\r\n-            state.touch = \"move\";\r\n-            this.updateState(state);\r\n-        }\r\n-    }\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (state.touch == \"start\") {\r\n-\r\n-            this._touchesPos = state.touchesPos;\r\n-            this.graphics.clear();\r\n-            this._touchesPos.length = 0;\r\n-\r\n-        } else if (state.touch == \"move\") {\r\n-\r\n-            this._touchesPos = state.touchesPos;\r\n-\r\n-            const MIN_POINT_DISTANCE = 4;\r\n-\r\n-            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n-            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n-            let lastIndex = 0;\r\n-            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n-                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n-                    continue;\r\n-                }\r\n-                lastIndex = i;\r\n-                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n-            }\r\n-            this.graphics.stroke();\r\n-\r\n-        } else if (state.touch == \"end\") {\r\n-\r\n-            this.graphics.clear();\r\n-            if (this._touchesPos.length > 0) {\r\n-\r\n-                for (let i = 0; i < this._touchesPos.length; i++) {\r\n-\r\n-                    this._touchesPos[i].y = this._view.height - this._touchesPos[i].y;\r\n-                }\r\n-\r\n-                let tempArrX = [];\r\n-                tempArrX = this._touchesPos;\r\n-                tempArrX.sort(this.comparePosX());\r\n-\r\n-                let tempArrY = [];\r\n-                tempArrY = this._touchesPos;\r\n-                tempArrY.sort(this.comparePosY());\r\n-\r\n-                var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n-                var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n-                let isSortY = false;\r\n-\r\n-                let isValid = true;\r\n-                if (chaX < 200 && chaY > 500) {\r\n-                    isSortY = true;\r\n-                    console.log('==== sort chaY ====');\r\n-                    this._touchesPos.sort(this.comparePosY());\r\n-                    console.log(this._touchesPos);\r\n-\r\n-                } else if (chaX > 500) {\r\n-                    console.log('==== sort chaX ====');\r\n-                    this._touchesPos.sort(this.comparePosX());\r\n-                    console.log(this._touchesPos);\r\n-                } else {\r\n-                    isValid = false;\r\n-                }\r\n-\r\n-                if (isValid) {\r\n-                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                        this._allPointRect[i].isContains = false;\r\n-                    }\r\n-\r\n-                    let pointNums = 0;\r\n-                    for (let i = 0; i < this._touchesPos.length; i++) {\r\n-\r\n-                        for (let j = 0; j < this._allPointRect.length; j++) {\r\n-\r\n-                            if (this._allPointRect[j].rect.contains(this._touchesPos[i])) {\r\n-                                this._allPointRect[j].isContains = true;\r\n-                                break;\r\n-                            }\r\n-                        }\r\n-                    }\r\n-\r\n-                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                        if (this._allPointRect[i].isContains) {\r\n-                            pointNums++;\r\n-                        }\r\n-                    }\r\n-\r\n-                    if (pointNums >= 2) {\r\n-\r\n-                        for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                            if (i === 0 && this._allPointRect[i].isContains) {\r\n-\r\n-                                if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n-\r\n-                                    this._allPointRect[i].limitMinx = true;\r\n-                                }\r\n-\r\n-                                if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n-\r\n-                                    this._allPointRect[i].limitMaxy = true;\r\n-                                }\r\n-\r\n-                            } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n-\r\n-                                if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n-\r\n-                                    this._allPointRect[i].limitMaxx = true;\r\n-                                }\r\n-\r\n-                            } else if (i === 3 && this._allPointRect[i].isContains) {\r\n-\r\n-                                if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n-\r\n-                                    this._allPointRect[i].limitMiny = true;\r\n-                                }\r\n-                            }\r\n-                        }\r\n-\r\n-                        if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n-                            this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n-\r\n-                            this._allPointData.push(true);\r\n-\r\n-                        } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n-                            this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n-                            this._allPointData.push(true);\r\n-                        } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n-                            this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n-                            this._allPointData.push(true);\r\n-                        } else {\r\n-                            this._allPointData.push(false);\r\n-                        }\r\n-\r\n-                        if (this._touchesPos.length > 0) {\r\n-\r\n-                            let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n-\r\n-                            let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                            this._view.addChild(zhiLine);\r\n-                            zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n-                            if (!isSortY) {\r\n-                                zhiLine.x = this._touchesPos[0].x;\r\n-                                zhiLine.y = this._touchesPos[0].y;\r\n-                                zhiLine.rotation = angle;\r\n-                            } else {\r\n-                                zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n-                                zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n-                                zhiLine.rotation = -Math.abs(angle);\r\n-                            }\r\n-\r\n-                            console.log('==== angle ====  ' + angle);\r\n-                            console.log('==== rotation ====  ' + zhiLine.rotation);\r\n-\r\n-                            zhiLine.sortingOrder = 0;\r\n-\r\n-                            zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n-\r\n-                            this._selflLines.push(zhiLine);\r\n-                        }\r\n-                    }\r\n-\r\n-                }\r\n-\r\n-                setTimeout(() => {\r\n-\r\n-                    let state: any = globalThis._.cloneDeep(this._state);\r\n-                    state.touch = 'no';\r\n-                    this.updateState(state);\r\n-\r\n-                }, 500);\r\n-            }\r\n-\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-                // let keyBtn = this._view.getChild('input1').asButton;\r\n-                // this.handTips2(keyBtn);\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-    angle(start, end) {\r\n-        var diff_x = end.x - start.x,\r\n-            diff_y = end.y - start.y;\r\n-        //返回角度,不是弧度\r\n-        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-        this.schedule(this.dragSchedule, this._scheduleTime);\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1625221002362,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -309,8 +309,9 @@\n \r\n         } else if (state.touch == \"end\") {\r\n \r\n             this.graphics.clear();\r\n+\r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n"
                },
                {
                    "date": 1625221199390,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -146,8 +146,9 @@\n             submit: this.submitType.No,\r\n             touch: \"no\",\r\n             reset: false,\r\n             touchesPos: [],\r\n+            _allPointData\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n"
                },
                {
                    "date": 1625221214505,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -146,9 +146,9 @@\n             submit: this.submitType.No,\r\n             touch: \"no\",\r\n             reset: false,\r\n             touchesPos: [],\r\n-            _allPointData\r\n+            _allLinesData: []\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n"
                },
                {
                    "date": 1625221220503,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -146,9 +146,9 @@\n             submit: this.submitType.No,\r\n             touch: \"no\",\r\n             reset: false,\r\n             touchesPos: [],\r\n-            _allLinesData: []\r\n+            allLinesData: []\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n"
                },
                {
                    "date": 1625221228916,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -146,9 +146,9 @@\n             submit: this.submitType.No,\r\n             touch: \"no\",\r\n             reset: false,\r\n             touchesPos: [],\r\n-            allLinesData: []\r\n+            allLinesAnwer: []\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n"
                },
                {
                    "date": 1625221260407,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -227,9 +227,9 @@\n     private _clickSubmit(evt: any) {\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n-        if (this._allPointData.length === 0) {\r\n+        if (state.allLinesAnwer.length === 0) {\r\n \r\n             state.submit = this.submitType.GuideShow;\r\n \r\n         } else {\r\n"
                },
                {
                    "date": 1625221267338,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -233,9 +233,9 @@\n             state.submit = this.submitType.GuideShow;\r\n \r\n         } else {\r\n             let isAllRight = true;\r\n-            for (let i = 0; i < this._allPointData.length; i++) {\r\n+            for (let i = 0; i < state.allLinesAnwer.length; i++) {\r\n \r\n                 if (!this._allPointData[i]) {\r\n                     isAllRight = false;\r\n                     break;\r\n"
                },
                {
                    "date": 1625221285501,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -235,9 +235,9 @@\n         } else {\r\n             let isAllRight = true;\r\n             for (let i = 0; i < state.allLinesAnwer.length; i++) {\r\n \r\n-                if (!this._allPointData[i]) {\r\n+                if (!state.allLinesAnwer[i]) {\r\n                     isAllRight = false;\r\n                     break;\r\n                 }\r\n             }\r\n@@ -405,9 +405,9 @@\n \r\n                         if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n                             this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n-                            this._allPointData.push(true);\r\n+                            state.allLinesAnwer.push(true);\r\n \r\n                         } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n                             this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n                             this._allPointData.push(true);\r\n"
                },
                {
                    "date": 1625221297352,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -409,14 +409,14 @@\n                             state.allLinesAnwer.push(true);\r\n \r\n                         } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n                             this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n-                            this._allPointData.push(true);\r\n+                            state.allLinesAnwer.push(true);\r\n                         } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n                             this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n-                            this._allPointData.push(true);\r\n+                            state.allLinesAnwer.push(true);\r\n                         } else {\r\n-                            this._allPointData.push(false);\r\n+                            state.allLinesAnwer.push(false);\r\n                         }\r\n \r\n                         if (this._touchesPos.length > 0) {\r\n \r\n"
                },
                {
                    "date": 1625221311329,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -449,8 +449,9 @@\n                 setTimeout(() => {\r\n \r\n                     let state: any = globalThis._.cloneDeep(this._state);\r\n                     state.touch = 'no';\r\n+                    state.allLinesAnwer\r\n                     this.updateState(state);\r\n \r\n                 }, 500);\r\n             }\r\n"
                },
                {
                    "date": 1625221316578,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -449,10 +449,10 @@\n                 setTimeout(() => {\r\n \r\n                     let state: any = globalThis._.cloneDeep(this._state);\r\n                     state.touch = 'no';\r\n-                    state.allLinesAnwer\r\n-                    this.updateState(state);\r\n+                    state.allLinesAnwer =\r\n+                        this.updateState(state);\r\n \r\n                 }, 500);\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625221325749,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,606 @@\n+import chooseAnswer_model0403_v2 from '../../numberPatterns/chooseAnswer-model0403-v2';\r\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v3 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _resetBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _touchesPos: any = [];\r\n+\r\n+    private _moveCurPos: cc.Vec2;\r\n+\r\n+    private graphics: cc.Graphics = null;\r\n+\r\n+    private _dragging = false;\r\n+\r\n+    private _scheduleTime = 0.03;\r\n+\r\n+    private _selflLines = [];\r\n+\r\n+    private _allPointRect = [];\r\n+\r\n+    private _allPointData = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    private lineType: any = cc.Enum({\r\n+\r\n+        StraightLine: 0,\r\n+        LineSegment: 1\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._allPointRect = [{\r\n+            'rect': new cc.Rect(610, 614, 80, 80),\r\n+            'isContains': false,\r\n+            'minx': 610,\r\n+            'maxx': 690,\r\n+            'miny': 614,\r\n+            'maxy': 694,\r\n+            'limitMinx': false,\r\n+            'limitMaxy': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n+            'limitMaxx': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n+            'limitMaxx': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n+            'limitMiny': false,\r\n+        }\r\n+        ];\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n+        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n+\r\n+        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+\r\n+        let huiNode = new cc.Node('huiNode');\r\n+        huiNode.parent = this._worldRoot;\r\n+\r\n+        this.graphics = huiNode.addComponent(cc.Graphics);\r\n+        this.graphics.lineWidth = 20;\r\n+        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n+        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n+        this.graphics.fillColor = cc.color(255, 0, 0);\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            touch: \"no\",\r\n+            reset: false,\r\n+            touchesPos: [],\r\n+            allLinesAnwer: []\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    _onDrawStart(event) {\r\n+        console.log('===== start 111 ====' + event.touch.getLocation());\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        if (state.touch === 'no') {\r\n+            state.touch = 'start';\r\n+            let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+            state.touchesPos.push(tempPos);\r\n+            this.updateState(state);\r\n+        }\r\n+    }\r\n+\r\n+    _onDrawMove(event) {\r\n+\r\n+        this._dragging = true;\r\n+        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+    }\r\n+\r\n+    _onDrawEnd(event) {\r\n+\r\n+        this._dragging = false;\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.touch = 'end';\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 排序方法\r\n+    comparePosX() {\r\n+        return function (a, b) {\r\n+            var value1 = a.x;\r\n+            var value2 = b.x;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n+    // 排序方法\r\n+    comparePosY() {\r\n+        return function (a, b) {\r\n+            var value1 = a.y;\r\n+            var value2 = b.y;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n+    private _clickReset(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.reset = true;\r\n+        this.updateState(state);\r\n+\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+\r\n+        if (state.allLinesAnwer.length === 0) {\r\n+\r\n+            state.submit = this.submitType.GuideShow;\r\n+\r\n+        } else {\r\n+            let isAllRight = true;\r\n+            for (let i = 0; i < state.allLinesAnwer.length; i++) {\r\n+\r\n+                if (!state.allLinesAnwer[i]) {\r\n+                    isAllRight = false;\r\n+                    break;\r\n+                }\r\n+            }\r\n+            if (isAllRight) {\r\n+                state.submit = this.submitType.RightFeed;\r\n+            } else {\r\n+                state.submit = this.submitType.WrongFeed;\r\n+            }\r\n+        }\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    // 临时\r\n+    // 拖拽定时器\r\n+    dragSchedule() {\r\n+        if (this._dragging) {\r\n+\r\n+            console.log('==== 3333333 拖拽定时器 ======');\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.touchesPos.push(this._moveCurPos);\r\n+            state.touch = \"move\";\r\n+            this.updateState(state);\r\n+        }\r\n+    }\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (state.touch == \"start\") {\r\n+\r\n+            this._touchesPos = state.touchesPos;\r\n+            this.graphics.clear();\r\n+            this._touchesPos.length = 0;\r\n+\r\n+        } else if (state.touch == \"move\") {\r\n+\r\n+            this._touchesPos = state.touchesPos;\r\n+\r\n+            const MIN_POINT_DISTANCE = 4;\r\n+\r\n+            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n+            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n+            let lastIndex = 0;\r\n+            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n+                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n+                    continue;\r\n+                }\r\n+                lastIndex = i;\r\n+                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n+            }\r\n+            this.graphics.stroke();\r\n+\r\n+        } else if (state.touch == \"end\") {\r\n+\r\n+            this.graphics.clear();\r\n+\r\n+            if (this._touchesPos.length > 0) {\r\n+\r\n+                for (let i = 0; i < this._touchesPos.length; i++) {\r\n+\r\n+                    this._touchesPos[i].y = this._view.height - this._touchesPos[i].y;\r\n+                }\r\n+\r\n+                let tempArrX = [];\r\n+                tempArrX = this._touchesPos;\r\n+                tempArrX.sort(this.comparePosX());\r\n+\r\n+                let tempArrY = [];\r\n+                tempArrY = this._touchesPos;\r\n+                tempArrY.sort(this.comparePosY());\r\n+\r\n+                var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n+                var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n+                let isSortY = false;\r\n+\r\n+                let isValid = true;\r\n+                if (chaX < 200 && chaY > 500) {\r\n+                    isSortY = true;\r\n+                    console.log('==== sort chaY ====');\r\n+                    this._touchesPos.sort(this.comparePosY());\r\n+                    console.log(this._touchesPos);\r\n+\r\n+                } else if (chaX > 500) {\r\n+                    console.log('==== sort chaX ====');\r\n+                    this._touchesPos.sort(this.comparePosX());\r\n+                    console.log(this._touchesPos);\r\n+                } else {\r\n+                    isValid = false;\r\n+                }\r\n+\r\n+                if (isValid) {\r\n+                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                        this._allPointRect[i].isContains = false;\r\n+                    }\r\n+\r\n+                    let pointNums = 0;\r\n+                    for (let i = 0; i < this._touchesPos.length; i++) {\r\n+\r\n+                        for (let j = 0; j < this._allPointRect.length; j++) {\r\n+\r\n+                            if (this._allPointRect[j].rect.contains(this._touchesPos[i])) {\r\n+                                this._allPointRect[j].isContains = true;\r\n+                                break;\r\n+                            }\r\n+                        }\r\n+                    }\r\n+\r\n+                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                        if (this._allPointRect[i].isContains) {\r\n+                            pointNums++;\r\n+                        }\r\n+                    }\r\n+\r\n+                    if (pointNums >= 2) {\r\n+\r\n+                        for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                            if (i === 0 && this._allPointRect[i].isContains) {\r\n+\r\n+                                if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n+\r\n+                                    this._allPointRect[i].limitMinx = true;\r\n+                                }\r\n+\r\n+                                if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n+\r\n+                                    this._allPointRect[i].limitMaxy = true;\r\n+                                }\r\n+\r\n+                            } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n+\r\n+                                if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n+\r\n+                                    this._allPointRect[i].limitMaxx = true;\r\n+                                }\r\n+\r\n+                            } else if (i === 3 && this._allPointRect[i].isContains) {\r\n+\r\n+                                if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n+\r\n+                                    this._allPointRect[i].limitMiny = true;\r\n+                                }\r\n+                            }\r\n+                        }\r\n+\r\n+                        if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n+                            this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+\r\n+                            state.allLinesAnwer.push(true);\r\n+\r\n+                        } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n+                            this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+                            state.allLinesAnwer.push(true);\r\n+                        } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n+                            this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+                            state.allLinesAnwer.push(true);\r\n+                        } else {\r\n+                            state.allLinesAnwer.push(false);\r\n+                        }\r\n+\r\n+                        if (this._touchesPos.length > 0) {\r\n+\r\n+                            let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n+\r\n+                            let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                            this._view.addChild(zhiLine);\r\n+                            zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n+                            if (!isSortY) {\r\n+                                zhiLine.x = this._touchesPos[0].x;\r\n+                                zhiLine.y = this._touchesPos[0].y;\r\n+                                zhiLine.rotation = angle;\r\n+                            } else {\r\n+                                zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n+                                zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n+                                zhiLine.rotation = -Math.abs(angle);\r\n+                            }\r\n+\r\n+                            console.log('==== angle ====  ' + angle);\r\n+                            console.log('==== rotation ====  ' + zhiLine.rotation);\r\n+\r\n+                            zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n+\r\n+                            this._selflLines.push(zhiLine);\r\n+                        }\r\n+                    }\r\n+\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state1: any = globalThis._.cloneDeep(this._state);\r\n+                    state1.touch = 'no';\r\n+                    state1.allLinesAnwer =\r\n+                        this.updateState(state);\r\n+\r\n+                }, 500);\r\n+            }\r\n+\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+                // let keyBtn = this._view.getChild('input1').asButton;\r\n+                // this.handTips2(keyBtn);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+    angle(start, end) {\r\n+        var diff_x = end.x - start.x,\r\n+            diff_y = end.y - start.y;\r\n+        //返回角度,不是弧度\r\n+        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+        this.schedule(this.dragSchedule, this._scheduleTime);\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1625221325889,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -603,610 +603,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-import chooseAnswer_model0403_v2 from '../../numberPatterns/chooseAnswer-model0403-v2';\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v3 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _resetBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _touchesPos: any = [];\r\n-\r\n-    private _moveCurPos: cc.Vec2;\r\n-\r\n-    private graphics: cc.Graphics = null;\r\n-\r\n-    private _dragging = false;\r\n-\r\n-    private _scheduleTime = 0.03;\r\n-\r\n-    private _selflLines = [];\r\n-\r\n-    private _allPointRect = [];\r\n-\r\n-    private _allPointData = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    private lineType: any = cc.Enum({\r\n-\r\n-        StraightLine: 0,\r\n-        LineSegment: 1\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._allPointRect = [{\r\n-            'rect': new cc.Rect(610, 614, 80, 80),\r\n-            'isContains': false,\r\n-            'minx': 610,\r\n-            'maxx': 690,\r\n-            'miny': 614,\r\n-            'maxy': 694,\r\n-            'limitMinx': false,\r\n-            'limitMaxy': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n-            'limitMaxx': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n-            'limitMaxx': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(610, 240, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n-            'limitMiny': false,\r\n-        }\r\n-        ];\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n-        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n-\r\n-        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n-\r\n-        let huiNode = new cc.Node('huiNode');\r\n-        huiNode.parent = this._worldRoot;\r\n-\r\n-        this.graphics = huiNode.addComponent(cc.Graphics);\r\n-        this.graphics.lineWidth = 20;\r\n-        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n-        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n-        this.graphics.fillColor = cc.color(255, 0, 0);\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            touch: \"no\",\r\n-            reset: false,\r\n-            touchesPos: [],\r\n-            allLinesAnwer: []\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    _onDrawStart(event) {\r\n-        console.log('===== start 111 ====' + event.touch.getLocation());\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        if (state.touch === 'no') {\r\n-            state.touch = 'start';\r\n-            let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-            state.touchesPos.push(tempPos);\r\n-            this.updateState(state);\r\n-        }\r\n-    }\r\n-\r\n-    _onDrawMove(event) {\r\n-\r\n-        this._dragging = true;\r\n-        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-    }\r\n-\r\n-    _onDrawEnd(event) {\r\n-\r\n-        this._dragging = false;\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.touch = 'end';\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 排序方法\r\n-    comparePosX() {\r\n-        return function (a, b) {\r\n-            var value1 = a.x;\r\n-            var value2 = b.x;\r\n-            return value1 - value2;\r\n-        }\r\n-    }\r\n-\r\n-    // 排序方法\r\n-    comparePosY() {\r\n-        return function (a, b) {\r\n-            var value1 = a.y;\r\n-            var value2 = b.y;\r\n-            return value1 - value2;\r\n-        }\r\n-    }\r\n-\r\n-    private _clickReset(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.reset = true;\r\n-        this.updateState(state);\r\n-\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-\r\n-        if (state.allLinesAnwer.length === 0) {\r\n-\r\n-            state.submit = this.submitType.GuideShow;\r\n-\r\n-        } else {\r\n-            let isAllRight = true;\r\n-            for (let i = 0; i < state.allLinesAnwer.length; i++) {\r\n-\r\n-                if (!state.allLinesAnwer[i]) {\r\n-                    isAllRight = false;\r\n-                    break;\r\n-                }\r\n-            }\r\n-            if (isAllRight) {\r\n-                state.submit = this.submitType.RightFeed;\r\n-            } else {\r\n-                state.submit = this.submitType.WrongFeed;\r\n-            }\r\n-        }\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    // 临时\r\n-    // 拖拽定时器\r\n-    dragSchedule() {\r\n-        if (this._dragging) {\r\n-\r\n-            console.log('==== 3333333 拖拽定时器 ======');\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.touchesPos.push(this._moveCurPos);\r\n-            state.touch = \"move\";\r\n-            this.updateState(state);\r\n-        }\r\n-    }\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (state.touch == \"start\") {\r\n-\r\n-            this._touchesPos = state.touchesPos;\r\n-            this.graphics.clear();\r\n-            this._touchesPos.length = 0;\r\n-\r\n-        } else if (state.touch == \"move\") {\r\n-\r\n-            this._touchesPos = state.touchesPos;\r\n-\r\n-            const MIN_POINT_DISTANCE = 4;\r\n-\r\n-            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n-            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n-            let lastIndex = 0;\r\n-            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n-                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n-                    continue;\r\n-                }\r\n-                lastIndex = i;\r\n-                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n-            }\r\n-            this.graphics.stroke();\r\n-\r\n-        } else if (state.touch == \"end\") {\r\n-\r\n-            this.graphics.clear();\r\n-\r\n-            if (this._touchesPos.length > 0) {\r\n-\r\n-                for (let i = 0; i < this._touchesPos.length; i++) {\r\n-\r\n-                    this._touchesPos[i].y = this._view.height - this._touchesPos[i].y;\r\n-                }\r\n-\r\n-                let tempArrX = [];\r\n-                tempArrX = this._touchesPos;\r\n-                tempArrX.sort(this.comparePosX());\r\n-\r\n-                let tempArrY = [];\r\n-                tempArrY = this._touchesPos;\r\n-                tempArrY.sort(this.comparePosY());\r\n-\r\n-                var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n-                var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n-                let isSortY = false;\r\n-\r\n-                let isValid = true;\r\n-                if (chaX < 200 && chaY > 500) {\r\n-                    isSortY = true;\r\n-                    console.log('==== sort chaY ====');\r\n-                    this._touchesPos.sort(this.comparePosY());\r\n-                    console.log(this._touchesPos);\r\n-\r\n-                } else if (chaX > 500) {\r\n-                    console.log('==== sort chaX ====');\r\n-                    this._touchesPos.sort(this.comparePosX());\r\n-                    console.log(this._touchesPos);\r\n-                } else {\r\n-                    isValid = false;\r\n-                }\r\n-\r\n-                if (isValid) {\r\n-                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                        this._allPointRect[i].isContains = false;\r\n-                    }\r\n-\r\n-                    let pointNums = 0;\r\n-                    for (let i = 0; i < this._touchesPos.length; i++) {\r\n-\r\n-                        for (let j = 0; j < this._allPointRect.length; j++) {\r\n-\r\n-                            if (this._allPointRect[j].rect.contains(this._touchesPos[i])) {\r\n-                                this._allPointRect[j].isContains = true;\r\n-                                break;\r\n-                            }\r\n-                        }\r\n-                    }\r\n-\r\n-                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                        if (this._allPointRect[i].isContains) {\r\n-                            pointNums++;\r\n-                        }\r\n-                    }\r\n-\r\n-                    if (pointNums >= 2) {\r\n-\r\n-                        for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                            if (i === 0 && this._allPointRect[i].isContains) {\r\n-\r\n-                                if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n-\r\n-                                    this._allPointRect[i].limitMinx = true;\r\n-                                }\r\n-\r\n-                                if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n-\r\n-                                    this._allPointRect[i].limitMaxy = true;\r\n-                                }\r\n-\r\n-                            } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n-\r\n-                                if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n-\r\n-                                    this._allPointRect[i].limitMaxx = true;\r\n-                                }\r\n-\r\n-                            } else if (i === 3 && this._allPointRect[i].isContains) {\r\n-\r\n-                                if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n-\r\n-                                    this._allPointRect[i].limitMiny = true;\r\n-                                }\r\n-                            }\r\n-                        }\r\n-\r\n-                        if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n-                            this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n-\r\n-                            state.allLinesAnwer.push(true);\r\n-\r\n-                        } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n-                            this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n-                            state.allLinesAnwer.push(true);\r\n-                        } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n-                            this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n-                            state.allLinesAnwer.push(true);\r\n-                        } else {\r\n-                            state.allLinesAnwer.push(false);\r\n-                        }\r\n-\r\n-                        if (this._touchesPos.length > 0) {\r\n-\r\n-                            let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n-\r\n-                            let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                            this._view.addChild(zhiLine);\r\n-                            zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n-                            if (!isSortY) {\r\n-                                zhiLine.x = this._touchesPos[0].x;\r\n-                                zhiLine.y = this._touchesPos[0].y;\r\n-                                zhiLine.rotation = angle;\r\n-                            } else {\r\n-                                zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n-                                zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n-                                zhiLine.rotation = -Math.abs(angle);\r\n-                            }\r\n-\r\n-                            console.log('==== angle ====  ' + angle);\r\n-                            console.log('==== rotation ====  ' + zhiLine.rotation);\r\n-\r\n-                            zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n-\r\n-                            this._selflLines.push(zhiLine);\r\n-                        }\r\n-                    }\r\n-\r\n-                }\r\n-\r\n-                setTimeout(() => {\r\n-\r\n-                    let state: any = globalThis._.cloneDeep(this._state);\r\n-                    state.touch = 'no';\r\n-                    state.allLinesAnwer =\r\n-                        this.updateState(state);\r\n-\r\n-                }, 500);\r\n-            }\r\n-\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-                // let keyBtn = this._view.getChild('input1').asButton;\r\n-                // this.handTips2(keyBtn);\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-    angle(start, end) {\r\n-        var diff_x = end.x - start.x,\r\n-            diff_y = end.y - start.y;\r\n-        //返回角度,不是弧度\r\n-        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-        this.schedule(this.dragSchedule, this._scheduleTime);\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1625221333724,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -449,10 +449,10 @@\n                 setTimeout(() => {\r\n \r\n                     let state1: any = globalThis._.cloneDeep(this._state);\r\n                     state1.touch = 'no';\r\n-                    state1.allLinesAnwer =\r\n-                        this.updateState(state);\r\n+                    state1.allLinesAnwer = state.allLinesAnwer\r\n+                    this.updateState(state);\r\n \r\n                 }, 500);\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625221339296,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -449,9 +449,9 @@\n                 setTimeout(() => {\r\n \r\n                     let state1: any = globalThis._.cloneDeep(this._state);\r\n                     state1.touch = 'no';\r\n-                    state1.allLinesAnwer = state.allLinesAnwer\r\n+                    state1.allLinesAnwer = state.allLinesAnwer;\r\n                     this.updateState(state);\r\n \r\n                 }, 500);\r\n             }\r\n"
                },
                {
                    "date": 1625221607709,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -402,22 +402,22 @@\n                                 }\r\n                             }\r\n                         }\r\n \r\n-                        if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n-                            this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+                        // if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n+                        //     this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n-                            state.allLinesAnwer.push(true);\r\n+                        //     state.allLinesAnwer.push(true);\r\n \r\n-                        } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n-                            this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n-                            state.allLinesAnwer.push(true);\r\n-                        } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n-                            this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n-                            state.allLinesAnwer.push(true);\r\n-                        } else {\r\n-                            state.allLinesAnwer.push(false);\r\n-                        }\r\n+                        // } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n+                        //     this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+                        //     state.allLinesAnwer.push(true);\r\n+                        // } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n+                        //     this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+                        //     state.allLinesAnwer.push(true);\r\n+                        // } else {\r\n+                        //     state.allLinesAnwer.push(false);\r\n+                        // }\r\n \r\n                         if (this._touchesPos.length > 0) {\r\n \r\n                             let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n@@ -449,9 +449,9 @@\n                 setTimeout(() => {\r\n \r\n                     let state1: any = globalThis._.cloneDeep(this._state);\r\n                     state1.touch = 'no';\r\n-                    state1.allLinesAnwer = state.allLinesAnwer;\r\n+                    //state1.allLinesAnwer = state.allLinesAnwer;\r\n                     this.updateState(state);\r\n \r\n                 }, 500);\r\n             }\r\n"
                },
                {
                    "date": 1625221709840,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -146,9 +146,8 @@\n             submit: this.submitType.No,\r\n             touch: \"no\",\r\n             reset: false,\r\n             touchesPos: [],\r\n-            allLinesAnwer: []\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n@@ -227,17 +226,17 @@\n     private _clickSubmit(evt: any) {\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n-        if (state.allLinesAnwer.length === 0) {\r\n+        if (this._allPointData.length === 0) {\r\n \r\n             state.submit = this.submitType.GuideShow;\r\n \r\n         } else {\r\n             let isAllRight = true;\r\n-            for (let i = 0; i < state.allLinesAnwer.length; i++) {\r\n+            for (let i = 0; i < this._allPointData.length; i++) {\r\n \r\n-                if (!state.allLinesAnwer[i]) {\r\n+                if (!this._allPointData[i]) {\r\n                     isAllRight = false;\r\n                     break;\r\n                 }\r\n             }\r\n@@ -310,9 +309,8 @@\n \r\n         } else if (state.touch == \"end\") {\r\n \r\n             this.graphics.clear();\r\n-\r\n             if (this._touchesPos.length > 0) {\r\n \r\n                 for (let i = 0; i < this._touchesPos.length; i++) {\r\n \r\n@@ -395,30 +393,34 @@\n                                 }\r\n \r\n                             } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n+                                console.log('===== 3333 ii ====');\r\n+                                console.log(this._touchesPos);\r\n+\r\n                                 if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n \r\n                                     this._allPointRect[i].limitMiny = true;\r\n                                 }\r\n                             }\r\n                         }\r\n \r\n-                        // if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n-                        //     this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n-                        //     state.allLinesAnwer.push(true);\r\n+                        if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n+                            this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n-                        // } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n-                        //     this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n-                        //     state.allLinesAnwer.push(true);\r\n-                        // } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n-                        //     this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n-                        //     state.allLinesAnwer.push(true);\r\n-                        // } else {\r\n-                        //     state.allLinesAnwer.push(false);\r\n-                        // }\r\n+                            this._allPointData.push(true);\r\n \r\n+                        } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains &&\r\n+                            this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+                            this._allPointData.push(true);\r\n+                        } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains &&\r\n+                            this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+                            this._allPointData.push(true);\r\n+                        } else {\r\n+                            this._allPointData.push(false);\r\n+                        }\r\n+\r\n                         if (this._touchesPos.length > 0) {\r\n \r\n                             let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n \r\n@@ -437,8 +439,10 @@\n \r\n                             console.log('==== angle ====  ' + angle);\r\n                             console.log('==== rotation ====  ' + zhiLine.rotation);\r\n \r\n+                            zhiLine.sortingOrder = 0;\r\n+\r\n                             zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n \r\n                             this._selflLines.push(zhiLine);\r\n                         }\r\n@@ -447,14 +451,13 @@\n                 }\r\n \r\n                 setTimeout(() => {\r\n \r\n-                    let state1: any = globalThis._.cloneDeep(this._state);\r\n-                    state1.touch = 'no';\r\n-                    //state1.allLinesAnwer = state.allLinesAnwer;\r\n+                    let state: any = globalThis._.cloneDeep(this._state);\r\n+                    state.touch = 'no';\r\n                     this.updateState(state);\r\n \r\n-                }, 500);\r\n+                });\r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1625221925140,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -292,8 +292,9 @@\n         } else if (state.touch == \"move\") {\r\n \r\n             this._touchesPos = state.touchesPos;\r\n \r\n+            console.log('==== ====');\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n             let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n             this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n"
                },
                {
                    "date": 1625221934337,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -292,9 +292,9 @@\n         } else if (state.touch == \"move\") {\r\n \r\n             this._touchesPos = state.touchesPos;\r\n \r\n-            console.log('==== ====');\r\n+            console.log('==== 444444 ====');\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n             let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n             this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n"
                },
                {
                    "date": 1625221940557,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -293,8 +293,9 @@\n \r\n             this._touchesPos = state.touchesPos;\r\n \r\n             console.log('==== 444444 ====');\r\n+            console.log();\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n             let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n             this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n"
                },
                {
                    "date": 1625221947617,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -293,9 +293,10 @@\n \r\n             this._touchesPos = state.touchesPos;\r\n \r\n             console.log('==== 444444 ====');\r\n-            console.log();\r\n+            console.log(state.touchesPos);\r\n+\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n             let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n             this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n"
                },
                {
                    "date": 1625222017392,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -292,11 +292,8 @@\n         } else if (state.touch == \"move\") {\r\n \r\n             this._touchesPos = state.touchesPos;\r\n \r\n-            console.log('==== 444444 ====');\r\n-            console.log(state.touchesPos);\r\n-\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n             let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n             this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n@@ -338,17 +335,18 @@\n                     console.log('==== sort chaY ====');\r\n                     this._touchesPos.sort(this.comparePosY());\r\n                     console.log(this._touchesPos);\r\n \r\n-                } else if (chaX > 500) {\r\n+                } else if (chaX > 500 && chaY < 200) {\r\n                     console.log('==== sort chaX ====');\r\n                     this._touchesPos.sort(this.comparePosX());\r\n                     console.log(this._touchesPos);\r\n                 } else {\r\n                     isValid = false;\r\n                 }\r\n \r\n                 if (isValid) {\r\n+\r\n                     for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                         this._allPointRect[i].isContains = false;\r\n                     }\r\n"
                },
                {
                    "date": 1625222058271,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -292,8 +292,9 @@\n         } else if (state.touch == \"move\") {\r\n \r\n             this._touchesPos = state.touchesPos;\r\n \r\n+            console.log('====== 9999999 =====');\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n             let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n             this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n"
                },
                {
                    "date": 1625222063783,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -293,8 +293,9 @@\n \r\n             this._touchesPos = state.touchesPos;\r\n \r\n             console.log('====== 9999999 =====');\r\n+            console.log();\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n             let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n             this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n"
                },
                {
                    "date": 1625222070293,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -293,9 +293,10 @@\n \r\n             this._touchesPos = state.touchesPos;\r\n \r\n             console.log('====== 9999999 =====');\r\n-            console.log();\r\n+            console.log(this._touchesPos);\r\n+\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n             let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n             this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n"
                },
                {
                    "date": 1625222148862,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -174,8 +174,9 @@\n         console.log('===== start 111 ====' + event.touch.getLocation());\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         if (state.touch === 'no') {\r\n+            state.touchesPos = [];\r\n             state.touch = 'start';\r\n             let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n             state.touchesPos.push(tempPos);\r\n             this.updateState(state);\r\n"
                },
                {
                    "date": 1625222169970,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -174,10 +174,10 @@\n         console.log('===== start 111 ====' + event.touch.getLocation());\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         if (state.touch === 'no') {\r\n+            state.touch = 'start';\r\n             state.touchesPos = [];\r\n-            state.touch = 'start';\r\n             let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n             state.touchesPos.push(tempPos);\r\n             this.updateState(state);\r\n         }\r\n"
                },
                {
                    "date": 1625222225052,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -262,8 +262,9 @@\n     dragSchedule() {\r\n         if (this._dragging) {\r\n \r\n             console.log('==== 3333333 拖拽定时器 ======');\r\n+            console.log(this._moveCurPos);\r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n             state.touchesPos.push(this._moveCurPos);\r\n             state.touch = \"move\";\r\n             this.updateState(state);\r\n"
                },
                {
                    "date": 1625222311792,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -263,8 +263,9 @@\n         if (this._dragging) {\r\n \r\n             console.log('==== 3333333 拖拽定时器 ======');\r\n             console.log(this._moveCurPos);\r\n+\r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n             state.touchesPos.push(this._moveCurPos);\r\n             state.touch = \"move\";\r\n             this.updateState(state);\r\n"
                },
                {
                    "date": 1625222336206,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -267,8 +267,11 @@\n \r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n             state.touchesPos.push(this._moveCurPos);\r\n             state.touch = \"move\";\r\n+            console.log('==== 3333333 拖拽定时器 ======');\r\n+            console.log(this._moveCurPos);\r\n+\r\n             this.updateState(state);\r\n         }\r\n     }\r\n \r\n"
                },
                {
                    "date": 1625222343134,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -268,9 +268,9 @@\n             let state: any = globalThis._.cloneDeep(this._state);\r\n             state.touchesPos.push(this._moveCurPos);\r\n             state.touch = \"move\";\r\n             console.log('==== 3333333 拖拽定时器 ======');\r\n-            console.log(this._moveCurPos);\r\n+            console.log(state.touchesPos);\r\n \r\n             this.updateState(state);\r\n         }\r\n     }\r\n"
                },
                {
                    "date": 1625222349261,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -267,9 +267,9 @@\n \r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n             state.touchesPos.push(this._moveCurPos);\r\n             state.touch = \"move\";\r\n-            console.log('==== 3333333 拖拽定时器 ======');\r\n+            console.log('==== 44444444 拖拽定时器 ======');\r\n             console.log(state.touchesPos);\r\n \r\n             this.updateState(state);\r\n         }\r\n"
                },
                {
                    "date": 1625222354595,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -267,9 +267,9 @@\n \r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n             state.touchesPos.push(this._moveCurPos);\r\n             state.touch = \"move\";\r\n-            console.log('==== 44444444 拖拽定时器 ======');\r\n+            console.log('==== 4444444 拖拽定时器 ======');\r\n             console.log(state.touchesPos);\r\n \r\n             this.updateState(state);\r\n         }\r\n"
                },
                {
                    "date": 1625222421871,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -262,16 +262,11 @@\n     dragSchedule() {\r\n         if (this._dragging) {\r\n \r\n             console.log('==== 3333333 拖拽定时器 ======');\r\n-            console.log(this._moveCurPos);\r\n-\r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n             state.touchesPos.push(this._moveCurPos);\r\n             state.touch = \"move\";\r\n-            console.log('==== 4444444 拖拽定时器 ======');\r\n-            console.log(state.touchesPos);\r\n-\r\n             this.updateState(state);\r\n         }\r\n     }\r\n \r\n"
                },
                {
                    "date": 1625222703237,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n     private _resetBtn: fgui.GButton;\r\n \r\n     private _package: any;\r\n \r\n-    private _touchesPos: any = [];\r\n+    private _curTouchesPos: any = [];\r\n \r\n     private _moveCurPos: cc.Vec2;\r\n \r\n     private graphics: cc.Graphics = null;\r\n@@ -145,9 +145,9 @@\n             title: false,\r\n             submit: this.submitType.No,\r\n             touch: \"no\",\r\n             reset: false,\r\n-            touchesPos: [],\r\n+            curTouchesPos: [],\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n@@ -175,11 +175,11 @@\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         if (state.touch === 'no') {\r\n             state.touch = 'start';\r\n-            state.touchesPos = [];\r\n+            state.curTouchesPos = [];\r\n             let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-            state.touchesPos.push(tempPos);\r\n+            state.curTouchesPos.push(tempPos);\r\n             this.updateState(state);\r\n         }\r\n     }\r\n \r\n@@ -263,9 +263,9 @@\n         if (this._dragging) {\r\n \r\n             console.log('==== 3333333 拖拽定时器 ======');\r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.touchesPos.push(this._moveCurPos);\r\n+            state.curTouchesPos.push(this._moveCurPos);\r\n             state.touch = \"move\";\r\n             this.updateState(state);\r\n         }\r\n     }\r\n@@ -285,49 +285,46 @@\n     updateUi(oldState: any, state: any) {\r\n \r\n         if (state.touch == \"start\") {\r\n \r\n-            this._touchesPos = state.touchesPos;\r\n+            this._curTouchesPos = state.curTouchesPos;\r\n             this.graphics.clear();\r\n-            this._touchesPos.length = 0;\r\n+            this._curTouchesPos.length = 0;\r\n \r\n         } else if (state.touch == \"move\") {\r\n \r\n-            this._touchesPos = state.touchesPos;\r\n+            this._curTouchesPos = state.curTouchesPos;\r\n \r\n-            console.log('====== 9999999 =====');\r\n-            console.log(this._touchesPos);\r\n-\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n             let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n-            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n+            this.graphics.moveTo(this._curTouchesPos[0].x - worldPos.x, this._curTouchesPos[0].y - worldPos.y);\r\n             let lastIndex = 0;\r\n-            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n-                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n+            for (let i = 1, l = this._curTouchesPos.length; i < l; i++) {\r\n+                if (this._curTouchesPos[i].sub(this._curTouchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n                     continue;\r\n                 }\r\n                 lastIndex = i;\r\n-                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n+                this.graphics.lineTo(this._curTouchesPos[i].x - worldPos.x, this._curTouchesPos[i].y - worldPos.y);\r\n             }\r\n             this.graphics.stroke();\r\n \r\n         } else if (state.touch == \"end\") {\r\n \r\n             this.graphics.clear();\r\n-            if (this._touchesPos.length > 0) {\r\n+            if (this._curTouchesPos.length > 0) {\r\n \r\n-                for (let i = 0; i < this._touchesPos.length; i++) {\r\n+                for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n \r\n-                    this._touchesPos[i].y = this._view.height - this._touchesPos[i].y;\r\n+                    this._curTouchesPos[i].y = this._view.height - this._curTouchesPos[i].y;\r\n                 }\r\n \r\n                 let tempArrX = [];\r\n-                tempArrX = this._touchesPos;\r\n+                tempArrX = this._curTouchesPos;\r\n                 tempArrX.sort(this.comparePosX());\r\n \r\n                 let tempArrY = [];\r\n-                tempArrY = this._touchesPos;\r\n+                tempArrY = this._curTouchesPos;\r\n                 tempArrY.sort(this.comparePosY());\r\n \r\n                 var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n                 var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n@@ -336,15 +333,15 @@\n                 let isValid = true;\r\n                 if (chaX < 200 && chaY > 500) {\r\n                     isSortY = true;\r\n                     console.log('==== sort chaY ====');\r\n-                    this._touchesPos.sort(this.comparePosY());\r\n-                    console.log(this._touchesPos);\r\n+                    this._curTouchesPos.sort(this.comparePosY());\r\n+                    console.log(this._curTouchesPos);\r\n \r\n                 } else if (chaX > 500 && chaY < 200) {\r\n                     console.log('==== sort chaX ====');\r\n-                    this._touchesPos.sort(this.comparePosX());\r\n-                    console.log(this._touchesPos);\r\n+                    this._curTouchesPos.sort(this.comparePosX());\r\n+                    console.log(this._curTouchesPos);\r\n                 } else {\r\n                     isValid = false;\r\n                 }\r\n \r\n@@ -355,13 +352,13 @@\n                         this._allPointRect[i].isContains = false;\r\n                     }\r\n \r\n                     let pointNums = 0;\r\n-                    for (let i = 0; i < this._touchesPos.length; i++) {\r\n+                    for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n \r\n                         for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n-                            if (this._allPointRect[j].rect.contains(this._touchesPos[i])) {\r\n+                            if (this._allPointRect[j].rect.contains(this._curTouchesPos[i])) {\r\n                                 this._allPointRect[j].isContains = true;\r\n                                 break;\r\n                             }\r\n                         }\r\n@@ -379,31 +376,31 @@\n                         for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                             if (i === 0 && this._allPointRect[i].isContains) {\r\n \r\n-                                if (this._touchesPos[0].x < this._allPointRect[i].minx) {\r\n+                                if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n                                     this._allPointRect[i].limitMinx = true;\r\n                                 }\r\n \r\n-                                if (this._touchesPos[this._touchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n+                                if (this._curTouchesPos[this._curTouchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n \r\n                                     this._allPointRect[i].limitMaxy = true;\r\n                                 }\r\n \r\n                             } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n \r\n-                                if (this._touchesPos[this._touchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n+                                if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                                     this._allPointRect[i].limitMaxx = true;\r\n                                 }\r\n \r\n                             } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n                                 console.log('===== 3333 ii ====');\r\n-                                console.log(this._touchesPos);\r\n+                                console.log(this._curTouchesPos);\r\n \r\n-                                if (this._touchesPos[0].y < this._allPointRect[i].miny) {\r\n+                                if (this._curTouchesPos[0].y < this._allPointRect[i].miny) {\r\n \r\n                                     this._allPointRect[i].limitMiny = true;\r\n                                 }\r\n                             }\r\n@@ -424,22 +421,22 @@\n                         } else {\r\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n-                        if (this._touchesPos.length > 0) {\r\n+                        if (this._curTouchesPos.length > 0) {\r\n \r\n-                            let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n+                            let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n                             let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                             this._view.addChild(zhiLine);\r\n-                            zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n+                            zhiLine.width = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             if (!isSortY) {\r\n-                                zhiLine.x = this._touchesPos[0].x;\r\n-                                zhiLine.y = this._touchesPos[0].y;\r\n+                                zhiLine.x = this._curTouchesPos[0].x;\r\n+                                zhiLine.y = this._curTouchesPos[0].y;\r\n                                 zhiLine.rotation = angle;\r\n                             } else {\r\n-                                zhiLine.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n-                                zhiLine.y = this._touchesPos[this._touchesPos.length - 1].y;\r\n+                                zhiLine.x = this._curTouchesPos[this._curTouchesPos.length - 1].x;\r\n+                                zhiLine.y = this._curTouchesPos[this._curTouchesPos.length - 1].y;\r\n                                 zhiLine.rotation = -Math.abs(angle);\r\n                             }\r\n \r\n                             console.log('==== angle ====  ' + angle);\r\n"
                },
                {
                    "date": 1625223148584,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -146,8 +146,9 @@\n             submit: this.submitType.No,\r\n             touch: \"no\",\r\n             reset: false,\r\n             curTouchesPos: [],\r\n+            allTouchLinesPos: {}\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n"
                },
                {
                    "date": 1625223271820,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -406,9 +406,8 @@\n                                 }\r\n                             }\r\n                         }\r\n \r\n-\r\n                         if (this._allPointRect[0].isContains && this._allPointRect[1].isContains &&\r\n                             this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n                             this._allPointData.push(true);\r\n@@ -422,8 +421,10 @@\n                         } else {\r\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n+\r\n+                        allTouchLinesPos\r\n                         if (this._curTouchesPos.length > 0) {\r\n \r\n                             let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625223279288,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -422,9 +422,9 @@\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n \r\n-                        allTouchLinesPos\r\n+                        state.allTouchLinesPos\r\n                         if (this._curTouchesPos.length > 0) {\r\n \r\n                             let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625223294228,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -422,9 +422,9 @@\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n \r\n-                        state.allTouchLinesPos\r\n+                        state.allTouchLinesPos[state.allTouchLinesPos]\r\n                         if (this._curTouchesPos.length > 0) {\r\n \r\n                             let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625223314469,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -422,9 +422,9 @@\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n \r\n-                        state.allTouchLinesPos[state.allTouchLinesPos]\r\n+                        state.allTouchLinesPos[state.allTouchLinesPos] = this._curTouchesPos;\r\n                         if (this._curTouchesPos.length > 0) {\r\n \r\n                             let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625223441448,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -422,9 +422,9 @@\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n \r\n-                        state.allTouchLinesPos[state.allTouchLinesPos] = this._curTouchesPos;\r\n+                        state.allTouchLinesPos[Object.keys(state.allTouchLinesPos)] = this._curTouchesPos;\r\n                         if (this._curTouchesPos.length > 0) {\r\n \r\n                             let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625223447413,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -422,9 +422,9 @@\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n \r\n-                        state.allTouchLinesPos[Object.keys(state.allTouchLinesPos)] = this._curTouchesPos;\r\n+                        state.allTouchLinesPos[Object.keys(state.allTouchLinesPos).length] = this._curTouchesPos;\r\n                         if (this._curTouchesPos.length > 0) {\r\n \r\n                             let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625223469040,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -423,8 +423,9 @@\n                         }\r\n \r\n \r\n                         state.allTouchLinesPos[Object.keys(state.allTouchLinesPos).length] = this._curTouchesPos;\r\n+\r\n                         if (this._curTouchesPos.length > 0) {\r\n \r\n                             let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625223555389,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -458,15 +458,18 @@\n                 setTimeout(() => {\r\n \r\n                     let state: any = globalThis._.cloneDeep(this._state);\r\n                     state.touch = 'no';\r\n+                    state.allTouchLinesPos\r\n                     this.updateState(state);\r\n \r\n                 });\r\n             }\r\n \r\n         }\r\n \r\n+        if ()\r\n+            allTouchLinesPos\r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n             if (state.submit === this.submitType.RightFeed) {\r\n \r\n"
                },
                {
                    "date": 1625223562359,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -458,9 +458,9 @@\n                 setTimeout(() => {\r\n \r\n                     let state: any = globalThis._.cloneDeep(this._state);\r\n                     state.touch = 'no';\r\n-                    state.allTouchLinesPos\r\n+                    state.allTouchLinesPos = state.allTouchLinesPos；\r\n                     this.updateState(state);\r\n \r\n                 });\r\n             }\r\n"
                },
                {
                    "date": 1625223572689,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -456,11 +456,11 @@\n                 }\r\n \r\n                 setTimeout(() => {\r\n \r\n-                    let state: any = globalThis._.cloneDeep(this._state);\r\n-                    state.touch = 'no';\r\n-                    state.allTouchLinesPos = state.allTouchLinesPos；\r\n+                    let state1: any = globalThis._.cloneDeep(this._state);\r\n+                    state1.touch = 'no';\r\n+                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n                     this.updateState(state);\r\n \r\n                 });\r\n             }\r\n"
                },
                {
                    "date": 1625223579070,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -459,9 +459,9 @@\n \r\n                     let state1: any = globalThis._.cloneDeep(this._state);\r\n                     state1.touch = 'no';\r\n                     state1.allTouchLinesPos = state.allTouchLinesPos;\r\n-                    this.updateState(state);\r\n+                    this.updateState(state1);\r\n \r\n                 });\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625223616393,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -466,11 +466,12 @@\n             }\r\n \r\n         }\r\n \r\n-        if ()\r\n-            allTouchLinesPos\r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+        }\r\n+        allTouchLinesPos\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n             if (state.submit === this.submitType.RightFeed) {\r\n \r\n                 this.answerFeedback(true);\r\n"
                },
                {
                    "date": 1625223624570,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -466,11 +466,12 @@\n             }\r\n \r\n         }\r\n \r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+        if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n+\r\n         }\r\n-        allTouchLinesPos\r\n+\r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n             if (state.submit === this.submitType.RightFeed) {\r\n \r\n"
                },
                {
                    "date": 1625223642801,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -421,37 +421,10 @@\n                         } else {\r\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n-\r\n                         state.allTouchLinesPos[Object.keys(state.allTouchLinesPos).length] = this._curTouchesPos;\r\n \r\n-                        if (this._curTouchesPos.length > 0) {\r\n-\r\n-                            let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n-\r\n-                            let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                            this._view.addChild(zhiLine);\r\n-                            zhiLine.width = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n-                            if (!isSortY) {\r\n-                                zhiLine.x = this._curTouchesPos[0].x;\r\n-                                zhiLine.y = this._curTouchesPos[0].y;\r\n-                                zhiLine.rotation = angle;\r\n-                            } else {\r\n-                                zhiLine.x = this._curTouchesPos[this._curTouchesPos.length - 1].x;\r\n-                                zhiLine.y = this._curTouchesPos[this._curTouchesPos.length - 1].y;\r\n-                                zhiLine.rotation = -Math.abs(angle);\r\n-                            }\r\n-\r\n-                            console.log('==== angle ====  ' + angle);\r\n-                            console.log('==== rotation ====  ' + zhiLine.rotation);\r\n-\r\n-                            zhiLine.sortingOrder = 0;\r\n-\r\n-                            zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n-\r\n-                            this._selflLines.push(zhiLine);\r\n-                        }\r\n                     }\r\n \r\n                 }\r\n \r\n@@ -468,8 +441,32 @@\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n+            let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n+\r\n+            let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+            this._view.addChild(zhiLine);\r\n+            zhiLine.width = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+            if (!isSortY) {\r\n+                zhiLine.x = this._curTouchesPos[0].x;\r\n+                zhiLine.y = this._curTouchesPos[0].y;\r\n+                zhiLine.rotation = angle;\r\n+            } else {\r\n+                zhiLine.x = this._curTouchesPos[this._curTouchesPos.length - 1].x;\r\n+                zhiLine.y = this._curTouchesPos[this._curTouchesPos.length - 1].y;\r\n+                zhiLine.rotation = -Math.abs(angle);\r\n+            }\r\n+\r\n+            console.log('==== angle ====  ' + angle);\r\n+            console.log('==== rotation ====  ' + zhiLine.rotation);\r\n+\r\n+            zhiLine.sortingOrder = 0;\r\n+\r\n+            zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n+\r\n+            this._selflLines.push(zhiLine);\r\n+\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n"
                },
                {
                    "date": 1625223650665,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -441,8 +441,9 @@\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n+\r\n             let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n             let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n             this._view.addChild(zhiLine);\r\n"
                },
                {
                    "date": 1625223680228,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -422,8 +422,9 @@\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n                         state.allTouchLinesPos[Object.keys(state.allTouchLinesPos).length] = this._curTouchesPos;\r\n+                        isSortY\r\n \r\n                     }\r\n \r\n                 }\r\n"
                },
                {
                    "date": 1625223696257,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -421,9 +421,10 @@\n                         } else {\r\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n-                        state.allTouchLinesPos[Object.keys(state.allTouchLinesPos).length] = this._curTouchesPos;\r\n+                        let temp =\r\n+                            state.allTouchLinesPos[Object.keys(state.allTouchLinesPos).length] = this._curTouchesPos;\r\n                         isSortY\r\n \r\n                     }\r\n \r\n"
                },
                {
                    "date": 1625223761410,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -421,10 +421,10 @@\n                         } else {\r\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n-                        let temp =\r\n-                            state.allTouchLinesPos[Object.keys(state.allTouchLinesPos).length] = this._curTouchesPos;\r\n+                        let temp = { 'pos': this._curTouchesPos };\r\n+                        state.allTouchLinesPos[Object.keys(state.allTouchLinesPos).length] = this._curTouchesPos;\r\n                         isSortY\r\n \r\n                     }\r\n \r\n"
                },
                {
                    "date": 1625223776578,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -421,9 +421,9 @@\n                         } else {\r\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n-                        let temp = { 'pos': this._curTouchesPos };\r\n+                        let temp = { 'pos': this._curTouchesPos, };\r\n                         state.allTouchLinesPos[Object.keys(state.allTouchLinesPos).length] = this._curTouchesPos;\r\n                         isSortY\r\n \r\n                     }\r\n"
                },
                {
                    "date": 1625223803246,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -421,9 +421,9 @@\n                         } else {\r\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n-                        let temp = { 'pos': this._curTouchesPos, };\r\n+                        let temp = { 'pos': this._curTouchesPos, 'isSortY': false };\r\n                         state.allTouchLinesPos[Object.keys(state.allTouchLinesPos).length] = this._curTouchesPos;\r\n                         isSortY\r\n \r\n                     }\r\n"
                },
                {
                    "date": 1625223808880,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -421,9 +421,9 @@\n                         } else {\r\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n-                        let temp = { 'pos': this._curTouchesPos, 'isSortY': false };\r\n+                        let temp = { 'pos': this._curTouchesPos, 'isSortY': isSortY };\r\n                         state.allTouchLinesPos[Object.keys(state.allTouchLinesPos).length] = this._curTouchesPos;\r\n                         isSortY\r\n \r\n                     }\r\n"
                },
                {
                    "date": 1625223834015,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -146,9 +146,9 @@\n             submit: this.submitType.No,\r\n             touch: \"no\",\r\n             reset: false,\r\n             curTouchesPos: [],\r\n-            allTouchLinesPos: {}\r\n+            allTouchLinesPos: []\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n@@ -422,9 +422,9 @@\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n                         let temp = { 'pos': this._curTouchesPos, 'isSortY': isSortY };\r\n-                        state.allTouchLinesPos[Object.keys(state.allTouchLinesPos).length] = this._curTouchesPos;\r\n+                        state.allTouchLinesPos.push() = this._curTouchesPos;\r\n                         isSortY\r\n \r\n                     }\r\n \r\n"
                },
                {
                    "date": 1625223842270,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -422,9 +422,9 @@\n                             this._allPointData.push(false);\r\n                         }\r\n \r\n                         let temp = { 'pos': this._curTouchesPos, 'isSortY': isSortY };\r\n-                        state.allTouchLinesPos.push() = this._curTouchesPos;\r\n+                        state.allTouchLinesPos.push(temp);\r\n                         isSortY\r\n \r\n                     }\r\n \r\n"
                },
                {
                    "date": 1625223849165,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -423,10 +423,8 @@\n                         }\r\n \r\n                         let temp = { 'pos': this._curTouchesPos, 'isSortY': isSortY };\r\n                         state.allTouchLinesPos.push(temp);\r\n-                        isSortY\r\n-\r\n                     }\r\n \r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625223893421,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -442,8 +442,9 @@\n \r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n \r\n+\r\n             let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n             let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n             this._view.addChild(zhiLine);\r\n"
                },
                {
                    "date": 1625223922091,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -44,8 +44,10 @@\n     private _allPointRect = [];\r\n \r\n     private _allPointData = [];\r\n \r\n+    private _curDrawIndex: number = 0;\r\n+\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n"
                },
                {
                    "date": 1625223940461,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -443,8 +443,9 @@\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n+            this._curDrawIndex\r\n \r\n \r\n             let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n"
                },
                {
                    "date": 1625224767797,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -445,9 +445,12 @@\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n             this._curDrawIndex\r\n \r\n+            for (let i = 0; i < state.allTouchLinesPos) {\r\n \r\n+            }\r\n+\r\n             let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n             let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n             this._view.addChild(zhiLine);\r\n"
                },
                {
                    "date": 1625224777797,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -445,9 +445,9 @@\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n             this._curDrawIndex\r\n \r\n-            for (let i = 0; i < state.allTouchLinesPos) {\r\n+            for (let i = 0; i < state.allTouchLinesPos.length; i++) {\r\n \r\n             }\r\n \r\n             let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n"
                },
                {
                    "date": 1625224791806,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -443,11 +443,10 @@\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n-            this._curDrawIndex\r\n+            for (let i = this.this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n-            for (let i = 0; i < state.allTouchLinesPos.length; i++) {\r\n \r\n             }\r\n \r\n             let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n"
                },
                {
                    "date": 1625224797912,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -443,9 +443,9 @@\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n-            for (let i = this.this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n+            for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n \r\n             }\r\n \r\n"
                },
                {
                    "date": 1625224957935,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -445,35 +445,30 @@\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n+                let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n-            }\r\n+                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                this._view.addChild(zhiLine);\r\n+                zhiLine.width = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                if (!isSortY) {\r\n+                    zhiLine.x = this._curTouchesPos[0].x;\r\n+                    zhiLine.y = this._curTouchesPos[0].y;\r\n+                    zhiLine.rotation = angle;\r\n+                } else {\r\n+                    zhiLine.x = this._curTouchesPos[this._curTouchesPos.length - 1].x;\r\n+                    zhiLine.y = this._curTouchesPos[this._curTouchesPos.length - 1].y;\r\n+                    zhiLine.rotation = -Math.abs(angle);\r\n+                }\r\n \r\n-            let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n+                console.log('==== angle ====  ' + angle);\r\n+                console.log('==== rotation ====  ' + zhiLine.rotation);\r\n \r\n-            let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-            this._view.addChild(zhiLine);\r\n-            zhiLine.width = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n-            if (!isSortY) {\r\n-                zhiLine.x = this._curTouchesPos[0].x;\r\n-                zhiLine.y = this._curTouchesPos[0].y;\r\n-                zhiLine.rotation = angle;\r\n-            } else {\r\n-                zhiLine.x = this._curTouchesPos[this._curTouchesPos.length - 1].x;\r\n-                zhiLine.y = this._curTouchesPos[this._curTouchesPos.length - 1].y;\r\n-                zhiLine.rotation = -Math.abs(angle);\r\n+                zhiLine.sortingOrder = 0;\r\n+\r\n+                zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n             }\r\n-\r\n-            console.log('==== angle ====  ' + angle);\r\n-            console.log('==== rotation ====  ' + zhiLine.rotation);\r\n-\r\n-            zhiLine.sortingOrder = 0;\r\n-\r\n-            zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n-\r\n-            this._selflLines.push(zhiLine);\r\n-\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n"
                },
                {
                    "date": 1625224987868,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -445,8 +445,9 @@\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n+                let tempPos = state.allTouchLinesPos[];\r\n                 let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n"
                },
                {
                    "date": 1625224993204,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -445,9 +445,9 @@\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n-                let tempPos = state.allTouchLinesPos[];\r\n+                let tempPos = state.allTouchLinesPos[i];\r\n                 let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n"
                },
                {
                    "date": 1625225030542,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -446,9 +446,9 @@\n \r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n                 let tempPos = state.allTouchLinesPos[i];\r\n-                let angle = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n+                let angle = this.angle(tempPos. [0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n"
                },
                {
                    "date": 1625225054482,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -446,9 +446,9 @@\n \r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n                 let tempPos = state.allTouchLinesPos[i];\r\n-                let angle = this.angle(tempPos. [0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n+                let angle = this.angle(tempPos.pos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n"
                },
                {
                    "date": 1625225083734,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -446,9 +446,9 @@\n \r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n                 let tempPos = state.allTouchLinesPos[i];\r\n-                let angle = this.angle(tempPos.pos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n+                let angle = this.angle(tempPos.pos[0], tempPos.pos[this._curTouchesPos.length - 1]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n"
                },
                {
                    "date": 1625225105401,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -446,9 +446,9 @@\n \r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n                 let tempPos = state.allTouchLinesPos[i];\r\n-                let angle = this.angle(tempPos.pos[0], tempPos.pos[this._curTouchesPos.length - 1]);\r\n+                let angle = this.angle(tempPos.pos[0], tempPos.pos[tempPos.pos.length - 1]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n"
                },
                {
                    "date": 1625225493915,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -445,9 +445,9 @@\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n-                let tempPos = state.allTouchLinesPos[i];\r\n+                let tempTouch = state.allTouchLinesPos[i];\r\n                 let angle = this.angle(tempPos.pos[0], tempPos.pos[tempPos.pos.length - 1]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n"
                },
                {
                    "date": 1625225504419,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -445,9 +445,9 @@\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n-                let tempTouch = state.allTouchLinesPos[i];\r\n+                let tempTouchPos = state.allTouchLinesPos[i];\r\n                 let angle = this.angle(tempPos.pos[0], tempPos.pos[tempPos.pos.length - 1]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n"
                },
                {
                    "date": 1625225509858,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -446,9 +446,9 @@\n \r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n                 let tempTouchPos = state.allTouchLinesPos[i];\r\n-                let angle = this.angle(tempPos.pos[0], tempPos.pos[tempPos.pos.length - 1]);\r\n+                let angle = this.angle(tempTouchPos.pos[0], tempTouchPos.pos[tempTouchPos.pos.length - 1]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n"
                },
                {
                    "date": 1625225526324,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -435,12 +435,10 @@\n                     let state1: any = globalThis._.cloneDeep(this._state);\r\n                     state1.touch = 'no';\r\n                     state1.allTouchLinesPos = state.allTouchLinesPos;\r\n                     this.updateState(state1);\r\n-\r\n                 });\r\n             }\r\n-\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n"
                },
                {
                    "date": 1625225550282,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -449,9 +449,9 @@\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n-                if (!isSortY) {\r\n+                if (!tempTouchPos.isSortY) {\r\n                     zhiLine.x = this._curTouchesPos[0].x;\r\n                     zhiLine.y = this._curTouchesPos[0].y;\r\n                     zhiLine.rotation = angle;\r\n                 } else {\r\n"
                },
                {
                    "date": 1625225598458,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -462,9 +462,8 @@\n \r\n                 console.log('==== angle ====  ' + angle);\r\n                 console.log('==== rotation ====  ' + zhiLine.rotation);\r\n \r\n-                zhiLine.sortingOrder = 0;\r\n \r\n                 zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1625225606208,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -462,9 +462,8 @@\n \r\n                 console.log('==== angle ====  ' + angle);\r\n                 console.log('==== rotation ====  ' + zhiLine.rotation);\r\n \r\n-\r\n                 zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1625225689677,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -458,13 +458,8 @@\n                     zhiLine.x = this._curTouchesPos[this._curTouchesPos.length - 1].x;\r\n                     zhiLine.y = this._curTouchesPos[this._curTouchesPos.length - 1].y;\r\n                     zhiLine.rotation = -Math.abs(angle);\r\n                 }\r\n-\r\n-                console.log('==== angle ====  ' + angle);\r\n-                console.log('==== rotation ====  ' + zhiLine.rotation);\r\n-\r\n-                zhiLine.data = { index: this._selflLines.length, type: this.lineType.StraightLine };\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n"
                },
                {
                    "date": 1625225791370,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -398,11 +398,8 @@\n                                 }\r\n \r\n                             } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                                console.log('===== 3333 ii ====');\r\n-                                console.log(this._curTouchesPos);\r\n-\r\n                                 if (this._curTouchesPos[0].y < this._allPointRect[i].miny) {\r\n \r\n                                     this._allPointRect[i].limitMiny = true;\r\n                                 }\r\n"
                },
                {
                    "date": 1625226789493,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -432,9 +432,9 @@\n                     let state1: any = globalThis._.cloneDeep(this._state);\r\n                     state1.touch = 'no';\r\n                     state1.allTouchLinesPos = state.allTouchLinesPos;\r\n                     this.updateState(state1);\r\n-                });\r\n+                }, 50);\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n"
                },
                {
                    "date": 1625226810138,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -455,8 +455,9 @@\n                     zhiLine.x = this._curTouchesPos[this._curTouchesPos.length - 1].x;\r\n                     zhiLine.y = this._curTouchesPos[this._curTouchesPos.length - 1].y;\r\n                     zhiLine.rotation = -Math.abs(angle);\r\n                 }\r\n+                this._curDrawIndex++;\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n"
                },
                {
                    "date": 1625226931074,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -445,16 +445,16 @@\n                 let angle = this.angle(tempTouchPos.pos[0], tempTouchPos.pos[tempTouchPos.pos.length - 1]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n-                zhiLine.width = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                zhiLine.width = tempTouchPos[tempTouchPos.length - 1].sub(tempTouchPos[0]).mag();\r\n                 if (!tempTouchPos.isSortY) {\r\n-                    zhiLine.x = this._curTouchesPos[0].x;\r\n-                    zhiLine.y = this._curTouchesPos[0].y;\r\n+                    zhiLine.x = tempTouchPos[0].x;\r\n+                    zhiLine.y = tempTouchPos[0].y;\r\n                     zhiLine.rotation = angle;\r\n                 } else {\r\n-                    zhiLine.x = this._curTouchesPos[this._curTouchesPos.length - 1].x;\r\n-                    zhiLine.y = this._curTouchesPos[this._curTouchesPos.length - 1].y;\r\n+                    zhiLine.x = tempTouchPos[tempTouchPos.length - 1].x;\r\n+                    zhiLine.y = tempTouchPos[tempTouchPos.length - 1].y;\r\n                     zhiLine.rotation = -Math.abs(angle);\r\n                 }\r\n                 this._curDrawIndex++;\r\n             }\r\n"
                },
                {
                    "date": 1625226979403,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -438,8 +438,9 @@\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n+\r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n                 let tempTouchPos = state.allTouchLinesPos[i];\r\n                 let angle = this.angle(tempTouchPos.pos[0], tempTouchPos.pos[tempTouchPos.pos.length - 1]);\r\n"
                },
                {
                    "date": 1625227061410,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -441,21 +441,21 @@\n \r\n \r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n-                let tempTouchPos = state.allTouchLinesPos[i];\r\n-                let angle = this.angle(tempTouchPos.pos[0], tempTouchPos.pos[tempTouchPos.pos.length - 1]);\r\n+                let tempTouch = state.allTouchLinesPos[i];\r\n+                let angle = this.angle(tempTouch.pos[0], tempTouch.pos[tempTouch.pos.length - 1]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n-                zhiLine.width = tempTouchPos[tempTouchPos.length - 1].sub(tempTouchPos[0]).mag();\r\n-                if (!tempTouchPos.isSortY) {\r\n-                    zhiLine.x = tempTouchPos[0].x;\r\n-                    zhiLine.y = tempTouchPos[0].y;\r\n+                zhiLine.width = tempTouch.pos[tempTouch.pos.length - 1].sub(tempTouch.pos[0]).mag();\r\n+                if (!tempTouch.isSortY) {\r\n+                    zhiLine.x = tempTouch.pos[0].x;\r\n+                    zhiLine.y = tempTouch.pos[0].y;\r\n                     zhiLine.rotation = angle;\r\n                 } else {\r\n-                    zhiLine.x = tempTouchPos[tempTouchPos.length - 1].x;\r\n-                    zhiLine.y = tempTouchPos[tempTouchPos.length - 1].y;\r\n+                    zhiLine.x = tempTouch.pos[tempTouch.pos.length - 1].x;\r\n+                    zhiLine.y = tempTouch.pos[tempTouch.pos.length - 1].y;\r\n                     zhiLine.rotation = -Math.abs(angle);\r\n                 }\r\n                 this._curDrawIndex++;\r\n             }\r\n"
                },
                {
                    "date": 1625227142921,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -441,21 +441,21 @@\n \r\n \r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n-                let tempTouch = state.allTouchLinesPos[i];\r\n-                let angle = this.angle(tempTouch.pos[0], tempTouch.pos[tempTouch.pos.length - 1]);\r\n+                let tempPos = state.allTouchLinesPos[i].pos;\r\n+                let angle = this.angle(tempPos[0], tempPos[tempPos.length - 1]);\r\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n-                zhiLine.width = tempTouch.pos[tempTouch.pos.length - 1].sub(tempTouch.pos[0]).mag();\r\n+                zhiLine.width = tempPos[tempPos.length - 1].sub(tempPos[0]).mag();\r\n                 if (!tempTouch.isSortY) {\r\n-                    zhiLine.x = tempTouch.pos[0].x;\r\n-                    zhiLine.y = tempTouch.pos[0].y;\r\n+                    zhiLine.x = tempPos.pos[0].x;\r\n+                    zhiLine.y = tempPos.pos[0].y;\r\n                     zhiLine.rotation = angle;\r\n                 } else {\r\n-                    zhiLine.x = tempTouch.pos[tempTouch.pos.length - 1].x;\r\n-                    zhiLine.y = tempTouch.pos[tempTouch.pos.length - 1].y;\r\n+                    zhiLine.x = tempPos[tempPos.length - 1].x;\r\n+                    zhiLine.y = tempPos[tempPos.length - 1].y;\r\n                     zhiLine.rotation = -Math.abs(angle);\r\n                 }\r\n                 this._curDrawIndex++;\r\n             }\r\n"
                },
                {
                    "date": 1625227151706,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -448,10 +448,10 @@\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = tempPos[tempPos.length - 1].sub(tempPos[0]).mag();\r\n                 if (!tempTouch.isSortY) {\r\n-                    zhiLine.x = tempPos.pos[0].x;\r\n-                    zhiLine.y = tempPos.pos[0].y;\r\n+                    zhiLine.x = tempPos[0].x;\r\n+                    zhiLine.y = tempPos[0].y;\r\n                     zhiLine.rotation = angle;\r\n                 } else {\r\n                     zhiLine.x = tempPos[tempPos.length - 1].x;\r\n                     zhiLine.y = tempPos[tempPos.length - 1].y;\r\n"
                },
                {
                    "date": 1625227158731,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -447,9 +447,9 @@\n \r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = tempPos[tempPos.length - 1].sub(tempPos[0]).mag();\r\n-                if (!tempTouch.isSortY) {\r\n+                if (!state.allTouchLinesPos[i].isSortY) {\r\n                     zhiLine.x = tempPos[0].x;\r\n                     zhiLine.y = tempPos[0].y;\r\n                     zhiLine.rotation = angle;\r\n                 } else {\r\n"
                },
                {
                    "date": 1625227164926,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -438,9 +438,8 @@\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n-\r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n                 let tempPos = state.allTouchLinesPos[i].pos;\r\n                 let angle = this.angle(tempPos[0], tempPos[tempPos.length - 1]);\r\n"
                },
                {
                    "date": 1625227396772,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -339,9 +339,9 @@\n                     console.log('==== sort chaY ====');\r\n                     this._curTouchesPos.sort(this.comparePosY());\r\n                     console.log(this._curTouchesPos);\r\n \r\n-                } else if (chaX > 500 && chaY < 200) {\r\n+                } else if (chaX > 500) {\r\n                     console.log('==== sort chaX ====');\r\n                     this._curTouchesPos.sort(this.comparePosX());\r\n                     console.log(this._curTouchesPos);\r\n                 } else {\r\n@@ -373,8 +373,9 @@\n                             pointNums++;\r\n                         }\r\n                     }\r\n \r\n+\r\n                     if (pointNums >= 2) {\r\n \r\n                         for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n"
                },
                {
                    "date": 1625228250576,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -439,8 +439,9 @@\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n+\r\n             for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n                 let tempPos = state.allTouchLinesPos[i].pos;\r\n                 let angle = this.angle(tempPos[0], tempPos[tempPos.length - 1]);\r\n"
                },
                {
                    "date": 1625228260201,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -437,30 +437,26 @@\n                 }, 50);\r\n             }\r\n         }\r\n \r\n-        if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n+        for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n+            let tempPos = state.allTouchLinesPos[i].pos;\r\n+            let angle = this.angle(tempPos[0], tempPos[tempPos.length - 1]);\r\n \r\n-            for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n-\r\n-                let tempPos = state.allTouchLinesPos[i].pos;\r\n-                let angle = this.angle(tempPos[0], tempPos[tempPos.length - 1]);\r\n-\r\n-                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                this._view.addChild(zhiLine);\r\n-                zhiLine.width = tempPos[tempPos.length - 1].sub(tempPos[0]).mag();\r\n-                if (!state.allTouchLinesPos[i].isSortY) {\r\n-                    zhiLine.x = tempPos[0].x;\r\n-                    zhiLine.y = tempPos[0].y;\r\n-                    zhiLine.rotation = angle;\r\n-                } else {\r\n-                    zhiLine.x = tempPos[tempPos.length - 1].x;\r\n-                    zhiLine.y = tempPos[tempPos.length - 1].y;\r\n-                    zhiLine.rotation = -Math.abs(angle);\r\n-                }\r\n-                this._curDrawIndex++;\r\n+            let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+            this._view.addChild(zhiLine);\r\n+            zhiLine.width = tempPos[tempPos.length - 1].sub(tempPos[0]).mag();\r\n+            if (!state.allTouchLinesPos[i].isSortY) {\r\n+                zhiLine.x = tempPos[0].x;\r\n+                zhiLine.y = tempPos[0].y;\r\n+                zhiLine.rotation = angle;\r\n+            } else {\r\n+                zhiLine.x = tempPos[tempPos.length - 1].x;\r\n+                zhiLine.y = tempPos[tempPos.length - 1].y;\r\n+                zhiLine.rotation = -Math.abs(angle);\r\n             }\r\n+            this._curDrawIndex++;\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n"
                },
                {
                    "date": 1625228495458,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -439,8 +439,9 @@\n         }\r\n \r\n         for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n+            console.log('=== ====');\r\n             let tempPos = state.allTouchLinesPos[i].pos;\r\n             let angle = this.angle(tempPos[0], tempPos[tempPos.length - 1]);\r\n \r\n             let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n"
                },
                {
                    "date": 1625228501988,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -439,9 +439,9 @@\n         }\r\n \r\n         for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n-            console.log('=== ====');\r\n+            console.log('====== allTouchLinesPos ====');\r\n             let tempPos = state.allTouchLinesPos[i].pos;\r\n             let angle = this.angle(tempPos[0], tempPos[tempPos.length - 1]);\r\n \r\n             let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n"
                },
                {
                    "date": 1625228510793,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -439,9 +439,9 @@\n         }\r\n \r\n         for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n-            console.log('====== allTouchLinesPos ====');\r\n+            console.log('====== allTouchLinesPos 展示 ====');\r\n             let tempPos = state.allTouchLinesPos[i].pos;\r\n             let angle = this.angle(tempPos[0], tempPos[tempPos.length - 1]);\r\n \r\n             let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n"
                },
                {
                    "date": 1625228524726,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -439,9 +439,9 @@\n         }\r\n \r\n         for (let i = this._curDrawIndex; i < state.allTouchLinesPos.length; i++) {\r\n \r\n-            console.log('====== allTouchLinesPos 展示 ====');\r\n+            console.log('====== allTouchLinesPos 展示全部线 ====');\r\n             let tempPos = state.allTouchLinesPos[i].pos;\r\n             let angle = this.angle(tempPos[0], tempPos[tempPos.length - 1]);\r\n \r\n             let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n"
                }
            ],
            "date": 1625119227755,
            "name": "Commit-0",
            "content": "\r\n/*\r\n * @Descripttion: \r\n * @version: \r\n * @Author: ruzhuan\r\n * @Date: 2021-06-08 18:00:00\r\n * @LastEditors: ruzhuan\r\n * @LastEditTime: 2021-06-08 18:00:00\r\n */\r\nconst { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class t4_05_model_v2 extends cc.Component {\r\n    private _worldRoot: cc.Node;\r\n\r\n    private _view: fgui.GComponent;\r\n\r\n    private _c1: fgui.Controller;\r\n\r\n    private _title: fgui.GButton;\r\n\r\n    private _titleTrigger: fgui.GLoader;\r\n\r\n    private _submitBtn: fgui.GButton;\r\n\r\n    private _package: any;\r\n\r\n    private _touchesPos: cc.Vec2[] = [];\r\n\r\n    private _touchXMax: number = 0;\r\n\r\n    private _touchXMin: number = 0;\r\n\r\n    private graphics: cc.Graphics = null;\r\n\r\n    private _zhiLine: fgui.GObject;\r\n\r\n    private _drawLan: fgui.GImage;\r\n\r\n    private _moveMinX: number = 430;\r\n\r\n    private _lanRect: cc.Rect;\r\n    private _redRect: cc.Rect;\r\n    private _playerRect: cc.Rect;\r\n    private _drawLineRect: cc.Rect;\r\n\r\n    private _drawRed: fgui.GImage;\r\n\r\n    private _maskBg: fgui.GGraph;\r\n\r\n    private _player: fgui.GImage;\r\n\r\n    private _moveSpeed: number = 1;\r\n\r\n    private _gameTime: number = 0;\r\n\r\n    private _defaultMinX: number = 550;\r\n\r\n    private _defaultMaxX: number = 1290;\r\n\r\n    private _defaultMidPosY: number = 635;\r\n\r\n    private _framesSecond: number = 20; //1秒钟运行20帧（次）\r\n\r\n    private _dragging = false;\r\n\r\n    private _scheduleTime = 0.01;\r\n\r\n    private _showPosArr: any = [\r\n        { 'line': { x: 25, y: 250 }, 'lan': { x: 16, y: 218 }, 'red': { x: 472, y: 218 } },\r\n        { 'line': { x: 25, y: 345 }, 'lan': { x: 16, y: 312 }, 'red': { x: 472, y: 312 } },\r\n        { 'line': { x: 25, y: 438 }, 'lan': { x: 16, y: 404 }, 'red': { x: 472, y: 404 } }];\r\n\r\n    private _showLines: any = [];\r\n\r\n    private _showLinesObj: any = [];\r\n\r\n    private _startBtn: fgui.GButton;\r\n\r\n    private submitType: any = cc.Enum({\r\n\r\n        No: 0,\r\n        GuideShow: 1,\r\n        WrongFeed: 2,\r\n        RightFeed: 3\r\n    });\r\n\r\n    private gameResult: any = cc.Enum({\r\n\r\n        No: 0,\r\n        Fail: 2,\r\n        Success: 3\r\n    });\r\n\r\n    private lineType: any = cc.Enum({\r\n\r\n        StraightLine: 0,\r\n        LineSegment: 1,\r\n        LeftLanRays: 2,\r\n        RightRedRays: 3\r\n    });\r\n\r\n    // 远程动态组件\r\n    private feedback: any;\r\n\r\n    private _state = {};\r\n\r\n    get state(): any {\r\n        return this._state;\r\n    }\r\n\r\n    set state(v: any) {\r\n        this.updateUi(this._state, v);\r\n        this._state = v;\r\n        this.mergeState();\r\n    }\r\n\r\n    async onLoad() {\r\n\r\n        this._worldRoot = cc.find(\"Canvas\").parent;\r\n\r\n        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n\r\n        fgui.GRoot.inst.addChild(this._view);\r\n\r\n        this._c1 = this._view.getController(\"c1\");\r\n\r\n        this._drawLan = this._view.getChild('lan').asImage;\r\n        this._drawRed = this._view.getChild('red').asImage;\r\n\r\n        this._lanRect = new cc.Rect(this._drawLan.x, this._drawLan.y, this._drawLan.width, this._drawLan.height);\r\n        this._redRect = new cc.Rect(this._drawRed.x, this._drawRed.y, this._drawRed.width, this._drawRed.height);\r\n\r\n        // 臨時\r\n        // bug 初始设置不播放不生效\r\n        if (this._c1) {\r\n            this._c1.selectedIndex = 1;\r\n            this._c1.selectedIndex = 0;\r\n        }\r\n\r\n        this._maskBg = this._view.getChild(\"maskBg\").asGraph;\r\n        this._maskBg.visible = true;\r\n\r\n        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n\r\n        this._title = this._view.getChild(\"title\").asButton;\r\n\r\n        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n\r\n        this._startBtn = this._view.getChild(\"start\").asButton;\r\n        this._startBtn.on(fgui.Event.CLICK, this._clickStart, this);\r\n\r\n        this._player = this._view.getChild('player').asImage;\r\n        this._player.x = this._view.width;\r\n        this._playerRect = new cc.Rect(this._player.x - 36, this._player.y + 10, 25, this._player.height);\r\n\r\n        this._view.off(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n        this._view.off(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n        this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n\r\n        let huiNode = new cc.Node('huiNode');\r\n        huiNode.parent = this._worldRoot;\r\n\r\n        this.graphics = huiNode.addComponent(cc.Graphics);\r\n        this.graphics.lineWidth = 20;\r\n        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n        this.graphics.fillColor = cc.color(255, 0, 0);\r\n        this.graphics.enabled = false;\r\n\r\n        // 初始化state\r\n        this._state = {\r\n            title: false,\r\n            submit: this.submitType.No,\r\n            gameStart: false,\r\n            gameOver: this.gameResult.No,\r\n            touch: \"end\",\r\n            touchesPos: []\r\n        }\r\n    }\r\n\r\n    async init(data: any) {\r\n        // 临时 model component json 配置加载\r\n        let { pathConfig, model, components } = data;\r\n        let Package = pathConfig.packageName;\r\n        let GComponent = model.uiPath;\r\n        let { boxSoundUrl, guidIndex } = model.config;\r\n        this._package = Package;\r\n\r\n        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n\r\n        this._zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n        this._view.addChild(this._zhiLine);\r\n        this._drawLineRect = new cc.Rect(this._zhiLine.x, this._zhiLine.y, this._zhiLine.width, this._zhiLine.height);\r\n\r\n        // 动效注册\r\n        // for (let v in ae) {\r\n        //     if (ae[v]) {\r\n        //         this[v] = {};\r\n        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n        //     }\r\n        // }\r\n\r\n        if (components) {\r\n            for (const key in components) {\r\n                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n                let componentBundle: any = await loadBundle(componentPath);\r\n                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n                this[key] = componentPrefab;\r\n            }\r\n        }\r\n    }\r\n\r\n    _onDrawStart(event) {\r\n        console.log('===== start 111 ====' + event.touch.getLocation());\r\n\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n        state.touch = 'start';\r\n        state.touchesPos.push(event.touch.getLocation());\r\n        this.updateState(state);\r\n    }\r\n\r\n    _onDrawMove(event) {\r\n\r\n        this._dragging = true;\r\n        this._touchesPos.push(event.touch.getLocation());\r\n\r\n        const MIN_POINT_DISTANCE = 4;\r\n\r\n        let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n        this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n        let lastIndex = 0;\r\n        for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n            if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n                continue;\r\n            }\r\n            lastIndex = i;\r\n            this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n        }\r\n        this.graphics.stroke();\r\n    }\r\n\r\n    _onDrawEnd(event) {\r\n\r\n        this._dragging = false;\r\n\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n        state.touch = 'end';\r\n        this.updateState(state);\r\n    }\r\n\r\n    updatePlayerMove(dt) {\r\n\r\n        // this.dragSchedule();\r\n        this._gameTime++;\r\n        console.log(this._gameTime);\r\n        if (this._gameTime >= this._framesSecond * 9) {\r\n\r\n\r\n            this._playerRect.x = this._player.x - 36;\r\n            if (this._drawLineRect.intersects(this._playerRect)) {\r\n\r\n                this._moveSpeed = 6;\r\n                if (this._player.x <= this._moveMinX) {\r\n                    this._gameTime = 0;\r\n                    this.unschedule(this.updatePlayerMove);\r\n                    let state: any = globalThis._.cloneDeep(this._state);\r\n                    state.gameOver = this.gameResult.Success;\r\n                    this.updateState(state);\r\n                }\r\n\r\n            } else {\r\n\r\n                console.log('===== _player.x ====' + this._player.x);\r\n                console.log('===== _touchXMin ====' + this._touchXMin);\r\n                console.log('===== _moveMinX ====' + this._moveMinX);\r\n\r\n                console.log(this._drawLineRect);\r\n                console.log(this._playerRect);\r\n\r\n                if (this._player.x > this._touchXMin) {\r\n\r\n                    this._gameTime = 0;\r\n                    this.unschedule(this.updatePlayerMove);\r\n\r\n                    //游戏结束\r\n                    let state: any = globalThis._.cloneDeep(this._state);\r\n                    state.gameOver = this.gameResult.Fail;\r\n                    this.updateState(state);\r\n\r\n                    return;\r\n\r\n                } else if (this._player.x <= this._touchXMin && this._player.x <= this._moveMinX) {\r\n\r\n                    this._gameTime = 0;\r\n                    this.unschedule(this.updatePlayerMove);\r\n\r\n                    let state: any = globalThis._.cloneDeep(this._state);\r\n                    state.gameOver = this.gameResult.Success;\r\n                    this.updateState(state);\r\n                    return;\r\n\r\n                }\r\n\r\n\r\n\r\n            }\r\n        }\r\n\r\n        this._player.x -= 4.2 * this._moveSpeed;\r\n    }\r\n\r\n    // 排序方法\r\n    comparePos() {\r\n        return function (a, b) {\r\n            var value1 = a.x;\r\n            var value2 = b.x;\r\n            return value1 - value2;\r\n        }\r\n    }\r\n\r\n    private _clickStart(evt: any) {\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n        state.gameStart = true;\r\n        this.updateState(state);\r\n\r\n    }\r\n\r\n    private _clickSubmit(evt: any) {\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n        this.updateState(state);\r\n    }\r\n\r\n    private _clickTitle(evt: any) {\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n        state.title = true;\r\n        this.updateState(state);\r\n    }\r\n\r\n    // 临时\r\n    // 拖拽定时器\r\n    dragSchedule() {\r\n        if (this._dragging) {\r\n\r\n            console.log('==== 3333333 拖拽定时器 ======');\r\n\r\n            let state: any = globalThis._.cloneDeep(this._state);\r\n            state.touchesPos = this._touchesPos;\r\n            state.touch = \"move\";\r\n            this.updateState(state);\r\n        }\r\n    }\r\n\r\n    // 获取状态\r\n    getState(data: any) {\r\n        this.updateState(data);\r\n    }\r\n\r\n    // 更新状态层\r\n    updateState(curState: any) {\r\n        if (globalThis._.isEqual(this._state, curState)) return;\r\n        this.state = curState;\r\n    }\r\n\r\n    // 更新ui层\r\n    updateUi(oldState: any, state: any) {\r\n\r\n        if (state.touch == \"start\") {\r\n\r\n            this._touchesPos = state.touchesPos;\r\n            this.graphics.clear();\r\n            this._zhiLine.visible = false;\r\n            this._touchesPos.length = 0;\r\n\r\n        } else if (state.touch == \"move\") {\r\n\r\n            this._touchesPos = state.touchesPos;\r\n\r\n        } else if (state.touch == \"end\") {\r\n\r\n            this.graphics.clear();\r\n\r\n            if (this._touchesPos.length > 0) {\r\n\r\n                this._zhiLine.visible = true;\r\n                this._zhiLine.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n                this._zhiLine.x = this._touchesPos[0].x;\r\n                this._zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                //this._zhiLine.y = 635;\r\n                this._zhiLine.sortingOrder = 0;\r\n                this._drawLan.sortingOrder = 1;\r\n                this._drawRed.sortingOrder = 1;\r\n                this._drawLineRect.y = this._zhiLine.y;\r\n                this._drawLineRect.width = this._zhiLine.width;\r\n\r\n                // 直线 线段 左蓝射线 右红射线\r\n\r\n                this._touchesPos.sort(this.comparePos());\r\n\r\n                let tempPos0 = new cc.Vec2(this._touchesPos[0].x, this._view.height - this._touchesPos[0].y);\r\n                let tempPos1 = new cc.Vec2(this._touchesPos[this._touchesPos.length - 1].x, this._view.height - this._touchesPos[this._touchesPos.length - 1].y);\r\n\r\n                if (this._lanRect.contains(tempPos0)) {\r\n                    console.log('==== 333 ====');\r\n                    this._touchesPos[0].x = this._defaultMinX;\r\n                }\r\n                if (this._redRect.contains(tempPos1)) {\r\n                    console.log('==== 444 ====');\r\n                    this._touchesPos[this._touchesPos.length - 1].x = this._defaultMaxX;\r\n                }\r\n\r\n                this._touchXMax = this._touchesPos[this._touchesPos.length - 1].x;\r\n                this._touchXMin = this._touchesPos[0].x;\r\n\r\n                this._drawLineRect.x = this._touchesPos[0].x;\r\n                this._drawLineRect.width = this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x;\r\n\r\n            }\r\n\r\n        }\r\n\r\n\r\n        if (!globalThis._.isEqual(oldState.gameOver, state.gameOver)) {\r\n\r\n            if (state.gameOver === this.gameResult.Success) {\r\n\r\n                this.unschedule(this.updatePlayerMove);\r\n                this.rightLineFly();\r\n\r\n            } else if (state.gameOver === this.gameResult.Fail) {\r\n\r\n                this.unschedule(this.updatePlayerMove);\r\n                //重新开始\r\n                cc.tween(this._player)\r\n                    .to(0.03, { y: this._player.y + 400 })\r\n                    .call(() => {\r\n                        let state: any = globalThis._.cloneDeep(this._state);\r\n                        state.gameStart = false;\r\n                        state.gameOver = this.gameResult.No;\r\n                        this.updateState(state);\r\n\r\n                    })\r\n                    .start()\r\n            }\r\n        }\r\n\r\n        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n\r\n            if (state.submit === this.submitType.RightFeed) {\r\n\r\n                this.answerFeedback(true);\r\n\r\n            } else if (state.submit === this.submitType.WrongFeed) {\r\n\r\n                this.answerFeedback(false);\r\n\r\n            } else if (state.submit === this.submitType.GuideShow) {\r\n\r\n                let keyBtn = this._view.getChild('input1').asButton;\r\n                this.handTips2(keyBtn);\r\n            }\r\n        }\r\n\r\n        if (!globalThis._.isEqual(oldState.gameStart, state.gameStart)) {\r\n\r\n            if (state.gameStart) {\r\n\r\n                // 游戏开始\r\n                this._zhiLine.visible = false;\r\n                this.graphics.clear();\r\n                this._touchesPos.length = 0;\r\n                this._player.x = this._view.width;\r\n                this._player.y = 635;\r\n                this._moveSpeed = 1;\r\n                this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n                this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n                this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n\r\n                this.graphics.enabled = true;\r\n\r\n                this._startBtn.visible = false;\r\n                this._maskBg.visible = false;\r\n\r\n                this.schedule(this.updatePlayerMove, 0.05);\r\n\r\n            } else {\r\n\r\n                this._view.off(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n                this._view.off(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n                this._view.off(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n\r\n                this._startBtn.visible = true;\r\n                this._maskBg.visible = true;\r\n                this.graphics.enabled = false;\r\n\r\n                this._zhiLine.visible = false;\r\n                this._zhiLine.width = 0;\r\n                this.graphics.clear();\r\n                this._touchesPos.length = 0;\r\n\r\n                this.unschedule(this.updatePlayerMove);\r\n            }\r\n        }\r\n\r\n        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n            this.playTitle(state.title);\r\n        }\r\n    }\r\n\r\n    rightLineFly() {\r\n\r\n        let len = this._showLinesObj.length;\r\n\r\n        if (len >= 3) {\r\n\r\n            return;\r\n\r\n        }\r\n\r\n        this._zhiLine.visible = false;\r\n        this._drawLan.visible = false;\r\n        this._drawRed.visible = false;\r\n\r\n        let dianLeftMin = this._drawLan.x;\r\n        let dianLeftMax = this._drawLan.x + this._drawLan.width;\r\n\r\n        let dianRightMax = this._drawRed.x + this._drawRed.width;\r\n        let dianRightMin = this._drawRed.x;\r\n\r\n        let cha = 5;\r\n        let tempLineData = {};\r\n\r\n        // 1、直线\r\n        if ((this._touchesPos[0].x - dianLeftMin) < -cha && (this._touchesPos[this._touchesPos.length - 1].x - dianRightMax) > cha) {\r\n\r\n            // 直线\r\n            tempLineData['type'] = this.lineType.StraightLine\r\n\r\n        } else if (this._touchesPos[0].x >= dianLeftMin &&\r\n            this._touchesPos[0].x <= dianLeftMax && this._touchesPos[this._touchesPos.length - 1].x >= dianRightMin && this._touchesPos[this._touchesPos.length - 1].x <= dianRightMax) {\r\n\r\n            //线段\r\n            tempLineData['type'] = this.lineType.LineSegment;\r\n\r\n        } else if (this._touchesPos[0].x >= dianLeftMin &&\r\n            this._touchesPos[0].x <= dianLeftMax && (this._touchesPos[this._touchesPos.length - 1].x - dianRightMax) > cha) {\r\n\r\n            // 左蓝射线\r\n            tempLineData['type'] = this.lineType.LeftLanRays;\r\n\r\n        } else if (this._touchesPos[this._touchesPos.length - 1].x >= dianRightMin &&\r\n            this._touchesPos[this._touchesPos.length - 1].x <= dianRightMax && (this._touchesPos[0].x - dianLeftMin) < -cha) {\r\n\r\n            // 右红射线\r\n            tempLineData['type'] = this.lineType.RightRedRays;\r\n\r\n        }\r\n\r\n        this._showLines.push(tempLineData);\r\n\r\n        console.log('==== type 111 ====' + tempLineData['type']);\r\n\r\n        let lineW = Math.abs(this._touchesPos[this._touchesPos.length - 1].x - this._touchesPos[0].x);\r\n\r\n        let leftLan = null;\r\n        let rightRed = null;\r\n\r\n        let lineObj = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n        this._view.addChild(lineObj);\r\n        lineObj.width = lineW;\r\n        lineObj.x = this._touchesPos[0].x;\r\n        lineObj.y = this._touchesPos[0].y;\r\n\r\n        if (tempLineData['type'] === this.lineType.LineSegment) {\r\n\r\n            leftLan = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox27');\r\n            this._view.addChild(leftLan);\r\n            leftLan.x = this._touchesPos[0].x;\r\n            leftLan.y = this._drawLan.y;\r\n\r\n            rightRed = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox26');\r\n            this._view.addChild(rightRed);\r\n            rightRed.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n            rightRed.y = this._drawRed.y;\r\n\r\n        } else if (tempLineData['type'] === this.lineType.LeftLanRays) {\r\n\r\n            leftLan = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox27');\r\n            this._view.addChild(leftLan);\r\n            leftLan.x = this._touchesPos[0].x;\r\n            leftLan.y = this._drawLan.y;\r\n\r\n        } else if (tempLineData['type'] === this.lineType.RightRedRays) {\r\n\r\n            rightRed = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox26');\r\n            this._view.addChild(rightRed);\r\n            rightRed.x = this._touchesPos[this._touchesPos.length - 1].x;\r\n            rightRed.y = this._drawRed.y;\r\n        }\r\n\r\n        cc.tween(lineObj)\r\n            .to(0.15, { x: this._showPosArr[len].line.x, y: this._showPosArr[len].line.y })\r\n            .to(0.15, { scaleX: 0.7, scaleY: 0.7 })\r\n            .call(() => {\r\n                let state: any = globalThis._.cloneDeep(this._state);\r\n                state.gameStart = false;\r\n                state.gameOver = this.gameResult.No;\r\n                this.updateState(state);\r\n\r\n                lineObj.width = 710;\r\n                this._showLinesObj.push(lineObj);\r\n                this._zhiLine.visible = true;\r\n                this._drawLan.visible = true;\r\n                this._drawRed.visible = true;\r\n                this._zhiLine.width = 0;\r\n            })\r\n            .start()\r\n\r\n        cc.tween(leftLan)\r\n            .to(0.15, { x: this._showPosArr[len].lan.x, y: this._showPosArr[len].lan.y })\r\n            .to(0.15, { scaleX: 0.7, scaleY: 0.7 })\r\n            .start()\r\n\r\n        cc.tween(rightRed)\r\n            .to(0.15, { x: this._showPosArr[len].red.x, y: this._showPosArr[len].red.y })\r\n            .to(0.15, { scaleX: 0.7, scaleY: 0.7 })\r\n            .start()\r\n\r\n\r\n    }\r\n\r\n    async playTitle(bool: boolean) {\r\n        this._c1.selectedIndex = bool ? 1 : 0;\r\n        if (bool) {\r\n            cc.audioEngine.stopAll();\r\n            this.forbidHandle();\r\n            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n            let audioId = cc.audioEngine.play(audio, false, 1);\r\n            cc.audioEngine.setFinishCallback(audioId, () => {\r\n                let state: any = globalThis._.cloneDeep(this._state);\r\n                state.title = false;\r\n                this.updateState(state);\r\n            });\r\n        } else {\r\n            this.disableForbidHandle();\r\n        }\r\n    }\r\n\r\n    answerFeedback(bool: boolean) {\r\n        if (!this.feedback) return;\r\n        let feedback: any = cc.instantiate(this.feedback);\r\n        feedback.x = 960;\r\n        feedback.y = 540;\r\n        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n        feedbackJs.init(bool);\r\n        feedback.parent = cc.find(\"Canvas\").parent;\r\n\r\n        setTimeout(() => {\r\n            feedback.destroy();\r\n            let state: any = globalThis._.cloneDeep(this._state);\r\n            state.submit = this.submitType.No;\r\n            this.updateState(state);\r\n        }, 2000);\r\n    }\r\n\r\n\r\n    /**\r\n     * 点击指引\r\n     * @param obj 点击对象\r\n     */\r\n    handTips2(obj: fgui.GObject) {\r\n        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n        this._view.addChild(hand);\r\n        let tempX = obj.x;\r\n        let tempY = obj.y;\r\n\r\n        hand.x = tempX;\r\n        hand.y = tempY;\r\n\r\n        cc.tween(hand).to(0.3, {\r\n            x: tempX - 30,\r\n            y: tempY - 30\r\n        }).to(0.3, {\r\n            x: tempX,\r\n            y: tempY\r\n        }).to(0.3, {\r\n            x: tempX - 30,\r\n            y: tempY - 30\r\n        }).to(0.3, {\r\n            x: tempX,\r\n            y: tempY\r\n        }).call(() => {\r\n            this._view.removeChild(hand);\r\n            hand = null;\r\n            let state: any = globalThis._.cloneDeep(this._state);\r\n            state.submit = this.submitType.No;\r\n            this.updateState(state)\r\n        }).start();\r\n    }\r\n\r\n    // 运行时 禁止操作\r\n    forbidHandle() {\r\n        console.log('===  运行时 禁止操作 =====');\r\n        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n        if (!handleMask) {\r\n            let handleMask = new cc.Node('handleMask');\r\n            handleMask.addComponent(cc.BlockInputEvents);\r\n            handleMask.parent = this._worldRoot;\r\n            handleMask.width = 1920;\r\n            handleMask.height = 1080;\r\n            handleMask.x = 960;\r\n            handleMask.y = 540;\r\n        }\r\n    }\r\n\r\n    // 消除禁止\r\n    disableForbidHandle() {\r\n        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n        if (handleMask) handleMask.destroy();\r\n    }\r\n\r\n    // 注册状态，及获取状态的方法\r\n    registerState() {\r\n        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n    }\r\n\r\n    // 解除状态，及获取状态的方法\r\n    relieveState() {\r\n        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n    }\r\n\r\n    // 本组件状态合并到全局\r\n    mergeState() {\r\n        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n    }\r\n\r\n    onEnable() {\r\n        this.registerState();\r\n        // this.schedule(this.dragSchedule, this._scheduleTime);\r\n    }\r\n\r\n    onDisable() {\r\n        this.relieveState();\r\n        cc.audioEngine.stopAll();\r\n    }\r\n}\r\n"
        }
    ]
}