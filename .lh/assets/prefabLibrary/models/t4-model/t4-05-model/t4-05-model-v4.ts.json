{
    "sourceFile": "assets/prefabLibrary/models/t4-model/t4-05-model/t4-05-model-v4.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 244,
            "patches": [
                {
                    "date": 1625136082123,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1625405723126,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,9 +10,9 @@\n const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n const { ccclass, property } = cc._decorator;\r\n \r\n @ccclass\r\n-export default class t4_05_model_v4 extends cc.Component {\r\n+export default class t4_05_model_v3 extends cc.Component {\r\n     private _worldRoot: cc.Node;\r\n \r\n     private _view: fgui.GComponent;\r\n \r\n@@ -27,18 +27,24 @@\n     private _resetBtn: fgui.GButton;\r\n \r\n     private _package: any;\r\n \r\n-    private _touchesPos: any = [];\r\n+    private _curTouchesPos: any = [];\r\n \r\n     private _moveCurPos: cc.Vec2;\r\n \r\n     private graphics: cc.Graphics = null;\r\n \r\n     private _dragging = false;\r\n \r\n-    private _scheduleTime = 0.03;\r\n+    private _scheduleTime = 0.08;\r\n \r\n+    private _allTouchLinesObj = {};\r\n+\r\n+    private _allOtherTouchLinesObj = {};\r\n+\r\n+    private _allPointRect = [];\r\n+\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n@@ -78,8 +84,40 @@\n             this._c1.selectedIndex = 1;\r\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n+        this._allPointRect = [{\r\n+            'rect': new cc.Rect(610, 614, 80, 80),\r\n+            'isContains': false,\r\n+            'minx': 610,\r\n+            'maxx': 690,\r\n+            'miny': 614,\r\n+            'maxy': 694,\r\n+            'limitMinx': false,\r\n+            'limitMaxy': false,\r\n+            'isPointInner': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n+            'limitMaxx': false,\r\n+            'isPointInner': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n+            'limitMaxx': false,\r\n+            'isPointInner': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(611, 242, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n+            'limitMiny': false,\r\n+            'isPointInner': false,\r\n+        }\r\n+        ];\r\n+\r\n+        // let tt1 = new cc.Vec2(1247, 282);\r\n+        // let tt2 = new cc.Vec2(652, 655);\r\n+        // console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n+\r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n         this._title = this._view.getChild(\"title\").asButton;\r\n@@ -106,11 +144,13 @@\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n-            touch: \"end\",\r\n+            touch: \"no\",\r\n             reset: false,\r\n-            touchesPos: [],\r\n+            curTouchesPos: cc.Vec2,\r\n+            allTouchLinesPos: {},\r\n+            allOtherTouchLinesPos: [],\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n@@ -136,12 +176,14 @@\n     _onDrawStart(event) {\r\n         console.log('===== start 111 ====' + event.touch.getLocation());\r\n \r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.touch = 'start';\r\n-        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-        state.touchesPos.push(tempPos);\r\n-        this.updateState(state);\r\n+        if (state.touch === 'no') {\r\n+            state.touch = 'start';\r\n+            let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+            state.curTouchesPos = tempPos;\r\n+            this.updateState(state);\r\n+        }\r\n     }\r\n \r\n     _onDrawMove(event) {\r\n \r\n@@ -152,32 +194,66 @@\n     _onDrawEnd(event) {\r\n \r\n         this._dragging = false;\r\n \r\n+        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.curTouchesPos = tempPos;\r\n         state.touch = 'end';\r\n         this.updateState(state);\r\n     }\r\n \r\n \r\n     // 排序方法\r\n-    comparePos() {\r\n+    comparePosX() {\r\n         return function (a, b) {\r\n             var value1 = a.x;\r\n             var value2 = b.x;\r\n             return value1 - value2;\r\n         }\r\n     }\r\n \r\n+    // 排序方法\r\n+    comparePosY() {\r\n+        return function (a, b) {\r\n+            var value1 = a.y;\r\n+            var value2 = b.y;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n     private _clickReset(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.reset = true;\r\n         this.updateState(state);\r\n \r\n     }\r\n \r\n     private _clickSubmit(evt: any) {\r\n+\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n+\r\n+        if (Object.keys(state.allTouchLinesPos).length === 0) {\r\n+\r\n+            state.submit = this.submitType.GuideShow;\r\n+\r\n+        } else {\r\n+\r\n+            let isAllRight = true;\r\n+            for (let key in state.allTouchLinesPos) {\r\n+\r\n+                if (!state.allTouchLinesPos[key].result) {\r\n+                    isAllRight = false;\r\n+                    break;\r\n+                }\r\n+            }\r\n+            if (isAllRight) {\r\n+                state.submit = this.submitType.RightFeed;\r\n+            } else {\r\n+                state.submit = this.submitType.WrongFeed;\r\n+            }\r\n+        }\r\n+\r\n         this.updateState(state);\r\n     }\r\n \r\n     private _clickTitle(evt: any) {\r\n@@ -192,9 +268,9 @@\n         if (this._dragging) {\r\n \r\n             console.log('==== 3333333 拖拽定时器 ======');\r\n             let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.touchesPos.push(this._moveCurPos);\r\n+            state.curTouchesPos = this._moveCurPos;\r\n             state.touch = \"move\";\r\n             this.updateState(state);\r\n         }\r\n     }\r\n@@ -214,56 +290,429 @@\n     updateUi(oldState: any, state: any) {\r\n \r\n         if (state.touch == \"start\") {\r\n \r\n-            this._touchesPos = state.touchesPos;\r\n+            this._curTouchesPos.length = 0;\r\n+            this._curTouchesPos.push(state.curTouchesPos);\r\n             this.graphics.clear();\r\n-            this._touchesPos.length = 0;\r\n \r\n         } else if (state.touch == \"move\") {\r\n \r\n-            this._touchesPos = state.touchesPos;\r\n+            this._curTouchesPos.push(state.curTouchesPos);\r\n+\r\n             const MIN_POINT_DISTANCE = 4;\r\n \r\n             let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n-            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n+            this.graphics.moveTo(this._curTouchesPos[0].x - worldPos.x, this._curTouchesPos[0].y - worldPos.y);\r\n             let lastIndex = 0;\r\n-            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n-                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n+            for (let i = 1, l = this._curTouchesPos.length; i < l; i++) {\r\n+                if (this._curTouchesPos[i].sub(this._curTouchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n                     continue;\r\n                 }\r\n                 lastIndex = i;\r\n-                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n+                this.graphics.lineTo(this._curTouchesPos[i].x - worldPos.x, this._curTouchesPos[i].y - worldPos.y);\r\n             }\r\n             this.graphics.stroke();\r\n \r\n         } else if (state.touch == \"end\") {\r\n \r\n+            this._curTouchesPos.push(state.curTouchesPos);\r\n+\r\n             this.graphics.clear();\r\n+            if (this._curTouchesPos.length > 0) {\r\n \r\n-            if (this._touchesPos.length > 0) {\r\n+                for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n \r\n-                let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n+                    this._curTouchesPos[i].y = this._view.height - this._curTouchesPos[i].y;\r\n+                }\r\n \r\n-                console.log('===== angle 999999 === ' + angle);\r\n+                let tempArrX = [];\r\n+                tempArrX = this._curTouchesPos;\r\n+                tempArrX.sort(this.comparePosX());\r\n \r\n+                let tempArrY = [];\r\n+                tempArrY = this._curTouchesPos;\r\n+                tempArrY.sort(this.comparePosY());\r\n+\r\n+                var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n+                var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n+                let isSortY = false;\r\n+\r\n+                let isValid = true;\r\n+                if (chaX > 400) {\r\n+\r\n+                    console.log('==== sort chaX ====');\r\n+                    this._curTouchesPos.sort(this.comparePosX());\r\n+                    console.log(this._curTouchesPos);\r\n+                } else if (chaX < 150 && chaY > 200) {\r\n+                    isSortY = true;\r\n+                    console.log('==== sort chaY ====');\r\n+                    this._curTouchesPos.sort(this.comparePosY());\r\n+                    console.log(this._curTouchesPos);\r\n+\r\n+                } else {\r\n+                    isValid = false;\r\n+                }\r\n+\r\n+                console.log('====== chaX ======' + chaX);\r\n+                console.log('====== chaY ======' + chaY);\r\n+\r\n+                if (isValid) {\r\n+\r\n+                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                        this._allPointRect[i].isContains = false;\r\n+                    }\r\n+\r\n+                    let pointNums = 0;\r\n+                    for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n+\r\n+                        for (let j = 0; j < this._allPointRect.length; j++) {\r\n+\r\n+                            if (this._allPointRect[j].rect.contains(this._curTouchesPos[i])) {\r\n+                                this._allPointRect[j].isContains = true;\r\n+\r\n+                                break;\r\n+                            }\r\n+                        }\r\n+                    }\r\n+                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                        if (this._allPointRect[i].isContains) {\r\n+                            pointNums++;\r\n+                            continue;\r\n+                        }\r\n+                    }\r\n+                    console.log('===== 5555 =====' + pointNums);\r\n+\r\n+                    if (pointNums >= 2) {\r\n+\r\n+                        for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                            if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n+                                this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n+                                this._allPointRect[i].isPointInner = true;\r\n+                            }\r\n+\r\n+                            if (i === 0 && this._allPointRect[i].isContains) {\r\n+\r\n+                                if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n+\r\n+                                    this._allPointRect[i].limitMinx = true;\r\n+                                }\r\n+                                if (this._curTouchesPos[this._curTouchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n+\r\n+                                    this._allPointRect[i].limitMaxy = true;\r\n+                                }\r\n+\r\n+                            } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n+\r\n+                                if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n+\r\n+                                    this._allPointRect[i].limitMaxx = true;\r\n+                                }\r\n+\r\n+                            } else if (i === 3 && this._allPointRect[i].isContains) {\r\n+\r\n+                                if (this._curTouchesPos[0].y < this._allPointRect[i].miny) {\r\n+\r\n+                                    this._allPointRect[i].limitMiny = true;\r\n+                                }\r\n+                            }\r\n+                        }\r\n+\r\n+                        let temp = { 'isSortY': isSortY };\r\n+                        if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n+\r\n+                            if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+\r\n+                                // 直线\r\n+                                temp['QiX'] = 652;\r\n+                                temp['QiY'] = 655;\r\n+                                temp['angle'] = 0;\r\n+                                temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                                temp['chaoInterQiY'] = 0;\r\n+                                temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                                temp['result'] = true;\r\n+                                state.allTouchLinesPos['line1'] = temp;\r\n+\r\n+\r\n+                            } else if (this._allPointRect[0].limitMinx && !this._allPointRect[1].limitMaxx) {\r\n+\r\n+                                // 左点超出射线\r\n+                                let pointMidChang = 593;\r\n+\r\n+                                temp['QiX'] = 652;\r\n+                                temp['QiY'] = 655;\r\n+                                temp['angle'] = 0;\r\n+                                temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                                temp['chaoInterQiY'] = 0;\r\n+                                temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n+                                temp['result'] = false;\r\n+                                state.allTouchLinesPos['line1'] = temp;\r\n+\r\n+                            } else if (!this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+\r\n+                                // 右点超出的射线\r\n+                                let pointMaxX = 1245;\r\n+                                let pointMidChang = 593;\r\n+\r\n+                                temp['QiX'] = 652;\r\n+                                temp['QiY'] = 655;\r\n+                                temp['angle'] = 0;\r\n+                                temp['chaoInterQiX'] = 0;\r\n+                                temp['chaoInterQiY'] = 0;\r\n+                                temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n+                                temp['result'] = false;\r\n+                                state.allTouchLinesPos['line1'] = temp;\r\n+\r\n+                            } else if (this._allPointRect[0].isPointInner && this._allPointRect[1].isPointInner) {\r\n+\r\n+                                //线段\r\n+                                let pointMidChang = 593;\r\n+                                temp['QiX'] = 652;\r\n+                                temp['QiY'] = 655;\r\n+                                temp['angle'] = 0;\r\n+                                temp['chaoInterQiX'] = 0;\r\n+                                temp['chaoInterQiY'] = 0;\r\n+                                temp['chang'] = pointMidChang;\r\n+                                temp['result'] = false;\r\n+                                state.allTouchLinesPos['line1'] = temp;\r\n+                            }\r\n+\r\n+                        } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains) {\r\n+\r\n+                            if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+\r\n+                                // 直线\r\n+                                temp['QiX'] = 652;\r\n+                                temp['QiY'] = 655;\r\n+                                temp['angle'] = -32;\r\n+                                temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                                temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);\r\n+                                temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                                temp['result'] = true;\r\n+                                state.allTouchLinesPos['line2'] = temp;\r\n+\r\n+                            } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n+\r\n+                                // 左点超出射线\r\n+                                let pointMidChang = 702;\r\n+\r\n+                                temp['QiX'] = 652;\r\n+                                temp['QiY'] = 655;\r\n+                                temp['angle'] = -32;\r\n+                                temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                                temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);;\r\n+                                temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n+                                temp['result'] = false;\r\n+                                state.allTouchLinesPos['line2'] = temp;\r\n+\r\n+                            } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+\r\n+                                // 右点超出的射线\r\n+                                let pointMaxX = 1245;\r\n+                                let pointMidChang = 702;\r\n+\r\n+                                temp['QiX'] = 652;\r\n+                                temp['QiY'] = 655;\r\n+                                temp['angle'] = -32;\r\n+                                temp['chaoInterQiX'] = 0;\r\n+                                temp['chaoInterQiY'] = 0;\r\n+                                temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n+                                temp['result'] = false;\r\n+                                state.allTouchLinesPos['line2'] = temp;\r\n+\r\n+                            } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n+\r\n+                                //线段\r\n+                                let pointMidChang = 702;\r\n+                                temp['QiX'] = 652;\r\n+                                temp['QiY'] = 655;\r\n+                                temp['angle'] = -32;\r\n+                                temp['chaoInterQiX'] = 0;\r\n+                                temp['chaoInterQiY'] = 0;\r\n+                                temp['chang'] = pointMidChang;\r\n+                                temp['result'] = false;\r\n+                                state.allTouchLinesPos['line2'] = temp;\r\n+                            }\r\n+\r\n+                        } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains) {\r\n+\r\n+                            if (this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+\r\n+                                // 直线\r\n+                                temp['QiX'] = 652;\r\n+                                temp['QiY'] = 655;\r\n+                                temp['angle'] = -90;\r\n+                                temp['chaoInterQiX'] = 0;\r\n+                                temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n+                                temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                                temp['result'] = true;\r\n+                                state.allTouchLinesPos['line3'] = temp;\r\n+\r\n+                            } else if (this._allPointRect[0].limitMaxy && !this._allPointRect[3].limitMiny) {\r\n+\r\n+                                // 下点超出射线\r\n+                                let pointMidChang = 372;\r\n+\r\n+                                temp['QiX'] = 652;\r\n+                                temp['QiY'] = 655;\r\n+                                temp['angle'] = -90;\r\n+                                temp['chaoInterQiX'] = 0;\r\n+                                temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n+                                temp['chang'] = pointMidChang + temp['chaoInterQiY'];\r\n+                                temp['result'] = false;\r\n+                                state.allTouchLinesPos['line3'] = temp;\r\n+\r\n+                            } else if (!this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+\r\n+                                // 上点超出的射线\r\n+                                let pointMinY = 283;\r\n+                                let pointMidChang = 372;\r\n+\r\n+                                temp['QiX'] = 652;\r\n+                                temp['QiY'] = 655;\r\n+                                temp['angle'] = -90;\r\n+\r\n+                                temp['chaoInterQiX'] = 0;\r\n+                                temp['chaoInterQiY'] = 0;\r\n+                                temp['chang'] = pointMidChang + (pointMinY - this._curTouchesPos[0].y);\r\n+                                temp['result'] = false;\r\n+                                state.allTouchLinesPos['line3'] = temp;\r\n+\r\n+                            } else if (this._allPointRect[0].isPointInner && this._allPointRect[3].isPointInner) {\r\n+\r\n+                                //线段\r\n+                                let pointMidChang = 372;\r\n+                                temp['QiX'] = 652;\r\n+                                temp['QiY'] = 655;\r\n+                                temp['angle'] = -90;\r\n+\r\n+                                temp['chaoInterQiX'] = 0;\r\n+                                temp['chaoInterQiY'] = 0;\r\n+                                temp['chang'] = pointMidChang;\r\n+                                temp['result'] = false;\r\n+                                state.allTouchLinesPos['line3'] = temp;\r\n+                            }\r\n+                        } else {\r\n+\r\n+                            temp['QiX'] = this._curTouchesPos[0].x;\r\n+                            temp['QiY'] = this._curTouchesPos[0].y;\r\n+                            if (isSortY) {\r\n+                                temp['angle'] = -this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n+                            } else {\r\n+                                temp['angle'] = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n+                            }\r\n+\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();;\r\n+                            temp['result'] = false;\r\n+                            state.allOtherTouchLinesPos.push(temp);\r\n+                        }\r\n+                    }\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state1: any = globalThis._.cloneDeep(this._state);\r\n+                    state1.touch = 'no';\r\n+                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n+                    state1.allOtherTouchLinesPos = state.allOtherTouchLinesPos;\r\n+                    this.updateState(state1);\r\n+\r\n+                }, 20);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.allOtherTouchLinesPos, state.allOtherTouchLinesPos)) {\r\n+\r\n+            for (let key in this._allOtherTouchLinesObj) {\r\n+                this._allOtherTouchLinesObj[key].removeFromParent();\r\n+            }\r\n+\r\n+            for (let i = 0; i < state.allOtherTouchLinesPos.length; i++) {\r\n+\r\n+                let temp = state.allOtherTouchLinesPos[i];\r\n                 let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                 this._view.addChild(zhiLine);\r\n-                zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n-                zhiLine.x = this._touchesPos[0].x;\r\n-                zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n-                zhiLine.rotation = -angle;\r\n+                zhiLine.width = temp['chang'];\r\n \r\n-                zhiLine.sortingOrder = 0;\r\n+                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n+                if (temp.isSortY) {\r\n \r\n-                this._touchesPos.sort(this.comparePos());\r\n+                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n \r\n+                } else {\r\n \r\n+                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n+                }\r\n+\r\n+                zhiLine.rotation = temp.angle;\r\n+                this._allOtherTouchLinesObj[i] = zhiLine;\r\n             }\r\n \r\n         }\r\n \r\n+        if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n+            for (let key in this._allTouchLinesObj) {\r\n+                this._allTouchLinesObj[key].removeFromParent();\r\n+            }\r\n+\r\n+            for (let key in state.allTouchLinesPos) {\r\n+\r\n+                let temp = state.allTouchLinesPos[key];\r\n+                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                this._view.addChild(zhiLine);\r\n+                zhiLine.width = temp['chang'];\r\n+\r\n+                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n+                if (temp.isSortY) {\r\n+\r\n+                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n+\r\n+                } else {\r\n+\r\n+                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n+                }\r\n+\r\n+                zhiLine.rotation = temp.angle;\r\n+                this._allTouchLinesObj[key] = zhiLine;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.reset, state.reset)) {\r\n+\r\n+            if (state.reset) {\r\n+\r\n+                for (let key in state.allTouchLinesPos) {\r\n+                    delete state.allTouchLinesPos[key];\r\n+                }\r\n+\r\n+                for (let key in this._allTouchLinesObj) {\r\n+                    this._allTouchLinesObj[key].removeFromParent();\r\n+                }\r\n+\r\n+                for (let key in this._allOtherTouchLinesObj) {\r\n+                    this._allOtherTouchLinesObj[key].removeFromParent();\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state1: any = globalThis._.cloneDeep(this._state);\r\n+                    state1.reset = false;\r\n+                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n+                    state1.allOtherTouchLinesPos = [];\r\n+                    this.updateState(state1);\r\n+\r\n+                }, 10);\r\n+\r\n+            }\r\n+\r\n+        }\r\n+\r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n             if (state.submit === this.submitType.RightFeed) {\r\n \r\n@@ -274,14 +723,13 @@\n                 this.answerFeedback(false);\r\n \r\n             } else if (state.submit === this.submitType.GuideShow) {\r\n \r\n-                let keyBtn = this._view.getChild('input1').asButton;\r\n-                this.handTips2(keyBtn);\r\n+                // let keyBtn = this._view.getChild('input1').asButton;\r\n+                // this.handTips2(keyBtn);\r\n             }\r\n         }\r\n \r\n-\r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n             this.playTitle(state.title);\r\n         }\r\n     }\r\n"
                },
                {
                    "date": 1625405787753,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,10 +39,8 @@\n     private _scheduleTime = 0.08;\r\n \r\n     private _allTouchLinesObj = {};\r\n \r\n-    private _allOtherTouchLinesObj = {};\r\n-\r\n     private _allPointRect = [];\r\n \r\n     private submitType: any = cc.Enum({\r\n \r\n@@ -147,10 +145,9 @@\n             submit: this.submitType.No,\r\n             touch: \"no\",\r\n             reset: false,\r\n             curTouchesPos: cc.Vec2,\r\n-            allTouchLinesPos: {},\r\n-            allOtherTouchLinesPos: [],\r\n+            allTouchLinesPos: {}\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n@@ -624,37 +621,8 @@\n                 }, 20);\r\n             }\r\n         }\r\n \r\n-        if (!globalThis._.isEqual(oldState.allOtherTouchLinesPos, state.allOtherTouchLinesPos)) {\r\n-\r\n-            for (let key in this._allOtherTouchLinesObj) {\r\n-                this._allOtherTouchLinesObj[key].removeFromParent();\r\n-            }\r\n-\r\n-            for (let i = 0; i < state.allOtherTouchLinesPos.length; i++) {\r\n-\r\n-                let temp = state.allOtherTouchLinesPos[i];\r\n-                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                this._view.addChild(zhiLine);\r\n-                zhiLine.width = temp['chang'];\r\n-\r\n-                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                if (temp.isSortY) {\r\n-\r\n-                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n-\r\n-                } else {\r\n-\r\n-                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n-                }\r\n-\r\n-                zhiLine.rotation = temp.angle;\r\n-                this._allOtherTouchLinesObj[i] = zhiLine;\r\n-            }\r\n-\r\n-        }\r\n-\r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n             for (let key in this._allTouchLinesObj) {\r\n                 this._allTouchLinesObj[key].removeFromParent();\r\n@@ -693,18 +661,13 @@\n                 for (let key in this._allTouchLinesObj) {\r\n                     this._allTouchLinesObj[key].removeFromParent();\r\n                 }\r\n \r\n-                for (let key in this._allOtherTouchLinesObj) {\r\n-                    this._allOtherTouchLinesObj[key].removeFromParent();\r\n-                }\r\n-\r\n                 setTimeout(() => {\r\n \r\n                     let state1: any = globalThis._.cloneDeep(this._state);\r\n                     state1.reset = false;\r\n                     state1.allTouchLinesPos = state.allTouchLinesPos;\r\n-                    state1.allOtherTouchLinesPos = [];\r\n                     this.updateState(state1);\r\n \r\n                 }, 10);\r\n \r\n"
                },
                {
                    "date": 1625405815700,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,8 +39,10 @@\n     private _scheduleTime = 0.08;\r\n \r\n     private _allTouchLinesObj = {};\r\n \r\n+    private _allOtherTouchLinesObj = {};\r\n+\r\n     private _allPointRect = [];\r\n \r\n     private submitType: any = cc.Enum({\r\n \r\n@@ -145,9 +147,10 @@\n             submit: this.submitType.No,\r\n             touch: \"no\",\r\n             reset: false,\r\n             curTouchesPos: cc.Vec2,\r\n-            allTouchLinesPos: {}\r\n+            allTouchLinesPos: {},\r\n+            allOtherTouchLinesPos: [],\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n@@ -621,8 +624,37 @@\n                 }, 20);\r\n             }\r\n         }\r\n \r\n+        if (!globalThis._.isEqual(oldState.allOtherTouchLinesPos, state.allOtherTouchLinesPos)) {\r\n+\r\n+            for (let key in this._allOtherTouchLinesObj) {\r\n+                this._allOtherTouchLinesObj[key].removeFromParent();\r\n+            }\r\n+\r\n+            for (let i = 0; i < state.allOtherTouchLinesPos.length; i++) {\r\n+\r\n+                let temp = state.allOtherTouchLinesPos[i];\r\n+                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                this._view.addChild(zhiLine);\r\n+                zhiLine.width = temp['chang'];\r\n+\r\n+                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n+                if (temp.isSortY) {\r\n+\r\n+                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n+\r\n+                } else {\r\n+\r\n+                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n+                }\r\n+\r\n+                zhiLine.rotation = temp.angle;\r\n+                this._allOtherTouchLinesObj[i] = zhiLine;\r\n+            }\r\n+\r\n+        }\r\n+\r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n             for (let key in this._allTouchLinesObj) {\r\n                 this._allTouchLinesObj[key].removeFromParent();\r\n@@ -661,13 +693,18 @@\n                 for (let key in this._allTouchLinesObj) {\r\n                     this._allTouchLinesObj[key].removeFromParent();\r\n                 }\r\n \r\n+                for (let key in this._allOtherTouchLinesObj) {\r\n+                    this._allOtherTouchLinesObj[key].removeFromParent();\r\n+                }\r\n+\r\n                 setTimeout(() => {\r\n \r\n                     let state1: any = globalThis._.cloneDeep(this._state);\r\n                     state1.reset = false;\r\n                     state1.allTouchLinesPos = state.allTouchLinesPos;\r\n+                    state1.allOtherTouchLinesPos = [];\r\n                     this.updateState(state1);\r\n \r\n                 }, 10);\r\n \r\n"
                },
                {
                    "date": 1625405890591,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -85,9 +85,9 @@\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n         this._allPointRect = [{\r\n-            'rect': new cc.Rect(610, 614, 80, 80),\r\n+            'rect': new cc.Rect(764, 590, 71, 71),\r\n             'isContains': false,\r\n             'minx': 610,\r\n             'maxx': 690,\r\n             'miny': 614,\r\n"
                },
                {
                    "date": 1625405916424,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -87,10 +87,10 @@\n \r\n         this._allPointRect = [{\r\n             'rect': new cc.Rect(764, 590, 71, 71),\r\n             'isContains': false,\r\n-            'minx': 610,\r\n-            'maxx': 690,\r\n+            'minx': 764,\r\n+            'maxx': 835,\r\n             'miny': 614,\r\n             'maxy': 694,\r\n             'limitMinx': false,\r\n             'limitMaxy': false,\r\n"
                },
                {
                    "date": 1625405929663,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -89,9 +89,9 @@\n             'rect': new cc.Rect(764, 590, 71, 71),\r\n             'isContains': false,\r\n             'minx': 764,\r\n             'maxx': 835,\r\n-            'miny': 614,\r\n+            'miny': 590,\r\n             'maxy': 694,\r\n             'limitMinx': false,\r\n             'limitMaxy': false,\r\n             'isPointInner': false,\r\n"
                },
                {
                    "date": 1625405942370,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,9 +90,9 @@\n             'isContains': false,\r\n             'minx': 764,\r\n             'maxx': 835,\r\n             'miny': 590,\r\n-            'maxy': 694,\r\n+            'maxy': 661,\r\n             'limitMinx': false,\r\n             'limitMaxy': false,\r\n             'isPointInner': false,\r\n         },\r\n"
                },
                {
                    "date": 1625406041733,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -96,9 +96,9 @@\n             'limitMaxy': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(1204, 610, 80, 80), 'isContains': false, 'minx': 1204, 'maxx': 1284, 'miny': 610, 'maxy': 690,\r\n+            'rect': new cc.Rect(1060, 590, 71, 71), 'isContains': false, 'minx': 1060, 'maxx': 1131, 'miny': 610, 'maxy': 690,\r\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n"
                },
                {
                    "date": 1625406051966,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -96,9 +96,9 @@\n             'limitMaxy': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(1060, 590, 71, 71), 'isContains': false, 'minx': 1060, 'maxx': 1131, 'miny': 610, 'maxy': 690,\r\n+            'rect': new cc.Rect(1060, 590, 71, 71), 'isContains': false, 'minx': 1060, 'maxx': 1131, 'miny': 590, 'maxy': 690,\r\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n"
                },
                {
                    "date": 1625406060158,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -96,9 +96,9 @@\n             'limitMaxy': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(1060, 590, 71, 71), 'isContains': false, 'minx': 1060, 'maxx': 1131, 'miny': 590, 'maxy': 690,\r\n+            'rect': new cc.Rect(1060, 590, 71, 71), 'isContains': false, 'minx': 1060, 'maxx': 1131, 'miny': 590, 'maxy': 661,\r\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n"
                },
                {
                    "date": 1625406091218,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -101,9 +101,9 @@\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(1205, 240, 80, 80), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n+            'rect': new cc.Rect(907, 368, 71, 71), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n"
                },
                {
                    "date": 1625406109080,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -101,9 +101,9 @@\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(907, 368, 71, 71), 'isContains': false, 'minx': 1205, 'maxx': 1285, 'miny': 240, 'maxy': 320,\r\n+            'rect': new cc.Rect(907, 368, 71, 71), 'isContains': false, 'minx': 907, 'maxx': 978, 'miny': 240, 'maxy': 320,\r\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n"
                },
                {
                    "date": 1625406123196,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -101,9 +101,9 @@\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(907, 368, 71, 71), 'isContains': false, 'minx': 907, 'maxx': 978, 'miny': 240, 'maxy': 320,\r\n+            'rect': new cc.Rect(907, 368, 71, 71), 'isContains': false, 'minx': 907, 'maxx': 978, 'miny': 368, 'maxy': 320,\r\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n"
                },
                {
                    "date": 1625406143481,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -101,9 +101,9 @@\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(907, 368, 71, 71), 'isContains': false, 'minx': 907, 'maxx': 978, 'miny': 368, 'maxy': 320,\r\n+            'rect': new cc.Rect(907, 368, 71, 71), 'isContains': false, 'minx': 907, 'maxx': 978, 'miny': 368, 'maxy': 439,\r\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n"
                },
                {
                    "date": 1625406151528,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -104,13 +104,8 @@\n         {\r\n             'rect': new cc.Rect(907, 368, 71, 71), 'isContains': false, 'minx': 907, 'maxx': 978, 'miny': 368, 'maxy': 439,\r\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(611, 242, 80, 80), 'isContains': false, 'minx': 610, 'maxx': 690, 'miny': 240, 'maxy': 320,\r\n-            'limitMiny': false,\r\n-            'isPointInner': false,\r\n         }\r\n         ];\r\n \r\n         // let tt1 = new cc.Vec2(1247, 282);\r\n"
                },
                {
                    "date": 1625406284942,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -334,17 +334,11 @@\n \r\n                 let isValid = true;\r\n                 if (chaX > 400) {\r\n \r\n-                    console.log('==== sort chaX ====');\r\n                     this._curTouchesPos.sort(this.comparePosX());\r\n+\r\n                     console.log(this._curTouchesPos);\r\n-                } else if (chaX < 150 && chaY > 200) {\r\n-                    isSortY = true;\r\n-                    console.log('==== sort chaY ====');\r\n-                    this._curTouchesPos.sort(this.comparePosY());\r\n-                    console.log(this._curTouchesPos);\r\n-\r\n                 } else {\r\n                     isValid = false;\r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625406369991,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -332,9 +332,9 @@\n                 var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n                 let isSortY = false;\r\n \r\n                 let isValid = true;\r\n-                if (chaX > 400) {\r\n+                if (chaX > 200) {\r\n \r\n                     this._curTouchesPos.sort(this.comparePosX());\r\n \r\n                     console.log(this._curTouchesPos);\r\n"
                },
                {
                    "date": 1625406375373,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -332,9 +332,9 @@\n                 var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n                 let isSortY = false;\r\n \r\n                 let isValid = true;\r\n-                if (chaX > 200) {\r\n+                if (chaX > 200 || ) {\r\n \r\n                     this._curTouchesPos.sort(this.comparePosX());\r\n \r\n                     console.log(this._curTouchesPos);\r\n"
                },
                {
                    "date": 1625406382320,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -332,9 +332,9 @@\n                 var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n                 let isSortY = false;\r\n \r\n                 let isValid = true;\r\n-                if (chaX > 200 || ) {\r\n+                if (chaX > 200 || chaY > 200) {\r\n \r\n                     this._curTouchesPos.sort(this.comparePosX());\r\n \r\n                     console.log(this._curTouchesPos);\r\n"
                },
                {
                    "date": 1625406394873,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -337,8 +337,9 @@\n \r\n                     this._curTouchesPos.sort(this.comparePosX());\r\n \r\n                     console.log(this._curTouchesPos);\r\n+\r\n                 } else {\r\n                     isValid = false;\r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625406401968,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -336,10 +336,8 @@\n                 if (chaX > 200 || chaY > 200) {\r\n \r\n                     this._curTouchesPos.sort(this.comparePosX());\r\n \r\n-                    console.log(this._curTouchesPos);\r\n-\r\n                 } else {\r\n                     isValid = false;\r\n                 }\r\n \r\n"
                },
                {
                    "date": 1625406454190,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -331,518 +331,505 @@\n                 var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n                 var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n                 let isSortY = false;\r\n \r\n-                let isValid = true;\r\n-                if (chaX > 200 || chaY > 200) {\r\n+                console.log('====== chaX ======' + chaX);\r\n+                console.log('====== chaY ======' + chaY);\r\n \r\n-                    this._curTouchesPos.sort(this.comparePosX());\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                } else {\r\n-                    isValid = false;\r\n+                    this._allPointRect[i].isContains = false;\r\n                 }\r\n \r\n-                console.log('====== chaX ======' + chaX);\r\n-                console.log('====== chaY ======' + chaY);\r\n+                let pointNums = 0;\r\n+                for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n \r\n-                if (isValid) {\r\n+                    for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n-                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+                        if (this._allPointRect[j].rect.contains(this._curTouchesPos[i])) {\r\n+                            this._allPointRect[j].isContains = true;\r\n \r\n-                        this._allPointRect[i].isContains = false;\r\n+                            break;\r\n+                        }\r\n                     }\r\n+                }\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                    let pointNums = 0;\r\n-                    for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n+                    if (this._allPointRect[i].isContains) {\r\n+                        pointNums++;\r\n+                        continue;\r\n+                    }\r\n+                }\r\n+                console.log('===== 5555 =====' + pointNums);\r\n \r\n-                        for (let j = 0; j < this._allPointRect.length; j++) {\r\n+                if (pointNums >= 2) {\r\n \r\n-                            if (this._allPointRect[j].rect.contains(this._curTouchesPos[i])) {\r\n-                                this._allPointRect[j].isContains = true;\r\n-\r\n-                                break;\r\n-                            }\r\n-                        }\r\n-                    }\r\n                     for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                        if (this._allPointRect[i].isContains) {\r\n-                            pointNums++;\r\n-                            continue;\r\n+                        if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n+                            this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n+                            this._allPointRect[i].isPointInner = true;\r\n                         }\r\n-                    }\r\n-                    console.log('===== 5555 =====' + pointNums);\r\n \r\n-                    if (pointNums >= 2) {\r\n+                        if (i === 0 && this._allPointRect[i].isContains) {\r\n \r\n-                        for (let i = 0; i < this._allPointRect.length; i++) {\r\n+                            if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n-                            if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n-                                this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n-                                this._allPointRect[i].isPointInner = true;\r\n+                                this._allPointRect[i].limitMinx = true;\r\n                             }\r\n+                            if (this._curTouchesPos[this._curTouchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n \r\n-                            if (i === 0 && this._allPointRect[i].isContains) {\r\n+                                this._allPointRect[i].limitMaxy = true;\r\n+                            }\r\n \r\n-                                if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n+                        } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n \r\n-                                    this._allPointRect[i].limitMinx = true;\r\n-                                }\r\n-                                if (this._curTouchesPos[this._curTouchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n+                            if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n-                                    this._allPointRect[i].limitMaxy = true;\r\n-                                }\r\n+                                this._allPointRect[i].limitMaxx = true;\r\n+                            }\r\n \r\n-                            } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n+                        } else if (i === 3 && this._allPointRect[i].isContains) {\r\n \r\n-                                if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n+                            if (this._curTouchesPos[0].y < this._allPointRect[i].miny) {\r\n \r\n-                                    this._allPointRect[i].limitMaxx = true;\r\n-                                }\r\n-\r\n-                            } else if (i === 3 && this._allPointRect[i].isContains) {\r\n-\r\n-                                if (this._curTouchesPos[0].y < this._allPointRect[i].miny) {\r\n-\r\n-                                    this._allPointRect[i].limitMiny = true;\r\n-                                }\r\n+                                this._allPointRect[i].limitMiny = true;\r\n                             }\r\n                         }\r\n+                    }\r\n \r\n-                        let temp = { 'isSortY': isSortY };\r\n-                        if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n+                    let temp = { 'isSortY': isSortY };\r\n+                    if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n-                            if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+                        if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n-                                // 直线\r\n-                                temp['QiX'] = 652;\r\n-                                temp['QiY'] = 655;\r\n-                                temp['angle'] = 0;\r\n-                                temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                                temp['chaoInterQiY'] = 0;\r\n-                                temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n-                                temp['result'] = true;\r\n-                                state.allTouchLinesPos['line1'] = temp;\r\n+                            // 直线\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = 0;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                            temp['result'] = true;\r\n+                            state.allTouchLinesPos['line1'] = temp;\r\n \r\n \r\n-                            } else if (this._allPointRect[0].limitMinx && !this._allPointRect[1].limitMaxx) {\r\n+                        } else if (this._allPointRect[0].limitMinx && !this._allPointRect[1].limitMaxx) {\r\n \r\n-                                // 左点超出射线\r\n-                                let pointMidChang = 593;\r\n+                            // 左点超出射线\r\n+                            let pointMidChang = 593;\r\n \r\n-                                temp['QiX'] = 652;\r\n-                                temp['QiY'] = 655;\r\n-                                temp['angle'] = 0;\r\n-                                temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                                temp['chaoInterQiY'] = 0;\r\n-                                temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n-                                temp['result'] = false;\r\n-                                state.allTouchLinesPos['line1'] = temp;\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = 0;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line1'] = temp;\r\n \r\n-                            } else if (!this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+                        } else if (!this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n-                                // 右点超出的射线\r\n-                                let pointMaxX = 1245;\r\n-                                let pointMidChang = 593;\r\n+                            // 右点超出的射线\r\n+                            let pointMaxX = 1245;\r\n+                            let pointMidChang = 593;\r\n \r\n-                                temp['QiX'] = 652;\r\n-                                temp['QiY'] = 655;\r\n-                                temp['angle'] = 0;\r\n-                                temp['chaoInterQiX'] = 0;\r\n-                                temp['chaoInterQiY'] = 0;\r\n-                                temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n-                                temp['result'] = false;\r\n-                                state.allTouchLinesPos['line1'] = temp;\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = 0;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line1'] = temp;\r\n \r\n-                            } else if (this._allPointRect[0].isPointInner && this._allPointRect[1].isPointInner) {\r\n+                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[1].isPointInner) {\r\n \r\n-                                //线段\r\n-                                let pointMidChang = 593;\r\n-                                temp['QiX'] = 652;\r\n-                                temp['QiY'] = 655;\r\n-                                temp['angle'] = 0;\r\n-                                temp['chaoInterQiX'] = 0;\r\n-                                temp['chaoInterQiY'] = 0;\r\n-                                temp['chang'] = pointMidChang;\r\n-                                temp['result'] = false;\r\n-                                state.allTouchLinesPos['line1'] = temp;\r\n-                            }\r\n+                            //线段\r\n+                            let pointMidChang = 593;\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = 0;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang;\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line1'] = temp;\r\n+                        }\r\n \r\n-                        } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains) {\r\n+                    } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains) {\r\n \r\n-                            if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+                        if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n-                                // 直线\r\n-                                temp['QiX'] = 652;\r\n-                                temp['QiY'] = 655;\r\n-                                temp['angle'] = -32;\r\n-                                temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                                temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);\r\n-                                temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n-                                temp['result'] = true;\r\n-                                state.allTouchLinesPos['line2'] = temp;\r\n+                            // 直线\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -32;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);\r\n+                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                            temp['result'] = true;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n \r\n-                            } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n+                        } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n \r\n-                                // 左点超出射线\r\n-                                let pointMidChang = 702;\r\n+                            // 左点超出射线\r\n+                            let pointMidChang = 702;\r\n \r\n-                                temp['QiX'] = 652;\r\n-                                temp['QiY'] = 655;\r\n-                                temp['angle'] = -32;\r\n-                                temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                                temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);;\r\n-                                temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n-                                temp['result'] = false;\r\n-                                state.allTouchLinesPos['line2'] = temp;\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -32;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);;\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n \r\n-                            } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+                        } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n-                                // 右点超出的射线\r\n-                                let pointMaxX = 1245;\r\n-                                let pointMidChang = 702;\r\n+                            // 右点超出的射线\r\n+                            let pointMaxX = 1245;\r\n+                            let pointMidChang = 702;\r\n \r\n-                                temp['QiX'] = 652;\r\n-                                temp['QiY'] = 655;\r\n-                                temp['angle'] = -32;\r\n-                                temp['chaoInterQiX'] = 0;\r\n-                                temp['chaoInterQiY'] = 0;\r\n-                                temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n-                                temp['result'] = false;\r\n-                                state.allTouchLinesPos['line2'] = temp;\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -32;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n \r\n-                            } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n+                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n-                                //线段\r\n-                                let pointMidChang = 702;\r\n-                                temp['QiX'] = 652;\r\n-                                temp['QiY'] = 655;\r\n-                                temp['angle'] = -32;\r\n-                                temp['chaoInterQiX'] = 0;\r\n-                                temp['chaoInterQiY'] = 0;\r\n-                                temp['chang'] = pointMidChang;\r\n-                                temp['result'] = false;\r\n-                                state.allTouchLinesPos['line2'] = temp;\r\n-                            }\r\n+                            //线段\r\n+                            let pointMidChang = 702;\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -32;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang;\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n+                        }\r\n \r\n-                        } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains) {\r\n+                    } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains) {\r\n \r\n-                            if (this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+                        if (this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n \r\n-                                // 直线\r\n-                                temp['QiX'] = 652;\r\n-                                temp['QiY'] = 655;\r\n-                                temp['angle'] = -90;\r\n-                                temp['chaoInterQiX'] = 0;\r\n-                                temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n-                                temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n-                                temp['result'] = true;\r\n-                                state.allTouchLinesPos['line3'] = temp;\r\n+                            // 直线\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -90;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n+                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                            temp['result'] = true;\r\n+                            state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                            } else if (this._allPointRect[0].limitMaxy && !this._allPointRect[3].limitMiny) {\r\n+                        } else if (this._allPointRect[0].limitMaxy && !this._allPointRect[3].limitMiny) {\r\n \r\n-                                // 下点超出射线\r\n-                                let pointMidChang = 372;\r\n+                            // 下点超出射线\r\n+                            let pointMidChang = 372;\r\n \r\n-                                temp['QiX'] = 652;\r\n-                                temp['QiY'] = 655;\r\n-                                temp['angle'] = -90;\r\n-                                temp['chaoInterQiX'] = 0;\r\n-                                temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n-                                temp['chang'] = pointMidChang + temp['chaoInterQiY'];\r\n-                                temp['result'] = false;\r\n-                                state.allTouchLinesPos['line3'] = temp;\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -90;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiY'];\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                            } else if (!this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+                        } else if (!this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n \r\n-                                // 上点超出的射线\r\n-                                let pointMinY = 283;\r\n-                                let pointMidChang = 372;\r\n+                            // 上点超出的射线\r\n+                            let pointMinY = 283;\r\n+                            let pointMidChang = 372;\r\n \r\n-                                temp['QiX'] = 652;\r\n-                                temp['QiY'] = 655;\r\n-                                temp['angle'] = -90;\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -90;\r\n \r\n-                                temp['chaoInterQiX'] = 0;\r\n-                                temp['chaoInterQiY'] = 0;\r\n-                                temp['chang'] = pointMidChang + (pointMinY - this._curTouchesPos[0].y);\r\n-                                temp['result'] = false;\r\n-                                state.allTouchLinesPos['line3'] = temp;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang + (pointMinY - this._curTouchesPos[0].y);\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                            } else if (this._allPointRect[0].isPointInner && this._allPointRect[3].isPointInner) {\r\n+                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[3].isPointInner) {\r\n \r\n-                                //线段\r\n-                                let pointMidChang = 372;\r\n-                                temp['QiX'] = 652;\r\n-                                temp['QiY'] = 655;\r\n-                                temp['angle'] = -90;\r\n+                            //线段\r\n+                            let pointMidChang = 372;\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -90;\r\n \r\n-                                temp['chaoInterQiX'] = 0;\r\n-                                temp['chaoInterQiY'] = 0;\r\n-                                temp['chang'] = pointMidChang;\r\n-                                temp['result'] = false;\r\n-                                state.allTouchLinesPos['line3'] = temp;\r\n-                            }\r\n-                        } else {\r\n-\r\n-                            temp['QiX'] = this._curTouchesPos[0].x;\r\n-                            temp['QiY'] = this._curTouchesPos[0].y;\r\n-                            if (isSortY) {\r\n-                                temp['angle'] = -this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n-                            } else {\r\n-                                temp['angle'] = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n-                            }\r\n-\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();;\r\n+                            temp['chang'] = pointMidChang;\r\n                             temp['result'] = false;\r\n-                            state.allOtherTouchLinesPos.push(temp);\r\n+                            state.allTouchLinesPos['line3'] = temp;\r\n                         }\r\n+                    } else {\r\n+\r\n+                        temp['QiX'] = this._curTouchesPos[0].x;\r\n+                        temp['QiY'] = this._curTouchesPos[0].y;\r\n+                        if (isSortY) {\r\n+                            temp['angle'] = -this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n+                        } else {\r\n+                            temp['angle'] = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n+                        }\r\n+\r\n+                        temp['chaoInterQiX'] = 0;\r\n+                        temp['chaoInterQiY'] = 0;\r\n+                        temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();;\r\n+                        temp['result'] = false;\r\n+                        state.allOtherTouchLinesPos.push(temp);\r\n                     }\r\n-                }\r\n \r\n-                setTimeout(() => {\r\n+                    setTimeout(() => {\r\n \r\n-                    let state1: any = globalThis._.cloneDeep(this._state);\r\n-                    state1.touch = 'no';\r\n-                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n-                    state1.allOtherTouchLinesPos = state.allOtherTouchLinesPos;\r\n-                    this.updateState(state1);\r\n+                        let state1: any = globalThis._.cloneDeep(this._state);\r\n+                        state1.touch = 'no';\r\n+                        state1.allTouchLinesPos = state.allTouchLinesPos;\r\n+                        state1.allOtherTouchLinesPos = state.allOtherTouchLinesPos;\r\n+                        this.updateState(state1);\r\n \r\n-                }, 20);\r\n+                    }, 20);\r\n+                }\r\n             }\r\n-        }\r\n \r\n-        if (!globalThis._.isEqual(oldState.allOtherTouchLinesPos, state.allOtherTouchLinesPos)) {\r\n+            if (!globalThis._.isEqual(oldState.allOtherTouchLinesPos, state.allOtherTouchLinesPos)) {\r\n \r\n-            for (let key in this._allOtherTouchLinesObj) {\r\n-                this._allOtherTouchLinesObj[key].removeFromParent();\r\n-            }\r\n+                for (let key in this._allOtherTouchLinesObj) {\r\n+                    this._allOtherTouchLinesObj[key].removeFromParent();\r\n+                }\r\n \r\n-            for (let i = 0; i < state.allOtherTouchLinesPos.length; i++) {\r\n+                for (let i = 0; i < state.allOtherTouchLinesPos.length; i++) {\r\n \r\n-                let temp = state.allOtherTouchLinesPos[i];\r\n-                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                this._view.addChild(zhiLine);\r\n-                zhiLine.width = temp['chang'];\r\n+                    let temp = state.allOtherTouchLinesPos[i];\r\n+                    let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                    this._view.addChild(zhiLine);\r\n+                    zhiLine.width = temp['chang'];\r\n \r\n-                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                if (temp.isSortY) {\r\n+                    zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n+                    if (temp.isSortY) {\r\n \r\n-                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n+                        zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n \r\n-                } else {\r\n+                    } else {\r\n \r\n-                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n+                        zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n+                    }\r\n+\r\n+                    zhiLine.rotation = temp.angle;\r\n+                    this._allOtherTouchLinesObj[i] = zhiLine;\r\n                 }\r\n \r\n-                zhiLine.rotation = temp.angle;\r\n-                this._allOtherTouchLinesObj[i] = zhiLine;\r\n             }\r\n \r\n-        }\r\n+            if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n-        if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n+                for (let key in this._allTouchLinesObj) {\r\n+                    this._allTouchLinesObj[key].removeFromParent();\r\n+                }\r\n \r\n-            for (let key in this._allTouchLinesObj) {\r\n-                this._allTouchLinesObj[key].removeFromParent();\r\n-            }\r\n+                for (let key in state.allTouchLinesPos) {\r\n \r\n-            for (let key in state.allTouchLinesPos) {\r\n+                    let temp = state.allTouchLinesPos[key];\r\n+                    let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                    this._view.addChild(zhiLine);\r\n+                    zhiLine.width = temp['chang'];\r\n \r\n-                let temp = state.allTouchLinesPos[key];\r\n-                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                this._view.addChild(zhiLine);\r\n-                zhiLine.width = temp['chang'];\r\n+                    zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n+                    if (temp.isSortY) {\r\n \r\n-                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                if (temp.isSortY) {\r\n+                        zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n \r\n-                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n+                    } else {\r\n \r\n-                } else {\r\n+                        zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n+                    }\r\n \r\n-                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n+                    zhiLine.rotation = temp.angle;\r\n+                    this._allTouchLinesObj[key] = zhiLine;\r\n                 }\r\n-\r\n-                zhiLine.rotation = temp.angle;\r\n-                this._allTouchLinesObj[key] = zhiLine;\r\n             }\r\n-        }\r\n \r\n-        if (!globalThis._.isEqual(oldState.reset, state.reset)) {\r\n+            if (!globalThis._.isEqual(oldState.reset, state.reset)) {\r\n \r\n-            if (state.reset) {\r\n+                if (state.reset) {\r\n \r\n-                for (let key in state.allTouchLinesPos) {\r\n-                    delete state.allTouchLinesPos[key];\r\n-                }\r\n+                    for (let key in state.allTouchLinesPos) {\r\n+                        delete state.allTouchLinesPos[key];\r\n+                    }\r\n \r\n-                for (let key in this._allTouchLinesObj) {\r\n-                    this._allTouchLinesObj[key].removeFromParent();\r\n-                }\r\n+                    for (let key in this._allTouchLinesObj) {\r\n+                        this._allTouchLinesObj[key].removeFromParent();\r\n+                    }\r\n \r\n-                for (let key in this._allOtherTouchLinesObj) {\r\n-                    this._allOtherTouchLinesObj[key].removeFromParent();\r\n-                }\r\n+                    for (let key in this._allOtherTouchLinesObj) {\r\n+                        this._allOtherTouchLinesObj[key].removeFromParent();\r\n+                    }\r\n \r\n-                setTimeout(() => {\r\n+                    setTimeout(() => {\r\n \r\n-                    let state1: any = globalThis._.cloneDeep(this._state);\r\n-                    state1.reset = false;\r\n-                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n-                    state1.allOtherTouchLinesPos = [];\r\n-                    this.updateState(state1);\r\n+                        let state1: any = globalThis._.cloneDeep(this._state);\r\n+                        state1.reset = false;\r\n+                        state1.allTouchLinesPos = state.allTouchLinesPos;\r\n+                        state1.allOtherTouchLinesPos = [];\r\n+                        this.updateState(state1);\r\n \r\n-                }, 10);\r\n+                    }, 10);\r\n \r\n+                }\r\n+\r\n             }\r\n \r\n-        }\r\n+            if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+                if (state.submit === this.submitType.RightFeed) {\r\n \r\n-            if (state.submit === this.submitType.RightFeed) {\r\n+                    this.answerFeedback(true);\r\n \r\n-                this.answerFeedback(true);\r\n+                } else if (state.submit === this.submitType.WrongFeed) {\r\n \r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n+                    this.answerFeedback(false);\r\n \r\n-                this.answerFeedback(false);\r\n+                } else if (state.submit === this.submitType.GuideShow) {\r\n \r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n+                    // let keyBtn = this._view.getChild('input1').asButton;\r\n+                    // this.handTips2(keyBtn);\r\n+                }\r\n+            }\r\n \r\n-                // let keyBtn = this._view.getChild('input1').asButton;\r\n-                // this.handTips2(keyBtn);\r\n+            if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+                this.playTitle(state.title);\r\n             }\r\n         }\r\n \r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n+        angle(start, end) {\r\n+            var diff_x = end.x - start.x,\r\n+                diff_y = end.y - start.y;\r\n+            //返回角度,不是弧度\r\n+            return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n         }\r\n-    }\r\n \r\n-    angle(start, end) {\r\n-        var diff_x = end.x - start.x,\r\n-            diff_y = end.y - start.y;\r\n-        //返回角度,不是弧度\r\n-        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n-    }\r\n \r\n+        async playTitle(bool: boolean) {\r\n+            this._c1.selectedIndex = bool ? 1 : 0;\r\n+            if (bool) {\r\n+                cc.audioEngine.stopAll();\r\n+                this.forbidHandle();\r\n+                let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+                let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+                let audioId = cc.audioEngine.play(audio, false, 1);\r\n+                cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                    let state: any = globalThis._.cloneDeep(this._state);\r\n+                    state.title = false;\r\n+                    this.updateState(state);\r\n+                });\r\n+            } else {\r\n+                this.disableForbidHandle();\r\n+            }\r\n+        }\r\n \r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+        answerFeedback(bool: boolean) {\r\n+            if (!this.feedback) return;\r\n+            let feedback: any = cc.instantiate(this.feedback);\r\n+            feedback.x = 960;\r\n+            feedback.y = 540;\r\n+            let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+            feedbackJs.init(bool);\r\n+            feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+            setTimeout(() => {\r\n+                feedback.destroy();\r\n                 let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n+                state.submit = this.submitType.No;\r\n                 this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n+            }, 2000);\r\n         }\r\n-    }\r\n \r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n \r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n+        /**\r\n+         * 点击指引\r\n+         * @param obj 点击对象\r\n+         */\r\n+        handTips2(obj: fgui.GObject) {\r\n+            let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+            this._view.addChild(hand);\r\n+            let tempX = obj.x;\r\n+            let tempY = obj.y;\r\n \r\n+            hand.x = tempX;\r\n+            hand.y = tempY;\r\n \r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n+            cc.tween(hand).to(0.3, {\r\n+                x: tempX - 30,\r\n+                y: tempY - 30\r\n+            }).to(0.3, {\r\n+                x: tempX,\r\n+                y: tempY\r\n+            }).to(0.3, {\r\n+                x: tempX - 30,\r\n+                y: tempY - 30\r\n+            }).to(0.3, {\r\n+                x: tempX,\r\n+                y: tempY\r\n+            }).call(() => {\r\n+                this._view.removeChild(hand);\r\n+                hand = null;\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.submit = this.submitType.No;\r\n+                this.updateState(state)\r\n+            }).start();\r\n+        }\r\n \r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n+        // 运行时 禁止操作\r\n+        forbidHandle() {\r\n+            console.log('===  运行时 禁止操作 =====');\r\n+            let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+            if (!handleMask) {\r\n+                let handleMask = new cc.Node('handleMask');\r\n+                handleMask.addComponent(cc.BlockInputEvents);\r\n+                handleMask.parent = this._worldRoot;\r\n+                handleMask.width = 1920;\r\n+                handleMask.height = 1080;\r\n+                handleMask.x = 960;\r\n+                handleMask.y = 540;\r\n+            }\r\n+        }\r\n \r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n+        // 消除禁止\r\n+        disableForbidHandle() {\r\n+            let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+            if (handleMask) handleMask.destroy();\r\n+        }\r\n \r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n+        // 注册状态，及获取状态的方法\r\n+        registerState() {\r\n+            if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n         }\r\n-    }\r\n \r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n+        // 解除状态，及获取状态的方法\r\n+        relieveState() {\r\n+            if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+        }\r\n \r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n+        // 本组件状态合并到全局\r\n+        mergeState() {\r\n+            if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+        }\r\n \r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n+        onEnable() {\r\n+            this.registerState();\r\n+            this.schedule(this.dragSchedule, this._scheduleTime);\r\n+        }\r\n \r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+        onDisable() {\r\n+            this.relieveState();\r\n+            cc.audioEngine.stopAll();\r\n+        }\r\n     }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-        this.schedule(this.dragSchedule, this._scheduleTime);\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1625406528030,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -586,250 +586,251 @@\n                         temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();;\r\n                         temp['result'] = false;\r\n                         state.allOtherTouchLinesPos.push(temp);\r\n                     }\r\n+                }\r\n \r\n-                    setTimeout(() => {\r\n+                setTimeout(() => {\r\n \r\n-                        let state1: any = globalThis._.cloneDeep(this._state);\r\n-                        state1.touch = 'no';\r\n-                        state1.allTouchLinesPos = state.allTouchLinesPos;\r\n-                        state1.allOtherTouchLinesPos = state.allOtherTouchLinesPos;\r\n-                        this.updateState(state1);\r\n+                    let state1: any = globalThis._.cloneDeep(this._state);\r\n+                    state1.touch = 'no';\r\n+                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n+                    state1.allOtherTouchLinesPos = state.allOtherTouchLinesPos;\r\n+                    this.updateState(state1);\r\n \r\n-                    }, 20);\r\n-                }\r\n+                }, 20);\r\n             }\r\n+        }\r\n \r\n-            if (!globalThis._.isEqual(oldState.allOtherTouchLinesPos, state.allOtherTouchLinesPos)) {\r\n+        if (!globalThis._.isEqual(oldState.allOtherTouchLinesPos, state.allOtherTouchLinesPos)) {\r\n \r\n-                for (let key in this._allOtherTouchLinesObj) {\r\n-                    this._allOtherTouchLinesObj[key].removeFromParent();\r\n-                }\r\n+            for (let key in this._allOtherTouchLinesObj) {\r\n+                this._allOtherTouchLinesObj[key].removeFromParent();\r\n+            }\r\n \r\n-                for (let i = 0; i < state.allOtherTouchLinesPos.length; i++) {\r\n+            for (let i = 0; i < state.allOtherTouchLinesPos.length; i++) {\r\n \r\n-                    let temp = state.allOtherTouchLinesPos[i];\r\n-                    let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                    this._view.addChild(zhiLine);\r\n-                    zhiLine.width = temp['chang'];\r\n+                let temp = state.allOtherTouchLinesPos[i];\r\n+                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                this._view.addChild(zhiLine);\r\n+                zhiLine.width = temp['chang'];\r\n \r\n-                    zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                    if (temp.isSortY) {\r\n+                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n+                if (temp.isSortY) {\r\n \r\n-                        zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n+                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n \r\n-                    } else {\r\n+                } else {\r\n \r\n-                        zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n-                    }\r\n-\r\n-                    zhiLine.rotation = temp.angle;\r\n-                    this._allOtherTouchLinesObj[i] = zhiLine;\r\n+                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n                 }\r\n \r\n+                zhiLine.rotation = temp.angle;\r\n+                this._allOtherTouchLinesObj[i] = zhiLine;\r\n             }\r\n \r\n-            if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n+        }\r\n \r\n-                for (let key in this._allTouchLinesObj) {\r\n-                    this._allTouchLinesObj[key].removeFromParent();\r\n-                }\r\n+        if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n-                for (let key in state.allTouchLinesPos) {\r\n+            for (let key in this._allTouchLinesObj) {\r\n+                this._allTouchLinesObj[key].removeFromParent();\r\n+            }\r\n \r\n-                    let temp = state.allTouchLinesPos[key];\r\n-                    let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                    this._view.addChild(zhiLine);\r\n-                    zhiLine.width = temp['chang'];\r\n+            for (let key in state.allTouchLinesPos) {\r\n \r\n-                    zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                    if (temp.isSortY) {\r\n+                let temp = state.allTouchLinesPos[key];\r\n+                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                this._view.addChild(zhiLine);\r\n+                zhiLine.width = temp['chang'];\r\n \r\n-                        zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n+                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n+                if (temp.isSortY) {\r\n \r\n-                    } else {\r\n+                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n \r\n-                        zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n-                    }\r\n+                } else {\r\n \r\n-                    zhiLine.rotation = temp.angle;\r\n-                    this._allTouchLinesObj[key] = zhiLine;\r\n+                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n                 }\r\n+\r\n+                zhiLine.rotation = temp.angle;\r\n+                this._allTouchLinesObj[key] = zhiLine;\r\n             }\r\n+        }\r\n \r\n-            if (!globalThis._.isEqual(oldState.reset, state.reset)) {\r\n+        if (!globalThis._.isEqual(oldState.reset, state.reset)) {\r\n \r\n-                if (state.reset) {\r\n+            if (state.reset) {\r\n \r\n-                    for (let key in state.allTouchLinesPos) {\r\n-                        delete state.allTouchLinesPos[key];\r\n-                    }\r\n+                for (let key in state.allTouchLinesPos) {\r\n+                    delete state.allTouchLinesPos[key];\r\n+                }\r\n \r\n-                    for (let key in this._allTouchLinesObj) {\r\n-                        this._allTouchLinesObj[key].removeFromParent();\r\n-                    }\r\n+                for (let key in this._allTouchLinesObj) {\r\n+                    this._allTouchLinesObj[key].removeFromParent();\r\n+                }\r\n \r\n-                    for (let key in this._allOtherTouchLinesObj) {\r\n-                        this._allOtherTouchLinesObj[key].removeFromParent();\r\n-                    }\r\n+                for (let key in this._allOtherTouchLinesObj) {\r\n+                    this._allOtherTouchLinesObj[key].removeFromParent();\r\n+                }\r\n \r\n-                    setTimeout(() => {\r\n+                setTimeout(() => {\r\n \r\n-                        let state1: any = globalThis._.cloneDeep(this._state);\r\n-                        state1.reset = false;\r\n-                        state1.allTouchLinesPos = state.allTouchLinesPos;\r\n-                        state1.allOtherTouchLinesPos = [];\r\n-                        this.updateState(state1);\r\n+                    let state1: any = globalThis._.cloneDeep(this._state);\r\n+                    state1.reset = false;\r\n+                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n+                    state1.allOtherTouchLinesPos = [];\r\n+                    this.updateState(state1);\r\n \r\n-                    }, 10);\r\n+                }, 10);\r\n \r\n-                }\r\n-\r\n             }\r\n \r\n-            if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+        }\r\n \r\n-                if (state.submit === this.submitType.RightFeed) {\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n-                    this.answerFeedback(true);\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n \r\n-                } else if (state.submit === this.submitType.WrongFeed) {\r\n+                this.answerFeedback(true);\r\n \r\n-                    this.answerFeedback(false);\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n \r\n-                } else if (state.submit === this.submitType.GuideShow) {\r\n+                this.answerFeedback(false);\r\n \r\n-                    // let keyBtn = this._view.getChild('input1').asButton;\r\n-                    // this.handTips2(keyBtn);\r\n-                }\r\n-            }\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n \r\n-            if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-                this.playTitle(state.title);\r\n+                // let keyBtn = this._view.getChild('input1').asButton;\r\n+                // this.handTips2(keyBtn);\r\n             }\r\n         }\r\n \r\n-        angle(start, end) {\r\n-            var diff_x = end.x - start.x,\r\n-                diff_y = end.y - start.y;\r\n-            //返回角度,不是弧度\r\n-            return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n         }\r\n+    }\r\n \r\n+    angle(start, end) {\r\n+        var diff_x = end.x - start.x,\r\n+            diff_y = end.y - start.y;\r\n+        //返回角度,不是弧度\r\n+        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n+    }\r\n \r\n-        async playTitle(bool: boolean) {\r\n-            this._c1.selectedIndex = bool ? 1 : 0;\r\n-            if (bool) {\r\n-                cc.audioEngine.stopAll();\r\n-                this.forbidHandle();\r\n-                let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-                let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-                let audioId = cc.audioEngine.play(audio, false, 1);\r\n-                cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                    let state: any = globalThis._.cloneDeep(this._state);\r\n-                    state.title = false;\r\n-                    this.updateState(state);\r\n-                });\r\n-            } else {\r\n-                this.disableForbidHandle();\r\n-            }\r\n-        }\r\n \r\n-        answerFeedback(bool: boolean) {\r\n-            if (!this.feedback) return;\r\n-            let feedback: any = cc.instantiate(this.feedback);\r\n-            feedback.x = 960;\r\n-            feedback.y = 540;\r\n-            let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-            feedbackJs.init(bool);\r\n-            feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-            setTimeout(() => {\r\n-                feedback.destroy();\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n                 let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.submit = this.submitType.No;\r\n+                state.title = false;\r\n                 this.updateState(state);\r\n-            }, 2000);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n         }\r\n+    }\r\n \r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n \r\n-        /**\r\n-         * 点击指引\r\n-         * @param obj 点击对象\r\n-         */\r\n-        handTips2(obj: fgui.GObject) {\r\n-            let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-            this._view.addChild(hand);\r\n-            let tempX = obj.x;\r\n-            let tempY = obj.y;\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n \r\n-            hand.x = tempX;\r\n-            hand.y = tempY;\r\n \r\n-            cc.tween(hand).to(0.3, {\r\n-                x: tempX - 30,\r\n-                y: tempY - 30\r\n-            }).to(0.3, {\r\n-                x: tempX,\r\n-                y: tempY\r\n-            }).to(0.3, {\r\n-                x: tempX - 30,\r\n-                y: tempY - 30\r\n-            }).to(0.3, {\r\n-                x: tempX,\r\n-                y: tempY\r\n-            }).call(() => {\r\n-                this._view.removeChild(hand);\r\n-                hand = null;\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.submit = this.submitType.No;\r\n-                this.updateState(state)\r\n-            }).start();\r\n-        }\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n \r\n-        // 运行时 禁止操作\r\n-        forbidHandle() {\r\n-            console.log('===  运行时 禁止操作 =====');\r\n-            let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-            if (!handleMask) {\r\n-                let handleMask = new cc.Node('handleMask');\r\n-                handleMask.addComponent(cc.BlockInputEvents);\r\n-                handleMask.parent = this._worldRoot;\r\n-                handleMask.width = 1920;\r\n-                handleMask.height = 1080;\r\n-                handleMask.x = 960;\r\n-                handleMask.y = 540;\r\n-            }\r\n-        }\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n \r\n-        // 消除禁止\r\n-        disableForbidHandle() {\r\n-            let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-            if (handleMask) handleMask.destroy();\r\n-        }\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n \r\n-        // 注册状态，及获取状态的方法\r\n-        registerState() {\r\n-            if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n         }\r\n+    }\r\n \r\n-        // 解除状态，及获取状态的方法\r\n-        relieveState() {\r\n-            if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-        }\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n \r\n-        // 本组件状态合并到全局\r\n-        mergeState() {\r\n-            if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-        }\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n \r\n-        onEnable() {\r\n-            this.registerState();\r\n-            this.schedule(this.dragSchedule, this._scheduleTime);\r\n-        }\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n \r\n-        onDisable() {\r\n-            this.relieveState();\r\n-            cc.audioEngine.stopAll();\r\n-        }\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n     }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+        this.schedule(this.dragSchedule, this._scheduleTime);\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1625406617181,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -319,23 +319,8 @@\n \r\n                     this._curTouchesPos[i].y = this._view.height - this._curTouchesPos[i].y;\r\n                 }\r\n \r\n-                let tempArrX = [];\r\n-                tempArrX = this._curTouchesPos;\r\n-                tempArrX.sort(this.comparePosX());\r\n-\r\n-                let tempArrY = [];\r\n-                tempArrY = this._curTouchesPos;\r\n-                tempArrY.sort(this.comparePosY());\r\n-\r\n-                var chaX = Math.abs(tempArrX[tempArrX.length - 1].x - tempArrX[0].x);\r\n-                var chaY = Math.abs(tempArrY[tempArrY.length - 1].y - tempArrY[0].y);\r\n-                let isSortY = false;\r\n-\r\n-                console.log('====== chaX ======' + chaX);\r\n-                console.log('====== chaY ======' + chaY);\r\n-\r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                     this._allPointRect[i].isContains = false;\r\n                 }\r\n"
                },
                {
                    "date": 1625406933402,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -331,9 +331,8 @@\n                     for (let j = 0; j < this._allPointRect.length; j++) {\r\n \r\n                         if (this._allPointRect[j].rect.contains(this._curTouchesPos[i])) {\r\n                             this._allPointRect[j].isContains = true;\r\n-\r\n                             break;\r\n                         }\r\n                     }\r\n                 }\r\n@@ -343,8 +342,9 @@\n                         pointNums++;\r\n                         continue;\r\n                     }\r\n                 }\r\n+\r\n                 console.log('===== 5555 =====' + pointNums);\r\n \r\n                 if (pointNums >= 2) {\r\n \r\n@@ -360,37 +360,27 @@\n                             if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n                                 this._allPointRect[i].limitMinx = true;\r\n                             }\r\n-                            if (this._curTouchesPos[this._curTouchesPos.length - 1].y > this._allPointRect[i].maxy) {\r\n \r\n-                                this._allPointRect[i].limitMaxy = true;\r\n-                            }\r\n-\r\n                         } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n \r\n                             if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                                 this._allPointRect[i].limitMaxx = true;\r\n                             }\r\n \r\n-                        } else if (i === 3 && this._allPointRect[i].isContains) {\r\n-\r\n-                            if (this._curTouchesPos[0].y < this._allPointRect[i].miny) {\r\n-\r\n-                                this._allPointRect[i].limitMiny = true;\r\n-                            }\r\n                         }\r\n                     }\r\n \r\n-                    let temp = { 'isSortY': isSortY };\r\n+                    let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n                             // 直线\r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n                             temp['angle'] = 0;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n                             temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n@@ -400,12 +390,12 @@\n \r\n                         } else if (this._allPointRect[0].limitMinx && !this._allPointRect[1].limitMaxx) {\r\n \r\n                             // 左点超出射线\r\n-                            let pointMidChang = 593;\r\n+                            let pointMidChang = 297;\r\n \r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n                             temp['angle'] = 0;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n                             temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n"
                },
                {
                    "date": 1625406979305,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -404,10 +404,10 @@\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n-                            let pointMaxX = 1245;\r\n-                            let pointMidChang = 593;\r\n+                            let pointMaxX = 1096;\r\n+                            let pointMidChang = 297;\r\n \r\n                             temp['QiX'] = 652;\r\n                             temp['QiY'] = 655;\r\n                             temp['angle'] = 0;\r\n"
                },
                {
                    "date": 1625406984451,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -407,10 +407,10 @@\n                             // 右点超出的射线\r\n                             let pointMaxX = 1096;\r\n                             let pointMidChang = 297;\r\n \r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n                             temp['angle'] = 0;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n"
                },
                {
                    "date": 1625407024909,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -419,9 +419,9 @@\n \r\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[1].isPointInner) {\r\n \r\n                             //线段\r\n-                            let pointMidChang = 593;\r\n+                            let pointMidChang = 297;\r\n                             temp['QiX'] = 652;\r\n                             temp['QiY'] = 655;\r\n                             temp['angle'] = 0;\r\n                             temp['chaoInterQiX'] = 0;\r\n"
                },
                {
                    "date": 1625407031816,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -420,10 +420,10 @@\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[1].isPointInner) {\r\n \r\n                             //线段\r\n                             let pointMidChang = 297;\r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n                             temp['angle'] = 0;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = pointMidChang;\r\n"
                },
                {
                    "date": 1625407055343,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -435,10 +435,10 @@\n \r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 直线\r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n                             temp['angle'] = -32;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n                             temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n"
                },
                {
                    "date": 1625407097805,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -101,9 +101,9 @@\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n         },\r\n         {\r\n-            'rect': new cc.Rect(907, 368, 71, 71), 'isContains': false, 'minx': 907, 'maxx': 978, 'miny': 368, 'maxy': 439,\r\n+            'rect': new cc.Rect(918, 368, 71, 71), 'isContains': false, 'minx': 918, 'maxx': 978, 'miny': 368, 'maxy': 439,\r\n             'limitMaxx': false,\r\n             'isPointInner': false,\r\n         }\r\n         ];\r\n"
                },
                {
                    "date": 1625407143278,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -111,8 +111,9 @@\n         // let tt1 = new cc.Vec2(1247, 282);\r\n         // let tt2 = new cc.Vec2(652, 655);\r\n         // console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n \r\n+\r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n         this._title = this._view.getChild(\"title\").asButton;\r\n"
                },
                {
                    "date": 1625407157805,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -111,8 +111,18 @@\n         // let tt1 = new cc.Vec2(1247, 282);\r\n         // let tt2 = new cc.Vec2(652, 655);\r\n         // console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n \r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n"
                },
                {
                    "date": 1625407184860,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -111,9 +111,9 @@\n         // let tt1 = new cc.Vec2(1247, 282);\r\n         // let tt2 = new cc.Vec2(652, 655);\r\n         // console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n \r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let pointGroup = this._view.getChild(\"n84\").asGroup;\r\n         let indexTemp = 0;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == selectGroup) {\r\n                 let img = this._view.getChildAt(i).asImage;\r\n"
                },
                {
                    "date": 1625407200325,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -112,11 +112,10 @@\n         // let tt2 = new cc.Vec2(652, 655);\r\n         // console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n \r\n         let pointGroup = this._view.getChild(\"n84\").asGroup;\r\n-        let indexTemp = 0;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n+            if (this._view.getChildAt(i).group == pointGroup) {\r\n                 let img = this._view.getChildAt(i).asImage;\r\n                 this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n                 img.visible = false;\r\n                 indexTemp++;\r\n"
                },
                {
                    "date": 1625407206546,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -115,11 +115,9 @@\n         let pointGroup = this._view.getChild(\"n84\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == pointGroup) {\r\n                 let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n+\r\n             }\r\n         }\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n"
                },
                {
                    "date": 1625407304496,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -115,9 +115,19 @@\n         let pointGroup = this._view.getChild(\"n84\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == pointGroup) {\r\n                 let img = this._view.getChildAt(i).asImage;\r\n-\r\n+                let temp = {\r\n+                    'rect': new cc.Rect(764, 590, 71, 71),\r\n+                    'isContains': false,\r\n+                    'minx': 764,\r\n+                    'maxx': 835,\r\n+                    'miny': 590,\r\n+                    'maxy': 661,\r\n+                    'limitMinx': false,\r\n+                    'limitMaxy': false,\r\n+                    'isPointInner': false,\r\n+                };\r\n             }\r\n         }\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n"
                },
                {
                    "date": 1625407330698,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -116,9 +116,9 @@\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == pointGroup) {\r\n                 let img = this._view.getChildAt(i).asImage;\r\n                 let temp = {\r\n-                    'rect': new cc.Rect(764, 590, 71, 71),\r\n+                    'rect': new cc.Rect(img.x, img.y, img.width, img.height),\r\n                     'isContains': false,\r\n                     'minx': 764,\r\n                     'maxx': 835,\r\n                     'miny': 590,\r\n"
                },
                {
                    "date": 1625407344563,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -118,11 +118,11 @@\n                 let img = this._view.getChildAt(i).asImage;\r\n                 let temp = {\r\n                     'rect': new cc.Rect(img.x, img.y, img.width, img.height),\r\n                     'isContains': false,\r\n-                    'minx': 764,\r\n+                    'minx': img.x,\r\n                     'maxx': 835,\r\n-                    'miny': 590,\r\n+                    'miny': img.y,\r\n                     'maxy': 661,\r\n                     'limitMinx': false,\r\n                     'limitMaxy': false,\r\n                     'isPointInner': false,\r\n"
                },
                {
                    "date": 1625407351960,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,829 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v3 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _resetBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _curTouchesPos: any = [];\r\n+\r\n+    private _moveCurPos: cc.Vec2;\r\n+\r\n+    private graphics: cc.Graphics = null;\r\n+\r\n+    private _dragging = false;\r\n+\r\n+    private _scheduleTime = 0.08;\r\n+\r\n+    private _allTouchLinesObj = {};\r\n+\r\n+    private _allOtherTouchLinesObj = {};\r\n+\r\n+    private _allPointRect = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._allPointRect = [{\r\n+            'rect': new cc.Rect(764, 590, 71, 71),\r\n+            'isContains': false,\r\n+            'minx': 764,\r\n+            'maxx': 835,\r\n+            'miny': 590,\r\n+            'maxy': 661,\r\n+            'limitMinx': false,\r\n+            'limitMaxy': false,\r\n+            'isPointInner': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(1060, 590, 71, 71), 'isContains': false, 'minx': 1060, 'maxx': 1131, 'miny': 590, 'maxy': 661,\r\n+            'limitMaxx': false,\r\n+            'isPointInner': false,\r\n+        },\r\n+        {\r\n+            'rect': new cc.Rect(918, 368, 71, 71), 'isContains': false, 'minx': 918, 'maxx': 978, 'miny': 368, 'maxy': 439,\r\n+            'limitMaxx': false,\r\n+            'isPointInner': false,\r\n+        }\r\n+        ];\r\n+\r\n+        // let tt1 = new cc.Vec2(1247, 282);\r\n+        // let tt2 = new cc.Vec2(652, 655);\r\n+        // console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n+\r\n+        let pointGroup = this._view.getChild(\"n84\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == pointGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                let temp = {\r\n+                    'rect': new cc.Rect(img.x, img.y, img.width, img.height),\r\n+                    'isContains': false,\r\n+                    'minx': img.x,\r\n+                    'maxx': img.y + img.width,\r\n+                    'miny': img.y,\r\n+                    'maxy': 661,\r\n+                    'limitMinx': false,\r\n+                    'limitMaxy': false,\r\n+                    'isPointInner': false,\r\n+                };\r\n+            }\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n+        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n+\r\n+        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+\r\n+        let huiNode = new cc.Node('huiNode');\r\n+        huiNode.parent = this._worldRoot;\r\n+\r\n+        this.graphics = huiNode.addComponent(cc.Graphics);\r\n+        this.graphics.lineWidth = 20;\r\n+        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n+        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n+        this.graphics.fillColor = cc.color(255, 0, 0);\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            touch: \"no\",\r\n+            reset: false,\r\n+            curTouchesPos: cc.Vec2,\r\n+            allTouchLinesPos: {},\r\n+            allOtherTouchLinesPos: [],\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    _onDrawStart(event) {\r\n+        console.log('===== start 111 ====' + event.touch.getLocation());\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        if (state.touch === 'no') {\r\n+            state.touch = 'start';\r\n+            let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+            state.curTouchesPos = tempPos;\r\n+            this.updateState(state);\r\n+        }\r\n+    }\r\n+\r\n+    _onDrawMove(event) {\r\n+\r\n+        this._dragging = true;\r\n+        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+    }\r\n+\r\n+    _onDrawEnd(event) {\r\n+\r\n+        this._dragging = false;\r\n+\r\n+        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.curTouchesPos = tempPos;\r\n+        state.touch = 'end';\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 排序方法\r\n+    comparePosX() {\r\n+        return function (a, b) {\r\n+            var value1 = a.x;\r\n+            var value2 = b.x;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n+    // 排序方法\r\n+    comparePosY() {\r\n+        return function (a, b) {\r\n+            var value1 = a.y;\r\n+            var value2 = b.y;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n+    private _clickReset(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.reset = true;\r\n+        this.updateState(state);\r\n+\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+\r\n+        if (Object.keys(state.allTouchLinesPos).length === 0) {\r\n+\r\n+            state.submit = this.submitType.GuideShow;\r\n+\r\n+        } else {\r\n+\r\n+            let isAllRight = true;\r\n+            for (let key in state.allTouchLinesPos) {\r\n+\r\n+                if (!state.allTouchLinesPos[key].result) {\r\n+                    isAllRight = false;\r\n+                    break;\r\n+                }\r\n+            }\r\n+            if (isAllRight) {\r\n+                state.submit = this.submitType.RightFeed;\r\n+            } else {\r\n+                state.submit = this.submitType.WrongFeed;\r\n+            }\r\n+        }\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    // 临时\r\n+    // 拖拽定时器\r\n+    dragSchedule() {\r\n+        if (this._dragging) {\r\n+\r\n+            console.log('==== 3333333 拖拽定时器 ======');\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.curTouchesPos = this._moveCurPos;\r\n+            state.touch = \"move\";\r\n+            this.updateState(state);\r\n+        }\r\n+    }\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (state.touch == \"start\") {\r\n+\r\n+            this._curTouchesPos.length = 0;\r\n+            this._curTouchesPos.push(state.curTouchesPos);\r\n+            this.graphics.clear();\r\n+\r\n+        } else if (state.touch == \"move\") {\r\n+\r\n+            this._curTouchesPos.push(state.curTouchesPos);\r\n+\r\n+            const MIN_POINT_DISTANCE = 4;\r\n+\r\n+            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n+            this.graphics.moveTo(this._curTouchesPos[0].x - worldPos.x, this._curTouchesPos[0].y - worldPos.y);\r\n+            let lastIndex = 0;\r\n+            for (let i = 1, l = this._curTouchesPos.length; i < l; i++) {\r\n+                if (this._curTouchesPos[i].sub(this._curTouchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n+                    continue;\r\n+                }\r\n+                lastIndex = i;\r\n+                this.graphics.lineTo(this._curTouchesPos[i].x - worldPos.x, this._curTouchesPos[i].y - worldPos.y);\r\n+            }\r\n+            this.graphics.stroke();\r\n+\r\n+        } else if (state.touch == \"end\") {\r\n+\r\n+            this._curTouchesPos.push(state.curTouchesPos);\r\n+\r\n+            this.graphics.clear();\r\n+            if (this._curTouchesPos.length > 0) {\r\n+\r\n+                for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n+\r\n+                    this._curTouchesPos[i].y = this._view.height - this._curTouchesPos[i].y;\r\n+                }\r\n+\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                    this._allPointRect[i].isContains = false;\r\n+                }\r\n+\r\n+                let pointNums = 0;\r\n+                for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n+\r\n+                    for (let j = 0; j < this._allPointRect.length; j++) {\r\n+\r\n+                        if (this._allPointRect[j].rect.contains(this._curTouchesPos[i])) {\r\n+                            this._allPointRect[j].isContains = true;\r\n+                            break;\r\n+                        }\r\n+                    }\r\n+                }\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                    if (this._allPointRect[i].isContains) {\r\n+                        pointNums++;\r\n+                        continue;\r\n+                    }\r\n+                }\r\n+\r\n+                console.log('===== 5555 =====' + pointNums);\r\n+\r\n+                if (pointNums >= 2) {\r\n+\r\n+                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                        if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n+                            this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n+                            this._allPointRect[i].isPointInner = true;\r\n+                        }\r\n+\r\n+                        if (i === 0 && this._allPointRect[i].isContains) {\r\n+\r\n+                            if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n+\r\n+                                this._allPointRect[i].limitMinx = true;\r\n+                            }\r\n+\r\n+                        } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n+\r\n+                            if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n+\r\n+                                this._allPointRect[i].limitMaxx = true;\r\n+                            }\r\n+\r\n+                        }\r\n+                    }\r\n+\r\n+                    let temp = {};\r\n+                    if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n+\r\n+                        if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+\r\n+                            // 直线\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = 0;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                            temp['result'] = true;\r\n+                            state.allTouchLinesPos['line1'] = temp;\r\n+\r\n+\r\n+                        } else if (this._allPointRect[0].limitMinx && !this._allPointRect[1].limitMaxx) {\r\n+\r\n+                            // 左点超出射线\r\n+                            let pointMidChang = 297;\r\n+\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = 0;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line1'] = temp;\r\n+\r\n+                        } else if (!this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+\r\n+                            // 右点超出的射线\r\n+                            let pointMaxX = 1096;\r\n+                            let pointMidChang = 297;\r\n+\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = 0;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line1'] = temp;\r\n+\r\n+                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[1].isPointInner) {\r\n+\r\n+                            //线段\r\n+                            let pointMidChang = 297;\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = 0;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang;\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line1'] = temp;\r\n+                        }\r\n+\r\n+                    } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains) {\r\n+\r\n+                        if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+\r\n+                            // 直线\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = -32;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);\r\n+                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                            temp['result'] = true;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n+\r\n+                        } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n+\r\n+                            // 左点超出射线\r\n+                            let pointMidChang = 702;\r\n+\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -32;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);;\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n+\r\n+                        } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+\r\n+                            // 右点超出的射线\r\n+                            let pointMaxX = 1245;\r\n+                            let pointMidChang = 702;\r\n+\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -32;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n+\r\n+                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n+\r\n+                            //线段\r\n+                            let pointMidChang = 702;\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -32;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang;\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n+                        }\r\n+\r\n+                    } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains) {\r\n+\r\n+                        if (this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+\r\n+                            // 直线\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -90;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n+                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                            temp['result'] = true;\r\n+                            state.allTouchLinesPos['line3'] = temp;\r\n+\r\n+                        } else if (this._allPointRect[0].limitMaxy && !this._allPointRect[3].limitMiny) {\r\n+\r\n+                            // 下点超出射线\r\n+                            let pointMidChang = 372;\r\n+\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -90;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiY'];\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line3'] = temp;\r\n+\r\n+                        } else if (!this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+\r\n+                            // 上点超出的射线\r\n+                            let pointMinY = 283;\r\n+                            let pointMidChang = 372;\r\n+\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -90;\r\n+\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang + (pointMinY - this._curTouchesPos[0].y);\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line3'] = temp;\r\n+\r\n+                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[3].isPointInner) {\r\n+\r\n+                            //线段\r\n+                            let pointMidChang = 372;\r\n+                            temp['QiX'] = 652;\r\n+                            temp['QiY'] = 655;\r\n+                            temp['angle'] = -90;\r\n+\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang;\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line3'] = temp;\r\n+                        }\r\n+                    } else {\r\n+\r\n+                        temp['QiX'] = this._curTouchesPos[0].x;\r\n+                        temp['QiY'] = this._curTouchesPos[0].y;\r\n+                        if (isSortY) {\r\n+                            temp['angle'] = -this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n+                        } else {\r\n+                            temp['angle'] = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n+                        }\r\n+\r\n+                        temp['chaoInterQiX'] = 0;\r\n+                        temp['chaoInterQiY'] = 0;\r\n+                        temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();;\r\n+                        temp['result'] = false;\r\n+                        state.allOtherTouchLinesPos.push(temp);\r\n+                    }\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state1: any = globalThis._.cloneDeep(this._state);\r\n+                    state1.touch = 'no';\r\n+                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n+                    state1.allOtherTouchLinesPos = state.allOtherTouchLinesPos;\r\n+                    this.updateState(state1);\r\n+\r\n+                }, 20);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.allOtherTouchLinesPos, state.allOtherTouchLinesPos)) {\r\n+\r\n+            for (let key in this._allOtherTouchLinesObj) {\r\n+                this._allOtherTouchLinesObj[key].removeFromParent();\r\n+            }\r\n+\r\n+            for (let i = 0; i < state.allOtherTouchLinesPos.length; i++) {\r\n+\r\n+                let temp = state.allOtherTouchLinesPos[i];\r\n+                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                this._view.addChild(zhiLine);\r\n+                zhiLine.width = temp['chang'];\r\n+\r\n+                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n+                if (temp.isSortY) {\r\n+\r\n+                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n+\r\n+                } else {\r\n+\r\n+                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n+                }\r\n+\r\n+                zhiLine.rotation = temp.angle;\r\n+                this._allOtherTouchLinesObj[i] = zhiLine;\r\n+            }\r\n+\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n+\r\n+            for (let key in this._allTouchLinesObj) {\r\n+                this._allTouchLinesObj[key].removeFromParent();\r\n+            }\r\n+\r\n+            for (let key in state.allTouchLinesPos) {\r\n+\r\n+                let temp = state.allTouchLinesPos[key];\r\n+                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                this._view.addChild(zhiLine);\r\n+                zhiLine.width = temp['chang'];\r\n+\r\n+                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n+                if (temp.isSortY) {\r\n+\r\n+                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n+\r\n+                } else {\r\n+\r\n+                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n+                }\r\n+\r\n+                zhiLine.rotation = temp.angle;\r\n+                this._allTouchLinesObj[key] = zhiLine;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.reset, state.reset)) {\r\n+\r\n+            if (state.reset) {\r\n+\r\n+                for (let key in state.allTouchLinesPos) {\r\n+                    delete state.allTouchLinesPos[key];\r\n+                }\r\n+\r\n+                for (let key in this._allTouchLinesObj) {\r\n+                    this._allTouchLinesObj[key].removeFromParent();\r\n+                }\r\n+\r\n+                for (let key in this._allOtherTouchLinesObj) {\r\n+                    this._allOtherTouchLinesObj[key].removeFromParent();\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state1: any = globalThis._.cloneDeep(this._state);\r\n+                    state1.reset = false;\r\n+                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n+                    state1.allOtherTouchLinesPos = [];\r\n+                    this.updateState(state1);\r\n+\r\n+                }, 10);\r\n+\r\n+            }\r\n+\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+                // let keyBtn = this._view.getChild('input1').asButton;\r\n+                // this.handTips2(keyBtn);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+    angle(start, end) {\r\n+        var diff_x = end.x - start.x,\r\n+            diff_y = end.y - start.y;\r\n+        //返回角度,不是弧度\r\n+        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+        this.schedule(this.dragSchedule, this._scheduleTime);\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1625407358832,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -121,9 +121,9 @@\n                     'isContains': false,\r\n                     'minx': img.x,\r\n                     'maxx': img.y + img.width,\r\n                     'miny': img.y,\r\n-                    'maxy': 661,\r\n+                    'maxy': img.y + ,\r\n                     'limitMinx': false,\r\n                     'limitMaxy': false,\r\n                     'isPointInner': false,\r\n                 };\r\n@@ -826,833 +826,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v3 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _resetBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _curTouchesPos: any = [];\r\n-\r\n-    private _moveCurPos: cc.Vec2;\r\n-\r\n-    private graphics: cc.Graphics = null;\r\n-\r\n-    private _dragging = false;\r\n-\r\n-    private _scheduleTime = 0.08;\r\n-\r\n-    private _allTouchLinesObj = {};\r\n-\r\n-    private _allOtherTouchLinesObj = {};\r\n-\r\n-    private _allPointRect = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._allPointRect = [{\r\n-            'rect': new cc.Rect(764, 590, 71, 71),\r\n-            'isContains': false,\r\n-            'minx': 764,\r\n-            'maxx': 835,\r\n-            'miny': 590,\r\n-            'maxy': 661,\r\n-            'limitMinx': false,\r\n-            'limitMaxy': false,\r\n-            'isPointInner': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(1060, 590, 71, 71), 'isContains': false, 'minx': 1060, 'maxx': 1131, 'miny': 590, 'maxy': 661,\r\n-            'limitMaxx': false,\r\n-            'isPointInner': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(918, 368, 71, 71), 'isContains': false, 'minx': 918, 'maxx': 978, 'miny': 368, 'maxy': 439,\r\n-            'limitMaxx': false,\r\n-            'isPointInner': false,\r\n-        }\r\n-        ];\r\n-\r\n-        // let tt1 = new cc.Vec2(1247, 282);\r\n-        // let tt2 = new cc.Vec2(652, 655);\r\n-        // console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n-\r\n-        let pointGroup = this._view.getChild(\"n84\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == pointGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                let temp = {\r\n-                    'rect': new cc.Rect(img.x, img.y, img.width, img.height),\r\n-                    'isContains': false,\r\n-                    'minx': img.x,\r\n-                    'maxx': 835,\r\n-                    'miny': img.y,\r\n-                    'maxy': 661,\r\n-                    'limitMinx': false,\r\n-                    'limitMaxy': false,\r\n-                    'isPointInner': false,\r\n-                };\r\n-            }\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n-        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n-\r\n-        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n-\r\n-        let huiNode = new cc.Node('huiNode');\r\n-        huiNode.parent = this._worldRoot;\r\n-\r\n-        this.graphics = huiNode.addComponent(cc.Graphics);\r\n-        this.graphics.lineWidth = 20;\r\n-        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n-        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n-        this.graphics.fillColor = cc.color(255, 0, 0);\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            touch: \"no\",\r\n-            reset: false,\r\n-            curTouchesPos: cc.Vec2,\r\n-            allTouchLinesPos: {},\r\n-            allOtherTouchLinesPos: [],\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    _onDrawStart(event) {\r\n-        console.log('===== start 111 ====' + event.touch.getLocation());\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        if (state.touch === 'no') {\r\n-            state.touch = 'start';\r\n-            let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-            state.curTouchesPos = tempPos;\r\n-            this.updateState(state);\r\n-        }\r\n-    }\r\n-\r\n-    _onDrawMove(event) {\r\n-\r\n-        this._dragging = true;\r\n-        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-    }\r\n-\r\n-    _onDrawEnd(event) {\r\n-\r\n-        this._dragging = false;\r\n-\r\n-        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.curTouchesPos = tempPos;\r\n-        state.touch = 'end';\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 排序方法\r\n-    comparePosX() {\r\n-        return function (a, b) {\r\n-            var value1 = a.x;\r\n-            var value2 = b.x;\r\n-            return value1 - value2;\r\n-        }\r\n-    }\r\n-\r\n-    // 排序方法\r\n-    comparePosY() {\r\n-        return function (a, b) {\r\n-            var value1 = a.y;\r\n-            var value2 = b.y;\r\n-            return value1 - value2;\r\n-        }\r\n-    }\r\n-\r\n-    private _clickReset(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.reset = true;\r\n-        this.updateState(state);\r\n-\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-\r\n-        if (Object.keys(state.allTouchLinesPos).length === 0) {\r\n-\r\n-            state.submit = this.submitType.GuideShow;\r\n-\r\n-        } else {\r\n-\r\n-            let isAllRight = true;\r\n-            for (let key in state.allTouchLinesPos) {\r\n-\r\n-                if (!state.allTouchLinesPos[key].result) {\r\n-                    isAllRight = false;\r\n-                    break;\r\n-                }\r\n-            }\r\n-            if (isAllRight) {\r\n-                state.submit = this.submitType.RightFeed;\r\n-            } else {\r\n-                state.submit = this.submitType.WrongFeed;\r\n-            }\r\n-        }\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    // 临时\r\n-    // 拖拽定时器\r\n-    dragSchedule() {\r\n-        if (this._dragging) {\r\n-\r\n-            console.log('==== 3333333 拖拽定时器 ======');\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.curTouchesPos = this._moveCurPos;\r\n-            state.touch = \"move\";\r\n-            this.updateState(state);\r\n-        }\r\n-    }\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (state.touch == \"start\") {\r\n-\r\n-            this._curTouchesPos.length = 0;\r\n-            this._curTouchesPos.push(state.curTouchesPos);\r\n-            this.graphics.clear();\r\n-\r\n-        } else if (state.touch == \"move\") {\r\n-\r\n-            this._curTouchesPos.push(state.curTouchesPos);\r\n-\r\n-            const MIN_POINT_DISTANCE = 4;\r\n-\r\n-            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n-            this.graphics.moveTo(this._curTouchesPos[0].x - worldPos.x, this._curTouchesPos[0].y - worldPos.y);\r\n-            let lastIndex = 0;\r\n-            for (let i = 1, l = this._curTouchesPos.length; i < l; i++) {\r\n-                if (this._curTouchesPos[i].sub(this._curTouchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n-                    continue;\r\n-                }\r\n-                lastIndex = i;\r\n-                this.graphics.lineTo(this._curTouchesPos[i].x - worldPos.x, this._curTouchesPos[i].y - worldPos.y);\r\n-            }\r\n-            this.graphics.stroke();\r\n-\r\n-        } else if (state.touch == \"end\") {\r\n-\r\n-            this._curTouchesPos.push(state.curTouchesPos);\r\n-\r\n-            this.graphics.clear();\r\n-            if (this._curTouchesPos.length > 0) {\r\n-\r\n-                for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n-\r\n-                    this._curTouchesPos[i].y = this._view.height - this._curTouchesPos[i].y;\r\n-                }\r\n-\r\n-                for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                    this._allPointRect[i].isContains = false;\r\n-                }\r\n-\r\n-                let pointNums = 0;\r\n-                for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n-\r\n-                    for (let j = 0; j < this._allPointRect.length; j++) {\r\n-\r\n-                        if (this._allPointRect[j].rect.contains(this._curTouchesPos[i])) {\r\n-                            this._allPointRect[j].isContains = true;\r\n-                            break;\r\n-                        }\r\n-                    }\r\n-                }\r\n-                for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                    if (this._allPointRect[i].isContains) {\r\n-                        pointNums++;\r\n-                        continue;\r\n-                    }\r\n-                }\r\n-\r\n-                console.log('===== 5555 =====' + pointNums);\r\n-\r\n-                if (pointNums >= 2) {\r\n-\r\n-                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                        if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n-                            this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n-                            this._allPointRect[i].isPointInner = true;\r\n-                        }\r\n-\r\n-                        if (i === 0 && this._allPointRect[i].isContains) {\r\n-\r\n-                            if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n-\r\n-                                this._allPointRect[i].limitMinx = true;\r\n-                            }\r\n-\r\n-                        } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n-\r\n-                            if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n-\r\n-                                this._allPointRect[i].limitMaxx = true;\r\n-                            }\r\n-\r\n-                        }\r\n-                    }\r\n-\r\n-                    let temp = {};\r\n-                    if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n-\r\n-                        if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n-\r\n-                            // 直线\r\n-                            temp['QiX'] = 799;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = 0;\r\n-                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n-                            temp['result'] = true;\r\n-                            state.allTouchLinesPos['line1'] = temp;\r\n-\r\n-\r\n-                        } else if (this._allPointRect[0].limitMinx && !this._allPointRect[1].limitMaxx) {\r\n-\r\n-                            // 左点超出射线\r\n-                            let pointMidChang = 297;\r\n-\r\n-                            temp['QiX'] = 799;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = 0;\r\n-                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line1'] = temp;\r\n-\r\n-                        } else if (!this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n-\r\n-                            // 右点超出的射线\r\n-                            let pointMaxX = 1096;\r\n-                            let pointMidChang = 297;\r\n-\r\n-                            temp['QiX'] = 799;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = 0;\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line1'] = temp;\r\n-\r\n-                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[1].isPointInner) {\r\n-\r\n-                            //线段\r\n-                            let pointMidChang = 297;\r\n-                            temp['QiX'] = 799;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = 0;\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang;\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line1'] = temp;\r\n-                        }\r\n-\r\n-                    } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains) {\r\n-\r\n-                        if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n-\r\n-                            // 直线\r\n-                            temp['QiX'] = 799;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = -32;\r\n-                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);\r\n-                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n-                            temp['result'] = true;\r\n-                            state.allTouchLinesPos['line2'] = temp;\r\n-\r\n-                        } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n-\r\n-                            // 左点超出射线\r\n-                            let pointMidChang = 702;\r\n-\r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n-                            temp['angle'] = -32;\r\n-                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);;\r\n-                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line2'] = temp;\r\n-\r\n-                        } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n-\r\n-                            // 右点超出的射线\r\n-                            let pointMaxX = 1245;\r\n-                            let pointMidChang = 702;\r\n-\r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n-                            temp['angle'] = -32;\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line2'] = temp;\r\n-\r\n-                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n-\r\n-                            //线段\r\n-                            let pointMidChang = 702;\r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n-                            temp['angle'] = -32;\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang;\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line2'] = temp;\r\n-                        }\r\n-\r\n-                    } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains) {\r\n-\r\n-                        if (this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n-\r\n-                            // 直线\r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n-                            temp['angle'] = -90;\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n-                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n-                            temp['result'] = true;\r\n-                            state.allTouchLinesPos['line3'] = temp;\r\n-\r\n-                        } else if (this._allPointRect[0].limitMaxy && !this._allPointRect[3].limitMiny) {\r\n-\r\n-                            // 下点超出射线\r\n-                            let pointMidChang = 372;\r\n-\r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n-                            temp['angle'] = -90;\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n-                            temp['chang'] = pointMidChang + temp['chaoInterQiY'];\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line3'] = temp;\r\n-\r\n-                        } else if (!this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n-\r\n-                            // 上点超出的射线\r\n-                            let pointMinY = 283;\r\n-                            let pointMidChang = 372;\r\n-\r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n-                            temp['angle'] = -90;\r\n-\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + (pointMinY - this._curTouchesPos[0].y);\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line3'] = temp;\r\n-\r\n-                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[3].isPointInner) {\r\n-\r\n-                            //线段\r\n-                            let pointMidChang = 372;\r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n-                            temp['angle'] = -90;\r\n-\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang;\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line3'] = temp;\r\n-                        }\r\n-                    } else {\r\n-\r\n-                        temp['QiX'] = this._curTouchesPos[0].x;\r\n-                        temp['QiY'] = this._curTouchesPos[0].y;\r\n-                        if (isSortY) {\r\n-                            temp['angle'] = -this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n-                        } else {\r\n-                            temp['angle'] = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n-                        }\r\n-\r\n-                        temp['chaoInterQiX'] = 0;\r\n-                        temp['chaoInterQiY'] = 0;\r\n-                        temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();;\r\n-                        temp['result'] = false;\r\n-                        state.allOtherTouchLinesPos.push(temp);\r\n-                    }\r\n-                }\r\n-\r\n-                setTimeout(() => {\r\n-\r\n-                    let state1: any = globalThis._.cloneDeep(this._state);\r\n-                    state1.touch = 'no';\r\n-                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n-                    state1.allOtherTouchLinesPos = state.allOtherTouchLinesPos;\r\n-                    this.updateState(state1);\r\n-\r\n-                }, 20);\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.allOtherTouchLinesPos, state.allOtherTouchLinesPos)) {\r\n-\r\n-            for (let key in this._allOtherTouchLinesObj) {\r\n-                this._allOtherTouchLinesObj[key].removeFromParent();\r\n-            }\r\n-\r\n-            for (let i = 0; i < state.allOtherTouchLinesPos.length; i++) {\r\n-\r\n-                let temp = state.allOtherTouchLinesPos[i];\r\n-                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                this._view.addChild(zhiLine);\r\n-                zhiLine.width = temp['chang'];\r\n-\r\n-                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                if (temp.isSortY) {\r\n-\r\n-                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n-\r\n-                } else {\r\n-\r\n-                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n-                }\r\n-\r\n-                zhiLine.rotation = temp.angle;\r\n-                this._allOtherTouchLinesObj[i] = zhiLine;\r\n-            }\r\n-\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n-\r\n-            for (let key in this._allTouchLinesObj) {\r\n-                this._allTouchLinesObj[key].removeFromParent();\r\n-            }\r\n-\r\n-            for (let key in state.allTouchLinesPos) {\r\n-\r\n-                let temp = state.allTouchLinesPos[key];\r\n-                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                this._view.addChild(zhiLine);\r\n-                zhiLine.width = temp['chang'];\r\n-\r\n-                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                if (temp.isSortY) {\r\n-\r\n-                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n-\r\n-                } else {\r\n-\r\n-                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n-                }\r\n-\r\n-                zhiLine.rotation = temp.angle;\r\n-                this._allTouchLinesObj[key] = zhiLine;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.reset, state.reset)) {\r\n-\r\n-            if (state.reset) {\r\n-\r\n-                for (let key in state.allTouchLinesPos) {\r\n-                    delete state.allTouchLinesPos[key];\r\n-                }\r\n-\r\n-                for (let key in this._allTouchLinesObj) {\r\n-                    this._allTouchLinesObj[key].removeFromParent();\r\n-                }\r\n-\r\n-                for (let key in this._allOtherTouchLinesObj) {\r\n-                    this._allOtherTouchLinesObj[key].removeFromParent();\r\n-                }\r\n-\r\n-                setTimeout(() => {\r\n-\r\n-                    let state1: any = globalThis._.cloneDeep(this._state);\r\n-                    state1.reset = false;\r\n-                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n-                    state1.allOtherTouchLinesPos = [];\r\n-                    this.updateState(state1);\r\n-\r\n-                }, 10);\r\n-\r\n-            }\r\n-\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-                // let keyBtn = this._view.getChild('input1').asButton;\r\n-                // this.handTips2(keyBtn);\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-    angle(start, end) {\r\n-        var diff_x = end.x - start.x,\r\n-            diff_y = end.y - start.y;\r\n-        //返回角度,不是弧度\r\n-        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-        this.schedule(this.dragSchedule, this._scheduleTime);\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1625407364132,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -121,9 +121,9 @@\n                     'isContains': false,\r\n                     'minx': img.x,\r\n                     'maxx': img.y + img.width,\r\n                     'miny': img.y,\r\n-                    'maxy': img.y + ,\r\n+                    'maxy': img.y + img.height,\r\n                     'limitMinx': false,\r\n                     'limitMaxy': false,\r\n                     'isPointInner': false,\r\n                 };\r\n"
                },
                {
                    "date": 1625407389626,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -125,8 +125,9 @@\n                     'maxy': img.y + img.height,\r\n                     'limitMinx': false,\r\n                     'limitMaxy': false,\r\n                     'isPointInner': false,\r\n+                    'isPointInner': false\r\n                 };\r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1625407400856,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -124,9 +124,8 @@\n                     'miny': img.y,\r\n                     'maxy': img.y + img.height,\r\n                     'limitMinx': false,\r\n                     'limitMaxy': false,\r\n-                    'isPointInner': false,\r\n                     'isPointInner': false\r\n                 };\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1625407415553,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -126,8 +126,9 @@\n                     'limitMinx': false,\r\n                     'limitMaxy': false,\r\n                     'isPointInner': false\r\n                 };\r\n+\r\n             }\r\n         }\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n"
                },
                {
                    "date": 1625407424238,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -127,8 +127,9 @@\n                     'limitMaxy': false,\r\n                     'isPointInner': false\r\n                 };\r\n \r\n+\r\n             }\r\n         }\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n"
                },
                {
                    "date": 1625407466369,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -128,8 +128,9 @@\n                     'isPointInner': false\r\n                 };\r\n \r\n \r\n+\r\n             }\r\n         }\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n"
                },
                {
                    "date": 1625407507727,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -126,11 +126,11 @@\n                     'limitMinx': false,\r\n                     'limitMaxy': false,\r\n                     'isPointInner': false\r\n                 };\r\n+                this._allPointRect.push();\r\n \r\n \r\n-\r\n             }\r\n         }\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n"
                },
                {
                    "date": 1625407513026,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -126,11 +126,9 @@\n                     'limitMinx': false,\r\n                     'limitMaxy': false,\r\n                     'isPointInner': false\r\n                 };\r\n-                this._allPointRect.push();\r\n-\r\n-\r\n+                this._allPointRect.push(temp);\r\n             }\r\n         }\r\n \r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n"
                },
                {
                    "date": 1625407523453,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -84,31 +84,8 @@\n             this._c1.selectedIndex = 1;\r\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n-        this._allPointRect = [{\r\n-            'rect': new cc.Rect(764, 590, 71, 71),\r\n-            'isContains': false,\r\n-            'minx': 764,\r\n-            'maxx': 835,\r\n-            'miny': 590,\r\n-            'maxy': 661,\r\n-            'limitMinx': false,\r\n-            'limitMaxy': false,\r\n-            'isPointInner': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(1060, 590, 71, 71), 'isContains': false, 'minx': 1060, 'maxx': 1131, 'miny': 590, 'maxy': 661,\r\n-            'limitMaxx': false,\r\n-            'isPointInner': false,\r\n-        },\r\n-        {\r\n-            'rect': new cc.Rect(918, 368, 71, 71), 'isContains': false, 'minx': 918, 'maxx': 978, 'miny': 368, 'maxy': 439,\r\n-            'limitMaxx': false,\r\n-            'isPointInner': false,\r\n-        }\r\n-        ];\r\n-\r\n         // let tt1 = new cc.Vec2(1247, 282);\r\n         // let tt2 = new cc.Vec2(652, 655);\r\n         // console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n \r\n"
                },
                {
                    "date": 1625407683812,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -433,9 +433,9 @@\n \r\n                             // 直线\r\n                             temp['QiX'] = 799;\r\n                             temp['QiY'] = 626;\r\n-                            temp['angle'] = -32;\r\n+                            temp['angle'] = -54;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n                             temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n"
                },
                {
                    "date": 1625407704163,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -435,9 +435,9 @@\n                             temp['QiX'] = 799;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -54;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);\r\n+                            temp['chaoInterQiY'] = Math.tan(-54) * (temp['QiX'] - this._curTouchesPos[0].x);\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625407841441,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -84,11 +84,11 @@\n             this._c1.selectedIndex = 1;\r\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n-        // let tt1 = new cc.Vec2(1247, 282);\r\n-        // let tt2 = new cc.Vec2(652, 655);\r\n-        // console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n+        let tt1 = new cc.Vec2(1247, 282);\r\n+        let tt2 = new cc.Vec2(652, 655);\r\n+        console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n \r\n         let pointGroup = this._view.getChild(\"n84\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == pointGroup) {\r\n"
                },
                {
                    "date": 1625407858922,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -84,10 +84,10 @@\n             this._c1.selectedIndex = 1;\r\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n-        let tt1 = new cc.Vec2(1247, 282);\r\n-        let tt2 = new cc.Vec2(652, 655);\r\n+        let tt1 = new cc.Vec2(953, 403);\r\n+        let tt2 = new cc.Vec2(800, 626);\r\n         console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n \r\n         let pointGroup = this._view.getChild(\"n84\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n"
                },
                {
                    "date": 1625408212148,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -84,11 +84,11 @@\n             this._c1.selectedIndex = 1;\r\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n-        let tt1 = new cc.Vec2(953, 403);\r\n-        let tt2 = new cc.Vec2(800, 626);\r\n-        console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n+        // let tt1 = new cc.Vec2(953, 403);\r\n+        // let tt2 = new cc.Vec2(800, 626);\r\n+        // console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n \r\n         let pointGroup = this._view.getChild(\"n84\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == pointGroup) {\r\n"
                },
                {
                    "date": 1625408227204,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -443,9 +443,9 @@\n \r\n                         } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 左点超出射线\r\n-                            let pointMidChang = 702;\r\n+                            let pointMidChang = 270;\r\n \r\n                             temp['QiX'] = 652;\r\n                             temp['QiY'] = 655;\r\n                             temp['angle'] = -32;\r\n"
                },
                {
                    "date": 1625408234346,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -445,10 +445,10 @@\n \r\n                             // 左点超出射线\r\n                             let pointMidChang = 270;\r\n \r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n                             temp['angle'] = -32;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n                             temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);;\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n"
                },
                {
                    "date": 1625408259852,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -447,11 +447,11 @@\n                             let pointMidChang = 270;\r\n \r\n                             temp['QiX'] = 799;\r\n                             temp['QiY'] = 626;\r\n-                            temp['angle'] = -32;\r\n+                            temp['angle'] = -54;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(-32) * (652 - this._curTouchesPos[0].x);;\r\n+                            temp['chaoInterQiY'] = Math.tan(-54) * (temp['QiX'] - this._curTouchesPos[0].x);;\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625408279505,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -460,11 +460,13 @@\n                             // 右点超出的射线\r\n                             let pointMaxX = 1245;\r\n                             let pointMidChang = 702;\r\n \r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n-                            temp['angle'] = -32;\r\n+                            let pointMidChang = 270;\r\n+\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = -54;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n                             temp['result'] = false;\r\n"
                },
                {
                    "date": 1625408286315,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -458,10 +458,8 @@\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n                             let pointMaxX = 1245;\r\n-                            let pointMidChang = 702;\r\n-\r\n                             let pointMidChang = 270;\r\n \r\n                             temp['QiX'] = 799;\r\n                             temp['QiY'] = 626;\r\n"
                },
                {
                    "date": 1625408336012,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -457,9 +457,9 @@\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n-                            let pointMaxX = 1245;\r\n+                            let pointMaxX = 953;\r\n                             let pointMidChang = 270;\r\n \r\n                             temp['QiX'] = 799;\r\n                             temp['QiY'] = 626;\r\n"
                },
                {
                    "date": 1625408344204,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -472,9 +472,9 @@\n \r\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n                             //线段\r\n-                            let pointMidChang = 702;\r\n+                            let pointMidChang = 270;\r\n                             temp['QiX'] = 652;\r\n                             temp['QiY'] = 655;\r\n                             temp['angle'] = -32;\r\n                             temp['chaoInterQiX'] = 0;\r\n"
                },
                {
                    "date": 1625408350745,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -473,11 +473,11 @@\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n                             //线段\r\n                             let pointMidChang = 270;\r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n-                            temp['angle'] = -32;\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = -54;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = pointMidChang;\r\n                             temp['result'] = false;\r\n"
                },
                {
                    "date": 1625408368535,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -483,9 +483,9 @@\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n                         }\r\n \r\n-                    } else if (this._allPointRect[0].isContains && this._allPointRect[3].isContains) {\r\n+                    } else if (this._allPointRect[2].isContains && this._allPointRect[3].isContains) {\r\n \r\n                         if (this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n \r\n                             // 直线\r\n"
                },
                {
                    "date": 1625408373689,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -485,9 +485,9 @@\n                         }\r\n \r\n                     } else if (this._allPointRect[2].isContains && this._allPointRect[3].isContains) {\r\n \r\n-                        if (this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+                        if (this._allPointRect[2].limitMaxy && this._allPointRect[3].limitMiny) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 652;\r\n                             temp['QiY'] = 655;\r\n"
                },
                {
                    "date": 1625408439471,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -100,8 +100,9 @@\n                     'maxx': img.y + img.width,\r\n                     'miny': img.y,\r\n                     'maxy': img.y + img.height,\r\n                     'limitMinx': false,\r\n+                    'limitMinx': false,\r\n                     'limitMaxy': false,\r\n                     'isPointInner': false\r\n                 };\r\n                 this._allPointRect.push(temp);\r\n"
                },
                {
                    "date": 1625408445629,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -100,9 +100,9 @@\n                     'maxx': img.y + img.width,\r\n                     'miny': img.y,\r\n                     'maxy': img.y + img.height,\r\n                     'limitMinx': false,\r\n-                    'limitMinx': false,\r\n+                    'limitMaxx': false,\r\n                     'limitMaxy': false,\r\n                     'isPointInner': false\r\n                 };\r\n                 this._allPointRect.push(temp);\r\n"
                },
                {
                    "date": 1625408519318,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -364,9 +364,13 @@\n                             if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                                 this._allPointRect[i].limitMaxx = true;\r\n                             }\r\n+                            if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n+                                this._allPointRect[i].limitMaxx = true;\r\n+                            }\r\n+\r\n                         }\r\n                     }\r\n \r\n                     let temp = {};\r\n"
                },
                {
                    "date": 1625408534734,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -364,9 +364,9 @@\n                             if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                                 this._allPointRect[i].limitMaxx = true;\r\n                             }\r\n-                            if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n+                            if (this._curTouchesPos[0].x > this._allPointRect[i].minx) {\r\n \r\n                                 this._allPointRect[i].limitMaxx = true;\r\n                             }\r\n \r\n"
                },
                {
                    "date": 1625408544255,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -364,9 +364,9 @@\n                             if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                                 this._allPointRect[i].limitMaxx = true;\r\n                             }\r\n-                            if (this._curTouchesPos[0].x > this._allPointRect[i].minx) {\r\n+                            if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n                                 this._allPointRect[i].limitMaxx = true;\r\n                             }\r\n \r\n"
                },
                {
                    "date": 1625408552071,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -366,9 +366,9 @@\n                                 this._allPointRect[i].limitMaxx = true;\r\n                             }\r\n                             if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n-                                this._allPointRect[i].limitMaxx = true;\r\n+                                this._allPointRect[i].limitMinx = true;\r\n                             }\r\n \r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625408586298,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -490,9 +490,9 @@\n                         }\r\n \r\n                     } else if (this._allPointRect[2].isContains && this._allPointRect[3].isContains) {\r\n \r\n-                        if (this._allPointRect[2].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+                        if (this._allPointRect[2].limitMaxy && this._allPointRect[3].limitMaxx) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 652;\r\n                             temp['QiY'] = 655;\r\n"
                },
                {
                    "date": 1625408593454,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -490,9 +490,9 @@\n                         }\r\n \r\n                     } else if (this._allPointRect[2].isContains && this._allPointRect[3].isContains) {\r\n \r\n-                        if (this._allPointRect[2].limitMaxy && this._allPointRect[3].limitMaxx) {\r\n+                        if (this._allPointRect[2].limitMinx && this._allPointRect[3].limitMaxx) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 652;\r\n                             temp['QiY'] = 655;\r\n"
                },
                {
                    "date": 1625408725294,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -493,9 +493,9 @@\n \r\n                         if (this._allPointRect[2].limitMinx && this._allPointRect[3].limitMaxx) {\r\n \r\n                             // 直线\r\n-                            temp['QiX'] = 652;\r\n+                            temp['QiX'] = 953;\r\n                             temp['QiY'] = 655;\r\n                             temp['angle'] = -90;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n"
                },
                {
                    "date": 1625408730492,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -494,9 +494,9 @@\n                         if (this._allPointRect[2].limitMinx && this._allPointRect[3].limitMaxx) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 953;\r\n-                            temp['QiY'] = 655;\r\n+                            temp['QiY'] = 403;\r\n                             temp['angle'] = -90;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n"
                },
                {
                    "date": 1625408743738,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -495,9 +495,9 @@\n \r\n                             // 直线\r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n-                            temp['angle'] = -90;\r\n+                            temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n"
                },
                {
                    "date": 1625408849558,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -496,9 +496,9 @@\n                             // 直线\r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n-                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiX'] = this._curTouchesPos[0].x - ;\r\n                             temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n"
                },
                {
                    "date": 1625408855970,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -496,9 +496,9 @@\n                             // 直线\r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n-                            temp['chaoInterQiX'] = this._curTouchesPos[0].x - ;\r\n+                            temp['chaoInterQiX'] = this._curTouchesPos[0].x - temp['QiX'];\r\n                             temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n"
                },
                {
                    "date": 1625408885834,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -496,9 +496,9 @@\n                             // 直线\r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n-                            temp['chaoInterQiX'] = this._curTouchesPos[0].x - temp['QiX'];\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x - ;\r\n                             temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n"
                },
                {
                    "date": 1625408934103,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -496,18 +496,18 @@\n                             // 直线\r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n-                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x - ;\r\n-                            temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n                         } else if (this._allPointRect[0].limitMaxy && !this._allPointRect[3].limitMiny) {\r\n \r\n                             // 下点超出射线\r\n-                            let pointMidChang = 372;\r\n+                            let pointMidChang = 272;\r\n \r\n                             temp['QiX'] = 652;\r\n                             temp['QiY'] = 655;\r\n                             temp['angle'] = -90;\r\n"
                },
                {
                    "date": 1625408945083,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -507,11 +507,11 @@\n \r\n                             // 下点超出射线\r\n                             let pointMidChang = 272;\r\n \r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n-                            temp['angle'] = -90;\r\n+                            temp['QiX'] = 953;\r\n+                            temp['QiY'] = 403;\r\n+                            temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiY'];\r\n                             temp['result'] = false;\r\n"
                },
                {
                    "date": 1625408957263,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -504,9 +504,9 @@\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n                         } else if (this._allPointRect[0].limitMaxy && !this._allPointRect[3].limitMiny) {\r\n \r\n-                            // 下点超出射线\r\n+                            // 左点超出射线\r\n                             let pointMidChang = 272;\r\n \r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n"
                },
                {
                    "date": 1625408967160,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -510,9 +510,9 @@\n \r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n-                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n                             temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiY'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n"
                },
                {
                    "date": 1625408972235,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -511,9 +511,9 @@\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = this._curTouchesPos[this._curTouchesPos.length - 1].y - temp['QiY'];\r\n+                            temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiY'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625409025672,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -505,8 +505,20 @@\n \r\n                         } else if (this._allPointRect[0].limitMaxy && !this._allPointRect[3].limitMiny) {\r\n \r\n                             // 左点超出射线\r\n+                            let pointMidChang = 270;\r\n+\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = -54;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = Math.tan(-54) * (temp['QiX'] - this._curTouchesPos[0].x);;\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n+\r\n+                            // 左点超出射线\r\n                             let pointMidChang = 272;\r\n \r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n"
                },
                {
                    "date": 1625409047593,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -523,9 +523,9 @@\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chaoInterQiY'] = Math.tan(-54) * (temp['QiX'] - this._curTouchesPos[0].x);;\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiY'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625409052767,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -523,9 +523,9 @@\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(-54) * (temp['QiX'] - this._curTouchesPos[0].x);;\r\n+                            temp['chaoInterQiY'] = Math.tan(-54) * (temp['QiX'] - this._curTouchesPos[0].x);\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiY'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625409057955,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -523,9 +523,9 @@\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(-54) * (temp['QiX'] - this._curTouchesPos[0].x);\r\n+                            temp['chaoInterQiY'] = Math.tan(57) * (temp['QiX'] - this._curTouchesPos[0].x);\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiY'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625409071682,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -524,9 +524,9 @@\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n                             temp['chaoInterQiY'] = Math.tan(57) * (temp['QiX'] - this._curTouchesPos[0].x);\r\n-                            temp['chang'] = pointMidChang + temp['chaoInterQiY'];\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n                         } else if (!this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n"
                },
                {
                    "date": 1625409079263,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -505,20 +505,8 @@\n \r\n                         } else if (this._allPointRect[0].limitMaxy && !this._allPointRect[3].limitMiny) {\r\n \r\n                             // 左点超出射线\r\n-                            let pointMidChang = 270;\r\n-\r\n-                            temp['QiX'] = 799;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = -54;\r\n-                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(-54) * (temp['QiX'] - this._curTouchesPos[0].x);;\r\n-                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line2'] = temp;\r\n-\r\n-                            // 左点超出射线\r\n                             let pointMidChang = 272;\r\n \r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n"
                },
                {
                    "date": 1625409097456,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -518,8 +518,21 @@\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n                         } else if (!this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n \r\n+                            // 右点超出的射线\r\n+                            let pointMaxX = 953;\r\n+                            let pointMidChang = 270;\r\n+\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = -54;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n+\r\n                             // 上点超出的射线\r\n                             let pointMinY = 283;\r\n                             let pointMidChang = 372;\r\n \r\n"
                },
                {
                    "date": 1625409113869,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -529,22 +529,8 @@\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n                             temp['result'] = false;\r\n-                            state.allTouchLinesPos['line2'] = temp;\r\n-\r\n-                            // 上点超出的射线\r\n-                            let pointMinY = 283;\r\n-                            let pointMidChang = 372;\r\n-\r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n-                            temp['angle'] = -90;\r\n-\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + (pointMinY - this._curTouchesPos[0].y);\r\n-                            temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[3].isPointInner) {\r\n \r\n"
                },
                {
                    "date": 1625409136832,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -519,9 +519,9 @@\n \r\n                         } else if (!this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n \r\n                             // 右点超出的射线\r\n-                            let pointMaxX = 953;\r\n+                            let pointMaxX = 1096;\r\n                             let pointMidChang = 270;\r\n \r\n                             temp['QiX'] = 799;\r\n                             temp['QiY'] = 626;\r\n"
                },
                {
                    "date": 1625409141965,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -520,9 +520,9 @@\n                         } else if (!this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n \r\n                             // 右点超出的射线\r\n                             let pointMaxX = 1096;\r\n-                            let pointMidChang = 270;\r\n+                            let pointMidChang = 272;\r\n \r\n                             temp['QiX'] = 799;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -54;\r\n"
                },
                {
                    "date": 1625409149201,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -522,11 +522,11 @@\n                             // 右点超出的射线\r\n                             let pointMaxX = 1096;\r\n                             let pointMidChang = 272;\r\n \r\n-                            temp['QiX'] = 799;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = -54;\r\n+                            temp['QiX'] = 953;\r\n+                            temp['QiY'] = 403;\r\n+                            temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n                             temp['result'] = false;\r\n"
                },
                {
                    "date": 1625409211363,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -534,9 +534,9 @@\n \r\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[3].isPointInner) {\r\n \r\n                             //线段\r\n-                            let pointMidChang = 372;\r\n+                            let pointMidChang = 272;\r\n                             temp['QiX'] = 652;\r\n                             temp['QiY'] = 655;\r\n                             temp['angle'] = -90;\r\n \r\n"
                },
                {
                    "date": 1625409216895,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -535,12 +535,11 @@\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[3].isPointInner) {\r\n \r\n                             //线段\r\n                             let pointMidChang = 272;\r\n-                            temp['QiX'] = 652;\r\n-                            temp['QiY'] = 655;\r\n-                            temp['angle'] = -90;\r\n-\r\n+                            temp['QiX'] = 953;\r\n+                            temp['QiY'] = 403;\r\n+                            temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = pointMidChang;\r\n                             temp['result'] = false;\r\n"
                },
                {
                    "date": 1625409225514,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -544,23 +544,8 @@\n                             temp['chang'] = pointMidChang;\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n                         }\r\n-                    } else {\r\n-\r\n-                        temp['QiX'] = this._curTouchesPos[0].x;\r\n-                        temp['QiY'] = this._curTouchesPos[0].y;\r\n-                        if (isSortY) {\r\n-                            temp['angle'] = -this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n-                        } else {\r\n-                            temp['angle'] = this.angle(this._curTouchesPos[0], this._curTouchesPos[this._curTouchesPos.length - 1]);\r\n-                        }\r\n-\r\n-                        temp['chaoInterQiX'] = 0;\r\n-                        temp['chaoInterQiY'] = 0;\r\n-                        temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();;\r\n-                        temp['result'] = false;\r\n-                        state.allOtherTouchLinesPos.push(temp);\r\n                     }\r\n                 }\r\n \r\n                 setTimeout(() => {\r\n"
                },
                {
                    "date": 1625409241337,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -573,17 +573,10 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = temp['chang'];\r\n \r\n                 zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                if (temp.isSortY) {\r\n+                zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n \r\n-                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n-\r\n-                } else {\r\n-\r\n-                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n-                }\r\n-\r\n                 zhiLine.rotation = temp.angle;\r\n                 this._allOtherTouchLinesObj[i] = zhiLine;\r\n             }\r\n \r\n"
                },
                {
                    "date": 1625409262682,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -595,17 +595,10 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = temp['chang'];\r\n \r\n                 zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                if (temp.isSortY) {\r\n+                zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n \r\n-                    zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n-\r\n-                } else {\r\n-\r\n-                    zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n-                }\r\n-\r\n                 zhiLine.rotation = temp.angle;\r\n                 this._allTouchLinesObj[key] = zhiLine;\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1625409634631,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -316,8 +316,10 @@\n \r\n                     this._curTouchesPos[i].y = this._view.height - this._curTouchesPos[i].y;\r\n                 }\r\n \r\n+                this._curTouchesPos.sort(this.comparePosX());\r\n+\r\n                 for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                     this._allPointRect[i].isContains = false;\r\n                 }\r\n"
                },
                {
                    "date": 1625410010549,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -438,13 +438,13 @@\n \r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 直线\r\n-                            temp['QiX'] = 799;\r\n+                            temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n-                            temp['angle'] = -54;\r\n+                            temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(-54) * (temp['QiX'] - this._curTouchesPos[0].x);\r\n+                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * (temp['QiX'] - this._curTouchesPos[0].x);\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n@@ -452,11 +452,11 @@\n \r\n                             // 左点超出射线\r\n                             let pointMidChang = 270;\r\n \r\n-                            temp['QiX'] = 799;\r\n+                            temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n-                            temp['angle'] = -54;\r\n+                            temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n                             temp['chaoInterQiY'] = Math.tan(-54) * (temp['QiX'] - this._curTouchesPos[0].x);;\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n@@ -467,11 +467,11 @@\n                             // 右点超出的射线\r\n                             let pointMaxX = 953;\r\n                             let pointMidChang = 270;\r\n \r\n-                            temp['QiX'] = 799;\r\n+                            temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n-                            temp['angle'] = -54;\r\n+                            temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n                             temp['result'] = false;\r\n@@ -480,11 +480,11 @@\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n                             //线段\r\n                             let pointMidChang = 270;\r\n-                            temp['QiX'] = 799;\r\n+                            temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n-                            temp['angle'] = -54;\r\n+                            temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = pointMidChang;\r\n                             temp['result'] = false;\r\n"
                },
                {
                    "date": 1625410018605,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -456,9 +456,9 @@\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(-54) * (temp['QiX'] - this._curTouchesPos[0].x);;\r\n+                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * (temp['QiX'] - this._curTouchesPos[0].x);;\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625410193615,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -464,17 +464,17 @@\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n-                            let pointMaxX = 953;\r\n+                            let pointMaxX = 986;\r\n                             let pointMidChang = 270;\r\n \r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n+                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX) + ;\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n"
                },
                {
                    "date": 1625410201136,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -472,9 +472,9 @@\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX) + ;\r\n+                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX) + 35;\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n"
                },
                {
                    "date": 1625410417812,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -472,9 +472,9 @@\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX) + 35;\r\n+                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n"
                },
                {
                    "date": 1625410462125,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -464,9 +464,9 @@\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n-                            let pointMaxX = 986;\r\n+                            let pointMaxY = 986;\r\n                             let pointMidChang = 270;\r\n \r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n"
                },
                {
                    "date": 1625410468551,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -464,9 +464,9 @@\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n-                            let pointMaxY = 986;\r\n+                            let pointMaxY = 376;\r\n                             let pointMidChang = 270;\r\n \r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n"
                },
                {
                    "date": 1625410483942,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -472,9 +472,9 @@\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n+                            temp['chang'] = pointMidChang + (pointMaxY - this._curTouchesPos[this._curTouchesPos.length - 1].y);\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n"
                },
                {
                    "date": 1625410529311,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -464,9 +464,9 @@\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n-                            let pointMaxY = 376;\r\n+                            let pointMaxY = 388;\r\n                             let pointMidChang = 270;\r\n \r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n"
                },
                {
                    "date": 1625410534431,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -464,9 +464,9 @@\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n-                            let pointMaxY = 388;\r\n+                            let pointMaxY = 385;\r\n                             let pointMidChang = 270;\r\n \r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n"
                },
                {
                    "date": 1625410577607,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -450,9 +450,9 @@\n \r\n                         } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 左点超出射线\r\n-                            let pointMidChang = 270;\r\n+                            let pointMidChang = 280;\r\n \r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n@@ -465,9 +465,9 @@\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n                             let pointMaxY = 385;\r\n-                            let pointMidChang = 270;\r\n+                            let pointMidChang = 280;\r\n \r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n@@ -479,9 +479,9 @@\n \r\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n                             //线段\r\n-                            let pointMidChang = 270;\r\n+                            let pointMidChang = 280;\r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = 0;\r\n"
                },
                {
                    "date": 1625410582958,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -464,9 +464,9 @@\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n-                            let pointMaxY = 385;\r\n+                            let pointMaxY = 380;\r\n                             let pointMidChang = 280;\r\n \r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n"
                },
                {
                    "date": 1625410642102,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -464,9 +464,9 @@\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n-                            let pointMaxY = 380;\r\n+                            let pointMaxY = 385;\r\n                             let pointMidChang = 280;\r\n \r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n"
                },
                {
                    "date": 1625410712185,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -456,9 +456,9 @@\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * (temp['QiX'] - this._curTouchesPos[0].x);;\r\n+                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625410797237,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -575,9 +575,9 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = temp['chang'];\r\n \r\n                 zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n+                zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n \r\n                 zhiLine.rotation = temp.angle;\r\n                 this._allOtherTouchLinesObj[i] = zhiLine;\r\n             }\r\n"
                },
                {
                    "date": 1625410868750,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -561,30 +561,9 @@\n                 }, 20);\r\n             }\r\n         }\r\n \r\n-        if (!globalThis._.isEqual(oldState.allOtherTouchLinesPos, state.allOtherTouchLinesPos)) {\r\n \r\n-            for (let key in this._allOtherTouchLinesObj) {\r\n-                this._allOtherTouchLinesObj[key].removeFromParent();\r\n-            }\r\n-\r\n-            for (let i = 0; i < state.allOtherTouchLinesPos.length; i++) {\r\n-\r\n-                let temp = state.allOtherTouchLinesPos[i];\r\n-                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                this._view.addChild(zhiLine);\r\n-                zhiLine.width = temp['chang'];\r\n-\r\n-                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n-\r\n-                zhiLine.rotation = temp.angle;\r\n-                this._allOtherTouchLinesObj[i] = zhiLine;\r\n-            }\r\n-\r\n-        }\r\n-\r\n         if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n \r\n             for (let key in this._allTouchLinesObj) {\r\n                 this._allTouchLinesObj[key].removeFromParent();\r\n@@ -597,9 +576,9 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = temp['chang'];\r\n \r\n                 zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n+                zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n \r\n                 zhiLine.rotation = temp.angle;\r\n                 this._allTouchLinesObj[key] = zhiLine;\r\n             }\r\n"
                },
                {
                    "date": 1625410911434,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -576,9 +576,9 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = temp['chang'];\r\n \r\n                 zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n+                zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n \r\n                 zhiLine.rotation = temp.angle;\r\n                 this._allTouchLinesObj[key] = zhiLine;\r\n             }\r\n"
                },
                {
                    "date": 1625411203304,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -442,9 +442,9 @@\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * (temp['QiX'] - this._curTouchesPos[0].x);\r\n+                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625411329057,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -576,9 +576,9 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = temp['chang'];\r\n \r\n                 zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n+                zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n \r\n                 zhiLine.rotation = temp.angle;\r\n                 this._allTouchLinesObj[key] = zhiLine;\r\n             }\r\n"
                },
                {
                    "date": 1625411345916,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -576,9 +576,9 @@\n                 this._view.addChild(zhiLine);\r\n                 zhiLine.width = temp['chang'];\r\n \r\n                 zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                zhiLine.y = temp.QiY + temp.chaoInterQiY;\r\n+                zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n \r\n                 zhiLine.rotation = temp.angle;\r\n                 this._allTouchLinesObj[key] = zhiLine;\r\n             }\r\n"
                },
                {
                    "date": 1625411406017,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -490,11 +490,11 @@\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n                         }\r\n \r\n-                    } else if (this._allPointRect[2].isContains && this._allPointRect[3].isContains) {\r\n+                    } else if (this._allPointRect[1].isContains && this._allPointRect[2].isContains) {\r\n \r\n-                        if (this._allPointRect[2].limitMinx && this._allPointRect[3].limitMaxx) {\r\n+                        if (this._allPointRect[1].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n"
                },
                {
                    "date": 1625411438586,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -504,9 +504,9 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                        } else if (this._allPointRect[0].limitMaxy && !this._allPointRect[3].limitMiny) {\r\n+                        } else if (this._allPointRect[1].limitMaxy && !this._allPointRect[2].limitMiny) {\r\n \r\n                             // 左点超出射线\r\n                             let pointMidChang = 272;\r\n \r\n@@ -518,9 +518,9 @@\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                        } else if (!this._allPointRect[0].limitMaxy && this._allPointRect[3].limitMiny) {\r\n+                        } else if (!this._allPointRect[1].limitMaxy && this._allPointRect[2].limitMiny) {\r\n \r\n                             // 右点超出的射线\r\n                             let pointMaxX = 1096;\r\n                             let pointMidChang = 272;\r\n@@ -533,9 +533,9 @@\n                             temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[3].isPointInner) {\r\n+                        } else if (this._allPointRect[1].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n                             //线段\r\n                             let pointMidChang = 272;\r\n                             temp['QiX'] = 953;\r\n"
                },
                {
                    "date": 1625411495036,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -491,11 +491,11 @@\n                             state.allTouchLinesPos['line2'] = temp;\r\n                         }\r\n \r\n                     } else if (this._allPointRect[1].isContains && this._allPointRect[2].isContains) {\r\n+                        limitMaxx\r\n+                        if (this._allPointRect[1].limitMinx && this._allPointRect[2].limitMinx) {\r\n \r\n-                        if (this._allPointRect[1].limitMinx && this._allPointRect[2].limitMaxx) {\r\n-\r\n                             // 直线\r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n"
                },
                {
                    "date": 1625411500261,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -491,11 +491,11 @@\n                             state.allTouchLinesPos['line2'] = temp;\r\n                         }\r\n \r\n                     } else if (this._allPointRect[1].isContains && this._allPointRect[2].isContains) {\r\n-                        limitMaxx\r\n-                        if (this._allPointRect[1].limitMinx && this._allPointRect[2].limitMinx) {\r\n \r\n+                        if (this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n+\r\n                             // 直线\r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n"
                },
                {
                    "date": 1625411513243,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -504,9 +504,9 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                        } else if (this._allPointRect[1].limitMaxy && !this._allPointRect[2].limitMiny) {\r\n+                        } else if (this._allPointRect[1].limitMaxx && !this._allPointRect[2].limitMinx) {\r\n \r\n                             // 左点超出射线\r\n                             let pointMidChang = 272;\r\n \r\n"
                },
                {
                    "date": 1625411576561,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -504,9 +504,9 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                        } else if (this._allPointRect[1].limitMaxx && !this._allPointRect[2].limitMinx) {\r\n+                        } else if (!this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n \r\n                             // 左点超出射线\r\n                             let pointMidChang = 272;\r\n \r\n@@ -518,9 +518,9 @@\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                        } else if (!this._allPointRect[1].limitMaxy && this._allPointRect[2].limitMiny) {\r\n+                        } else if (!this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n \r\n                             // 右点超出的射线\r\n                             let pointMaxX = 1096;\r\n                             let pointMidChang = 272;\r\n"
                },
                {
                    "date": 1625411592380,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -518,9 +518,9 @@\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                        } else if (!this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n+                        } else if (this._allPointRect[1].limitMaxx && !this._allPointRect[2].limitMinx) {\r\n \r\n                             // 右点超出的射线\r\n                             let pointMaxX = 1096;\r\n                             let pointMidChang = 272;\r\n"
                },
                {
                    "date": 1625411619338,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -529,9 +529,9 @@\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n+                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].y - pointMaxY);\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n                         } else if (this._allPointRect[1].isPointInner && this._allPointRect[2].isPointInner) {\r\n"
                },
                {
                    "date": 1625411646066,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -521,9 +521,9 @@\n \r\n                         } else if (this._allPointRect[1].limitMaxx && !this._allPointRect[2].limitMinx) {\r\n \r\n                             // 右点超出的射线\r\n-                            let pointMaxX = 1096;\r\n+                            let pointMaxY = 660;\r\n                             let pointMidChang = 272;\r\n \r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n"
                },
                {
                    "date": 1625411738306,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -507,9 +507,9 @@\n \r\n                         } else if (!this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n \r\n                             // 左点超出射线\r\n-                            let pointMidChang = 272;\r\n+                            let pointMidChang = 280;\r\n \r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n@@ -522,9 +522,9 @@\n                         } else if (this._allPointRect[1].limitMaxx && !this._allPointRect[2].limitMinx) {\r\n \r\n                             // 右点超出的射线\r\n                             let pointMaxY = 660;\r\n-                            let pointMidChang = 272;\r\n+                            let pointMidChang = 280;\r\n \r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n@@ -536,9 +536,9 @@\n \r\n                         } else if (this._allPointRect[1].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n                             //线段\r\n-                            let pointMidChang = 272;\r\n+                            let pointMidChang = 280;\r\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = 0;\r\n"
                },
                {
                    "date": 1625411934517,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -460,8 +460,9 @@\n                             temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n+                            console.log('==== ===' + );\r\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n"
                },
                {
                    "date": 1625411941808,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -460,9 +460,9 @@\n                             temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n-                            console.log('==== ===' + );\r\n+                            console.log('==== ===' + temp['chaoInterQiX']);\r\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n"
                },
                {
                    "date": 1625411946880,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -460,9 +460,9 @@\n                             temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n-                            console.log('==== ===' + temp['chaoInterQiX']);\r\n+                            console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n"
                },
                {
                    "date": 1625411952528,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -461,8 +461,9 @@\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n                             console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n+                            console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n"
                },
                {
                    "date": 1625411960786,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -461,9 +461,9 @@\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n                             console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n-                            console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n+                            console.log('==== chaoInterQiX ===' + temp['chaoInterQiY']);\r\n \r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n"
                },
                {
                    "date": 1625411969008,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,764 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v3 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _resetBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _curTouchesPos: any = [];\r\n+\r\n+    private _moveCurPos: cc.Vec2;\r\n+\r\n+    private graphics: cc.Graphics = null;\r\n+\r\n+    private _dragging = false;\r\n+\r\n+    private _scheduleTime = 0.08;\r\n+\r\n+    private _allTouchLinesObj = {};\r\n+\r\n+    private _allOtherTouchLinesObj = {};\r\n+\r\n+    private _allPointRect = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        // let tt1 = new cc.Vec2(953, 403);\r\n+        // let tt2 = new cc.Vec2(800, 626);\r\n+        // console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n+\r\n+        let pointGroup = this._view.getChild(\"n84\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == pointGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                let temp = {\r\n+                    'rect': new cc.Rect(img.x, img.y, img.width, img.height),\r\n+                    'isContains': false,\r\n+                    'minx': img.x,\r\n+                    'maxx': img.y + img.width,\r\n+                    'miny': img.y,\r\n+                    'maxy': img.y + img.height,\r\n+                    'limitMinx': false,\r\n+                    'limitMaxx': false,\r\n+                    'limitMaxy': false,\r\n+                    'isPointInner': false\r\n+                };\r\n+                this._allPointRect.push(temp);\r\n+            }\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n+        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n+\r\n+        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n+        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n+\r\n+        let huiNode = new cc.Node('huiNode');\r\n+        huiNode.parent = this._worldRoot;\r\n+\r\n+        this.graphics = huiNode.addComponent(cc.Graphics);\r\n+        this.graphics.lineWidth = 20;\r\n+        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n+        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n+        this.graphics.fillColor = cc.color(255, 0, 0);\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            touch: \"no\",\r\n+            reset: false,\r\n+            curTouchesPos: cc.Vec2,\r\n+            allTouchLinesPos: {},\r\n+            allOtherTouchLinesPos: [],\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    _onDrawStart(event) {\r\n+        console.log('===== start 111 ====' + event.touch.getLocation());\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        if (state.touch === 'no') {\r\n+            state.touch = 'start';\r\n+            let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+            state.curTouchesPos = tempPos;\r\n+            this.updateState(state);\r\n+        }\r\n+    }\r\n+\r\n+    _onDrawMove(event) {\r\n+\r\n+        this._dragging = true;\r\n+        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+    }\r\n+\r\n+    _onDrawEnd(event) {\r\n+\r\n+        this._dragging = false;\r\n+\r\n+        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.curTouchesPos = tempPos;\r\n+        state.touch = 'end';\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 排序方法\r\n+    comparePosX() {\r\n+        return function (a, b) {\r\n+            var value1 = a.x;\r\n+            var value2 = b.x;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n+    // 排序方法\r\n+    comparePosY() {\r\n+        return function (a, b) {\r\n+            var value1 = a.y;\r\n+            var value2 = b.y;\r\n+            return value1 - value2;\r\n+        }\r\n+    }\r\n+\r\n+    private _clickReset(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.reset = true;\r\n+        this.updateState(state);\r\n+\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+\r\n+        if (Object.keys(state.allTouchLinesPos).length === 0) {\r\n+\r\n+            state.submit = this.submitType.GuideShow;\r\n+\r\n+        } else {\r\n+\r\n+            let isAllRight = true;\r\n+            for (let key in state.allTouchLinesPos) {\r\n+\r\n+                if (!state.allTouchLinesPos[key].result) {\r\n+                    isAllRight = false;\r\n+                    break;\r\n+                }\r\n+            }\r\n+            if (isAllRight) {\r\n+                state.submit = this.submitType.RightFeed;\r\n+            } else {\r\n+                state.submit = this.submitType.WrongFeed;\r\n+            }\r\n+        }\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    // 临时\r\n+    // 拖拽定时器\r\n+    dragSchedule() {\r\n+        if (this._dragging) {\r\n+\r\n+            console.log('==== 3333333 拖拽定时器 ======');\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.curTouchesPos = this._moveCurPos;\r\n+            state.touch = \"move\";\r\n+            this.updateState(state);\r\n+        }\r\n+    }\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (state.touch == \"start\") {\r\n+\r\n+            this._curTouchesPos.length = 0;\r\n+            this._curTouchesPos.push(state.curTouchesPos);\r\n+            this.graphics.clear();\r\n+\r\n+        } else if (state.touch == \"move\") {\r\n+\r\n+            this._curTouchesPos.push(state.curTouchesPos);\r\n+\r\n+            const MIN_POINT_DISTANCE = 4;\r\n+\r\n+            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n+            this.graphics.moveTo(this._curTouchesPos[0].x - worldPos.x, this._curTouchesPos[0].y - worldPos.y);\r\n+            let lastIndex = 0;\r\n+            for (let i = 1, l = this._curTouchesPos.length; i < l; i++) {\r\n+                if (this._curTouchesPos[i].sub(this._curTouchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n+                    continue;\r\n+                }\r\n+                lastIndex = i;\r\n+                this.graphics.lineTo(this._curTouchesPos[i].x - worldPos.x, this._curTouchesPos[i].y - worldPos.y);\r\n+            }\r\n+            this.graphics.stroke();\r\n+\r\n+        } else if (state.touch == \"end\") {\r\n+\r\n+            this._curTouchesPos.push(state.curTouchesPos);\r\n+\r\n+            this.graphics.clear();\r\n+            if (this._curTouchesPos.length > 0) {\r\n+\r\n+                for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n+\r\n+                    this._curTouchesPos[i].y = this._view.height - this._curTouchesPos[i].y;\r\n+                }\r\n+\r\n+                this._curTouchesPos.sort(this.comparePosX());\r\n+\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                    this._allPointRect[i].isContains = false;\r\n+                }\r\n+\r\n+                let pointNums = 0;\r\n+                for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n+\r\n+                    for (let j = 0; j < this._allPointRect.length; j++) {\r\n+\r\n+                        if (this._allPointRect[j].rect.contains(this._curTouchesPos[i])) {\r\n+                            this._allPointRect[j].isContains = true;\r\n+                            break;\r\n+                        }\r\n+                    }\r\n+                }\r\n+                for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                    if (this._allPointRect[i].isContains) {\r\n+                        pointNums++;\r\n+                        continue;\r\n+                    }\r\n+                }\r\n+\r\n+                console.log('===== 5555 =====' + pointNums);\r\n+\r\n+                if (pointNums >= 2) {\r\n+\r\n+                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n+\r\n+                        if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n+                            this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n+                            this._allPointRect[i].isPointInner = true;\r\n+                        }\r\n+\r\n+                        if (i === 0 && this._allPointRect[i].isContains) {\r\n+\r\n+                            if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n+\r\n+                                this._allPointRect[i].limitMinx = true;\r\n+                            }\r\n+\r\n+                        } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n+\r\n+                            if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n+\r\n+                                this._allPointRect[i].limitMaxx = true;\r\n+                            }\r\n+                            if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n+\r\n+                                this._allPointRect[i].limitMinx = true;\r\n+                            }\r\n+\r\n+                        }\r\n+                    }\r\n+\r\n+                    let temp = {};\r\n+                    if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n+\r\n+                        if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+\r\n+                            // 直线\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = 0;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                            temp['result'] = true;\r\n+                            state.allTouchLinesPos['line1'] = temp;\r\n+\r\n+\r\n+                        } else if (this._allPointRect[0].limitMinx && !this._allPointRect[1].limitMaxx) {\r\n+\r\n+                            // 左点超出射线\r\n+                            let pointMidChang = 297;\r\n+\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = 0;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line1'] = temp;\r\n+\r\n+                        } else if (!this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+\r\n+                            // 右点超出的射线\r\n+                            let pointMaxX = 1096;\r\n+                            let pointMidChang = 297;\r\n+\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = 0;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line1'] = temp;\r\n+\r\n+                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[1].isPointInner) {\r\n+\r\n+                            //线段\r\n+                            let pointMidChang = 297;\r\n+                            temp['QiX'] = 799;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = 0;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang;\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line1'] = temp;\r\n+                        }\r\n+\r\n+                    } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains) {\r\n+\r\n+                        if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+\r\n+                            // 直线\r\n+                            temp['QiX'] = 800;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = -57;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n+                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                            temp['result'] = true;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n+\r\n+                        } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n+\r\n+                            // 左点超出射线\r\n+                            let pointMidChang = 280;\r\n+\r\n+                            temp['QiX'] = 800;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = -57;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n+                            console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n+                            console.log('==== chaoInterQiy ===' + temp['chaoInterQiY']);\r\n+\r\n+                        } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+\r\n+                            // 右点超出的射线\r\n+                            let pointMaxY = 385;\r\n+                            let pointMidChang = 280;\r\n+\r\n+                            temp['QiX'] = 800;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = -57;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang + (pointMaxY - this._curTouchesPos[this._curTouchesPos.length - 1].y);\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n+\r\n+                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n+\r\n+                            //线段\r\n+                            let pointMidChang = 280;\r\n+                            temp['QiX'] = 800;\r\n+                            temp['QiY'] = 626;\r\n+                            temp['angle'] = -57;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang;\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line2'] = temp;\r\n+                        }\r\n+\r\n+                    } else if (this._allPointRect[1].isContains && this._allPointRect[2].isContains) {\r\n+\r\n+                        if (this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n+\r\n+                            // 直线\r\n+                            temp['QiX'] = 953;\r\n+                            temp['QiY'] = 403;\r\n+                            temp['angle'] = 57;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n+                            temp['result'] = true;\r\n+                            state.allTouchLinesPos['line3'] = temp;\r\n+\r\n+                        } else if (!this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n+\r\n+                            // 左点超出射线\r\n+                            let pointMidChang = 280;\r\n+\r\n+                            temp['QiX'] = 953;\r\n+                            temp['QiY'] = 403;\r\n+                            temp['angle'] = 57;\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = Math.tan(57) * (temp['QiX'] - this._curTouchesPos[0].x);\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line3'] = temp;\r\n+\r\n+                        } else if (this._allPointRect[1].limitMaxx && !this._allPointRect[2].limitMinx) {\r\n+\r\n+                            // 右点超出的射线\r\n+                            let pointMaxY = 660;\r\n+                            let pointMidChang = 280;\r\n+\r\n+                            temp['QiX'] = 953;\r\n+                            temp['QiY'] = 403;\r\n+                            temp['angle'] = 57;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].y - pointMaxY);\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line3'] = temp;\r\n+\r\n+                        } else if (this._allPointRect[1].isPointInner && this._allPointRect[2].isPointInner) {\r\n+\r\n+                            //线段\r\n+                            let pointMidChang = 280;\r\n+                            temp['QiX'] = 953;\r\n+                            temp['QiY'] = 403;\r\n+                            temp['angle'] = 57;\r\n+                            temp['chaoInterQiX'] = 0;\r\n+                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chang'] = pointMidChang;\r\n+                            temp['result'] = false;\r\n+                            state.allTouchLinesPos['line3'] = temp;\r\n+                        }\r\n+                    }\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state1: any = globalThis._.cloneDeep(this._state);\r\n+                    state1.touch = 'no';\r\n+                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n+                    state1.allOtherTouchLinesPos = state.allOtherTouchLinesPos;\r\n+                    this.updateState(state1);\r\n+\r\n+                }, 20);\r\n+            }\r\n+        }\r\n+\r\n+\r\n+        if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n+\r\n+            for (let key in this._allTouchLinesObj) {\r\n+                this._allTouchLinesObj[key].removeFromParent();\r\n+            }\r\n+\r\n+            for (let key in state.allTouchLinesPos) {\r\n+\r\n+                let temp = state.allTouchLinesPos[key];\r\n+                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n+                this._view.addChild(zhiLine);\r\n+                zhiLine.width = temp['chang'];\r\n+\r\n+                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n+                zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n+\r\n+                zhiLine.rotation = temp.angle;\r\n+                this._allTouchLinesObj[key] = zhiLine;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.reset, state.reset)) {\r\n+\r\n+            if (state.reset) {\r\n+\r\n+                for (let key in state.allTouchLinesPos) {\r\n+                    delete state.allTouchLinesPos[key];\r\n+                }\r\n+\r\n+                for (let key in this._allTouchLinesObj) {\r\n+                    this._allTouchLinesObj[key].removeFromParent();\r\n+                }\r\n+\r\n+                for (let key in this._allOtherTouchLinesObj) {\r\n+                    this._allOtherTouchLinesObj[key].removeFromParent();\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state1: any = globalThis._.cloneDeep(this._state);\r\n+                    state1.reset = false;\r\n+                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n+                    state1.allOtherTouchLinesPos = [];\r\n+                    this.updateState(state1);\r\n+\r\n+                }, 10);\r\n+\r\n+            }\r\n+\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+                // let keyBtn = this._view.getChild('input1').asButton;\r\n+                // this.handTips2(keyBtn);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+    angle(start, end) {\r\n+        var diff_x = end.x - start.x,\r\n+            diff_y = end.y - start.y;\r\n+        //返回角度,不是弧度\r\n+        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+        this.schedule(this.dragSchedule, this._scheduleTime);\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1625411990034,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -761,768 +761,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v3 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _resetBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _curTouchesPos: any = [];\r\n-\r\n-    private _moveCurPos: cc.Vec2;\r\n-\r\n-    private graphics: cc.Graphics = null;\r\n-\r\n-    private _dragging = false;\r\n-\r\n-    private _scheduleTime = 0.08;\r\n-\r\n-    private _allTouchLinesObj = {};\r\n-\r\n-    private _allOtherTouchLinesObj = {};\r\n-\r\n-    private _allPointRect = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        // let tt1 = new cc.Vec2(953, 403);\r\n-        // let tt2 = new cc.Vec2(800, 626);\r\n-        // console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n-\r\n-        let pointGroup = this._view.getChild(\"n84\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == pointGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                let temp = {\r\n-                    'rect': new cc.Rect(img.x, img.y, img.width, img.height),\r\n-                    'isContains': false,\r\n-                    'minx': img.x,\r\n-                    'maxx': img.y + img.width,\r\n-                    'miny': img.y,\r\n-                    'maxy': img.y + img.height,\r\n-                    'limitMinx': false,\r\n-                    'limitMaxx': false,\r\n-                    'limitMaxy': false,\r\n-                    'isPointInner': false\r\n-                };\r\n-                this._allPointRect.push(temp);\r\n-            }\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n-        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n-\r\n-        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n-        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n-\r\n-        let huiNode = new cc.Node('huiNode');\r\n-        huiNode.parent = this._worldRoot;\r\n-\r\n-        this.graphics = huiNode.addComponent(cc.Graphics);\r\n-        this.graphics.lineWidth = 20;\r\n-        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n-        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n-        this.graphics.fillColor = cc.color(255, 0, 0);\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            touch: \"no\",\r\n-            reset: false,\r\n-            curTouchesPos: cc.Vec2,\r\n-            allTouchLinesPos: {},\r\n-            allOtherTouchLinesPos: [],\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    _onDrawStart(event) {\r\n-        console.log('===== start 111 ====' + event.touch.getLocation());\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        if (state.touch === 'no') {\r\n-            state.touch = 'start';\r\n-            let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-            state.curTouchesPos = tempPos;\r\n-            this.updateState(state);\r\n-        }\r\n-    }\r\n-\r\n-    _onDrawMove(event) {\r\n-\r\n-        this._dragging = true;\r\n-        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-    }\r\n-\r\n-    _onDrawEnd(event) {\r\n-\r\n-        this._dragging = false;\r\n-\r\n-        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.curTouchesPos = tempPos;\r\n-        state.touch = 'end';\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 排序方法\r\n-    comparePosX() {\r\n-        return function (a, b) {\r\n-            var value1 = a.x;\r\n-            var value2 = b.x;\r\n-            return value1 - value2;\r\n-        }\r\n-    }\r\n-\r\n-    // 排序方法\r\n-    comparePosY() {\r\n-        return function (a, b) {\r\n-            var value1 = a.y;\r\n-            var value2 = b.y;\r\n-            return value1 - value2;\r\n-        }\r\n-    }\r\n-\r\n-    private _clickReset(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.reset = true;\r\n-        this.updateState(state);\r\n-\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-\r\n-        if (Object.keys(state.allTouchLinesPos).length === 0) {\r\n-\r\n-            state.submit = this.submitType.GuideShow;\r\n-\r\n-        } else {\r\n-\r\n-            let isAllRight = true;\r\n-            for (let key in state.allTouchLinesPos) {\r\n-\r\n-                if (!state.allTouchLinesPos[key].result) {\r\n-                    isAllRight = false;\r\n-                    break;\r\n-                }\r\n-            }\r\n-            if (isAllRight) {\r\n-                state.submit = this.submitType.RightFeed;\r\n-            } else {\r\n-                state.submit = this.submitType.WrongFeed;\r\n-            }\r\n-        }\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    // 临时\r\n-    // 拖拽定时器\r\n-    dragSchedule() {\r\n-        if (this._dragging) {\r\n-\r\n-            console.log('==== 3333333 拖拽定时器 ======');\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.curTouchesPos = this._moveCurPos;\r\n-            state.touch = \"move\";\r\n-            this.updateState(state);\r\n-        }\r\n-    }\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (state.touch == \"start\") {\r\n-\r\n-            this._curTouchesPos.length = 0;\r\n-            this._curTouchesPos.push(state.curTouchesPos);\r\n-            this.graphics.clear();\r\n-\r\n-        } else if (state.touch == \"move\") {\r\n-\r\n-            this._curTouchesPos.push(state.curTouchesPos);\r\n-\r\n-            const MIN_POINT_DISTANCE = 4;\r\n-\r\n-            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n-            this.graphics.moveTo(this._curTouchesPos[0].x - worldPos.x, this._curTouchesPos[0].y - worldPos.y);\r\n-            let lastIndex = 0;\r\n-            for (let i = 1, l = this._curTouchesPos.length; i < l; i++) {\r\n-                if (this._curTouchesPos[i].sub(this._curTouchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n-                    continue;\r\n-                }\r\n-                lastIndex = i;\r\n-                this.graphics.lineTo(this._curTouchesPos[i].x - worldPos.x, this._curTouchesPos[i].y - worldPos.y);\r\n-            }\r\n-            this.graphics.stroke();\r\n-\r\n-        } else if (state.touch == \"end\") {\r\n-\r\n-            this._curTouchesPos.push(state.curTouchesPos);\r\n-\r\n-            this.graphics.clear();\r\n-            if (this._curTouchesPos.length > 0) {\r\n-\r\n-                for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n-\r\n-                    this._curTouchesPos[i].y = this._view.height - this._curTouchesPos[i].y;\r\n-                }\r\n-\r\n-                this._curTouchesPos.sort(this.comparePosX());\r\n-\r\n-                for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                    this._allPointRect[i].isContains = false;\r\n-                }\r\n-\r\n-                let pointNums = 0;\r\n-                for (let i = 0; i < this._curTouchesPos.length; i++) {\r\n-\r\n-                    for (let j = 0; j < this._allPointRect.length; j++) {\r\n-\r\n-                        if (this._allPointRect[j].rect.contains(this._curTouchesPos[i])) {\r\n-                            this._allPointRect[j].isContains = true;\r\n-                            break;\r\n-                        }\r\n-                    }\r\n-                }\r\n-                for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                    if (this._allPointRect[i].isContains) {\r\n-                        pointNums++;\r\n-                        continue;\r\n-                    }\r\n-                }\r\n-\r\n-                console.log('===== 5555 =====' + pointNums);\r\n-\r\n-                if (pointNums >= 2) {\r\n-\r\n-                    for (let i = 0; i < this._allPointRect.length; i++) {\r\n-\r\n-                        if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n-                            this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n-                            this._allPointRect[i].isPointInner = true;\r\n-                        }\r\n-\r\n-                        if (i === 0 && this._allPointRect[i].isContains) {\r\n-\r\n-                            if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n-\r\n-                                this._allPointRect[i].limitMinx = true;\r\n-                            }\r\n-\r\n-                        } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n-\r\n-                            if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n-\r\n-                                this._allPointRect[i].limitMaxx = true;\r\n-                            }\r\n-                            if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n-\r\n-                                this._allPointRect[i].limitMinx = true;\r\n-                            }\r\n-\r\n-                        }\r\n-                    }\r\n-\r\n-                    let temp = {};\r\n-                    if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n-\r\n-                        if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n-\r\n-                            // 直线\r\n-                            temp['QiX'] = 799;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = 0;\r\n-                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n-                            temp['result'] = true;\r\n-                            state.allTouchLinesPos['line1'] = temp;\r\n-\r\n-\r\n-                        } else if (this._allPointRect[0].limitMinx && !this._allPointRect[1].limitMaxx) {\r\n-\r\n-                            // 左点超出射线\r\n-                            let pointMidChang = 297;\r\n-\r\n-                            temp['QiX'] = 799;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = 0;\r\n-                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line1'] = temp;\r\n-\r\n-                        } else if (!this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n-\r\n-                            // 右点超出的射线\r\n-                            let pointMaxX = 1096;\r\n-                            let pointMidChang = 297;\r\n-\r\n-                            temp['QiX'] = 799;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = 0;\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].x - pointMaxX);\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line1'] = temp;\r\n-\r\n-                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[1].isPointInner) {\r\n-\r\n-                            //线段\r\n-                            let pointMidChang = 297;\r\n-                            temp['QiX'] = 799;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = 0;\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang;\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line1'] = temp;\r\n-                        }\r\n-\r\n-                    } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains) {\r\n-\r\n-                        if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n-\r\n-                            // 直线\r\n-                            temp['QiX'] = 800;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = -57;\r\n-                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n-                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n-                            temp['result'] = true;\r\n-                            state.allTouchLinesPos['line2'] = temp;\r\n-\r\n-                        } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n-\r\n-                            // 左点超出射线\r\n-                            let pointMidChang = 280;\r\n-\r\n-                            temp['QiX'] = 800;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = -57;\r\n-                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n-                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line2'] = temp;\r\n-                            console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n-                            console.log('==== chaoInterQiX ===' + temp['chaoInterQiY']);\r\n-\r\n-                        } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n-\r\n-                            // 右点超出的射线\r\n-                            let pointMaxY = 385;\r\n-                            let pointMidChang = 280;\r\n-\r\n-                            temp['QiX'] = 800;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = -57;\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + (pointMaxY - this._curTouchesPos[this._curTouchesPos.length - 1].y);\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line2'] = temp;\r\n-\r\n-                        } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n-\r\n-                            //线段\r\n-                            let pointMidChang = 280;\r\n-                            temp['QiX'] = 800;\r\n-                            temp['QiY'] = 626;\r\n-                            temp['angle'] = -57;\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang;\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line2'] = temp;\r\n-                        }\r\n-\r\n-                    } else if (this._allPointRect[1].isContains && this._allPointRect[2].isContains) {\r\n-\r\n-                        if (this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n-\r\n-                            // 直线\r\n-                            temp['QiX'] = 953;\r\n-                            temp['QiY'] = 403;\r\n-                            temp['angle'] = 57;\r\n-                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n-                            temp['result'] = true;\r\n-                            state.allTouchLinesPos['line3'] = temp;\r\n-\r\n-                        } else if (!this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n-\r\n-                            // 左点超出射线\r\n-                            let pointMidChang = 280;\r\n-\r\n-                            temp['QiX'] = 953;\r\n-                            temp['QiY'] = 403;\r\n-                            temp['angle'] = 57;\r\n-                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(57) * (temp['QiX'] - this._curTouchesPos[0].x);\r\n-                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line3'] = temp;\r\n-\r\n-                        } else if (this._allPointRect[1].limitMaxx && !this._allPointRect[2].limitMinx) {\r\n-\r\n-                            // 右点超出的射线\r\n-                            let pointMaxY = 660;\r\n-                            let pointMidChang = 280;\r\n-\r\n-                            temp['QiX'] = 953;\r\n-                            temp['QiY'] = 403;\r\n-                            temp['angle'] = 57;\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].y - pointMaxY);\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line3'] = temp;\r\n-\r\n-                        } else if (this._allPointRect[1].isPointInner && this._allPointRect[2].isPointInner) {\r\n-\r\n-                            //线段\r\n-                            let pointMidChang = 280;\r\n-                            temp['QiX'] = 953;\r\n-                            temp['QiY'] = 403;\r\n-                            temp['angle'] = 57;\r\n-                            temp['chaoInterQiX'] = 0;\r\n-                            temp['chaoInterQiY'] = 0;\r\n-                            temp['chang'] = pointMidChang;\r\n-                            temp['result'] = false;\r\n-                            state.allTouchLinesPos['line3'] = temp;\r\n-                        }\r\n-                    }\r\n-                }\r\n-\r\n-                setTimeout(() => {\r\n-\r\n-                    let state1: any = globalThis._.cloneDeep(this._state);\r\n-                    state1.touch = 'no';\r\n-                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n-                    state1.allOtherTouchLinesPos = state.allOtherTouchLinesPos;\r\n-                    this.updateState(state1);\r\n-\r\n-                }, 20);\r\n-            }\r\n-        }\r\n-\r\n-\r\n-        if (!globalThis._.isEqual(oldState.allTouchLinesPos, state.allTouchLinesPos)) {\r\n-\r\n-            for (let key in this._allTouchLinesObj) {\r\n-                this._allTouchLinesObj[key].removeFromParent();\r\n-            }\r\n-\r\n-            for (let key in state.allTouchLinesPos) {\r\n-\r\n-                let temp = state.allTouchLinesPos[key];\r\n-                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n-                this._view.addChild(zhiLine);\r\n-                zhiLine.width = temp['chang'];\r\n-\r\n-                zhiLine.x = temp.QiX - temp.chaoInterQiX;\r\n-                zhiLine.y = temp.QiY - temp.chaoInterQiY;\r\n-\r\n-                zhiLine.rotation = temp.angle;\r\n-                this._allTouchLinesObj[key] = zhiLine;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.reset, state.reset)) {\r\n-\r\n-            if (state.reset) {\r\n-\r\n-                for (let key in state.allTouchLinesPos) {\r\n-                    delete state.allTouchLinesPos[key];\r\n-                }\r\n-\r\n-                for (let key in this._allTouchLinesObj) {\r\n-                    this._allTouchLinesObj[key].removeFromParent();\r\n-                }\r\n-\r\n-                for (let key in this._allOtherTouchLinesObj) {\r\n-                    this._allOtherTouchLinesObj[key].removeFromParent();\r\n-                }\r\n-\r\n-                setTimeout(() => {\r\n-\r\n-                    let state1: any = globalThis._.cloneDeep(this._state);\r\n-                    state1.reset = false;\r\n-                    state1.allTouchLinesPos = state.allTouchLinesPos;\r\n-                    state1.allOtherTouchLinesPos = [];\r\n-                    this.updateState(state1);\r\n-\r\n-                }, 10);\r\n-\r\n-            }\r\n-\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-                // let keyBtn = this._view.getChild('input1').asButton;\r\n-                // this.handTips2(keyBtn);\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-    angle(start, end) {\r\n-        var diff_x = end.x - start.x,\r\n-            diff_y = end.y - start.y;\r\n-        //返回角度,不是弧度\r\n-        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-        this.schedule(this.dragSchedule, this._scheduleTime);\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1625411998033,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -447,8 +447,11 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n+                            console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n+                            console.log('==== chaoInterQiy ===' + temp['chaoInterQiY']);\r\n+\r\n                         } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 左点超出射线\r\n                             let pointMidChang = 280;\r\n@@ -460,11 +463,10 @@\n                             temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n-                            console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n-                            console.log('==== chaoInterQiy ===' + temp['chaoInterQiY']);\r\n \r\n+\r\n                         } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 右点超出的射线\r\n                             let pointMaxY = 385;\r\n"
                },
                {
                    "date": 1625412193902,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -442,9 +442,9 @@\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n+                            temp['chaoInterQiY'] = Math.tan(57) * temp['chaoInterQiX'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625412222938,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -442,9 +442,9 @@\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(57) * temp['chaoInterQiX'];\r\n+                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625412251173,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -442,9 +442,9 @@\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n+                            temp['chaoInterQiY'] = this._curTouchesPos[0].x - temp['QiX'] Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625412267664,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -441,10 +441,10 @@\n                             // 直线\r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n-                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = this._curTouchesPos[0].x - temp['QiX'] Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n+                            temp['chaoInterQiX'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n+                            temp['chaoInterQiY'] = this._curTouchesPos[0].x - temp['QiY'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625412285049,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -441,10 +441,10 @@\n                             // 直线\r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n+                            temp['chaoInterQiY'] = this._curTouchesPos[0].x - temp['QiY'];\r\n                             temp['chaoInterQiX'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n-                            temp['chaoInterQiY'] = this._curTouchesPos[0].x - temp['QiY'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625412291396,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -442,9 +442,9 @@\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiY'] = this._curTouchesPos[0].x - temp['QiY'];\r\n-                            temp['chaoInterQiX'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n+                            temp['chaoInterQiX'] = temp['chaoInterQiY']、Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625412296509,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -442,9 +442,9 @@\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiY'] = this._curTouchesPos[0].x - temp['QiY'];\r\n-                            temp['chaoInterQiX'] = temp['chaoInterQiY']、Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n+                            temp['chaoInterQiX'] = temp['chaoInterQiY'] / Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625412301587,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -442,9 +442,9 @@\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiY'] = this._curTouchesPos[0].x - temp['QiY'];\r\n-                            temp['chaoInterQiX'] = temp['chaoInterQiY'] / Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n+                            temp['chaoInterQiX'] = temp['chaoInterQiY'] / Math.tan(temp['angle']);\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625412324644,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -441,9 +441,9 @@\n                             // 直线\r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n-                            temp['chaoInterQiY'] = this._curTouchesPos[0].x - temp['QiY'];\r\n+                            temp['chaoInterQiY'] = this._curTouchesPos[0].y - temp['QiY'];\r\n                             temp['chaoInterQiX'] = temp['chaoInterQiY'] / Math.tan(temp['angle']);\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n"
                },
                {
                    "date": 1625412385112,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -441,10 +441,10 @@\n                             // 直线\r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n-                            temp['chaoInterQiY'] = this._curTouchesPos[0].y - temp['QiY'];\r\n-                            temp['chaoInterQiX'] = temp['chaoInterQiY'] / Math.tan(temp['angle']);\r\n+                            temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n+                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625412434283,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -437,8 +437,9 @@\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains) {\r\n \r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n+\r\n                             // 直线\r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n@@ -447,8 +448,9 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n+                            console.log();\r\n                             console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n                             console.log('==== chaoInterQiy ===' + temp['chaoInterQiY']);\r\n \r\n                         } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n"
                },
                {
                    "date": 1625412440724,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -448,9 +448,9 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n-                            console.log();\r\n+                            console.log('==== ===');\r\n                             console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n                             console.log('==== chaoInterQiy ===' + temp['chaoInterQiY']);\r\n \r\n                         } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n"
                },
                {
                    "date": 1625412445893,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -448,9 +448,9 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n-                            console.log('==== ===');\r\n+                            console.log('==== ===' + );\r\n                             console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n                             console.log('==== chaoInterQiy ===' + temp['chaoInterQiY']);\r\n \r\n                         } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n"
                },
                {
                    "date": 1625412452761,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -448,9 +448,9 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n-                            console.log('==== ===' + );\r\n+                            console.log('==== ===' + Math.tan{});\r\n                             console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n                             console.log('==== chaoInterQiy ===' + temp['chaoInterQiY']);\r\n \r\n                         } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n"
                },
                {
                    "date": 1625412461208,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -448,9 +448,9 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n-                            console.log('==== ===' + Math.tan{});\r\n+                            console.log('==== ===' + Math.tan(-57));\r\n                             console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n                             console.log('==== chaoInterQiy ===' + temp['chaoInterQiY']);\r\n \r\n                         } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n"
                },
                {
                    "date": 1625412503719,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -448,9 +448,9 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n-                            console.log('==== ===' + Math.tan(-57));\r\n+                            console.log('==== tan ===' + Math.tan(-57));\r\n                             console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n                             console.log('==== chaoInterQiy ===' + temp['chaoInterQiY']);\r\n \r\n                         } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n"
                },
                {
                    "date": 1625452044085,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -437,15 +437,14 @@\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains) {\r\n \r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n-\r\n                             // 直线\r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n+                            temp['chaoInterQiY'] = Math.tan(temp['angle'] * 3.14 / 180) * temp['chaoInterQiX'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625452138032,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -447,12 +447,8 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n-                            console.log('==== tan ===' + Math.tan(-57));\r\n-                            console.log('==== chaoInterQiX ===' + temp['chaoInterQiX']);\r\n-                            console.log('==== chaoInterQiy ===' + temp['chaoInterQiY']);\r\n-\r\n                         } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 左点超出射线\r\n                             let pointMidChang = 280;\r\n"
                },
                {
                    "date": 1625452207929,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -456,9 +456,9 @@\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(temp['angle']) * temp['chaoInterQiX'];\r\n+                            temp['chaoInterQiY'] = Math.tan(temp['angle'] * 3.14 / 180) * temp['chaoInterQiX'];\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625452333319,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -500,9 +500,9 @@\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = 0;\r\n+                            temp['chaoInterQiY'] = Math.tan(temp['angle'] * 3.14 / 180) * temp['chaoInterQiX'];;\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625452390538,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -500,9 +500,9 @@\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(temp['angle'] * 3.14 / 180) * temp['chaoInterQiX'];;\r\n+                            temp['chaoInterQiY'] = Math.tan(temp['angle'] * 3.14 / 180) * temp['chaoInterQiX'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n@@ -514,9 +514,9 @@\n                             temp['QiX'] = 953;\r\n                             temp['QiY'] = 403;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n-                            temp['chaoInterQiY'] = Math.tan(57) * (temp['QiX'] - this._curTouchesPos[0].x);\r\n+                            temp['chaoInterQiY'] = Math.tan(temp['angle'] * 3.14 / 180) * temp['chaoInterQiX'];\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n"
                },
                {
                    "date": 1625452728310,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -496,10 +496,10 @@\n \r\n                         if (this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n \r\n                             // 直线\r\n-                            temp['QiX'] = 953;\r\n-                            temp['QiY'] = 403;\r\n+                            temp['QiX'] = 956;\r\n+                            temp['QiY'] = 397;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n                             temp['chaoInterQiY'] = Math.tan(temp['angle'] * 3.14 / 180) * temp['chaoInterQiX'];\r\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n@@ -510,10 +510,10 @@\n \r\n                             // 左点超出射线\r\n                             let pointMidChang = 280;\r\n \r\n-                            temp['QiX'] = 953;\r\n-                            temp['QiY'] = 403;\r\n+                            temp['QiX'] = 956;\r\n+                            temp['QiY'] = 397;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n                             temp['chaoInterQiY'] = Math.tan(temp['angle'] * 3.14 / 180) * temp['chaoInterQiX'];\r\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n@@ -525,10 +525,10 @@\n                             // 右点超出的射线\r\n                             let pointMaxY = 660;\r\n                             let pointMidChang = 280;\r\n \r\n-                            temp['QiX'] = 953;\r\n-                            temp['QiY'] = 403;\r\n+                            temp['QiX'] = 956;\r\n+                            temp['QiY'] = 397;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = pointMidChang + (this._curTouchesPos[this._curTouchesPos.length - 1].y - pointMaxY);\r\n@@ -538,10 +538,10 @@\n                         } else if (this._allPointRect[1].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n                             //线段\r\n                             let pointMidChang = 280;\r\n-                            temp['QiX'] = 953;\r\n-                            temp['QiY'] = 403;\r\n+                            temp['QiX'] = 956;\r\n+                            temp['QiY'] = 397;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = 0;\r\n                             temp['chaoInterQiY'] = 0;\r\n                             temp['chang'] = pointMidChang;\r\n"
                },
                {
                    "date": 1625452789987,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -537,9 +537,9 @@\n \r\n                         } else if (this._allPointRect[1].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n                             //线段\r\n-                            let pointMidChang = 280;\r\n+                            let pointMidChang = 290;\r\n                             temp['QiX'] = 956;\r\n                             temp['QiY'] = 397;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = 0;\r\n"
                },
                {
                    "date": 1625452816088,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -537,9 +537,9 @@\n \r\n                         } else if (this._allPointRect[1].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n                             //线段\r\n-                            let pointMidChang = 290;\r\n+                            let pointMidChang = 300;\r\n                             temp['QiX'] = 956;\r\n                             temp['QiY'] = 397;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = 0;\r\n"
                },
                {
                    "date": 1625452838581,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -537,9 +537,9 @@\n \r\n                         } else if (this._allPointRect[1].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n                             //线段\r\n-                            let pointMidChang = 300;\r\n+                            let pointMidChang = 500;\r\n                             temp['QiX'] = 956;\r\n                             temp['QiY'] = 397;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = 0;\r\n"
                },
                {
                    "date": 1625452897047,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -536,8 +536,9 @@\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n                         } else if (this._allPointRect[1].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n+                            console.log('===== 线段 =====');\r\n                             //线段\r\n                             let pointMidChang = 500;\r\n                             temp['QiX'] = 956;\r\n                             temp['QiY'] = 397;\r\n"
                },
                {
                    "date": 1625453019068,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -84,11 +84,11 @@\n             this._c1.selectedIndex = 1;\r\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n-        // let tt1 = new cc.Vec2(953, 403);\r\n-        // let tt2 = new cc.Vec2(800, 626);\r\n-        // console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n+        let tt1 = new cc.Vec2(953, 403);\r\n+        let tt2 = new cc.Vec2(800, 626);\r\n+        console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n \r\n         let pointGroup = this._view.getChild(\"n84\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == pointGroup) {\r\n"
                },
                {
                    "date": 1625453027725,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -86,9 +86,9 @@\n         }\r\n \r\n         let tt1 = new cc.Vec2(953, 403);\r\n         let tt2 = new cc.Vec2(800, 626);\r\n-        console.log('=== mag DDDD ===' + tt1.sub(tt2).mag());\r\n+        console.log('=== mag 44444 DDDD ===' + tt1.sub(tt2).mag());\r\n \r\n         let pointGroup = this._view.getChild(\"n84\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == pointGroup) {\r\n"
                },
                {
                    "date": 1625453122016,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -507,8 +507,9 @@\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n                         } else if (!this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n \r\n+                            console.log('===== 左点超出射线 =====');\r\n                             // 左点超出射线\r\n                             let pointMidChang = 280;\r\n \r\n                             temp['QiX'] = 956;\r\n@@ -521,8 +522,10 @@\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n                         } else if (this._allPointRect[1].limitMaxx && !this._allPointRect[2].limitMinx) {\r\n \r\n+                            console.log('===== 右点超出的射线 =====');\r\n+\r\n                             // 右点超出的射线\r\n                             let pointMaxY = 660;\r\n                             let pointMidChang = 280;\r\n \r\n"
                },
                {
                    "date": 1625453127083,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -495,8 +495,10 @@\n                     } else if (this._allPointRect[1].isContains && this._allPointRect[2].isContains) {\r\n \r\n                         if (this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n \r\n+                            console.log('===== 左点超出射线 =====');\r\n+\r\n                             // 直线\r\n                             temp['QiX'] = 956;\r\n                             temp['QiY'] = 397;\r\n                             temp['angle'] = 57;\r\n"
                },
                {
                    "date": 1625453132789,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -495,9 +495,9 @@\n                     } else if (this._allPointRect[1].isContains && this._allPointRect[2].isContains) {\r\n \r\n                         if (this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n \r\n-                            console.log('===== 左点超出射线 =====');\r\n+                            console.log('===== 直线 =====');\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 956;\r\n                             temp['QiY'] = 397;\r\n"
                },
                {
                    "date": 1625454376499,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -353,8 +353,13 @@\n                             this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n                             this._allPointRect[i].isPointInner = true;\r\n                         }\r\n \r\n+                        if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n+\r\n+                            this._allPointRect[i].limitMinx = true;\r\n+                        }\r\n+\r\n                         if (i === 0 && this._allPointRect[i].isContains) {\r\n \r\n                             if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n"
                },
                {
                    "date": 1625454388164,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -358,8 +358,13 @@\n \r\n                             this._allPointRect[i].limitMinx = true;\r\n                         }\r\n \r\n+                        if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n+\r\n+                            this._allPointRect[i].limitMinx = true;\r\n+                        }\r\n+\r\n                         if (i === 0 && this._allPointRect[i].isContains) {\r\n \r\n                             if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n"
                },
                {
                    "date": 1625454478582,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -353,13 +353,11 @@\n                             this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n                             this._allPointRect[i].isPointInner = true;\r\n                         }\r\n \r\n-                        if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n+                        if (this._allPointRect[i].isContains) {\r\n \r\n-                            this._allPointRect[i].limitMinx = true;\r\n                         }\r\n-\r\n                         if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n                             this._allPointRect[i].limitMinx = true;\r\n                         }\r\n"
                },
                {
                    "date": 1625454485527,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -355,14 +355,15 @@\n                         }\r\n \r\n                         if (this._allPointRect[i].isContains) {\r\n \r\n-                        }\r\n-                        if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n+                            if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n-                            this._allPointRect[i].limitMinx = true;\r\n+                                this._allPointRect[i].limitMinx = true;\r\n+                            }\r\n                         }\r\n \r\n+\r\n                         if (i === 0 && this._allPointRect[i].isContains) {\r\n \r\n                             if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n"
                },
                {
                    "date": 1625454495881,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -361,9 +361,8 @@\n                                 this._allPointRect[i].limitMinx = true;\r\n                             }\r\n                         }\r\n \r\n-\r\n                         if (i === 0 && this._allPointRect[i].isContains) {\r\n \r\n                             if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n"
                },
                {
                    "date": 1625454511675,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -359,8 +359,10 @@\n                             if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n                                 this._allPointRect[i].limitMinx = true;\r\n                             }\r\n+\r\n+\r\n                         }\r\n \r\n                         if (i === 0 && this._allPointRect[i].isContains) {\r\n \r\n"
                },
                {
                    "date": 1625454530806,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -360,9 +360,13 @@\n \r\n                                 this._allPointRect[i].limitMinx = true;\r\n                             }\r\n \r\n+                            if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n+                                this._allPointRect[i].limitMaxx = true;\r\n+                            }\r\n+\r\n                         }\r\n \r\n                         if (i === 0 && this._allPointRect[i].isContains) {\r\n \r\n"
                },
                {
                    "date": 1625454567788,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -364,30 +364,10 @@\n                             if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                                 this._allPointRect[i].limitMaxx = true;\r\n                             }\r\n-\r\n                         }\r\n \r\n-                        if (i === 0 && this._allPointRect[i].isContains) {\r\n-\r\n-                            if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n-\r\n-                                this._allPointRect[i].limitMinx = true;\r\n-                            }\r\n-\r\n-                        } else if ((i === 1 && this._allPointRect[i].isContains) || (i === 2 && this._allPointRect[i].isContains)) {\r\n-\r\n-                            if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n-\r\n-                                this._allPointRect[i].limitMaxx = true;\r\n-                            }\r\n-                            if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n-\r\n-                                this._allPointRect[i].limitMinx = true;\r\n-                            }\r\n-\r\n-                        }\r\n                     }\r\n \r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n"
                },
                {
                    "date": 1625454938728,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -368,8 +368,9 @@\n                         }\r\n \r\n                     }\r\n \r\n+                    console.log(this._allPointRect);\r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n"
                },
                {
                    "date": 1625454946619,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -369,8 +369,9 @@\n \r\n                     }\r\n \r\n                     console.log(this._allPointRect);\r\n+\r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n"
                },
                {
                    "date": 1625455144931,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -355,8 +355,11 @@\n                         }\r\n \r\n                         if (this._allPointRect[i].isContains) {\r\n \r\n+                            if () {\r\n+\r\n+                            }\r\n                             if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n                                 this._allPointRect[i].limitMinx = true;\r\n                             }\r\n"
                },
                {
                    "date": 1625455188443,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -355,9 +355,9 @@\n                         }\r\n \r\n                         if (this._allPointRect[i].isContains) {\r\n \r\n-                            if () {\r\n+                            if (i === 0) {\r\n \r\n                             }\r\n                             if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n"
                },
                {
                    "date": 1625455194562,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -356,14 +356,14 @@\n \r\n                         if (this._allPointRect[i].isContains) {\r\n \r\n                             if (i === 0) {\r\n+                                if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n+                                    this._allPointRect[i].limitMinx = true;\r\n+                                }\r\n                             }\r\n-                            if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n-                                this._allPointRect[i].limitMinx = true;\r\n-                            }\r\n \r\n                             if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                                 this._allPointRect[i].limitMaxx = true;\r\n"
                },
                {
                    "date": 1625455261825,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -346,8 +346,9 @@\n                 console.log('===== 5555 =====' + pointNums);\r\n \r\n                 if (pointNums >= 2) {\r\n \r\n+\r\n                     for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                         if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n                             this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n@@ -362,17 +363,19 @@\n                                     this._allPointRect[i].limitMinx = true;\r\n                                 }\r\n                             }\r\n \r\n-\r\n                             if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                                 this._allPointRect[i].limitMaxx = true;\r\n                             }\r\n                         }\r\n \r\n                     }\r\n \r\n+                    if () {\r\n+\r\n+                    }\r\n                     console.log(this._allPointRect);\r\n \r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n"
                },
                {
                    "date": 1625455271872,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -371,9 +371,9 @@\n                         }\r\n \r\n                     }\r\n \r\n-                    if () {\r\n+                    if (this._allPointRect[i].isContains) {\r\n \r\n                     }\r\n                     console.log(this._allPointRect);\r\n \r\n"
                },
                {
                    "date": 1625455331520,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -371,16 +371,18 @@\n                         }\r\n \r\n                     }\r\n \r\n-                    if (this._allPointRect[i].isContains) {\r\n-\r\n-                    }\r\n                     console.log(this._allPointRect);\r\n \r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n+                        if (this._curTouchesPos[0].x < this._allPointRect[0].minx) {\r\n+\r\n+                            this._allPointRect[i].limitMinx = true;\r\n+                        }\r\n+\r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 799;\r\n"
                },
                {
                    "date": 1625455345816,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -378,11 +378,15 @@\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n                         if (this._curTouchesPos[0].x < this._allPointRect[0].minx) {\r\n \r\n-                            this._allPointRect[i].limitMinx = true;\r\n+                            this._allPointRect[0].limitMinx = true;\r\n                         }\r\n+                        if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n+                            this._allPointRect[i].limitMaxx = true;\r\n+                        }\r\n+\r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 799;\r\n"
                },
                {
                    "date": 1625455354212,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -380,11 +380,11 @@\n                         if (this._curTouchesPos[0].x < this._allPointRect[0].minx) {\r\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n-                        if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n+                        if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[1].maxx) {\r\n \r\n-                            this._allPointRect[i].limitMaxx = true;\r\n+                            this._allPointRect[1].limitMaxx = true;\r\n                         }\r\n \r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n"
                },
                {
                    "date": 1625455384317,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -443,8 +443,17 @@\n                         }\r\n \r\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains) {\r\n \r\n+                        if (this._curTouchesPos[0].x < this._allPointRect[0].minx) {\r\n+\r\n+                            this._allPointRect[0].limitMinx = true;\r\n+                        }\r\n+                        if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[1].maxx) {\r\n+\r\n+                            this._allPointRect[1].limitMaxx = true;\r\n+                        }\r\n+\r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 800;\r\n"
                },
                {
                    "date": 1625455410233,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -447,9 +447,9 @@\n                         if (this._curTouchesPos[0].x < this._allPointRect[0].minx) {\r\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n-                        if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[1].maxx) {\r\n+                        if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[2].maxx) {\r\n \r\n                             this._allPointRect[1].limitMaxx = true;\r\n                         }\r\n \r\n"
                },
                {
                    "date": 1625455428293,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -449,9 +449,9 @@\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n                         if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[2].maxx) {\r\n \r\n-                            this._allPointRect[1].limitMaxx = true;\r\n+                            this._allPointRect[2].limitMaxx = true;\r\n                         }\r\n \r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n@@ -510,8 +510,17 @@\n                         }\r\n \r\n                     } else if (this._allPointRect[1].isContains && this._allPointRect[2].isContains) {\r\n \r\n+                        if (this._curTouchesPos[0].x < this._allPointRect[0].minx) {\r\n+\r\n+                            this._allPointRect[0].limitMinx = true;\r\n+                        }\r\n+                        if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[2].maxx) {\r\n+\r\n+                            this._allPointRect[2].limitMaxx = true;\r\n+                        }\r\n+\r\n                         if (this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n \r\n                             console.log('===== 直线 =====');\r\n \r\n"
                },
                {
                    "date": 1625455439937,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -510,9 +510,9 @@\n                         }\r\n \r\n                     } else if (this._allPointRect[1].isContains && this._allPointRect[2].isContains) {\r\n \r\n-                        if (this._curTouchesPos[0].x < this._allPointRect[0].minx) {\r\n+                        if (this._curTouchesPos[0].x < this._allPointRect[2].minx) {\r\n \r\n                             this._allPointRect[0].limitMinx = true;\r\n                         }\r\n                         if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[2].maxx) {\r\n"
                },
                {
                    "date": 1625455463558,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -512,13 +512,13 @@\n                     } else if (this._allPointRect[1].isContains && this._allPointRect[2].isContains) {\r\n \r\n                         if (this._curTouchesPos[0].x < this._allPointRect[2].minx) {\r\n \r\n-                            this._allPointRect[0].limitMinx = true;\r\n+                            this._allPointRect[2].limitMinx = true;\r\n                         }\r\n-                        if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[2].maxx) {\r\n+                        if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[1].maxx) {\r\n \r\n-                            this._allPointRect[2].limitMaxx = true;\r\n+                            this._allPointRect[1].limitMaxx = true;\r\n                         }\r\n \r\n                         if (this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n \r\n"
                },
                {
                    "date": 1625455561781,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -353,24 +353,8 @@\n                         if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n                             this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n                             this._allPointRect[i].isPointInner = true;\r\n                         }\r\n-\r\n-                        if (this._allPointRect[i].isContains) {\r\n-\r\n-                            if (i === 0) {\r\n-                                if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n-\r\n-                                    this._allPointRect[i].limitMinx = true;\r\n-                                }\r\n-                            }\r\n-\r\n-                            if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n-\r\n-                                this._allPointRect[i].limitMaxx = true;\r\n-                            }\r\n-                        }\r\n-\r\n                     }\r\n \r\n                     console.log(this._allPointRect);\r\n \r\n"
                },
                {
                    "date": 1625455800099,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -355,10 +355,8 @@\n                             this._allPointRect[i].isPointInner = true;\r\n                         }\r\n                     }\r\n \r\n-                    console.log(this._allPointRect);\r\n-\r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n                         if (this._curTouchesPos[0].x < this._allPointRect[0].minx) {\r\n@@ -369,8 +367,10 @@\n \r\n                             this._allPointRect[1].limitMaxx = true;\r\n                         }\r\n \r\n+                        console.log(this._allPointRect);\r\n+\r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 799;\r\n@@ -436,8 +436,10 @@\n \r\n                             this._allPointRect[2].limitMaxx = true;\r\n                         }\r\n \r\n+                        console.log(this._allPointRect);\r\n+\r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 800;\r\n@@ -503,8 +505,10 @@\n \r\n                             this._allPointRect[1].limitMaxx = true;\r\n                         }\r\n \r\n+                        console.log(this._allPointRect);\r\n+\r\n                         if (this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n \r\n                             console.log('===== 直线 =====');\r\n \r\n"
                },
                {
                    "date": 1625456299577,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -349,8 +349,9 @@\n \r\n \r\n                     for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n+                        this._allPointRect[0].limitMinx = false;\r\n                         if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n                             this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n                             this._allPointRect[i].isPointInner = true;\r\n                         }\r\n"
                },
                {
                    "date": 1625456418946,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -346,9 +346,8 @@\n                 console.log('===== 5555 =====' + pointNums);\r\n \r\n                 if (pointNums >= 2) {\r\n \r\n-\r\n                     for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                         this._allPointRect[0].limitMinx = false;\r\n                         if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n"
                },
                {
                    "date": 1625456462985,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -99,8 +99,9 @@\n                     'minx': img.x,\r\n                     'maxx': img.y + img.width,\r\n                     'miny': img.y,\r\n                     'maxy': img.y + img.height,\r\n+                    limitQiMinx\r\n                     'limitMinx': false,\r\n                     'limitMaxx': false,\r\n                     'limitMaxy': false,\r\n                     'isPointInner': false\r\n"
                },
                {
                    "date": 1625456471751,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -99,9 +99,10 @@\n                     'minx': img.x,\r\n                     'maxx': img.y + img.width,\r\n                     'miny': img.y,\r\n                     'maxy': img.y + img.height,\r\n-                    limitQiMinx\r\n+                    'limitQiMinx'\r\n+                    \r\n                     'limitMinx': false,\r\n                     'limitMaxx': false,\r\n                     'limitMaxy': false,\r\n                     'isPointInner': false\r\n"
                },
                {
                    "date": 1625456480969,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -99,10 +99,10 @@\n                     'minx': img.x,\r\n                     'maxx': img.y + img.width,\r\n                     'miny': img.y,\r\n                     'maxy': img.y + img.height,\r\n-                    'limitQiMinx'\r\n-                    \r\n+                    'limitQiMinx': false,\r\n+\r\n                     'limitMinx': false,\r\n                     'limitMaxx': false,\r\n                     'limitMaxy': false,\r\n                     'isPointInner': false\r\n"
                },
                {
                    "date": 1625456492116,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -103,9 +103,8 @@\n                     'limitQiMinx': false,\r\n \r\n                     'limitMinx': false,\r\n                     'limitMaxx': false,\r\n-                    'limitMaxy': false,\r\n                     'isPointInner': false\r\n                 };\r\n                 this._allPointRect.push(temp);\r\n             }\r\n"
                },
                {
                    "date": 1625456530116,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -100,11 +100,12 @@\n                     'maxx': img.y + img.width,\r\n                     'miny': img.y,\r\n                     'maxy': img.y + img.height,\r\n                     'limitQiMinx': false,\r\n-\r\n+                    'limitEndMinx': false,\r\n                     'limitMinx': false,\r\n                     'limitMaxx': false,\r\n+\r\n                     'isPointInner': false\r\n                 };\r\n                 this._allPointRect.push(temp);\r\n             }\r\n"
                },
                {
                    "date": 1625456587908,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -101,11 +101,8 @@\n                     'miny': img.y,\r\n                     'maxy': img.y + img.height,\r\n                     'limitQiMinx': false,\r\n                     'limitEndMinx': false,\r\n-                    'limitMinx': false,\r\n-                    'limitMaxx': false,\r\n-\r\n                     'isPointInner': false\r\n                 };\r\n                 this._allPointRect.push(temp);\r\n             }\r\n"
                },
                {
                    "date": 1625456612613,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -100,9 +100,9 @@\n                     'maxx': img.y + img.width,\r\n                     'miny': img.y,\r\n                     'maxy': img.y + img.height,\r\n                     'limitQiMinx': false,\r\n-                    'limitEndMinx': false,\r\n+                    'limitEndMaxx': false,\r\n                     'isPointInner': false\r\n                 };\r\n                 this._allPointRect.push(temp);\r\n             }\r\n"
                },
                {
                    "date": 1625456660307,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -347,9 +347,11 @@\n                 if (pointNums >= 2) {\r\n \r\n                     for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                        this._allPointRect[0].limitMinx = false;\r\n+                        this._allPointRect[0].limitQiMinx = false;\r\n+                        this._allPointRect[0].limitQiMinx = false;\r\n+\r\n                         if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n                             this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n                             this._allPointRect[i].isPointInner = true;\r\n                         }\r\n"
                },
                {
                    "date": 1625456665586,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -348,9 +348,9 @@\n \r\n                     for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n                         this._allPointRect[0].limitQiMinx = false;\r\n-                        this._allPointRect[0].limitQiMinx = false;\r\n+                        this._allPointRect[0].limitEndMaxx = false;\r\n \r\n                         if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n                             this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n                             this._allPointRect[i].isPointInner = true;\r\n"
                },
                {
                    "date": 1625456677256,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,8 +354,12 @@\n                         if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n                             this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n                             this._allPointRect[i].isPointInner = true;\r\n                         }\r\n+\r\n+                        if () {\r\n+\r\n+                        }\r\n                     }\r\n \r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n"
                },
                {
                    "date": 1625456685775,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -355,9 +355,9 @@\n                             this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n                             this._allPointRect[i].isPointInner = true;\r\n                         }\r\n \r\n-                        if () {\r\n+                        if (this._allPointRect[1].isContains) {\r\n \r\n                         }\r\n                     }\r\n \r\n"
                },
                {
                    "date": 1625456692762,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -357,8 +357,9 @@\n                         }\r\n \r\n                         if (this._allPointRect[1].isContains) {\r\n \r\n+\r\n                         }\r\n                     }\r\n \r\n                     let temp = {};\r\n"
                },
                {
                    "date": 1625456712798,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -357,24 +357,25 @@\n                         }\r\n \r\n                         if (this._allPointRect[1].isContains) {\r\n \r\n+                            if (this._curTouchesPos[0].x < this._allPointRect[0].minx) {\r\n \r\n+                                this._allPointRect[0].limitMinx = true;\r\n+                            }\r\n+                            if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[1].maxx) {\r\n+\r\n+                                this._allPointRect[1].limitMaxx = true;\r\n+                            }\r\n+\r\n                         }\r\n                     }\r\n \r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n-                        if (this._curTouchesPos[0].x < this._allPointRect[0].minx) {\r\n \r\n-                            this._allPointRect[0].limitMinx = true;\r\n-                        }\r\n-                        if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[1].maxx) {\r\n \r\n-                            this._allPointRect[1].limitMaxx = true;\r\n-                        }\r\n-\r\n                         console.log(this._allPointRect);\r\n \r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n"
                },
                {
                    "date": 1625456726483,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -359,9 +359,9 @@\n                         if (this._allPointRect[1].isContains) {\r\n \r\n                             if (this._curTouchesPos[0].x < this._allPointRect[0].minx) {\r\n \r\n-                                this._allPointRect[0].limitMinx = true;\r\n+                                this._allPointRect[0].limitQiMinx = true;\r\n                             }\r\n                             if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[1].maxx) {\r\n \r\n                                 this._allPointRect[1].limitMaxx = true;\r\n"
                },
                {
                    "date": 1625456738830,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -357,11 +357,11 @@\n                         }\r\n \r\n                         if (this._allPointRect[1].isContains) {\r\n \r\n-                            if (this._curTouchesPos[0].x < this._allPointRect[0].minx) {\r\n+                            if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n-                                this._allPointRect[0].limitQiMinx = true;\r\n+                                this._allPointRect[i].limitQiMinx = true;\r\n                             }\r\n                             if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[1].maxx) {\r\n \r\n                                 this._allPointRect[1].limitMaxx = true;\r\n"
                },
                {
                    "date": 1625456745682,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -361,11 +361,11 @@\n                             if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n                                 this._allPointRect[i].limitQiMinx = true;\r\n                             }\r\n-                            if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[1].maxx) {\r\n+                            if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n-                                this._allPointRect[1].limitMaxx = true;\r\n+                                this._allPointRect[i].limitMaxx = true;\r\n                             }\r\n \r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625456771723,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -363,9 +363,9 @@\n                                 this._allPointRect[i].limitQiMinx = true;\r\n                             }\r\n                             if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n-                                this._allPointRect[i].limitMaxx = true;\r\n+                                this._allPointRect[i].limitEndMaxx = true;\r\n                             }\r\n \r\n                         }\r\n                     }\r\n"
                },
                {
                    "date": 1625456826103,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -369,15 +369,12 @@\n \r\n                         }\r\n                     }\r\n \r\n+                    console.log('===== ====' + );\r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n-\r\n-\r\n-                        console.log(this._allPointRect);\r\n-\r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 799;\r\n"
                },
                {
                    "date": 1625456831796,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -369,9 +369,9 @@\n \r\n                         }\r\n                     }\r\n \r\n-                    console.log('===== ====' + );\r\n+                    console.log('===== ====' + this._allPointRect);\r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n"
                },
                {
                    "date": 1625456836989,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -369,9 +369,9 @@\n \r\n                         }\r\n                     }\r\n \r\n-                    console.log('===== ====' + this._allPointRect);\r\n+                    console.log('===== allPointRect ====' + this._allPointRect);\r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n"
                },
                {
                    "date": 1625456847444,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -370,8 +370,9 @@\n                         }\r\n                     }\r\n \r\n                     console.log('===== allPointRect ====' + this._allPointRect);\r\n+\r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n                         if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n"
                },
                {
                    "date": 1625456852993,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -365,9 +365,8 @@\n                             if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[i].maxx) {\r\n \r\n                                 this._allPointRect[i].limitEndMaxx = true;\r\n                             }\r\n-\r\n                         }\r\n                     }\r\n \r\n                     console.log('===== allPointRect ====' + this._allPointRect);\r\n"
                },
                {
                    "date": 1625457478489,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -373,9 +373,9 @@\n \r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n-                        if (this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+                        if (this._allPointRect[0].limitQiMinx && this._allPointRect[1].limitEndMaxx) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 799;\r\n                             temp['QiY'] = 626;\r\n"
                },
                {
                    "date": 1625457492301,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -386,9 +386,9 @@\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line1'] = temp;\r\n \r\n \r\n-                        } else if (this._allPointRect[0].limitMinx && !this._allPointRect[1].limitMaxx) {\r\n+                        } else if (this._allPointRect[0].limitQiMinx && !this._allPointRect[1].limitEndMaxx) {\r\n \r\n                             // 左点超出射线\r\n                             let pointMidChang = 297;\r\n \r\n@@ -400,9 +400,9 @@\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line1'] = temp;\r\n \r\n-                        } else if (!this._allPointRect[0].limitMinx && this._allPointRect[1].limitMaxx) {\r\n+                        } else if (!this._allPointRect[0].limitQiMinx && this._allPointRect[1].limitEndMaxx) {\r\n \r\n                             // 右点超出的射线\r\n                             let pointMaxX = 1096;\r\n                             let pointMidChang = 297;\r\n"
                },
                {
                    "date": 1625457506188,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -442,9 +442,9 @@\n                         }\r\n \r\n                         console.log(this._allPointRect);\r\n \r\n-                        if (this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+                        if (this._allPointRect[0].limitQiMinx && this._allPointRect[2].limitEndMaxx) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n"
                },
                {
                    "date": 1625457571257,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -431,19 +431,8 @@\n                         }\r\n \r\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains) {\r\n \r\n-                        if (this._curTouchesPos[0].x < this._allPointRect[0].minx) {\r\n-\r\n-                            this._allPointRect[0].limitMinx = true;\r\n-                        }\r\n-                        if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[2].maxx) {\r\n-\r\n-                            this._allPointRect[2].limitMaxx = true;\r\n-                        }\r\n-\r\n-                        console.log(this._allPointRect);\r\n-\r\n                         if (this._allPointRect[0].limitQiMinx && this._allPointRect[2].limitEndMaxx) {\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 800;\r\n@@ -454,9 +443,9 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n-                        } else if (this._allPointRect[0].limitMinx && !this._allPointRect[2].limitMaxx) {\r\n+                        } else if (this._allPointRect[0].limitQiMinx && !this._allPointRect[2].limitEndMaxx) {\r\n \r\n                             // 左点超出射线\r\n                             let pointMidChang = 280;\r\n \r\n@@ -469,9 +458,9 @@\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n \r\n-                        } else if (!this._allPointRect[0].limitMinx && this._allPointRect[2].limitMaxx) {\r\n+                        } else if (!this._allPointRect[0].limitQiMinx && this._allPointRect[2].limitEndMaxx) {\r\n \r\n                             // 右点超出的射线\r\n                             let pointMaxY = 385;\r\n                             let pointMidChang = 280;\r\n@@ -500,21 +489,10 @@\n                         }\r\n \r\n                     } else if (this._allPointRect[1].isContains && this._allPointRect[2].isContains) {\r\n \r\n-                        if (this._curTouchesPos[0].x < this._allPointRect[2].minx) {\r\n+                        if (this._allPointRect[2].limitQiMinx && this._allPointRect[1].limitMaxx) {\r\n \r\n-                            this._allPointRect[2].limitMinx = true;\r\n-                        }\r\n-                        if (this._curTouchesPos[this._curTouchesPos.length - 1].x > this._allPointRect[1].maxx) {\r\n-\r\n-                            this._allPointRect[1].limitMaxx = true;\r\n-                        }\r\n-\r\n-                        console.log(this._allPointRect);\r\n-\r\n-                        if (this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n-\r\n                             console.log('===== 直线 =====');\r\n \r\n                             // 直线\r\n                             temp['QiX'] = 956;\r\n"
                },
                {
                    "date": 1625457589177,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -489,9 +489,9 @@\n                         }\r\n \r\n                     } else if (this._allPointRect[1].isContains && this._allPointRect[2].isContains) {\r\n \r\n-                        if (this._allPointRect[2].limitQiMinx && this._allPointRect[1].limitMaxx) {\r\n+                        if (this._allPointRect[2].limitQiMinx && this._allPointRect[1].limitEndMaxx) {\r\n \r\n                             console.log('===== 直线 =====');\r\n \r\n                             // 直线\r\n@@ -503,9 +503,9 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                        } else if (!this._allPointRect[1].limitMaxx && this._allPointRect[2].limitMinx) {\r\n+                        } else if (this._allPointRect[2].limitQiMinx && this._allPointRect[1].limitEndMaxx) {\r\n \r\n                             console.log('===== 左点超出射线 =====');\r\n                             // 左点超出射线\r\n                             let pointMidChang = 280;\r\n"
                },
                {
                    "date": 1625457602429,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -503,9 +503,9 @@\n                             temp['chang'] = this._curTouchesPos[this._curTouchesPos.length - 1].sub(this._curTouchesPos[0]).mag();\r\n                             temp['result'] = true;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                        } else if (this._allPointRect[2].limitQiMinx && this._allPointRect[1].limitEndMaxx) {\r\n+                        } else if (this._allPointRect[2].limitQiMinx && !this._allPointRect[1].limitEndMaxx) {\r\n \r\n                             console.log('===== 左点超出射线 =====');\r\n                             // 左点超出射线\r\n                             let pointMidChang = 280;\r\n"
                },
                {
                    "date": 1625457610474,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -518,9 +518,9 @@\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                        } else if (this._allPointRect[1].limitMaxx && !this._allPointRect[2].limitMinx) {\r\n+                        } else if (this._allPointRect[2].limitQiMinx && !this._allPointRect[1].limitEndMaxx) {\r\n \r\n                             console.log('===== 右点超出的射线 =====');\r\n \r\n                             // 右点超出的射线\r\n"
                },
                {
                    "date": 1625457635133,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -518,9 +518,9 @@\n                             temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n-                        } else if (this._allPointRect[2].limitQiMinx && !this._allPointRect[1].limitEndMaxx) {\r\n+                        } else if (!this._allPointRect[2].limitQiMinx && this._allPointRect[1].limitEndMaxx) {\r\n \r\n                             console.log('===== 右点超出的射线 =====');\r\n \r\n                             // 右点超出的射线\r\n"
                },
                {
                    "date": 1625457794539,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -368,9 +368,10 @@\n                             }\r\n                         }\r\n                     }\r\n \r\n-                    console.log('===== allPointRect ====' + this._allPointRect);\r\n+                    console.log('===== allPointRect ====');\r\n+                    console.log(this._allPointRect);\r\n \r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n"
                },
                {
                    "date": 1625457888612,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -355,9 +355,9 @@\n                             this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n                             this._allPointRect[i].isPointInner = true;\r\n                         }\r\n \r\n-                        if (this._allPointRect[1].isContains) {\r\n+                        if (this._allPointRect[i].isContains) {\r\n \r\n                             if (this._curTouchesPos[0].x < this._allPointRect[i].minx) {\r\n \r\n                                 this._allPointRect[i].limitQiMinx = true;\r\n"
                },
                {
                    "date": 1625457950157,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -370,8 +370,9 @@\n                     }\r\n \r\n                     console.log('===== allPointRect ====');\r\n                     console.log(this._allPointRect);\r\n+                    console.log(this._allPointRect);\r\n \r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n"
                },
                {
                    "date": 1625457965187,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -370,9 +370,9 @@\n                     }\r\n \r\n                     console.log('===== allPointRect ====');\r\n                     console.log(this._allPointRect);\r\n-                    console.log(this._allPointRect);\r\n+                    console.log(this.this._curTouchesPos);\r\n \r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n"
                },
                {
                    "date": 1625457972167,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -370,9 +370,9 @@\n                     }\r\n \r\n                     console.log('===== allPointRect ====');\r\n                     console.log(this._allPointRect);\r\n-                    console.log(this.this._curTouchesPos);\r\n+                    console.log(this._curTouchesPos);\r\n \r\n                     let temp = {};\r\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n"
                },
                {
                    "date": 1625458081906,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -96,9 +96,9 @@\n                 let temp = {\r\n                     'rect': new cc.Rect(img.x, img.y, img.width, img.height),\r\n                     'isContains': false,\r\n                     'minx': img.x,\r\n-                    'maxx': img.y + img.width,\r\n+                    'maxx': img.x + img.width,\r\n                     'miny': img.y,\r\n                     'maxy': img.y + img.height,\r\n                     'limitQiMinx': false,\r\n                     'limitEndMaxx': false,\r\n"
                },
                {
                    "date": 1625458314524,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -541,9 +541,9 @@\n                         } else if (this._allPointRect[1].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n                             console.log('===== 线段 =====');\r\n                             //线段\r\n-                            let pointMidChang = 500;\r\n+                            let pointMidChang = 280;\r\n                             temp['QiX'] = 956;\r\n                             temp['QiY'] = 397;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = 0;\r\n"
                },
                {
                    "date": 1625459053244,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -516,9 +516,9 @@\n                             temp['QiY'] = 397;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n                             temp['chaoInterQiY'] = Math.tan(temp['angle'] * 3.14 / 180) * temp['chaoInterQiX'];\r\n-                            temp['chang'] = pointMidChang + temp['chaoInterQiX'];\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiX'] + ;\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n                         } else if (!this._allPointRect[2].limitQiMinx && this._allPointRect[1].limitEndMaxx) {\r\n"
                },
                {
                    "date": 1625459058482,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -516,9 +516,9 @@\n                             temp['QiY'] = 397;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n                             temp['chaoInterQiY'] = Math.tan(temp['angle'] * 3.14 / 180) * temp['chaoInterQiX'];\r\n-                            temp['chang'] = pointMidChang + temp['chaoInterQiX'] + ;\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiX'] + 35;\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n                         } else if (!this._allPointRect[2].limitQiMinx && this._allPointRect[1].limitEndMaxx) {\r\n"
                },
                {
                    "date": 1625459084411,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -516,9 +516,9 @@\n                             temp['QiY'] = 397;\r\n                             temp['angle'] = 57;\r\n                             temp['chaoInterQiX'] = temp['QiX'] - this._curTouchesPos[0].x;\r\n                             temp['chaoInterQiY'] = Math.tan(temp['angle'] * 3.14 / 180) * temp['chaoInterQiX'];\r\n-                            temp['chang'] = pointMidChang + temp['chaoInterQiX'] + 35;\r\n+                            temp['chang'] = pointMidChang + temp['chaoInterQiX'] + 40;\r\n                             temp['result'] = false;\r\n                             state.allTouchLinesPos['line3'] = temp;\r\n \r\n                         } else if (!this._allPointRect[2].limitQiMinx && this._allPointRect[1].limitEndMaxx) {\r\n"
                },
                {
                    "date": 1625459321438,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -435,8 +435,9 @@\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains) {\r\n \r\n                         if (this._allPointRect[0].limitQiMinx && this._allPointRect[2].limitEndMaxx) {\r\n \r\n+                            console.log('===== 左点超出射线 =====');\r\n                             // 直线\r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n@@ -447,8 +448,9 @@\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n                         } else if (this._allPointRect[0].limitQiMinx && !this._allPointRect[2].limitEndMaxx) {\r\n \r\n+                            console.log('===== 左点超出射线 =====');\r\n                             // 左点超出射线\r\n                             let pointMidChang = 280;\r\n \r\n                             temp['QiX'] = 800;\r\n@@ -462,8 +464,9 @@\n \r\n \r\n                         } else if (!this._allPointRect[0].limitQiMinx && this._allPointRect[2].limitEndMaxx) {\r\n \r\n+                            console.log('===== 右点超出的射线 =====');\r\n                             // 右点超出的射线\r\n                             let pointMaxY = 385;\r\n                             let pointMidChang = 280;\r\n \r\n@@ -477,8 +480,9 @@\n                             state.allTouchLinesPos['line2'] = temp;\r\n \r\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[2].isPointInner) {\r\n \r\n+                            console.log('===== 线段 =====');\r\n                             //线段\r\n                             let pointMidChang = 280;\r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n"
                },
                {
                    "date": 1625459334777,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -419,8 +419,9 @@\n                             state.allTouchLinesPos['line1'] = temp;\r\n \r\n                         } else if (this._allPointRect[0].isPointInner && this._allPointRect[1].isPointInner) {\r\n \r\n+                            console.log('===== 线段 =====');\r\n                             //线段\r\n                             let pointMidChang = 297;\r\n                             temp['QiX'] = 799;\r\n                             temp['QiY'] = 626;\r\n@@ -435,9 +436,9 @@\n                     } else if (this._allPointRect[0].isContains && this._allPointRect[2].isContains) {\r\n \r\n                         if (this._allPointRect[0].limitQiMinx && this._allPointRect[2].limitEndMaxx) {\r\n \r\n-                            console.log('===== 左点超出射线 =====');\r\n+                            console.log('===== 直线 =====');\r\n                             // 直线\r\n                             temp['QiX'] = 800;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = -57;\r\n"
                },
                {
                    "date": 1625459343015,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -404,8 +404,9 @@\n                             state.allTouchLinesPos['line1'] = temp;\r\n \r\n                         } else if (!this._allPointRect[0].limitQiMinx && this._allPointRect[1].limitEndMaxx) {\r\n \r\n+                            console.log('===== 右点超出的射线 =====');\r\n                             // 右点超出的射线\r\n                             let pointMaxX = 1096;\r\n                             let pointMidChang = 297;\r\n \r\n"
                },
                {
                    "date": 1625459352134,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -390,8 +390,9 @@\n \r\n \r\n                         } else if (this._allPointRect[0].limitQiMinx && !this._allPointRect[1].limitEndMaxx) {\r\n \r\n+                            console.log('===== 左点超出射线 =====');\r\n                             // 左点超出射线\r\n                             let pointMidChang = 297;\r\n \r\n                             temp['QiX'] = 799;\r\n"
                },
                {
                    "date": 1625459361262,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -377,8 +377,9 @@\n                     if (this._allPointRect[0].isContains && this._allPointRect[1].isContains) {\r\n \r\n                         if (this._allPointRect[0].limitQiMinx && this._allPointRect[1].limitEndMaxx) {\r\n \r\n+                            console.log('===== 直线 =====');\r\n                             // 直线\r\n                             temp['QiX'] = 799;\r\n                             temp['QiY'] = 626;\r\n                             temp['angle'] = 0;\r\n"
                },
                {
                    "date": 1625459497291,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -347,10 +347,10 @@\n                 if (pointNums >= 2) {\r\n \r\n                     for (let i = 0; i < this._allPointRect.length; i++) {\r\n \r\n-                        this._allPointRect[0].limitQiMinx = false;\r\n-                        this._allPointRect[0].limitEndMaxx = false;\r\n+                        this._allPointRect[i].limitQiMinx = false;\r\n+                        this._allPointRect[i].limitEndMaxx = false;\r\n \r\n                         if (this._allPointRect[i].rect.contains(this._curTouchesPos[0]) ||\r\n                             this._allPointRect[i].rect.contains(this._curTouchesPos[this._curTouchesPos.length - 1])) {\r\n                             this._allPointRect[i].isPointInner = true;\r\n"
                },
                {
                    "date": 1625466154269,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,9 +10,9 @@\n const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n const { ccclass, property } = cc._decorator;\r\n \r\n @ccclass\r\n-export default class t4_05_model_v3 extends cc.Component {\r\n+export default class t4_05_model_v4 extends cc.Component {\r\n     private _worldRoot: cc.Node;\r\n \r\n     private _view: fgui.GComponent;\r\n \r\n"
                }
            ],
            "date": 1625136082123,
            "name": "Commit-0",
            "content": "\r\n/*\r\n * @Descripttion: \r\n * @version: \r\n * @Author: ruzhuan\r\n * @Date: 2021-06-08 18:00:00\r\n * @LastEditors: ruzhuan\r\n * @LastEditTime: 2021-06-08 18:00:00\r\n */\r\nconst { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class t4_05_model_v4 extends cc.Component {\r\n    private _worldRoot: cc.Node;\r\n\r\n    private _view: fgui.GComponent;\r\n\r\n    private _c1: fgui.Controller;\r\n\r\n    private _title: fgui.GButton;\r\n\r\n    private _titleTrigger: fgui.GLoader;\r\n\r\n    private _submitBtn: fgui.GButton;\r\n\r\n    private _resetBtn: fgui.GButton;\r\n\r\n    private _package: any;\r\n\r\n    private _touchesPos: any = [];\r\n\r\n    private _moveCurPos: cc.Vec2;\r\n\r\n    private graphics: cc.Graphics = null;\r\n\r\n    private _dragging = false;\r\n\r\n    private _scheduleTime = 0.03;\r\n\r\n    private submitType: any = cc.Enum({\r\n\r\n        No: 0,\r\n        GuideShow: 1,\r\n        WrongFeed: 2,\r\n        RightFeed: 3\r\n    });\r\n\r\n    // 远程动态组件\r\n    private feedback: any;\r\n\r\n    private _state = {};\r\n\r\n    get state(): any {\r\n        return this._state;\r\n    }\r\n\r\n    set state(v: any) {\r\n        this.updateUi(this._state, v);\r\n        this._state = v;\r\n        this.mergeState();\r\n    }\r\n\r\n    async onLoad() {\r\n\r\n        this._worldRoot = cc.find(\"Canvas\").parent;\r\n\r\n        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n\r\n        fgui.GRoot.inst.addChild(this._view);\r\n\r\n        this._c1 = this._view.getController(\"c1\");\r\n\r\n        // 臨時\r\n        // bug 初始设置不播放不生效\r\n        if (this._c1) {\r\n            this._c1.selectedIndex = 1;\r\n            this._c1.selectedIndex = 0;\r\n        }\r\n\r\n        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n\r\n        this._title = this._view.getChild(\"title\").asButton;\r\n\r\n        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n\r\n        this._resetBtn = this._view.getChild(\"restart\").asButton;\r\n        this._resetBtn.on(fgui.Event.CLICK, this._clickReset, this);\r\n\r\n        this._view.on(cc.Node.EventType.TOUCH_START, this._onDrawStart, this);\r\n        this._view.on(cc.Node.EventType.TOUCH_MOVE, this._onDrawMove, this);\r\n        this._view.on(cc.Node.EventType.TOUCH_END, this._onDrawEnd, this);\r\n\r\n        let huiNode = new cc.Node('huiNode');\r\n        huiNode.parent = this._worldRoot;\r\n\r\n        this.graphics = huiNode.addComponent(cc.Graphics);\r\n        this.graphics.lineWidth = 20;\r\n        this.graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n        this.graphics.strokeColor = cc.color(255, 0, 0);\r\n        this.graphics.fillColor = cc.color(255, 0, 0);\r\n\r\n        // 初始化state\r\n        this._state = {\r\n            title: false,\r\n            submit: this.submitType.No,\r\n            touch: \"end\",\r\n            reset: false,\r\n            touchesPos: [],\r\n        }\r\n    }\r\n\r\n    async init(data: any) {\r\n        // 临时 model component json 配置加载\r\n        let { pathConfig, model, components } = data;\r\n        let Package = pathConfig.packageName;\r\n        let GComponent = model.uiPath;\r\n        let { boxSoundUrl, guidIndex } = model.config;\r\n        this._package = Package;\r\n\r\n        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n\r\n        if (components) {\r\n            for (const key in components) {\r\n                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n                let componentBundle: any = await loadBundle(componentPath);\r\n                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n                this[key] = componentPrefab;\r\n            }\r\n        }\r\n    }\r\n\r\n    _onDrawStart(event) {\r\n        console.log('===== start 111 ====' + event.touch.getLocation());\r\n\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n        state.touch = 'start';\r\n        let tempPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n        state.touchesPos.push(tempPos);\r\n        this.updateState(state);\r\n    }\r\n\r\n    _onDrawMove(event) {\r\n\r\n        this._dragging = true;\r\n        this._moveCurPos = new cc.Vec2(event.touch.getLocation().x, event.touch.getLocation().y);\r\n    }\r\n\r\n    _onDrawEnd(event) {\r\n\r\n        this._dragging = false;\r\n\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n        state.touch = 'end';\r\n        this.updateState(state);\r\n    }\r\n\r\n\r\n    // 排序方法\r\n    comparePos() {\r\n        return function (a, b) {\r\n            var value1 = a.x;\r\n            var value2 = b.x;\r\n            return value1 - value2;\r\n        }\r\n    }\r\n\r\n    private _clickReset(evt: any) {\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n        state.reset = true;\r\n        this.updateState(state);\r\n\r\n    }\r\n\r\n    private _clickSubmit(evt: any) {\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n        this.updateState(state);\r\n    }\r\n\r\n    private _clickTitle(evt: any) {\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n        state.title = true;\r\n        this.updateState(state);\r\n    }\r\n\r\n    // 临时\r\n    // 拖拽定时器\r\n    dragSchedule() {\r\n        if (this._dragging) {\r\n\r\n            console.log('==== 3333333 拖拽定时器 ======');\r\n            let state: any = globalThis._.cloneDeep(this._state);\r\n            state.touchesPos.push(this._moveCurPos);\r\n            state.touch = \"move\";\r\n            this.updateState(state);\r\n        }\r\n    }\r\n\r\n    // 获取状态\r\n    getState(data: any) {\r\n        this.updateState(data);\r\n    }\r\n\r\n    // 更新状态层\r\n    updateState(curState: any) {\r\n        if (globalThis._.isEqual(this._state, curState)) return;\r\n        this.state = curState;\r\n    }\r\n\r\n    // 更新ui层\r\n    updateUi(oldState: any, state: any) {\r\n\r\n        if (state.touch == \"start\") {\r\n\r\n            this._touchesPos = state.touchesPos;\r\n            this.graphics.clear();\r\n            this._touchesPos.length = 0;\r\n\r\n        } else if (state.touch == \"move\") {\r\n\r\n            this._touchesPos = state.touchesPos;\r\n            const MIN_POINT_DISTANCE = 4;\r\n\r\n            let worldPos = this.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n            this.graphics.moveTo(this._touchesPos[0].x - worldPos.x, this._touchesPos[0].y - worldPos.y);\r\n            let lastIndex = 0;\r\n            for (let i = 1, l = this._touchesPos.length; i < l; i++) {\r\n                if (this._touchesPos[i].sub(this._touchesPos[lastIndex]).mag() < MIN_POINT_DISTANCE) {\r\n                    continue;\r\n                }\r\n                lastIndex = i;\r\n                this.graphics.lineTo(this._touchesPos[i].x - worldPos.x, this._touchesPos[i].y - worldPos.y);\r\n            }\r\n            this.graphics.stroke();\r\n\r\n        } else if (state.touch == \"end\") {\r\n\r\n            this.graphics.clear();\r\n\r\n            if (this._touchesPos.length > 0) {\r\n\r\n                let angle = this.angle(this._touchesPos[0], this._touchesPos[this._touchesPos.length - 1]);\r\n\r\n                console.log('===== angle 999999 === ' + angle);\r\n\r\n                let zhiLine = fgui.UIPackage.createObjectFromURL('ui://mgpb39d5xdox2a');\r\n                this._view.addChild(zhiLine);\r\n                zhiLine.width = this._touchesPos[this._touchesPos.length - 1].sub(this._touchesPos[0]).mag();\r\n                zhiLine.x = this._touchesPos[0].x;\r\n                zhiLine.y = this._view.height - this._touchesPos[0].y;\r\n                zhiLine.rotation = -angle;\r\n\r\n                zhiLine.sortingOrder = 0;\r\n\r\n                this._touchesPos.sort(this.comparePos());\r\n\r\n\r\n            }\r\n\r\n        }\r\n\r\n\r\n        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n\r\n            if (state.submit === this.submitType.RightFeed) {\r\n\r\n                this.answerFeedback(true);\r\n\r\n            } else if (state.submit === this.submitType.WrongFeed) {\r\n\r\n                this.answerFeedback(false);\r\n\r\n            } else if (state.submit === this.submitType.GuideShow) {\r\n\r\n                let keyBtn = this._view.getChild('input1').asButton;\r\n                this.handTips2(keyBtn);\r\n            }\r\n        }\r\n\r\n\r\n        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n            this.playTitle(state.title);\r\n        }\r\n    }\r\n\r\n    angle(start, end) {\r\n        var diff_x = end.x - start.x,\r\n            diff_y = end.y - start.y;\r\n        //返回角度,不是弧度\r\n        return 360 * Math.atan(diff_y / diff_x) / (2 * Math.PI);\r\n    }\r\n\r\n\r\n    async playTitle(bool: boolean) {\r\n        this._c1.selectedIndex = bool ? 1 : 0;\r\n        if (bool) {\r\n            cc.audioEngine.stopAll();\r\n            this.forbidHandle();\r\n            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n            let audioId = cc.audioEngine.play(audio, false, 1);\r\n            cc.audioEngine.setFinishCallback(audioId, () => {\r\n                let state: any = globalThis._.cloneDeep(this._state);\r\n                state.title = false;\r\n                this.updateState(state);\r\n            });\r\n        } else {\r\n            this.disableForbidHandle();\r\n        }\r\n    }\r\n\r\n    answerFeedback(bool: boolean) {\r\n        if (!this.feedback) return;\r\n        let feedback: any = cc.instantiate(this.feedback);\r\n        feedback.x = 960;\r\n        feedback.y = 540;\r\n        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n        feedbackJs.init(bool);\r\n        feedback.parent = cc.find(\"Canvas\").parent;\r\n\r\n        setTimeout(() => {\r\n            feedback.destroy();\r\n            let state: any = globalThis._.cloneDeep(this._state);\r\n            state.submit = this.submitType.No;\r\n            this.updateState(state);\r\n        }, 2000);\r\n    }\r\n\r\n\r\n    /**\r\n     * 点击指引\r\n     * @param obj 点击对象\r\n     */\r\n    handTips2(obj: fgui.GObject) {\r\n        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n        this._view.addChild(hand);\r\n        let tempX = obj.x;\r\n        let tempY = obj.y;\r\n\r\n        hand.x = tempX;\r\n        hand.y = tempY;\r\n\r\n        cc.tween(hand).to(0.3, {\r\n            x: tempX - 30,\r\n            y: tempY - 30\r\n        }).to(0.3, {\r\n            x: tempX,\r\n            y: tempY\r\n        }).to(0.3, {\r\n            x: tempX - 30,\r\n            y: tempY - 30\r\n        }).to(0.3, {\r\n            x: tempX,\r\n            y: tempY\r\n        }).call(() => {\r\n            this._view.removeChild(hand);\r\n            hand = null;\r\n            let state: any = globalThis._.cloneDeep(this._state);\r\n            state.submit = this.submitType.No;\r\n            this.updateState(state)\r\n        }).start();\r\n    }\r\n\r\n    // 运行时 禁止操作\r\n    forbidHandle() {\r\n        console.log('===  运行时 禁止操作 =====');\r\n        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n        if (!handleMask) {\r\n            let handleMask = new cc.Node('handleMask');\r\n            handleMask.addComponent(cc.BlockInputEvents);\r\n            handleMask.parent = this._worldRoot;\r\n            handleMask.width = 1920;\r\n            handleMask.height = 1080;\r\n            handleMask.x = 960;\r\n            handleMask.y = 540;\r\n        }\r\n    }\r\n\r\n    // 消除禁止\r\n    disableForbidHandle() {\r\n        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n        if (handleMask) handleMask.destroy();\r\n    }\r\n\r\n    // 注册状态，及获取状态的方法\r\n    registerState() {\r\n        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n    }\r\n\r\n    // 解除状态，及获取状态的方法\r\n    relieveState() {\r\n        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n    }\r\n\r\n    // 本组件状态合并到全局\r\n    mergeState() {\r\n        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n    }\r\n\r\n    onEnable() {\r\n        this.registerState();\r\n        this.schedule(this.dragSchedule, this._scheduleTime);\r\n    }\r\n\r\n    onDisable() {\r\n        this.relieveState();\r\n        cc.audioEngine.stopAll();\r\n    }\r\n}\r\n"
        }
    ]
}