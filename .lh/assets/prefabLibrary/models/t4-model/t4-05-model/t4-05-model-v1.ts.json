{
    "sourceFile": "assets/prefabLibrary/models/t4-model/t4-05-model/t4-05-model-v1.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 181,
            "patches": [
                {
                    "date": 1624502666702,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1624503136463,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -77,9 +77,8 @@\n \r\n \r\n         this._mask = this._view.getChild('maskBg').asGraph;\r\n         this._c1 = this._view.getController(\"c1\");\r\n-        this._c2 = this._view.getController(\"c2\");\r\n \r\n         // 臨時\r\n         // bug 初始设置不播放不生效\r\n         if (this._c1) {\r\n"
                },
                {
                    "date": 1624503193006,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,30 +17,16 @@\n     private _view: fgui.GComponent;\r\n \r\n     private _c1: fgui.Controller;\r\n \r\n-    private _c2: fgui.Controller;\r\n-\r\n-    private _paoShow: any = [];\r\n-\r\n-    private _chooseBtn: any = [];\r\n-\r\n-    private _selectIcons: any = [];\r\n-\r\n-    private _chooseCach: any = [];\r\n-\r\n     private _title: fgui.GButton;\r\n \r\n     private _titleTrigger: fgui.GLoader;\r\n \r\n     private _submitBtn: fgui.GButton;\r\n \r\n     private _package: any;\r\n \r\n-    private _boxSound: cc.AudioClip;\r\n-\r\n-    private _mask: fgui.GGraph;\r\n-\r\n     private _guidIndex: number = 0;\r\n \r\n     private _box3D: fgui.GLoader3D;\r\n \r\n@@ -85,51 +71,16 @@\n             this._c1.selectedIndex = 1;\r\n             this._c1.selectedIndex = 0;\r\n         }\r\n \r\n-        this._box3D = this._view.getChild(\"box\") as fgui.GLoader3D;\r\n-        this._box3D.on(fgui.Event.CLICK, this._clickBox, this);\r\n-        this._box3D.url = \"ui://733aoo45gzaz75\";\r\n-        this._box3D.animationName = 'sjq_idle';\r\n-\r\n         this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n         if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n \r\n         this._title = this._view.getChild(\"title\").asButton;\r\n \r\n         this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n         if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n \r\n-        let paoGroup = this._view.getChild(\"pao\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == paoGroup) {\r\n-                let btn: fgui.GButton = this._view.getChildAt(i).asButton;\r\n-                btn.alpha = 0;\r\n-                this._paoShow.push(btn);\r\n-            }\r\n-        }\r\n-\r\n-        let chooseGroup = this._view.getChild(\"choose\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == chooseGroup) {\r\n-                let btn: fgui.GButton = this._view.getChildAt(i).asButton;\r\n-                btn.data = { index: this._chooseCach.length };\r\n-                let temp = { index: this._chooseCach.length, selected: false };\r\n-                this._chooseCach.push(temp);\r\n-                this._chooseBtn.push(btn);\r\n-                btn.on(fgui.Event.CLICK, this._clickChoose, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectedGroup = this._view.getChild(\"select\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectedGroup) {\r\n-                let icon: fgui.GImage = this._view.getChildAt(i).asImage;\r\n-                icon.visible = false;\r\n-                this._selectIcons.push(icon);\r\n-            }\r\n-        }\r\n-\r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n             boxPlay: false,\r\n"
                },
                {
                    "date": 1624503463820,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,12 +25,8 @@\n     private _submitBtn: fgui.GButton;\r\n \r\n     private _package: any;\r\n \r\n-    private _guidIndex: number = 0;\r\n-\r\n-    private _box3D: fgui.GLoader3D;\r\n-\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n@@ -60,10 +56,8 @@\n         this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n \r\n         fgui.GRoot.inst.addChild(this._view);\r\n \r\n-\r\n-        this._mask = this._view.getChild('maskBg').asGraph;\r\n         this._c1 = this._view.getController(\"c1\");\r\n \r\n         // 臨時\r\n         // bug 初始设置不播放不生效\r\n@@ -82,11 +76,8 @@\n \r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n-            boxPlay: false,\r\n-            canChoose: false,\r\n-            chooseCach: this._chooseCach,\r\n             submit: this.submitType.No,\r\n         }\r\n     }\r\n \r\n"
                },
                {
                    "date": 1624503490663,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,12 +90,11 @@\n         this._package = Package;\r\n \r\n         this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n \r\n-        let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n \r\n-        if (guidIndex) this._guidIndex = guidIndex;\r\n \r\n         // 动效注册\r\n         // for (let v in ae) {\r\n         //     if (ae[v]) {\r\n"
                },
                {
                    "date": 1624503583640,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -113,25 +113,8 @@\n             }\r\n         }\r\n     }\r\n \r\n-    private _clickChoose(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        let obj: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let btn: fgui.GButton = obj.asButton;\r\n-\r\n-        for (let i = 0; i < state.chooseCach.length; i++) {\r\n-            state.chooseCach[i].selected = false;\r\n-        }\r\n-        for (let i = 0; i < state.chooseCach.length; i++) {\r\n-            if (state.chooseCach[i].index === btn.data.index) {\r\n-                state.chooseCach[i].selected = true;\r\n-                break;\r\n-            }\r\n-        }\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n     private _clickSubmit(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n \r\n         let isHave = 0;\r\n@@ -163,14 +146,8 @@\n \r\n         this.updateState(state);\r\n     }\r\n \r\n-    private _clickBox(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.boxPlay = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n     private _clickTitle(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.title = true;\r\n         this.updateState(state);\r\n@@ -190,29 +167,11 @@\n \r\n     // 更新ui层\r\n     updateUi(oldState: any, state: any) {\r\n \r\n-        if (!globalThis._.isEqual(oldState.boxPlay, state.boxPlay)) {\r\n-            if (state.boxPlay) {\r\n-                this.playBoxSpeak(state.boxPlay);\r\n-            } else {\r\n-                this._box3D.animationName = 'sjq_idle';\r\n-                this._c2.selectedIndex = 0;\r\n-            }\r\n-        }\r\n \r\n-        if (!globalThis._.isEqual(oldState.chooseCach, state.chooseCach)) {\r\n \r\n-            for (let i = 0; i < state.chooseCach.length; i++) {\r\n \r\n-                for (let j = 0; j < this._selectIcons.length; j++) {\r\n-                    if (state.chooseCach[i].index === j) {\r\n-                        this._selectIcons[j].visible = state.chooseCach[i].selected;\r\n-                        break;\r\n-                    }\r\n-                }\r\n-            }\r\n-        }\r\n \r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n             if (state.submit === this.submitType.RightFeed) {\r\n@@ -224,20 +183,16 @@\n                 this.answerFeedback(false);\r\n \r\n             } else if (state.submit === this.submitType.GuideShow) {\r\n \r\n-                this.handTips2(this._chooseBtn[this._guidIndex]);\r\n+\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n             this.playTitle(state.title);\r\n         }\r\n \r\n-        if (!globalThis._.isEqual(oldState.canChoose, state.canChoose)) {\r\n-            this._mask.visible = !state.canChoose;\r\n-        }\r\n-\r\n     }\r\n \r\n \r\n     async playTitle(bool: boolean) {\r\n@@ -257,75 +212,8 @@\n             this.disableForbidHandle();\r\n         }\r\n     }\r\n \r\n-    playBoxSpeak(bool: boolean) {\r\n-        if (bool) {\r\n-\r\n-            this._box3D.animationName = 'sjq_idle1to2';\r\n-\r\n-            cc.tween(this._box3D)\r\n-                .delay(0.3)\r\n-                .call(() => {\r\n-                    this._box3D.animationName = 'sjq_idle2';\r\n-                })\r\n-                .start()\r\n-\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            this.playBoxSound();\r\n-\r\n-        } else {\r\n-            this._c2.selectedIndex = 0;\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    async playBoxSound() {\r\n-\r\n-        for (let i = 0; i < this._paoShow.length; i++) {\r\n-            this._paoShow[i].alpha = 0;\r\n-        }\r\n-\r\n-        cc.tween(this)\r\n-            .delay(0.5)\r\n-            .call(() => {\r\n-\r\n-                this._c2.selectedIndex = 1;\r\n-                this.playPaoShowAnimate(0);\r\n-            })\r\n-            .start();\r\n-\r\n-        let audioId = cc.audioEngine.play(this._boxSound, false, 1);\r\n-        cc.audioEngine.setFinishCallback(audioId, () => {\r\n-            this._box3D.animationName = 'sjq_idle';\r\n-            this.disableForbidHandle();\r\n-            for (let i = 0; i < this._paoShow.length; i++) {\r\n-                this._paoShow[i].alpha = 0;\r\n-            }\r\n-            this._c2.selectedIndex = 0;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.boxPlay = false;\r\n-            state.canChoose = true;\r\n-            this.updateState(state);\r\n-\r\n-        });\r\n-    }\r\n-\r\n-    playPaoShowAnimate(index: number) {\r\n-\r\n-        cc.tween(this._paoShow[index])\r\n-            .to(1.0, { alpha: 1 })\r\n-            .call(() => {\r\n-                index++;\r\n-                if (index < this._paoShow.length) {\r\n-                    this.playPaoShowAnimate(index);\r\n-                }\r\n-            })\r\n-            .start()\r\n-\r\n-    }\r\n-\r\n     answerFeedback(bool: boolean) {\r\n         if (!this.feedback) return;\r\n         let feedback: any = cc.instantiate(this.feedback);\r\n         feedback.x = 960;\r\n@@ -417,9 +305,8 @@\n         this.registerState();\r\n     }\r\n \r\n     onDisable() {\r\n-        cc.tween(this._box3D).stop();\r\n         cc.tween(this).stop();\r\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n"
                },
                {
                    "date": 1624503781226,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -167,12 +167,8 @@\n \r\n     // 更新ui层\r\n     updateUi(oldState: any, state: any) {\r\n \r\n-\r\n-\r\n-\r\n-\r\n         if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n \r\n             if (state.submit === this.submitType.RightFeed) {\r\n \r\n"
                },
                {
                    "date": 1624504221674,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,309 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+\r\n+        let isHave = 0;\r\n+        for (let i = 0; i < state.chooseCach.length; i++) {\r\n+\r\n+            if (state.chooseCach[i].selected) {\r\n+                isHave++;\r\n+            }\r\n+        }\r\n+\r\n+        if (isHave === 0) {\r\n+            state.submit = this.submitType.GuideShow;\r\n+        } else if (isHave === 1) {\r\n+\r\n+            state.submit = this.submitType.WrongFeed;\r\n+\r\n+            for (let i = 0; i < state.chooseCach.length; i++) {\r\n+\r\n+                if (state.chooseCach[i].selected && state.chooseCach[i].index === 0) {\r\n+\r\n+                    state.submit = this.submitType.RightFeed;\r\n+                    break;\r\n+                }\r\n+            }\r\n+\r\n+        } else {\r\n+            state.submit = this.submitType.WrongFeed;\r\n+        }\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624504230561,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -306,313 +306,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-\r\n-        let isHave = 0;\r\n-        for (let i = 0; i < state.chooseCach.length; i++) {\r\n-\r\n-            if (state.chooseCach[i].selected) {\r\n-                isHave++;\r\n-            }\r\n-        }\r\n-\r\n-        if (isHave === 0) {\r\n-            state.submit = this.submitType.GuideShow;\r\n-        } else if (isHave === 1) {\r\n-\r\n-            state.submit = this.submitType.WrongFeed;\r\n-\r\n-            for (let i = 0; i < state.chooseCach.length; i++) {\r\n-\r\n-                if (state.chooseCach[i].selected && state.chooseCach[i].index === 0) {\r\n-\r\n-                    state.submit = this.submitType.RightFeed;\r\n-                    break;\r\n-                }\r\n-            }\r\n-\r\n-        } else {\r\n-            state.submit = this.submitType.WrongFeed;\r\n-        }\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624504292226,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,309 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+\r\n+        let isHave = 0;\r\n+        for (let i = 0; i < state.chooseCach.length; i++) {\r\n+\r\n+            if (state.chooseCach[i].selected) {\r\n+                isHave++;\r\n+            }\r\n+        }\r\n+\r\n+        if (isHave === 0) {\r\n+            state.submit = this.submitType.GuideShow;\r\n+        } else if (isHave === 1) {\r\n+\r\n+            state.submit = this.submitType.WrongFeed;\r\n+\r\n+            for (let i = 0; i < state.chooseCach.length; i++) {\r\n+\r\n+                if (state.chooseCach[i].selected && state.chooseCach[i].index === 0) {\r\n+\r\n+                    state.submit = this.submitType.RightFeed;\r\n+                    break;\r\n+                }\r\n+            }\r\n+\r\n+        } else {\r\n+            state.submit = this.submitType.WrongFeed;\r\n+        }\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624504299184,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -179,16 +179,14 @@\n                 this.answerFeedback(false);\r\n \r\n             } else if (state.submit === this.submitType.GuideShow) {\r\n \r\n-\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n             this.playTitle(state.title);\r\n         }\r\n-\r\n     }\r\n \r\n \r\n     async playTitle(bool: boolean) {\r\n@@ -306,313 +304,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-\r\n-        let isHave = 0;\r\n-        for (let i = 0; i < state.chooseCach.length; i++) {\r\n-\r\n-            if (state.chooseCach[i].selected) {\r\n-                isHave++;\r\n-            }\r\n-        }\r\n-\r\n-        if (isHave === 0) {\r\n-            state.submit = this.submitType.GuideShow;\r\n-        } else if (isHave === 1) {\r\n-\r\n-            state.submit = this.submitType.WrongFeed;\r\n-\r\n-            for (let i = 0; i < state.chooseCach.length; i++) {\r\n-\r\n-                if (state.chooseCach[i].selected && state.chooseCach[i].index === 0) {\r\n-\r\n-                    state.submit = this.submitType.RightFeed;\r\n-                    break;\r\n-                }\r\n-            }\r\n-\r\n-        } else {\r\n-            state.submit = this.submitType.WrongFeed;\r\n-        }\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624504346928,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,307 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+\r\n+        let isHave = 0;\r\n+        for (let i = 0; i < state.chooseCach.length; i++) {\r\n+\r\n+            if (state.chooseCach[i].selected) {\r\n+                isHave++;\r\n+            }\r\n+        }\r\n+\r\n+        if (isHave === 0) {\r\n+            state.submit = this.submitType.GuideShow;\r\n+        } else if (isHave === 1) {\r\n+\r\n+            state.submit = this.submitType.WrongFeed;\r\n+\r\n+            for (let i = 0; i < state.chooseCach.length; i++) {\r\n+\r\n+                if (state.chooseCach[i].selected && state.chooseCach[i].index === 0) {\r\n+\r\n+                    state.submit = this.submitType.RightFeed;\r\n+                    break;\r\n+                }\r\n+            }\r\n+\r\n+        } else {\r\n+            state.submit = this.submitType.WrongFeed;\r\n+        }\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624504434610,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -304,311 +304,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-\r\n-        let isHave = 0;\r\n-        for (let i = 0; i < state.chooseCach.length; i++) {\r\n-\r\n-            if (state.chooseCach[i].selected) {\r\n-                isHave++;\r\n-            }\r\n-        }\r\n-\r\n-        if (isHave === 0) {\r\n-            state.submit = this.submitType.GuideShow;\r\n-        } else if (isHave === 1) {\r\n-\r\n-            state.submit = this.submitType.WrongFeed;\r\n-\r\n-            for (let i = 0; i < state.chooseCach.length; i++) {\r\n-\r\n-                if (state.chooseCach[i].selected && state.chooseCach[i].index === 0) {\r\n-\r\n-                    state.submit = this.submitType.RightFeed;\r\n-                    break;\r\n-                }\r\n-            }\r\n-\r\n-        } else {\r\n-            state.submit = this.submitType.WrongFeed;\r\n-        }\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624506511457,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -115,36 +115,13 @@\n     }\r\n \r\n     private _clickSubmit(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n \r\n-        let isHave = 0;\r\n-        for (let i = 0; i < state.chooseCach.length; i++) {\r\n \r\n-            if (state.chooseCach[i].selected) {\r\n-                isHave++;\r\n-            }\r\n-        }\r\n-\r\n-        if (isHave === 0) {\r\n-            state.submit = this.submitType.GuideShow;\r\n-        } else if (isHave === 1) {\r\n-\r\n-            state.submit = this.submitType.WrongFeed;\r\n-\r\n-            for (let i = 0; i < state.chooseCach.length; i++) {\r\n-\r\n-                if (state.chooseCach[i].selected && state.chooseCach[i].index === 0) {\r\n-\r\n-                    state.submit = this.submitType.RightFeed;\r\n-                    break;\r\n-                }\r\n-            }\r\n-\r\n-        } else {\r\n-            state.submit = this.submitType.WrongFeed;\r\n-        }\r\n-\r\n         this.updateState(state);\r\n     }\r\n \r\n     private _clickTitle(evt: any) {\r\n"
                },
                {
                    "date": 1624506518708,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -119,9 +119,8 @@\n         state.submit = this.submitType.GuideShow;\r\n         state.submit = this.submitType.WrongFeed;\r\n         state.submit = this.submitType.RightFeed;\r\n \r\n-\r\n         this.updateState(state);\r\n     }\r\n \r\n     private _clickTitle(evt: any) {\r\n"
                },
                {
                    "date": 1624506680753,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,8 +25,14 @@\n     private _submitBtn: fgui.GButton;\r\n \r\n     private _package: any;\r\n \r\n+    private _selectArr: [];\r\n+\r\n+    private _kuangArr: [];\r\n+\r\n+    private _textArr: [];\r\n+\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n"
                },
                {
                    "date": 1624506761230,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,8 +79,10 @@\n \r\n         this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n         if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n \r\n+        let optionGroup = this._view.getChild(\"optionBox\").asGroup;\r\n+\r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n"
                },
                {
                    "date": 1624506768922,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,9 +79,9 @@\n \r\n         this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n         if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n \r\n-        let optionGroup = this._view.getChild(\"optionBox\").asGroup;\r\n+        let kuangGroup = this._view.getChild(\"optionBox\").asGroup;\r\n \r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n"
                },
                {
                    "date": 1624506781405,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,9 +79,9 @@\n \r\n         this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n         if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n \r\n-        let kuangGroup = this._view.getChild(\"optionBox\").asGroup;\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n \r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n"
                },
                {
                    "date": 1624506795854,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -80,9 +80,27 @@\n         this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n         if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n \r\n         let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == optionGroup) {\r\n+                let btn = null;\r\n+                if (this._isAnimateShow) {\r\n \r\n+                    btn = this._view.getChildAt(i) as fgui.GLoader3D;\r\n+                    btn.animationName = this._animateName[btn.name].idle;\r\n+                    btn.skinName = this._animateName[btn.name].skin;\r\n+                    btn.url = \"ui://733aoo45gzaz72\";\r\n+\r\n+                } else {\r\n+                    btn = this._view.getChildAt(i).asButton;\r\n+                }\r\n+\r\n+                btn.on(fgui.Event.CLICK, this._clickOption, this);\r\n+                this._options[btn.name] = btn;\r\n+            }\r\n+        }\r\n+\r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n"
                },
                {
                    "date": 1624506823703,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,10 +27,8 @@\n     private _package: any;\r\n \r\n     private _selectArr: [];\r\n \r\n-    private _kuangArr: [];\r\n-\r\n     private _textArr: [];\r\n \r\n     private submitType: any = cc.Enum({\r\n \r\n"
                },
                {
                    "date": 1624506842596,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,9 +79,9 @@\n         if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n \r\n         let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == optionGroup) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let btn = null;\r\n                 if (this._isAnimateShow) {\r\n \r\n                     btn = this._view.getChildAt(i) as fgui.GLoader3D;\r\n"
                },
                {
                    "date": 1624506857772,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -80,18 +80,18 @@\n \r\n         let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = null;\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n                 if (this._isAnimateShow) {\r\n \r\n                     btn = this._view.getChildAt(i) as fgui.GLoader3D;\r\n                     btn.animationName = this._animateName[btn.name].idle;\r\n                     btn.skinName = this._animateName[btn.name].skin;\r\n                     btn.url = \"ui://733aoo45gzaz72\";\r\n \r\n                 } else {\r\n-                    btn = this._view.getChildAt(i).asButton;\r\n+\r\n                 }\r\n \r\n                 btn.on(fgui.Event.CLICK, this._clickOption, this);\r\n                 this._options[btn.name] = btn;\r\n"
                },
                {
                    "date": 1624506863069,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -81,19 +81,8 @@\n         let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let btn = this._view.getChildAt(i).asButton;\r\n-                if (this._isAnimateShow) {\r\n-\r\n-                    btn = this._view.getChildAt(i) as fgui.GLoader3D;\r\n-                    btn.animationName = this._animateName[btn.name].idle;\r\n-                    btn.skinName = this._animateName[btn.name].skin;\r\n-                    btn.url = \"ui://733aoo45gzaz72\";\r\n-\r\n-                } else {\r\n-\r\n-                }\r\n-\r\n                 btn.on(fgui.Event.CLICK, this._clickOption, this);\r\n                 this._options[btn.name] = btn;\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1624506868501,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -82,9 +82,8 @@\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let btn = this._view.getChildAt(i).asButton;\r\n                 btn.on(fgui.Event.CLICK, this._clickOption, this);\r\n-                this._options[btn.name] = btn;\r\n             }\r\n         }\r\n \r\n         // 初始化state\r\n"
                },
                {
                    "date": 1624506884365,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,295 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectArr: [];\r\n+\r\n+    private _textArr: [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                btn.on(fgui.Event.CLICK, this._clickOption, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624506890548,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -292,299 +292,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectArr: [];\r\n-\r\n-    private _textArr: [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                btn.on(fgui.Event.CLICK, this._clickOption, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624506946279,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,295 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectArr: [];\r\n+\r\n+    private _textArr: [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                btn.on(fgui.Event.CLICK, this._clickOption, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624506974079,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -81,9 +81,9 @@\n         let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let btn = this._view.getChildAt(i).asButton;\r\n-                btn.on(fgui.Event.CLICK, this._clickOption, this);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n \r\n         // 初始化state\r\n@@ -125,303 +125,13 @@\n             }\r\n         }\r\n     }\r\n \r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n+    private _clickKuang(evt: any) {\r\n \r\n-        this.updateState(state);\r\n-    }\r\n \r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n     }\r\n \r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectArr: [];\r\n-\r\n-    private _textArr: [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                btn.on(fgui.Event.CLICK, this._clickOption, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n     private _clickSubmit(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.submit = this.submitType.GuideShow;\r\n         state.submit = this.submitType.WrongFeed;\r\n"
                },
                {
                    "date": 1624507010054,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -128,8 +128,9 @@\n \r\n     private _clickKuang(evt: any) {\r\n \r\n \r\n+\r\n     }\r\n \r\n     private _clickSubmit(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1624507022052,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -29,8 +29,10 @@\n     private _selectArr: [];\r\n \r\n     private _textArr: [];\r\n \r\n+\r\n+\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n"
                },
                {
                    "date": 1624507058371,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -29,10 +29,10 @@\n     private _selectArr: [];\r\n \r\n     private _textArr: [];\r\n \r\n+    private _kuangNameArr: [];\r\n \r\n-\r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n         GuideShow: 1,\r\n@@ -83,8 +83,9 @@\n         let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let btn = this._view.getChildAt(i).asButton;\r\n+                this._kuangNameArr.push(btn.name);\r\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1624507125655,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,13 +25,13 @@\n     private _submitBtn: fgui.GButton;\r\n \r\n     private _package: any;\r\n \r\n-    private _selectArr: [];\r\n+    private _selectArr: any = [];\r\n \r\n-    private _textArr: [];\r\n+    private _textArr: any = [];\r\n \r\n-    private _kuangNameArr: [];\r\n+    private _kuangNameArr: any = [];\r\n \r\n     private submitType: any = cc.Enum({\r\n \r\n         No: 0,\r\n"
                },
                {
                    "date": 1624507188828,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,304 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectArr: any = [];\r\n+\r\n+    private _textArr: any = [];\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624507200285,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -301,308 +301,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectArr: any = [];\r\n-\r\n-    private _textArr: any = [];\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-\r\n-\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624507230754,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,8 +92,9 @@\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n"
                },
                {
                    "date": 1624507583074,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -132,9 +132,10 @@\n \r\n     private _clickKuang(evt: any) {\r\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        selectKuangName\r\n     }\r\n \r\n     private _clickSubmit(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1624507596809,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,306 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectArr: any = [];\r\n+\r\n+    private _textArr: any = [];\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624507608508,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -134,8 +134,9 @@\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.selectKuangName = btn.name;\r\n+        this.updateState();\r\n     }\r\n \r\n     private _clickSubmit(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n@@ -303,310 +304,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectArr: any = [];\r\n-\r\n-    private _textArr: any = [];\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        selectKuangName\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624507623316,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -88,8 +88,17 @@\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n \r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n@@ -134,9 +143,9 @@\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.selectKuangName = btn.name;\r\n-        this.updateState();\r\n+        this.updateState(state);\r\n     }\r\n \r\n     private _clickSubmit(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n"
                },
                {
                    "date": 1624507629581,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,316 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectArr: any = [];\r\n+\r\n+    private _textArr: any = [];\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624507639907,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -88,9 +88,9 @@\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n \r\n-        let selectGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let btn = this._view.getChildAt(i).asButton;\r\n                 this._kuangNameArr.push(btn.name);\r\n@@ -313,320 +313,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectArr: any = [];\r\n-\r\n-    private _textArr: any = [];\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624507652770,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,9 +25,9 @@\n     private _submitBtn: fgui.GButton;\r\n \r\n     private _package: any;\r\n \r\n-    private _selectArr: any = [];\r\n+    private _selectArr: any = {};\r\n \r\n     private _textArr: any = [];\r\n \r\n     private _kuangNameArr: any = [];\r\n"
                },
                {
                    "date": 1624507659258,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,9 +25,9 @@\n     private _submitBtn: fgui.GButton;\r\n \r\n     private _package: any;\r\n \r\n-    private _selectArr: any = {};\r\n+    private _selectMap: any = {};\r\n \r\n     private _textArr: any = [];\r\n \r\n     private _kuangNameArr: any = [];\r\n"
                },
                {
                    "date": 1624507668364,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,9 +27,9 @@\n     private _package: any;\r\n \r\n     private _selectMap: any = {};\r\n \r\n-    private _textArr: any = [];\r\n+    private _textMap: any = {};\r\n \r\n     private _kuangNameArr: any = [];\r\n \r\n     private submitType: any = cc.Enum({\r\n"
                },
                {
                    "date": 1624507689005,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,9 +91,10 @@\n \r\n         let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n+                let btn = this._view.getChildAt(i).asImage;\r\n+                _selectMap\r\n                 this._kuangNameArr.push(btn.name);\r\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1624507697146,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,10 +91,10 @@\n \r\n         let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asImage;\r\n-                _selectMap\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap\r\n                 this._kuangNameArr.push(btn.name);\r\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1624507718724,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,10 +92,10 @@\n         let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap\r\n-                this._kuangNameArr.push(btn.name);\r\n+                this._selectMap[this._kuangNameArr[i]] = \r\n+                .push(btn.name);\r\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1624507728333,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,10 +92,10 @@\n         let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[i]] = \r\n-                .push(btn.name);\r\n+                this._selectMap[this._kuangNameArr[i]] = img;\r\n+\r\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1624507735298,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,9 +94,8 @@\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let img = this._view.getChildAt(i).asImage;\r\n                 this._selectMap[this._kuangNameArr[i]] = img;\r\n \r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n \r\n         // 初始化state\r\n"
                },
                {
                    "date": 1624507741471,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -93,9 +93,9 @@\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let img = this._view.getChildAt(i).asImage;\r\n                 this._selectMap[this._kuangNameArr[i]] = img;\r\n-\r\n+                img.visible = false;\r\n             }\r\n         }\r\n \r\n         // 初始化state\r\n"
                },
                {
                    "date": 1624507747219,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,9 +90,9 @@\n         }\r\n \r\n         let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n                 let img = this._view.getChildAt(i).asImage;\r\n                 this._selectMap[this._kuangNameArr[i]] = img;\r\n                 img.visible = false;\r\n             }\r\n"
                },
                {
                    "date": 1624507765387,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -97,8 +97,17 @@\n                 img.visible = false;\r\n             }\r\n         }\r\n \r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[i]] = img;\r\n+                img.visible = false;\r\n+            }\r\n+        }\r\n+\r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n"
                },
                {
                    "date": 1624507788836,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -99,10 +99,10 @@\n         }\r\n \r\n         let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let img = this._view.getChildAt(i).asLabel;\r\n                 this._selectMap[this._kuangNameArr[i]] = img;\r\n                 img.visible = false;\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1624507805414,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -100,10 +100,10 @@\n \r\n         let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == textGroup) {\r\n-                let img = this._view.getChildAt(i).asLabel;\r\n-                this._selectMap[this._kuangNameArr[i]] = img;\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._selectMap[this._kuangNameArr[i]] = label;\r\n                 img.visible = false;\r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1624507815419,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -101,10 +101,9 @@\n         let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == textGroup) {\r\n                 let label = this._view.getChildAt(i).asLabel;\r\n-                this._selectMap[this._kuangNameArr[i]] = label;\r\n-                img.visible = false;\r\n+                this._selectMap[this._textMap[i]] = label;\r\n             }\r\n         }\r\n \r\n         // 初始化state\r\n"
                },
                {
                    "date": 1624507822682,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -102,8 +102,9 @@\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == textGroup) {\r\n                 let label = this._view.getChildAt(i).asLabel;\r\n                 this._selectMap[this._textMap[i]] = label;\r\n+\r\n             }\r\n         }\r\n \r\n         // 初始化state\r\n"
                },
                {
                    "date": 1624507855443,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -101,9 +101,9 @@\n         let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == textGroup) {\r\n                 let label = this._view.getChildAt(i).asLabel;\r\n-                this._selectMap[this._textMap[i]] = label;\r\n+                this._textMap[this._kuangNameArr[i]] = label;\r\n \r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1624507885195,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -199,8 +199,11 @@\n             } else if (state.submit === this.submitType.GuideShow) {\r\n \r\n             }\r\n         }\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n \r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n             this.playTitle(state.title);\r\n         }\r\n"
                },
                {
                    "date": 1624507890412,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -200,9 +200,10 @@\n \r\n             }\r\n         }\r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-            this.playTitle(state.title);\r\n+\r\n+\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n             this.playTitle(state.title);\r\n"
                },
                {
                    "date": 1624507895574,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -201,9 +201,11 @@\n             }\r\n         }\r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n \r\n+            if () {\r\n \r\n+            }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n             this.playTitle(state.title);\r\n"
                },
                {
                    "date": 1624507901518,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -201,10 +201,11 @@\n             }\r\n         }\r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n \r\n-            if () {\r\n+            if (state.selectKuangName) {\r\n \r\n+\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n"
                },
                {
                    "date": 1624507912084,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -201,9 +201,9 @@\n             }\r\n         }\r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n \r\n-            if (state.selectKuangName) {\r\n+            if (state.selectKuangName != '') {\r\n \r\n \r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1624508003127,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -203,8 +203,9 @@\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n \r\n             if (state.selectKuangName != '') {\r\n \r\n+                this._selectMap[state.selectKuangName]\r\n \r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1624508018316,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -203,9 +203,9 @@\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n \r\n             if (state.selectKuangName != '') {\r\n \r\n-                this._selectMap[state.selectKuangName]\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n \r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1624508023413,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -204,9 +204,8 @@\n \r\n             if (state.selectKuangName != '') {\r\n \r\n                 this._selectMap[state.selectKuangName].visible = true;\r\n-\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n"
                },
                {
                    "date": 1624508033180,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -201,12 +201,16 @@\n             }\r\n         }\r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n \r\n+\r\n             if (state.selectKuangName != '') {\r\n \r\n                 this._selectMap[state.selectKuangName].visible = true;\r\n             }\r\n+            if () {\r\n+\r\n+            }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n             this.playTitle(state.title);\r\n"
                },
                {
                    "date": 1624508044772,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -206,10 +206,10 @@\n             if (state.selectKuangName != '') {\r\n \r\n                 this._selectMap[state.selectKuangName].visible = true;\r\n             }\r\n-            if () {\r\n-\r\n+            if (oldState.selectKuangName != '') {\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n"
                },
                {
                    "date": 1624508050106,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -207,9 +207,9 @@\n \r\n                 this._selectMap[state.selectKuangName].visible = true;\r\n             }\r\n             if (oldState.selectKuangName != '') {\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n+                this._selectMap[state.selectKuangName].visible = false;\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n"
                },
                {
                    "date": 1624508055301,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -206,9 +206,11 @@\n             if (state.selectKuangName != '') {\r\n \r\n                 this._selectMap[state.selectKuangName].visible = true;\r\n             }\r\n+\r\n             if (oldState.selectKuangName != '') {\r\n+\r\n                 this._selectMap[state.selectKuangName].visible = false;\r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1624508067077,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,338 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[i]] = img;\r\n+                img.visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[i]] = label;\r\n+\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624508081843,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -335,342 +335,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[i]] = img;\r\n-                img.visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[i]] = label;\r\n-\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624508174958,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,338 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[i]] = img;\r\n+                img.visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[i]] = label;\r\n+\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624508203177,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -83,8 +83,9 @@\n         let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== ===' + );\r\n                 this._kuangNameArr.push(btn.name);\r\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n@@ -335,342 +336,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[i]] = img;\r\n-                img.visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[i]] = label;\r\n-\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624508208627,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -83,9 +83,9 @@\n         let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== ===' + );\r\n+                console.log('=== ===' + btn.name);\r\n                 this._kuangNameArr.push(btn.name);\r\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1624508214049,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -83,9 +83,9 @@\n         let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== ===' + btn.name);\r\n+                console.log('=== name ===' + btn.name);\r\n                 this._kuangNameArr.push(btn.name);\r\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1624508264847,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,8 +90,9 @@\n             }\r\n         }\r\n \r\n         let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == selectGroup) {\r\n                 let img = this._view.getChildAt(i).asImage;\r\n                 this._selectMap[this._kuangNameArr[i]] = img;\r\n"
                },
                {
                    "date": 1624508270782,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,9 +94,9 @@\n         let indexTemp = 0;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == selectGroup) {\r\n                 let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[i]] = img;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n                 img.visible = false;\r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1624508275880,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -96,8 +96,9 @@\n             if (this._view.getChildAt(i).group == selectGroup) {\r\n                 let img = this._view.getChildAt(i).asImage;\r\n                 this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n                 img.visible = false;\r\n+                indexTemp++;\r\n             }\r\n         }\r\n \r\n         let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n"
                },
                {
                    "date": 1624508284189,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -100,8 +100,9 @@\n                 indexTemp++;\r\n             }\r\n         }\r\n \r\n+        indexTemp = 0;\r\n         let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == textGroup) {\r\n                 let label = this._view.getChildAt(i).asLabel;\r\n"
                },
                {
                    "date": 1624508292374,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -105,10 +105,10 @@\n         let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == textGroup) {\r\n                 let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[i]] = label;\r\n-\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n             }\r\n         }\r\n \r\n         // 初始化state\r\n"
                },
                {
                    "date": 1624508397756,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -110,8 +110,17 @@\n                 indexTemp++;\r\n             }\r\n         }\r\n \r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n"
                },
                {
                    "date": 1624508411984,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -110,9 +110,9 @@\n                 indexTemp++;\r\n             }\r\n         }\r\n \r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        let textGroup = this._view.getChild(\"key\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == textGroup) {\r\n                 let label = this._view.getChildAt(i).asLabel;\r\n                 this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n"
                },
                {
                    "date": 1624508417063,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -110,9 +110,9 @@\n                 indexTemp++;\r\n             }\r\n         }\r\n \r\n-        let textGroup = this._view.getChild(\"key\").asGroup;\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == textGroup) {\r\n                 let label = this._view.getChildAt(i).asLabel;\r\n                 this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n"
                },
                {
                    "date": 1624508423179,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -112,9 +112,9 @@\n         }\r\n \r\n         let keyGroup = this._view.getChild(\"key\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n                 let label = this._view.getChildAt(i).asLabel;\r\n                 this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n                 indexTemp++;\r\n             }\r\n"
                },
                {
                    "date": 1624508430371,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -113,9 +113,9 @@\n \r\n         let keyGroup = this._view.getChild(\"key\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n+                let label = this._view.getChildAt(i).asButton;\r\n                 this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n                 indexTemp++;\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1624508457440,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -113,10 +113,10 @@\n \r\n         let keyGroup = this._view.getChild(\"key\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let label = this._view.getChildAt(i).asButton;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = keyBtn;\r\n                 indexTemp++;\r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1624508490673,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,351 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = keyBtn;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624508504394,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -115,363 +115,13 @@\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == keyGroup) {\r\n                 let keyBtn = this._view.getChildAt(i).asButton;\r\n                 this._textMap[this._kuangNameArr[indexTemp]] = keyBtn;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n                 indexTemp++;\r\n             }\r\n         }\r\n \r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = keyBtn;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n"
                },
                {
                    "date": 1624508521821,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -114,11 +114,9 @@\n         let keyGroup = this._view.getChild(\"key\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == keyGroup) {\r\n                 let keyBtn = this._view.getChildAt(i).asButton;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = keyBtn;\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-                indexTemp++;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n \r\n         // 初始化state\r\n"
                },
                {
                    "date": 1624508548972,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -167,8 +167,16 @@\n         state.selectKuangName = btn.name;\r\n         this.updateState(state);\r\n     }\r\n \r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n     private _clickSubmit(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.submit = this.submitType.GuideShow;\r\n         state.submit = this.submitType.WrongFeed;\r\n"
                },
                {
                    "date": 1624508555997,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -159,9 +159,9 @@\n             }\r\n         }\r\n     }\r\n \r\n-    private _clickKuang(evt: any) {\r\n+    private _clickKey(evt: any) {\r\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.selectKuangName = btn.name;\r\n"
                },
                {
                    "date": 1624508621003,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -114,9 +114,9 @@\n         let keyGroup = this._view.getChild(\"key\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == keyGroup) {\r\n                 let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n             }\r\n         }\r\n \r\n         // 初始化state\r\n"
                },
                {
                    "date": 1624508649973,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -123,8 +123,9 @@\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n             selectKuangName: '',\r\n+            keyNumber: '',\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n"
                },
                {
                    "date": 1624508664341,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,359 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624508674520,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,359 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.keyNumber = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624508680843,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -163,8 +163,9 @@\n \r\n     private _clickKey(evt: any) {\r\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.keyNumber = btn.name;\r\n         this.updateState(state);\r\n     }\r\n@@ -356,722 +357,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624508973297,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -163,9 +163,9 @@\n \r\n     private _clickKey(evt: any) {\r\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-\r\n+        let subName = btn.name.substring('input'.length);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.keyNumber = btn.name;\r\n         this.updateState(state);\r\n     }\r\n"
                },
                {
                    "date": 1624508984485,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -164,8 +164,9 @@\n     private _clickKey(evt: any) {\r\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let subName = btn.name.substring('input'.length);\r\n+        console.log('==== ==');\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.keyNumber = btn.name;\r\n         this.updateState(state);\r\n     }\r\n"
                },
                {
                    "date": 1624508990476,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -164,9 +164,9 @@\n     private _clickKey(evt: any) {\r\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let subName = btn.name.substring('input'.length);\r\n-        console.log('==== ==');\r\n+        console.log('==== subName ==' + );\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.keyNumber = btn.name;\r\n         this.updateState(state);\r\n     }\r\n"
                },
                {
                    "date": 1624508997698,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -164,9 +164,9 @@\n     private _clickKey(evt: any) {\r\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let subName = btn.name.substring('input'.length);\r\n-        console.log('==== subName ==' + );\r\n+        console.log('==== subName ==' + subName);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.keyNumber = btn.name;\r\n         this.updateState(state);\r\n     }\r\n"
                },
                {
                    "date": 1624509027001,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,361 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let subName = btn.name.substring('input'.length);\r\n+        console.log('==== subName ==' + subName);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.keyNumber = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624509032519,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -358,365 +358,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let subName = btn.name.substring('input'.length);\r\n-        console.log('==== subName ==' + subName);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624509046301,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -166,9 +166,9 @@\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let subName = btn.name.substring('input'.length);\r\n         console.log('==== subName ==' + subName);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber = btn.name;\r\n+        state.keyNumber = subName;\r\n         this.updateState(state);\r\n     }\r\n \r\n     private _clickKuang(evt: any) {\r\n"
                },
                {
                    "date": 1624509079777,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -166,9 +166,9 @@\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let subName = btn.name.substring('input'.length);\r\n         console.log('==== subName ==' + subName);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber = subName;\r\n+        state.keyNumber += subName;\r\n         this.updateState(state);\r\n     }\r\n \r\n     private _clickKuang(evt: any) {\r\n"
                },
                {
                    "date": 1624509132742,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,361 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let subName = btn.name.substring('input'.length);\r\n+        console.log('==== subName ==' + subName);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.keyNumber += subName;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624509139192,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -358,365 +358,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let subName = btn.name.substring('input'.length);\r\n-        console.log('==== subName ==' + subName);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber += subName;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624509277020,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -166,9 +166,9 @@\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let subName = btn.name.substring('input'.length);\r\n         console.log('==== subName ==' + subName);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber += subName;\r\n+        state.keyNumber = subName;\r\n         this.updateState(state);\r\n     }\r\n \r\n     private _clickKuang(evt: any) {\r\n"
                },
                {
                    "date": 1624509824498,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -235,9 +235,23 @@\n \r\n                 this._selectMap[oldState.selectKuangName].visible = false;\r\n             }\r\n         }\r\n+        keyNumber\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n \r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n         if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n             this.playTitle(state.title);\r\n         }\r\n     }\r\n"
                },
                {
                    "date": 1624509830240,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -222,9 +222,9 @@\n             } else if (state.submit === this.submitType.GuideShow) {\r\n \r\n             }\r\n         }\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n \r\n \r\n             if (state.selectKuangName != '') {\r\n \r\n@@ -235,9 +235,9 @@\n \r\n                 this._selectMap[oldState.selectKuangName].visible = false;\r\n             }\r\n         }\r\n-        keyNumber\r\n+\r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n \r\n \r\n             if (state.selectKuangName != '') {\r\n"
                },
                {
                    "date": 1624509835579,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,375 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let subName = btn.name.substring('input'.length);\r\n+        console.log('==== subName ==' + subName);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.keyNumber = subName;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n+\r\n+\r\n+            if (state.keyNumber != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624509840695,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -229,13 +229,8 @@\n             if (state.keyNumber != '') {\r\n \r\n                 this._selectMap[state.selectKuangName].visible = true;\r\n             }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n \r\n@@ -372,379 +367,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let subName = btn.name.substring('input'.length);\r\n-        console.log('==== subName ==' + subName);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber = subName;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624509878372,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -227,8 +227,11 @@\n \r\n \r\n             if (state.keyNumber != '') {\r\n \r\n+                if (oldState.selectKuangName) {\r\n+\r\n+                }\r\n                 this._selectMap[state.selectKuangName].visible = true;\r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1624509887871,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -227,9 +227,9 @@\n \r\n \r\n             if (state.keyNumber != '') {\r\n \r\n-                if (oldState.selectKuangName) {\r\n+                if (oldState.selectKuangName != state.selectKuangName) {\r\n \r\n                 }\r\n                 this._selectMap[state.selectKuangName].visible = true;\r\n             }\r\n"
                },
                {
                    "date": 1624509892987,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -229,8 +229,10 @@\n             if (state.keyNumber != '') {\r\n \r\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n \r\n+                } else {\r\n+\r\n                 }\r\n                 this._selectMap[state.selectKuangName].visible = true;\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1624509915599,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -229,8 +229,9 @@\n             if (state.keyNumber != '') {\r\n \r\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n \r\n+                    this._textMap[] = \r\n                 } else {\r\n \r\n                 }\r\n                 this._selectMap[state.selectKuangName].visible = true;\r\n"
                },
                {
                    "date": 1624509921056,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,376 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let subName = btn.name.substring('input'.length);\r\n+        console.log('==== subName ==' + subName);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.keyNumber = subName;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n+\r\n+\r\n+            if (state.keyNumber != '') {\r\n+\r\n+                if (oldState.selectKuangName != state.selectKuangName) {\r\n+\r\n+                    this._textMap[state.selectKuangName] = \r\n+                } else {\r\n+\r\n+                }\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624510052223,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -373,380 +373,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let subName = btn.name.substring('input'.length);\r\n-        console.log('==== subName ==' + subName);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber = subName;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n-\r\n-\r\n-            if (state.keyNumber != '') {\r\n-\r\n-                if (oldState.selectKuangName != state.selectKuangName) {\r\n-\r\n-                    this._textMap[] = \r\n-                } else {\r\n-\r\n-                }\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624510063509,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -231,11 +231,11 @@\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n \r\n                     this._textMap[state.selectKuangName] = \r\n                 } else {\r\n+                    this._textMap[state.selectKuangName] = \r\n+                }\r\n \r\n-                }\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n"
                },
                {
                    "date": 1624510087569,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -231,9 +231,9 @@\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n \r\n                     this._textMap[state.selectKuangName] = \r\n                 } else {\r\n-                    this._textMap[state.selectKuangName] = \r\n+                    this._textMap[state.selectKuangName].text = \r\n                 }\r\n \r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1624510125968,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -229,11 +229,11 @@\n             if (state.keyNumber != '') {\r\n \r\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n \r\n-                    this._textMap[state.selectKuangName] = \r\n+                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n                 } else {\r\n-                    this._textMap[state.selectKuangName].text = \r\n+                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n                 }\r\n \r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1624510264051,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,376 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let subName = btn.name.substring('input'.length);\r\n+        console.log('==== subName ==' + subName);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.keyNumber = subName;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n+\r\n+\r\n+            if (state.keyNumber != '') {\r\n+\r\n+                if (oldState.selectKuangName != state.selectKuangName) {\r\n+\r\n+                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n+                } else {\r\n+                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n+                }\r\n+\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624510318978,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,376 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let subName = btn.name.substring('input'.length);\r\n+        console.log('==== subName ==' + subName);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.keyNumber = subName;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n+\r\n+\r\n+            if (state.keyNumber != '') {\r\n+\r\n+                if (oldState.selectKuangName != state.selectKuangName) {\r\n+\r\n+                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n+                } else {\r\n+                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n+                }\r\n+\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624510421561,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -175,8 +175,9 @@\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.selectKuangName = btn.name;\r\n+        console.log('== ====');\r\n         this.updateState(state);\r\n     }\r\n \r\n     private _clickSubmit(evt: any) {\r\n@@ -373,756 +374,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let subName = btn.name.substring('input'.length);\r\n-        console.log('==== subName ==' + subName);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber = subName;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n-\r\n-\r\n-            if (state.keyNumber != '') {\r\n-\r\n-                if (oldState.selectKuangName != state.selectKuangName) {\r\n-\r\n-                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n-                } else {\r\n-                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n-                }\r\n-\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let subName = btn.name.substring('input'.length);\r\n-        console.log('==== subName ==' + subName);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber = subName;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n-\r\n-\r\n-            if (state.keyNumber != '') {\r\n-\r\n-                if (oldState.selectKuangName != state.selectKuangName) {\r\n-\r\n-                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n-                } else {\r\n-                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n-                }\r\n-\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624510428426,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -175,9 +175,8 @@\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.selectKuangName = btn.name;\r\n-        console.log('== ====');\r\n         this.updateState(state);\r\n     }\r\n \r\n     private _clickSubmit(evt: any) {\r\n"
                },
                {
                    "date": 1624510458665,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -118,8 +118,10 @@\n                 keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n             }\r\n         }\r\n \r\n+        this._textMap[state.selectKuangName].text += state.keyNumber;\r\n+\r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n@@ -233,9 +235,8 @@\n                     this._textMap[state.selectKuangName] = state.keyNumber;\r\n                 } else {\r\n                     this._textMap[state.selectKuangName].text += state.keyNumber;\r\n                 }\r\n-\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n"
                },
                {
                    "date": 1624510472437,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -118,9 +118,9 @@\n                 keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n             }\r\n         }\r\n \r\n-        this._textMap[state.selectKuangName].text += state.keyNumber;\r\n+        this._textMap['kuang2'].text = '';\r\n \r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n"
                },
                {
                    "date": 1624510479222,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -118,9 +118,9 @@\n                 keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n             }\r\n         }\r\n \r\n-        this._textMap['kuang2'].text = '';\r\n+        this._textMap['kuang2'].text = 'pppp';\r\n \r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n"
                },
                {
                    "date": 1624510934533,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -118,10 +118,8 @@\n                 keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n             }\r\n         }\r\n \r\n-        this._textMap['kuang2'].text = 'pppp';\r\n-\r\n         // 初始化state\r\n         this._state = {\r\n             title: false,\r\n             submit: this.submitType.No,\r\n"
                },
                {
                    "date": 1624511220799,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -224,8 +224,9 @@\n             }\r\n         }\r\n         if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n \r\n+            console.log('==== ====');\r\n \r\n             if (state.keyNumber != '') {\r\n \r\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n"
                },
                {
                    "date": 1624511225948,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -224,9 +224,9 @@\n             }\r\n         }\r\n         if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n \r\n-            console.log('==== ====');\r\n+            console.log('==== ====' + );\r\n \r\n             if (state.keyNumber != '') {\r\n \r\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n"
                },
                {
                    "date": 1624511305475,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -224,9 +224,10 @@\n             }\r\n         }\r\n         if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n \r\n-            console.log('==== ====' + );\r\n+            console.log('==== oldState.selectKuangName ====' + oldState.selectKuangName);\r\n+            console.log('==== oldState.selectKuangName ====' + oldState.selectKuangName);\r\n \r\n             if (state.keyNumber != '') {\r\n \r\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n"
                },
                {
                    "date": 1624511312989,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -225,9 +225,9 @@\n         }\r\n         if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n \r\n             console.log('==== oldState.selectKuangName ====' + oldState.selectKuangName);\r\n-            console.log('==== oldState.selectKuangName ====' + oldState.selectKuangName);\r\n+            console.log('==== state.selectKuangName ====' + state.selectKuangName);\r\n \r\n             if (state.keyNumber != '') {\r\n \r\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n"
                },
                {
                    "date": 1624511501963,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -235,8 +235,12 @@\n                     this._textMap[state.selectKuangName] = state.keyNumber;\r\n                 } else {\r\n                     this._textMap[state.selectKuangName].text += state.keyNumber;\r\n                 }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                }, 0.01);\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n"
                },
                {
                    "date": 1624511507066,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -238,9 +238,10 @@\n                 }\r\n \r\n                 setTimeout(() => {\r\n \r\n-                }, 0.01);\r\n+\r\n+                }, 0.02);\r\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n"
                },
                {
                    "date": 1624511519108,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -238,8 +238,11 @@\n                 }\r\n \r\n                 setTimeout(() => {\r\n \r\n+                    let state: any = globalThis._.cloneDeep(this._state);\r\n+                    state.title = false;\r\n+                    this.updateState(state);\r\n \r\n                 }, 0.02);\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1624511526468,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -238,11 +238,11 @@\n                 }\r\n \r\n                 setTimeout(() => {\r\n \r\n-                    let state: any = globalThis._.cloneDeep(this._state);\r\n-                    state.title = false;\r\n-                    this.updateState(state);\r\n+                    let state2: any = globalThis._.cloneDeep(this._state);\r\n+                    state2.title = false;\r\n+                    this.updateState(state2);\r\n \r\n                 }, 0.02);\r\n             }\r\n         }\r\n"
                },
                {
                    "date": 1624511532986,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,385 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let subName = btn.name.substring('input'.length);\r\n+        console.log('==== subName ==' + subName);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.keyNumber = subName;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n+\r\n+            console.log('==== oldState.selectKuangName ====' + oldState.selectKuangName);\r\n+            console.log('==== state.selectKuangName ====' + state.selectKuangName);\r\n+\r\n+            if (state.keyNumber != '') {\r\n+\r\n+                if (oldState.selectKuangName != state.selectKuangName) {\r\n+\r\n+                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n+                } else {\r\n+                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state2: any = globalThis._.cloneDeep(this._state);\r\n+                    state2.keyNumber = '';\r\n+                    this.updateState(state2);\r\n+\r\n+                }, 0.02);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624511540933,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -382,389 +382,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let subName = btn.name.substring('input'.length);\r\n-        console.log('==== subName ==' + subName);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber = subName;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n-\r\n-            console.log('==== oldState.selectKuangName ====' + oldState.selectKuangName);\r\n-            console.log('==== state.selectKuangName ====' + state.selectKuangName);\r\n-\r\n-            if (state.keyNumber != '') {\r\n-\r\n-                if (oldState.selectKuangName != state.selectKuangName) {\r\n-\r\n-                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n-                } else {\r\n-                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n-                }\r\n-\r\n-                setTimeout(() => {\r\n-\r\n-                    let state2: any = globalThis._.cloneDeep(this._state);\r\n-                    state2.title = false;\r\n-                    this.updateState(state2);\r\n-\r\n-                }, 0.02);\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624511613035,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,385 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let subName = btn.name.substring('input'.length);\r\n+        console.log('==== subName ==' + subName);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.keyNumber = subName;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n+\r\n+            console.log('==== oldState.selectKuangName ====' + oldState.selectKuangName);\r\n+            console.log('==== state.selectKuangName ====' + state.selectKuangName);\r\n+\r\n+            if (state.keyNumber != '') {\r\n+\r\n+                if (oldState.selectKuangName != state.selectKuangName) {\r\n+\r\n+                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n+                } else {\r\n+                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state2: any = globalThis._.cloneDeep(this._state);\r\n+                    state2.keyNumber = '';\r\n+                    this.updateState(state2);\r\n+\r\n+                }, 0.02);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624511626941,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -174,393 +174,11 @@\n     private _clickKuang(evt: any) {\r\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n+        if () {\r\n \r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n         }\r\n-        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n-\r\n-            console.log('==== oldState.selectKuangName ====' + oldState.selectKuangName);\r\n-            console.log('==== state.selectKuangName ====' + state.selectKuangName);\r\n-\r\n-            if (state.keyNumber != '') {\r\n-\r\n-                if (oldState.selectKuangName != state.selectKuangName) {\r\n-\r\n-                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n-                } else {\r\n-                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n-                }\r\n-\r\n-                setTimeout(() => {\r\n-\r\n-                    let state2: any = globalThis._.cloneDeep(this._state);\r\n-                    state2.keyNumber = '';\r\n-                    this.updateState(state2);\r\n-\r\n-                }, 0.02);\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let subName = btn.name.substring('input'.length);\r\n-        console.log('==== subName ==' + subName);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber = subName;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n         state.selectKuangName = btn.name;\r\n         this.updateState(state);\r\n     }\r\n \r\n"
                },
                {
                    "date": 1624511633198,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -174,9 +174,9 @@\n     private _clickKuang(evt: any) {\r\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n-        if () {\r\n+        if (state.selectKuangName === ) {\r\n \r\n         }\r\n         state.selectKuangName = btn.name;\r\n         this.updateState(state);\r\n"
                },
                {
                    "date": 1624511638413,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -174,9 +174,9 @@\n     private _clickKuang(evt: any) {\r\n \r\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n-        if (state.selectKuangName === ) {\r\n+        if (state.selectKuangName === btn.name) {\r\n \r\n         }\r\n         state.selectKuangName = btn.name;\r\n         this.updateState(state);\r\n"
                },
                {
                    "date": 1624511650354,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,388 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let subName = btn.name.substring('input'.length);\r\n+        console.log('==== subName ==' + subName);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.keyNumber = subName;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        if (state.selectKuangName === btn.name) {\r\n+            state.selectKuangName = '';\r\n+        }\r\n+        state.selectKuangName = btn.name;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n+\r\n+            console.log('==== oldState.selectKuangName ====' + oldState.selectKuangName);\r\n+            console.log('==== state.selectKuangName ====' + state.selectKuangName);\r\n+\r\n+            if (state.keyNumber != '') {\r\n+\r\n+                if (oldState.selectKuangName != state.selectKuangName) {\r\n+\r\n+                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n+                } else {\r\n+                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state2: any = globalThis._.cloneDeep(this._state);\r\n+                    state2.keyNumber = '';\r\n+                    this.updateState(state2);\r\n+\r\n+                }, 0.02);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624511658533,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -176,401 +176,15 @@\n         var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         if (state.selectKuangName === btn.name) {\r\n             state.selectKuangName = '';\r\n-        }\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n-\r\n-            console.log('==== oldState.selectKuangName ====' + oldState.selectKuangName);\r\n-            console.log('==== state.selectKuangName ====' + state.selectKuangName);\r\n-\r\n-            if (state.keyNumber != '') {\r\n-\r\n-                if (oldState.selectKuangName != state.selectKuangName) {\r\n-\r\n-                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n-                } else {\r\n-                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n-                }\r\n-\r\n-                setTimeout(() => {\r\n-\r\n-                    let state2: any = globalThis._.cloneDeep(this._state);\r\n-                    state2.keyNumber = '';\r\n-                    this.updateState(state2);\r\n-\r\n-                }, 0.02);\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n         } else {\r\n-            this.disableForbidHandle();\r\n+            state.selectKuangName = btn.name;\r\n         }\r\n-    }\r\n \r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let subName = btn.name.substring('input'.length);\r\n-        console.log('==== subName ==' + subName);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber = subName;\r\n         this.updateState(state);\r\n     }\r\n \r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        if (state.selectKuangName === btn.name) {\r\n-\r\n-        }\r\n-        state.selectKuangName = btn.name;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n     private _clickSubmit(evt: any) {\r\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         state.submit = this.submitType.GuideShow;\r\n         state.submit = this.submitType.WrongFeed;\r\n"
                },
                {
                    "date": 1624511664174,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -177,8 +177,9 @@\n         let state: any = globalThis._.cloneDeep(this._state);\r\n         if (state.selectKuangName === btn.name) {\r\n             state.selectKuangName = '';\r\n         } else {\r\n+\r\n             state.selectKuangName = btn.name;\r\n         }\r\n \r\n         this.updateState(state);\r\n"
                },
                {
                    "date": 1624511695201,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,391 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let subName = btn.name.substring('input'.length);\r\n+        console.log('==== subName ==' + subName);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.keyNumber = subName;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        if (state.selectKuangName === btn.name) {\r\n+            state.selectKuangName = '';\r\n+        } else {\r\n+\r\n+            state.selectKuangName = btn.name;\r\n+        }\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n+\r\n+            console.log('==== oldState.selectKuangName ====' + oldState.selectKuangName);\r\n+            console.log('==== state.selectKuangName ====' + state.selectKuangName);\r\n+\r\n+            if (state.keyNumber != '') {\r\n+\r\n+                if (oldState.selectKuangName != state.selectKuangName) {\r\n+\r\n+                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n+                } else {\r\n+                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state2: any = globalThis._.cloneDeep(this._state);\r\n+                    state2.keyNumber = '';\r\n+                    this.updateState(state2);\r\n+\r\n+                }, 0.02);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624511713473,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -388,395 +388,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let subName = btn.name.substring('input'.length);\r\n-        console.log('==== subName ==' + subName);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber = subName;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        if (state.selectKuangName === btn.name) {\r\n-            state.selectKuangName = '';\r\n-        } else {\r\n-\r\n-            state.selectKuangName = btn.name;\r\n-        }\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n-\r\n-            console.log('==== oldState.selectKuangName ====' + oldState.selectKuangName);\r\n-            console.log('==== state.selectKuangName ====' + state.selectKuangName);\r\n-\r\n-            if (state.keyNumber != '') {\r\n-\r\n-                if (oldState.selectKuangName != state.selectKuangName) {\r\n-\r\n-                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n-                } else {\r\n-                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n-                }\r\n-\r\n-                setTimeout(() => {\r\n-\r\n-                    let state2: any = globalThis._.cloneDeep(this._state);\r\n-                    state2.keyNumber = '';\r\n-                    this.updateState(state2);\r\n-\r\n-                }, 0.02);\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624514970707,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -230,11 +230,8 @@\n             }\r\n         }\r\n         if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n \r\n-            console.log('==== oldState.selectKuangName ====' + oldState.selectKuangName);\r\n-            console.log('==== state.selectKuangName ====' + state.selectKuangName);\r\n-\r\n             if (state.keyNumber != '') {\r\n \r\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n \r\n"
                },
                {
                    "date": 1624515054461,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -124,8 +124,9 @@\n             title: false,\r\n             submit: this.submitType.No,\r\n             selectKuangName: '',\r\n             keyNumber: '',\r\n+            textMap:\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n"
                },
                {
                    "date": 1624515061536,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -124,9 +124,9 @@\n             title: false,\r\n             submit: this.submitType.No,\r\n             selectKuangName: '',\r\n             keyNumber: '',\r\n-            textMap:\r\n+            textMap: {}\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n"
                },
                {
                    "date": 1624515177896,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,8 +79,9 @@\n \r\n         this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n         if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n \r\n+        let tempAnswerMap = {};\r\n         let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n         for (let i = 0; i < this._view.numChildren; i++) {\r\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let btn = this._view.getChildAt(i).asButton;\r\n"
                },
                {
                    "date": 1624515205790,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -86,8 +86,9 @@\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let btn = this._view.getChildAt(i).asButton;\r\n                 console.log('=== name ===' + btn.name);\r\n                 this._kuangNameArr.push(btn.name);\r\n+                tempAnswerMap[] = 0;\r\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1624515212842,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -86,9 +86,9 @@\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let btn = this._view.getChildAt(i).asButton;\r\n                 console.log('=== name ===' + btn.name);\r\n                 this._kuangNameArr.push(btn.name);\r\n-                tempAnswerMap[] = 0;\r\n+                tempAnswerMap[btn.name] = 0;\r\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n \r\n"
                },
                {
                    "date": 1624515259463,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -126,9 +126,9 @@\n             title: false,\r\n             submit: this.submitType.No,\r\n             selectKuangName: '',\r\n             keyNumber: '',\r\n-            textMap: {}\r\n+            textMap: tempAnswerMap;\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n"
                },
                {
                    "date": 1624515271639,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -86,9 +86,9 @@\n             if (this._view.getChildAt(i).group == kuangGroup) {\r\n                 let btn = this._view.getChildAt(i).asButton;\r\n                 console.log('=== name ===' + btn.name);\r\n                 this._kuangNameArr.push(btn.name);\r\n-                tempAnswerMap[btn.name] = 0;\r\n+                tempAnswerMap[btn.name] = '';\r\n                 btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n             }\r\n         }\r\n \r\n@@ -126,9 +126,9 @@\n             title: false,\r\n             submit: this.submitType.No,\r\n             selectKuangName: '',\r\n             keyNumber: '',\r\n-            textMap: tempAnswerMap;\r\n+            textMap: tempAnswerMap,\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n"
                },
                {
                    "date": 1624515307698,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -252,8 +252,10 @@\n                 }, 0.02);\r\n             }\r\n         }\r\n \r\n+        tempAnswerMap\r\n+\r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n \r\n \r\n             if (state.selectKuangName != '') {\r\n"
                },
                {
                    "date": 1624515352046,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -252,8 +252,11 @@\n                 }, 0.02);\r\n             }\r\n         }\r\n \r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n         tempAnswerMap\r\n \r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n \r\n"
                },
                {
                    "date": 1624515357357,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -252,13 +252,13 @@\n                 }, 0.02);\r\n             }\r\n         }\r\n \r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+        if (!globalThis._.isEqual(oldState.tempAnswerMap, state.tempAnswerMap)) {\r\n             this.playTitle(state.title);\r\n         }\r\n-        tempAnswerMap\r\n \r\n+\r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n \r\n \r\n             if (state.selectKuangName != '') {\r\n"
                },
                {
                    "date": 1624515362521,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -253,9 +253,10 @@\n             }\r\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.tempAnswerMap, state.tempAnswerMap)) {\r\n-            this.playTitle(state.title);\r\n+\r\n+\r\n         }\r\n \r\n \r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n"
                },
                {
                    "date": 1624515369312,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -255,8 +255,9 @@\n \r\n         if (!globalThis._.isEqual(oldState.tempAnswerMap, state.tempAnswerMap)) {\r\n \r\n \r\n+\r\n         }\r\n \r\n \r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n"
                },
                {
                    "date": 1624515432325,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -126,9 +126,9 @@\n             title: false,\r\n             submit: this.submitType.No,\r\n             selectKuangName: '',\r\n             keyNumber: '',\r\n-            textMap: tempAnswerMap,\r\n+            answerMap: tempAnswerMap,\r\n         }\r\n     }\r\n \r\n     async init(data: any) {\r\n@@ -252,9 +252,9 @@\n                 }, 0.02);\r\n             }\r\n         }\r\n \r\n-        if (!globalThis._.isEqual(oldState.tempAnswerMap, state.tempAnswerMap)) {\r\n+        if (!globalThis._.isEqual(oldState.answerMap, state.answerMap)) {\r\n \r\n \r\n \r\n         }\r\n"
                },
                {
                    "date": 1624515439329,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -255,9 +255,8 @@\n \r\n         if (!globalThis._.isEqual(oldState.answerMap, state.answerMap)) {\r\n \r\n \r\n-\r\n         }\r\n \r\n \r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n"
                },
                {
                    "date": 1624515448847,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -255,8 +255,9 @@\n \r\n         if (!globalThis._.isEqual(oldState.answerMap, state.answerMap)) {\r\n \r\n \r\n+\r\n         }\r\n \r\n \r\n         if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n"
                },
                {
                    "date": 1624515553441,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -237,11 +237,11 @@\n             if (state.keyNumber != '') {\r\n \r\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n \r\n-                    this._textMap[state.selectKuangName] = state.keyNumber;\r\n+                    state.answerMap[state.selectKuangName] = state.keyNumber;\r\n                 } else {\r\n-                    this._textMap[state.selectKuangName].text += state.keyNumber;\r\n+                    state.answerMap[state.selectKuangName] += state.keyNumber;\r\n                 }\r\n \r\n                 setTimeout(() => {\r\n \r\n"
                },
                {
                    "date": 1624515576067,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -246,8 +246,9 @@\n                 setTimeout(() => {\r\n \r\n                     let state2: any = globalThis._.cloneDeep(this._state);\r\n                     state2.keyNumber = '';\r\n+                    state2.answerMap = state.answerMap;\r\n                     this.updateState(state2);\r\n \r\n                 }, 0.02);\r\n             }\r\n"
                },
                {
                    "date": 1624515615413,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -255,9 +255,11 @@\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.answerMap, state.answerMap)) {\r\n \r\n+            for (let key int state.answerMap) {\r\n \r\n+            }\r\n \r\n         }\r\n \r\n \r\n"
                },
                {
                    "date": 1624515632945,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -255,10 +255,11 @@\n         }\r\n \r\n         if (!globalThis._.isEqual(oldState.answerMap, state.answerMap)) {\r\n \r\n-            for (let key int state.answerMap) {\r\n+            for (let key in state.answerMap) {\r\n \r\n+                this._textMap[] = \r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1624515666103,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -257,9 +257,9 @@\n         if (!globalThis._.isEqual(oldState.answerMap, state.answerMap)) {\r\n \r\n             for (let key in state.answerMap) {\r\n \r\n-                this._textMap[] = \r\n+                this._textMap[state.answerMap[key]] =  \r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1624515675794,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -257,9 +257,9 @@\n         if (!globalThis._.isEqual(oldState.answerMap, state.answerMap)) {\r\n \r\n             for (let key in state.answerMap) {\r\n \r\n-                this._textMap[state.answerMap[key]] =  \r\n+                this._textMap[state.answerMap[key]].text =  \r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1624515688140,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -257,9 +257,9 @@\n         if (!globalThis._.isEqual(oldState.answerMap, state.answerMap)) {\r\n \r\n             for (let key in state.answerMap) {\r\n \r\n-                this._textMap[state.answerMap[key]].text =  \r\n+                this._textMap[].text = state.answerMap[key];\r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1624515699903,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -257,9 +257,9 @@\n         if (!globalThis._.isEqual(oldState.answerMap, state.answerMap)) {\r\n \r\n             for (let key in state.answerMap) {\r\n \r\n-                this._textMap[].text = state.answerMap[key];\r\n+                this._textMap[key].text = state.answerMap[key];\r\n             }\r\n \r\n         }\r\n \r\n"
                },
                {
                    "date": 1624515715045,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -237,8 +237,11 @@\n             if (state.keyNumber != '') {\r\n \r\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n \r\n+                    if () {\r\n+\r\n+                    }\r\n                     state.answerMap[state.selectKuangName] = state.keyNumber;\r\n                 } else {\r\n                     state.answerMap[state.selectKuangName] += state.keyNumber;\r\n                 }\r\n"
                },
                {
                    "date": 1624515723184,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -237,9 +237,9 @@\n             if (state.keyNumber != '') {\r\n \r\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n \r\n-                    if () {\r\n+                    if (state.keyNumber = ) {\r\n \r\n                     }\r\n                     state.answerMap[state.selectKuangName] = state.keyNumber;\r\n                 } else {\r\n"
                },
                {
                    "date": 1624515733643,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -237,9 +237,9 @@\n             if (state.keyNumber != '') {\r\n \r\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n \r\n-                    if (state.keyNumber = ) {\r\n+                    if (state.keyNumber === 'x') {\r\n \r\n                     }\r\n                     state.answerMap[state.selectKuangName] = state.keyNumber;\r\n                 } else {\r\n"
                },
                {
                    "date": 1624515924503,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -239,10 +239,12 @@\n                 if (oldState.selectKuangName != state.selectKuangName) {\r\n \r\n                     if (state.keyNumber === 'x') {\r\n \r\n+                    } else {\r\n+                        state.answerMap[state.selectKuangName] = state.keyNumber;\r\n                     }\r\n-                    state.answerMap[state.selectKuangName] = state.keyNumber;\r\n+\r\n                 } else {\r\n                     state.answerMap[state.selectKuangName] += state.keyNumber;\r\n                 }\r\n \r\n"
                },
                {
                    "date": 1624515934910,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -244,8 +244,13 @@\n                         state.answerMap[state.selectKuangName] = state.keyNumber;\r\n                     }\r\n \r\n                 } else {\r\n+                    if (state.keyNumber === 'x') {\r\n+\r\n+                    } else {\r\n+\r\n+                    }\r\n                     state.answerMap[state.selectKuangName] += state.keyNumber;\r\n                 }\r\n \r\n                 setTimeout(() => {\r\n"
                },
                {
                    "date": 1624515940941,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -244,14 +244,15 @@\n                         state.answerMap[state.selectKuangName] = state.keyNumber;\r\n                     }\r\n \r\n                 } else {\r\n+\r\n                     if (state.keyNumber === 'x') {\r\n \r\n                     } else {\r\n+                        state.answerMap[state.selectKuangName] += state.keyNumber;\r\n+                    }\r\n \r\n-                    }\r\n-                    state.answerMap[state.selectKuangName] += state.keyNumber;\r\n                 }\r\n \r\n                 setTimeout(() => {\r\n \r\n"
                },
                {
                    "date": 1624515947224,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,414 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let tempAnswerMap = {};\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                tempAnswerMap[btn.name] = '';\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+            answerMap: tempAnswerMap,\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let subName = btn.name.substring('input'.length);\r\n+        console.log('==== subName ==' + subName);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.keyNumber = subName;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        if (state.selectKuangName === btn.name) {\r\n+            state.selectKuangName = '';\r\n+        } else {\r\n+\r\n+            state.selectKuangName = btn.name;\r\n+        }\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n+\r\n+            if (state.keyNumber != '') {\r\n+\r\n+                if (oldState.selectKuangName != state.selectKuangName) {\r\n+\r\n+                    if (state.keyNumber === 'x') {\r\n+\r\n+                    } else {\r\n+                        state.answerMap[state.selectKuangName] = state.keyNumber;\r\n+                    }\r\n+\r\n+                } else {\r\n+\r\n+                    if (state.keyNumber === 'x') {\r\n+\r\n+                    } else {\r\n+\r\n+                        state.answerMap[state.selectKuangName] += state.keyNumber;\r\n+                    }\r\n+\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state2: any = globalThis._.cloneDeep(this._state);\r\n+                    state2.keyNumber = '';\r\n+                    state2.answerMap = state.answerMap;\r\n+                    this.updateState(state2);\r\n+\r\n+                }, 0.02);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.answerMap, state.answerMap)) {\r\n+\r\n+            for (let key in state.answerMap) {\r\n+\r\n+                this._textMap[key].text = state.answerMap[key];\r\n+            }\r\n+\r\n+        }\r\n+\r\n+\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624515953236,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -411,417 +411,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let tempAnswerMap = {};\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                tempAnswerMap[btn.name] = '';\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-            answerMap: tempAnswerMap,\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let subName = btn.name.substring('input'.length);\r\n-        console.log('==== subName ==' + subName);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber = subName;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        if (state.selectKuangName === btn.name) {\r\n-            state.selectKuangName = '';\r\n-        } else {\r\n-\r\n-            state.selectKuangName = btn.name;\r\n-        }\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n-\r\n-            if (state.keyNumber != '') {\r\n-\r\n-                if (oldState.selectKuangName != state.selectKuangName) {\r\n-\r\n-                    if (state.keyNumber === 'x') {\r\n-\r\n-                    } else {\r\n-                        state.answerMap[state.selectKuangName] = state.keyNumber;\r\n-                    }\r\n-\r\n-                } else {\r\n-\r\n-                    if (state.keyNumber === 'x') {\r\n-\r\n-                    } else {\r\n-                        state.answerMap[state.selectKuangName] += state.keyNumber;\r\n-                    }\r\n-\r\n-                }\r\n-\r\n-                setTimeout(() => {\r\n-\r\n-                    let state2: any = globalThis._.cloneDeep(this._state);\r\n-                    state2.keyNumber = '';\r\n-                    state2.answerMap = state.answerMap;\r\n-                    this.updateState(state2);\r\n-\r\n-                }, 0.02);\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.answerMap, state.answerMap)) {\r\n-\r\n-            for (let key in state.answerMap) {\r\n-\r\n-                this._textMap[key].text = state.answerMap[key];\r\n-            }\r\n-\r\n-        }\r\n-\r\n-\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                },
                {
                    "date": 1624516679279,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,414 @@\n+\r\n+/*\r\n+ * @Descripttion: \r\n+ * @version: \r\n+ * @Author: ruzhuan\r\n+ * @Date: 2021-06-08 18:00:00\r\n+ * @LastEditors: ruzhuan\r\n+ * @LastEditTime: 2021-06-08 18:00:00\r\n+ */\r\n+const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n+const { ccclass, property } = cc._decorator;\r\n+\r\n+@ccclass\r\n+export default class t4_05_model_v1 extends cc.Component {\r\n+    private _worldRoot: cc.Node;\r\n+\r\n+    private _view: fgui.GComponent;\r\n+\r\n+    private _c1: fgui.Controller;\r\n+\r\n+    private _title: fgui.GButton;\r\n+\r\n+    private _titleTrigger: fgui.GLoader;\r\n+\r\n+    private _submitBtn: fgui.GButton;\r\n+\r\n+    private _package: any;\r\n+\r\n+    private _selectMap: any = {};\r\n+\r\n+    private _textMap: any = {};\r\n+\r\n+    private _kuangNameArr: any = [];\r\n+\r\n+    private submitType: any = cc.Enum({\r\n+\r\n+        No: 0,\r\n+        GuideShow: 1,\r\n+        WrongFeed: 2,\r\n+        RightFeed: 3\r\n+    });\r\n+\r\n+    // 远程动态组件\r\n+    private feedback: any;\r\n+\r\n+    private _state = {};\r\n+\r\n+    get state(): any {\r\n+        return this._state;\r\n+    }\r\n+\r\n+    set state(v: any) {\r\n+        this.updateUi(this._state, v);\r\n+        this._state = v;\r\n+        this.mergeState();\r\n+    }\r\n+\r\n+    async onLoad() {\r\n+        this._worldRoot = cc.find(\"Canvas\").parent;\r\n+\r\n+        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n+        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n+\r\n+        fgui.GRoot.inst.addChild(this._view);\r\n+\r\n+        this._c1 = this._view.getController(\"c1\");\r\n+\r\n+        // 臨時\r\n+        // bug 初始设置不播放不生效\r\n+        if (this._c1) {\r\n+            this._c1.selectedIndex = 1;\r\n+            this._c1.selectedIndex = 0;\r\n+        }\r\n+\r\n+        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n+        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n+\r\n+        this._title = this._view.getChild(\"title\").asButton;\r\n+\r\n+        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n+        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n+\r\n+        let tempAnswerMap = {};\r\n+        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == kuangGroup) {\r\n+                let btn = this._view.getChildAt(i).asButton;\r\n+                console.log('=== name ===' + btn.name);\r\n+                this._kuangNameArr.push(btn.name);\r\n+                tempAnswerMap[btn.name] = '';\r\n+                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n+            }\r\n+        }\r\n+\r\n+        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n+        let indexTemp = 0;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == selectGroup) {\r\n+                let img = this._view.getChildAt(i).asImage;\r\n+                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n+                img.visible = false;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        indexTemp = 0;\r\n+        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == textGroup) {\r\n+                let label = this._view.getChildAt(i).asLabel;\r\n+                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n+                indexTemp++;\r\n+            }\r\n+        }\r\n+\r\n+        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n+        for (let i = 0; i < this._view.numChildren; i++) {\r\n+            if (this._view.getChildAt(i).group == keyGroup) {\r\n+                let keyBtn = this._view.getChildAt(i).asButton;\r\n+                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n+            }\r\n+        }\r\n+\r\n+        // 初始化state\r\n+        this._state = {\r\n+            title: false,\r\n+            submit: this.submitType.No,\r\n+            selectKuangName: '',\r\n+            keyNumber: '',\r\n+            answerMap: tempAnswerMap,\r\n+        }\r\n+    }\r\n+\r\n+    async init(data: any) {\r\n+        // 临时 model component json 配置加载\r\n+        let { pathConfig, model, components } = data;\r\n+        let Package = pathConfig.packageName;\r\n+        let GComponent = model.uiPath;\r\n+        let { boxSoundUrl, guidIndex } = model.config;\r\n+        this._package = Package;\r\n+\r\n+        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n+\r\n+        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n+        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n+\r\n+\r\n+        // 动效注册\r\n+        // for (let v in ae) {\r\n+        //     if (ae[v]) {\r\n+        //         this[v] = {};\r\n+        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n+        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n+        //     }\r\n+        // }\r\n+\r\n+        if (components) {\r\n+            for (const key in components) {\r\n+                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n+                let componentBundle: any = await loadBundle(componentPath);\r\n+                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n+                this[key] = componentPrefab;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    private _clickKey(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let subName = btn.name.substring('input'.length);\r\n+        console.log('==== subName ==' + subName);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.keyNumber = subName;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickKuang(evt: any) {\r\n+\r\n+        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        if (state.selectKuangName === btn.name) {\r\n+            state.selectKuangName = '';\r\n+        } else {\r\n+\r\n+            state.selectKuangName = btn.name;\r\n+        }\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickSubmit(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.submit = this.submitType.GuideShow;\r\n+        state.submit = this.submitType.WrongFeed;\r\n+        state.submit = this.submitType.RightFeed;\r\n+\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+    private _clickTitle(evt: any) {\r\n+        let state: any = globalThis._.cloneDeep(this._state);\r\n+        state.title = true;\r\n+        this.updateState(state);\r\n+    }\r\n+\r\n+\r\n+    // 获取状态\r\n+    getState(data: any) {\r\n+        this.updateState(data);\r\n+    }\r\n+\r\n+    // 更新状态层\r\n+    updateState(curState: any) {\r\n+        if (globalThis._.isEqual(this._state, curState)) return;\r\n+        this.state = curState;\r\n+    }\r\n+\r\n+    // 更新ui层\r\n+    updateUi(oldState: any, state: any) {\r\n+\r\n+        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n+\r\n+            if (state.submit === this.submitType.RightFeed) {\r\n+\r\n+                this.answerFeedback(true);\r\n+\r\n+            } else if (state.submit === this.submitType.WrongFeed) {\r\n+\r\n+                this.answerFeedback(false);\r\n+\r\n+            } else if (state.submit === this.submitType.GuideShow) {\r\n+\r\n+            }\r\n+        }\r\n+        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n+\r\n+            if (state.keyNumber != '') {\r\n+\r\n+                if (oldState.selectKuangName != state.selectKuangName) {\r\n+\r\n+                    if (state.keyNumber === 'x') {\r\n+\r\n+                    } else {\r\n+                        state.answerMap[state.selectKuangName] = state.keyNumber;\r\n+                    }\r\n+\r\n+                } else {\r\n+\r\n+                    if (state.keyNumber === 'x') {\r\n+\r\n+                    } else {\r\n+\r\n+                        state.answerMap[state.selectKuangName] += state.keyNumber;\r\n+                    }\r\n+\r\n+                }\r\n+\r\n+                setTimeout(() => {\r\n+\r\n+                    let state2: any = globalThis._.cloneDeep(this._state);\r\n+                    state2.keyNumber = '';\r\n+                    state2.answerMap = state.answerMap;\r\n+                    this.updateState(state2);\r\n+\r\n+                }, 0.02);\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.answerMap, state.answerMap)) {\r\n+\r\n+            for (let key in state.answerMap) {\r\n+\r\n+                this._textMap[key].text = state.answerMap[key];\r\n+            }\r\n+\r\n+        }\r\n+\r\n+\r\n+        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n+\r\n+\r\n+            if (state.selectKuangName != '') {\r\n+\r\n+                this._selectMap[state.selectKuangName].visible = true;\r\n+            }\r\n+\r\n+            if (oldState.selectKuangName != '') {\r\n+\r\n+                this._selectMap[oldState.selectKuangName].visible = false;\r\n+            }\r\n+        }\r\n+\r\n+        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n+            this.playTitle(state.title);\r\n+        }\r\n+    }\r\n+\r\n+\r\n+    async playTitle(bool: boolean) {\r\n+        this._c1.selectedIndex = bool ? 1 : 0;\r\n+        if (bool) {\r\n+            cc.audioEngine.stopAll();\r\n+            this.forbidHandle();\r\n+            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n+            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n+            let audioId = cc.audioEngine.play(audio, false, 1);\r\n+            cc.audioEngine.setFinishCallback(audioId, () => {\r\n+                let state: any = globalThis._.cloneDeep(this._state);\r\n+                state.title = false;\r\n+                this.updateState(state);\r\n+            });\r\n+        } else {\r\n+            this.disableForbidHandle();\r\n+        }\r\n+    }\r\n+\r\n+    answerFeedback(bool: boolean) {\r\n+        if (!this.feedback) return;\r\n+        let feedback: any = cc.instantiate(this.feedback);\r\n+        feedback.x = 960;\r\n+        feedback.y = 540;\r\n+        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n+        feedbackJs.init(bool);\r\n+        feedback.parent = cc.find(\"Canvas\").parent;\r\n+\r\n+        setTimeout(() => {\r\n+            feedback.destroy();\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state);\r\n+        }, 2000);\r\n+    }\r\n+\r\n+\r\n+    /**\r\n+     * 点击指引\r\n+     * @param obj 点击对象\r\n+     */\r\n+    handTips2(obj: fgui.GObject) {\r\n+        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n+        this._view.addChild(hand);\r\n+        let tempX = obj.x;\r\n+        let tempY = obj.y;\r\n+\r\n+        hand.x = tempX;\r\n+        hand.y = tempY;\r\n+\r\n+        cc.tween(hand).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).to(0.3, {\r\n+            x: tempX - 30,\r\n+            y: tempY - 30\r\n+        }).to(0.3, {\r\n+            x: tempX,\r\n+            y: tempY\r\n+        }).call(() => {\r\n+            this._view.removeChild(hand);\r\n+            hand = null;\r\n+            let state: any = globalThis._.cloneDeep(this._state);\r\n+            state.submit = this.submitType.No;\r\n+            this.updateState(state)\r\n+        }).start();\r\n+    }\r\n+\r\n+    // 运行时 禁止操作\r\n+    forbidHandle() {\r\n+        console.log('===  运行时 禁止操作 =====');\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (!handleMask) {\r\n+            let handleMask = new cc.Node('handleMask');\r\n+            handleMask.addComponent(cc.BlockInputEvents);\r\n+            handleMask.parent = this._worldRoot;\r\n+            handleMask.width = 1920;\r\n+            handleMask.height = 1080;\r\n+            handleMask.x = 960;\r\n+            handleMask.y = 540;\r\n+        }\r\n+    }\r\n+\r\n+    // 消除禁止\r\n+    disableForbidHandle() {\r\n+        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n+        if (handleMask) handleMask.destroy();\r\n+    }\r\n+\r\n+    // 注册状态，及获取状态的方法\r\n+    registerState() {\r\n+        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n+    }\r\n+\r\n+    // 解除状态，及获取状态的方法\r\n+    relieveState() {\r\n+        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n+    }\r\n+\r\n+    // 本组件状态合并到全局\r\n+    mergeState() {\r\n+        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n+    }\r\n+\r\n+    onEnable() {\r\n+        this.registerState();\r\n+    }\r\n+\r\n+    onDisable() {\r\n+        cc.tween(this).stop();\r\n+        this.relieveState();\r\n+        cc.audioEngine.stopAll();\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1624516714910,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -411,418 +411,4 @@\n         this.relieveState();\r\n         cc.audioEngine.stopAll();\r\n     }\r\n }\r\n-\r\n-/*\r\n- * @Descripttion: \r\n- * @version: \r\n- * @Author: ruzhuan\r\n- * @Date: 2021-06-08 18:00:00\r\n- * @LastEditors: ruzhuan\r\n- * @LastEditTime: 2021-06-08 18:00:00\r\n- */\r\n-const { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\n-const { ccclass, property } = cc._decorator;\r\n-\r\n-@ccclass\r\n-export default class t4_05_model_v1 extends cc.Component {\r\n-    private _worldRoot: cc.Node;\r\n-\r\n-    private _view: fgui.GComponent;\r\n-\r\n-    private _c1: fgui.Controller;\r\n-\r\n-    private _title: fgui.GButton;\r\n-\r\n-    private _titleTrigger: fgui.GLoader;\r\n-\r\n-    private _submitBtn: fgui.GButton;\r\n-\r\n-    private _package: any;\r\n-\r\n-    private _selectMap: any = {};\r\n-\r\n-    private _textMap: any = {};\r\n-\r\n-    private _kuangNameArr: any = [];\r\n-\r\n-    private submitType: any = cc.Enum({\r\n-\r\n-        No: 0,\r\n-        GuideShow: 1,\r\n-        WrongFeed: 2,\r\n-        RightFeed: 3\r\n-    });\r\n-\r\n-    // 远程动态组件\r\n-    private feedback: any;\r\n-\r\n-    private _state = {};\r\n-\r\n-    get state(): any {\r\n-        return this._state;\r\n-    }\r\n-\r\n-    set state(v: any) {\r\n-        this.updateUi(this._state, v);\r\n-        this._state = v;\r\n-        this.mergeState();\r\n-    }\r\n-\r\n-    async onLoad() {\r\n-        this._worldRoot = cc.find(\"Canvas\").parent;\r\n-\r\n-        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n-        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n-\r\n-        fgui.GRoot.inst.addChild(this._view);\r\n-\r\n-        this._c1 = this._view.getController(\"c1\");\r\n-\r\n-        // 臨時\r\n-        // bug 初始设置不播放不生效\r\n-        if (this._c1) {\r\n-            this._c1.selectedIndex = 1;\r\n-            this._c1.selectedIndex = 0;\r\n-        }\r\n-\r\n-        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n-        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n-\r\n-        this._title = this._view.getChild(\"title\").asButton;\r\n-\r\n-        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n-        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n-\r\n-        let tempAnswerMap = {};\r\n-        let kuangGroup = this._view.getChild(\"kuangGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == kuangGroup) {\r\n-                let btn = this._view.getChildAt(i).asButton;\r\n-                console.log('=== name ===' + btn.name);\r\n-                this._kuangNameArr.push(btn.name);\r\n-                tempAnswerMap[btn.name] = '';\r\n-                btn.on(fgui.Event.CLICK, this._clickKuang, this);\r\n-            }\r\n-        }\r\n-\r\n-        let selectGroup = this._view.getChild(\"selectGroup\").asGroup;\r\n-        let indexTemp = 0;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == selectGroup) {\r\n-                let img = this._view.getChildAt(i).asImage;\r\n-                this._selectMap[this._kuangNameArr[indexTemp]] = img;\r\n-                img.visible = false;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        indexTemp = 0;\r\n-        let textGroup = this._view.getChild(\"textGroup\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == textGroup) {\r\n-                let label = this._view.getChildAt(i).asLabel;\r\n-                this._textMap[this._kuangNameArr[indexTemp]] = label;\r\n-                indexTemp++;\r\n-            }\r\n-        }\r\n-\r\n-        let keyGroup = this._view.getChild(\"key\").asGroup;\r\n-        for (let i = 0; i < this._view.numChildren; i++) {\r\n-            if (this._view.getChildAt(i).group == keyGroup) {\r\n-                let keyBtn = this._view.getChildAt(i).asButton;\r\n-                keyBtn.on(fgui.Event.CLICK, this._clickKey, this);\r\n-            }\r\n-        }\r\n-\r\n-        // 初始化state\r\n-        this._state = {\r\n-            title: false,\r\n-            submit: this.submitType.No,\r\n-            selectKuangName: '',\r\n-            keyNumber: '',\r\n-            answerMap: tempAnswerMap,\r\n-        }\r\n-    }\r\n-\r\n-    async init(data: any) {\r\n-        // 临时 model component json 配置加载\r\n-        let { pathConfig, model, components } = data;\r\n-        let Package = pathConfig.packageName;\r\n-        let GComponent = model.uiPath;\r\n-        let { boxSoundUrl, guidIndex } = model.config;\r\n-        this._package = Package;\r\n-\r\n-        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n-\r\n-        // let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n-        // this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n-\r\n-\r\n-        // 动效注册\r\n-        // for (let v in ae) {\r\n-        //     if (ae[v]) {\r\n-        //         this[v] = {};\r\n-        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n-        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n-        //     }\r\n-        // }\r\n-\r\n-        if (components) {\r\n-            for (const key in components) {\r\n-                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n-                let componentBundle: any = await loadBundle(componentPath);\r\n-                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n-                this[key] = componentPrefab;\r\n-            }\r\n-        }\r\n-    }\r\n-\r\n-    private _clickKey(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let subName = btn.name.substring('input'.length);\r\n-        console.log('==== subName ==' + subName);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.keyNumber = subName;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickKuang(evt: any) {\r\n-\r\n-        var btn: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        if (state.selectKuangName === btn.name) {\r\n-            state.selectKuangName = '';\r\n-        } else {\r\n-\r\n-            state.selectKuangName = btn.name;\r\n-        }\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickSubmit(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.submit = this.submitType.GuideShow;\r\n-        state.submit = this.submitType.WrongFeed;\r\n-        state.submit = this.submitType.RightFeed;\r\n-\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-    private _clickTitle(evt: any) {\r\n-        let state: any = globalThis._.cloneDeep(this._state);\r\n-        state.title = true;\r\n-        this.updateState(state);\r\n-    }\r\n-\r\n-\r\n-    // 获取状态\r\n-    getState(data: any) {\r\n-        this.updateState(data);\r\n-    }\r\n-\r\n-    // 更新状态层\r\n-    updateState(curState: any) {\r\n-        if (globalThis._.isEqual(this._state, curState)) return;\r\n-        this.state = curState;\r\n-    }\r\n-\r\n-    // 更新ui层\r\n-    updateUi(oldState: any, state: any) {\r\n-\r\n-        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n-\r\n-            if (state.submit === this.submitType.RightFeed) {\r\n-\r\n-                this.answerFeedback(true);\r\n-\r\n-            } else if (state.submit === this.submitType.WrongFeed) {\r\n-\r\n-                this.answerFeedback(false);\r\n-\r\n-            } else if (state.submit === this.submitType.GuideShow) {\r\n-\r\n-            }\r\n-        }\r\n-        if (!globalThis._.isEqual(oldState.keyNumber, state.keyNumber)) {\r\n-\r\n-            if (state.keyNumber != '') {\r\n-\r\n-                if (oldState.selectKuangName != state.selectKuangName) {\r\n-\r\n-                    if (state.keyNumber === 'x') {\r\n-\r\n-                    } else {\r\n-                        state.answerMap[state.selectKuangName] = state.keyNumber;\r\n-                    }\r\n-\r\n-                } else {\r\n-\r\n-                    if (state.keyNumber === 'x') {\r\n-\r\n-                    } else {\r\n-\r\n-                        state.answerMap[state.selectKuangName] += state.keyNumber;\r\n-                    }\r\n-\r\n-                }\r\n-\r\n-                setTimeout(() => {\r\n-\r\n-                    let state2: any = globalThis._.cloneDeep(this._state);\r\n-                    state2.keyNumber = '';\r\n-                    state2.answerMap = state.answerMap;\r\n-                    this.updateState(state2);\r\n-\r\n-                }, 0.02);\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.answerMap, state.answerMap)) {\r\n-\r\n-            for (let key in state.answerMap) {\r\n-\r\n-                this._textMap[key].text = state.answerMap[key];\r\n-            }\r\n-\r\n-        }\r\n-\r\n-\r\n-        if (!globalThis._.isEqual(oldState.selectKuangName, state.selectKuangName)) {\r\n-\r\n-\r\n-            if (state.selectKuangName != '') {\r\n-\r\n-                this._selectMap[state.selectKuangName].visible = true;\r\n-            }\r\n-\r\n-            if (oldState.selectKuangName != '') {\r\n-\r\n-                this._selectMap[oldState.selectKuangName].visible = false;\r\n-            }\r\n-        }\r\n-\r\n-        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n-            this.playTitle(state.title);\r\n-        }\r\n-    }\r\n-\r\n-\r\n-    async playTitle(bool: boolean) {\r\n-        this._c1.selectedIndex = bool ? 1 : 0;\r\n-        if (bool) {\r\n-            cc.audioEngine.stopAll();\r\n-            this.forbidHandle();\r\n-            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n-            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n-            let audioId = cc.audioEngine.play(audio, false, 1);\r\n-            cc.audioEngine.setFinishCallback(audioId, () => {\r\n-                let state: any = globalThis._.cloneDeep(this._state);\r\n-                state.title = false;\r\n-                this.updateState(state);\r\n-            });\r\n-        } else {\r\n-            this.disableForbidHandle();\r\n-        }\r\n-    }\r\n-\r\n-    answerFeedback(bool: boolean) {\r\n-        if (!this.feedback) return;\r\n-        let feedback: any = cc.instantiate(this.feedback);\r\n-        feedback.x = 960;\r\n-        feedback.y = 540;\r\n-        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n-        feedbackJs.init(bool);\r\n-        feedback.parent = cc.find(\"Canvas\").parent;\r\n-\r\n-        setTimeout(() => {\r\n-            feedback.destroy();\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state);\r\n-        }, 2000);\r\n-    }\r\n-\r\n-\r\n-    /**\r\n-     * 点击指引\r\n-     * @param obj 点击对象\r\n-     */\r\n-    handTips2(obj: fgui.GObject) {\r\n-        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n-        this._view.addChild(hand);\r\n-        let tempX = obj.x;\r\n-        let tempY = obj.y;\r\n-\r\n-        hand.x = tempX;\r\n-        hand.y = tempY;\r\n-\r\n-        cc.tween(hand).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).to(0.3, {\r\n-            x: tempX - 30,\r\n-            y: tempY - 30\r\n-        }).to(0.3, {\r\n-            x: tempX,\r\n-            y: tempY\r\n-        }).call(() => {\r\n-            this._view.removeChild(hand);\r\n-            hand = null;\r\n-            let state: any = globalThis._.cloneDeep(this._state);\r\n-            state.submit = this.submitType.No;\r\n-            this.updateState(state)\r\n-        }).start();\r\n-    }\r\n-\r\n-    // 运行时 禁止操作\r\n-    forbidHandle() {\r\n-        console.log('===  运行时 禁止操作 =====');\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (!handleMask) {\r\n-            let handleMask = new cc.Node('handleMask');\r\n-            handleMask.addComponent(cc.BlockInputEvents);\r\n-            handleMask.parent = this._worldRoot;\r\n-            handleMask.width = 1920;\r\n-            handleMask.height = 1080;\r\n-            handleMask.x = 960;\r\n-            handleMask.y = 540;\r\n-        }\r\n-    }\r\n-\r\n-    // 消除禁止\r\n-    disableForbidHandle() {\r\n-        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n-        if (handleMask) handleMask.destroy();\r\n-    }\r\n-\r\n-    // 注册状态，及获取状态的方法\r\n-    registerState() {\r\n-        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n-    }\r\n-\r\n-    // 解除状态，及获取状态的方法\r\n-    relieveState() {\r\n-        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n-    }\r\n-\r\n-    // 本组件状态合并到全局\r\n-    mergeState() {\r\n-        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n-    }\r\n-\r\n-    onEnable() {\r\n-        this.registerState();\r\n-    }\r\n-\r\n-    onDisable() {\r\n-        cc.tween(this).stop();\r\n-        this.relieveState();\r\n-        cc.audioEngine.stopAll();\r\n-    }\r\n-}\r\n"
                }
            ],
            "date": 1624502666702,
            "name": "Commit-0",
            "content": "\r\n/*\r\n * @Descripttion: \r\n * @version: \r\n * @Author: ruzhuan\r\n * @Date: 2021-06-08 18:00:00\r\n * @LastEditors: ruzhuan\r\n * @LastEditTime: 2021-06-08 18:00:00\r\n */\r\nconst { loadBundle, loadPrefab, loadResource } = window['GlobalData'].sample;\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class t4_05_model_v1 extends cc.Component {\r\n    private _worldRoot: cc.Node;\r\n\r\n    private _view: fgui.GComponent;\r\n\r\n    private _c1: fgui.Controller;\r\n\r\n    private _c2: fgui.Controller;\r\n\r\n    private _paoShow: any = [];\r\n\r\n    private _chooseBtn: any = [];\r\n\r\n    private _selectIcons: any = [];\r\n\r\n    private _chooseCach: any = [];\r\n\r\n    private _title: fgui.GButton;\r\n\r\n    private _titleTrigger: fgui.GLoader;\r\n\r\n    private _submitBtn: fgui.GButton;\r\n\r\n    private _package: any;\r\n\r\n    private _boxSound: cc.AudioClip;\r\n\r\n    private _mask: fgui.GGraph;\r\n\r\n    private _guidIndex: number = 0;\r\n\r\n    private _box3D: fgui.GLoader3D;\r\n\r\n    private submitType: any = cc.Enum({\r\n\r\n        No: 0,\r\n        GuideShow: 1,\r\n        WrongFeed: 2,\r\n        RightFeed: 3\r\n    });\r\n\r\n    // 远程动态组件\r\n    private feedback: any;\r\n\r\n    private _state = {};\r\n\r\n    get state(): any {\r\n        return this._state;\r\n    }\r\n\r\n    set state(v: any) {\r\n        this.updateUi(this._state, v);\r\n        this._state = v;\r\n        this.mergeState();\r\n    }\r\n\r\n    async onLoad() {\r\n        this._worldRoot = cc.find(\"Canvas\").parent;\r\n\r\n        this._view.y = (fgui.GRoot.inst.height - this._view.height) / 2;\r\n        this._view.x = (fgui.GRoot.inst.width - this._view.width) / 2;\r\n\r\n        fgui.GRoot.inst.addChild(this._view);\r\n\r\n\r\n        this._mask = this._view.getChild('maskBg').asGraph;\r\n        this._c1 = this._view.getController(\"c1\");\r\n        this._c2 = this._view.getController(\"c2\");\r\n\r\n        // 臨時\r\n        // bug 初始设置不播放不生效\r\n        if (this._c1) {\r\n            this._c1.selectedIndex = 1;\r\n            this._c1.selectedIndex = 0;\r\n        }\r\n\r\n        this._box3D = this._view.getChild(\"box\") as fgui.GLoader3D;\r\n        this._box3D.on(fgui.Event.CLICK, this._clickBox, this);\r\n        this._box3D.url = \"ui://733aoo45gzaz75\";\r\n        this._box3D.animationName = 'sjq_idle';\r\n\r\n        this._titleTrigger = this._view.getChild(\"titleTrigger\").asLoader;\r\n        if (this._titleTrigger) this._titleTrigger.on(fgui.Event.CLICK, this._clickTitle, this);\r\n\r\n        this._title = this._view.getChild(\"title\").asButton;\r\n\r\n        this._submitBtn = this._view.getChild(\"submit\").asButton;\r\n        if (this._submitBtn) this._submitBtn.on(fgui.Event.CLICK, this._clickSubmit, this);\r\n\r\n        let paoGroup = this._view.getChild(\"pao\").asGroup;\r\n        for (let i = 0; i < this._view.numChildren; i++) {\r\n            if (this._view.getChildAt(i).group == paoGroup) {\r\n                let btn: fgui.GButton = this._view.getChildAt(i).asButton;\r\n                btn.alpha = 0;\r\n                this._paoShow.push(btn);\r\n            }\r\n        }\r\n\r\n        let chooseGroup = this._view.getChild(\"choose\").asGroup;\r\n        for (let i = 0; i < this._view.numChildren; i++) {\r\n            if (this._view.getChildAt(i).group == chooseGroup) {\r\n                let btn: fgui.GButton = this._view.getChildAt(i).asButton;\r\n                btn.data = { index: this._chooseCach.length };\r\n                let temp = { index: this._chooseCach.length, selected: false };\r\n                this._chooseCach.push(temp);\r\n                this._chooseBtn.push(btn);\r\n                btn.on(fgui.Event.CLICK, this._clickChoose, this);\r\n            }\r\n        }\r\n\r\n        let selectedGroup = this._view.getChild(\"select\").asGroup;\r\n        for (let i = 0; i < this._view.numChildren; i++) {\r\n            if (this._view.getChildAt(i).group == selectedGroup) {\r\n                let icon: fgui.GImage = this._view.getChildAt(i).asImage;\r\n                icon.visible = false;\r\n                this._selectIcons.push(icon);\r\n            }\r\n        }\r\n\r\n        // 初始化state\r\n        this._state = {\r\n            title: false,\r\n            boxPlay: false,\r\n            canChoose: false,\r\n            chooseCach: this._chooseCach,\r\n            submit: this.submitType.No,\r\n        }\r\n    }\r\n\r\n    async init(data: any) {\r\n        // 临时 model component json 配置加载\r\n        let { pathConfig, model, components } = data;\r\n        let Package = pathConfig.packageName;\r\n        let GComponent = model.uiPath;\r\n        let { boxSoundUrl, guidIndex } = model.config;\r\n        this._package = Package;\r\n\r\n        this._view = fgui.UIPackage.createObject(Package, GComponent).asCom;\r\n\r\n        let item = fgui.UIPackage.getItemByURL(boxSoundUrl);\r\n        this._boxSound = await loadResource(item.file, cc.AudioClip);\r\n\r\n        if (guidIndex) this._guidIndex = guidIndex;\r\n\r\n        // 动效注册\r\n        // for (let v in ae) {\r\n        //     if (ae[v]) {\r\n        //         this[v] = {};\r\n        //         if (ae[v].component) this[v].component = fgui.UIPackage.createObject(Package, ae[v].component).asCom;\r\n        //         if (ae[v].pos) this[v].pos = ae[v].pos;\r\n        //     }\r\n        // }\r\n\r\n        if (components) {\r\n            for (const key in components) {\r\n                let componentPath: any = `${pathConfig.remoteUrl}${pathConfig.componentBundlePath}${components[key].bundleName}`;\r\n                let componentBundle: any = await loadBundle(componentPath);\r\n                let componentPrefab: any = await loadPrefab(componentBundle, components[key].prefabName);\r\n                this[key] = componentPrefab;\r\n            }\r\n        }\r\n    }\r\n\r\n    private _clickChoose(evt: any) {\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n        let obj: fgui.GObject = fgui.GObject.cast(evt.currentTarget);\r\n        let btn: fgui.GButton = obj.asButton;\r\n\r\n        for (let i = 0; i < state.chooseCach.length; i++) {\r\n            state.chooseCach[i].selected = false;\r\n        }\r\n        for (let i = 0; i < state.chooseCach.length; i++) {\r\n            if (state.chooseCach[i].index === btn.data.index) {\r\n                state.chooseCach[i].selected = true;\r\n                break;\r\n            }\r\n        }\r\n        this.updateState(state);\r\n    }\r\n\r\n    private _clickSubmit(evt: any) {\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n\r\n        let isHave = 0;\r\n        for (let i = 0; i < state.chooseCach.length; i++) {\r\n\r\n            if (state.chooseCach[i].selected) {\r\n                isHave++;\r\n            }\r\n        }\r\n\r\n        if (isHave === 0) {\r\n            state.submit = this.submitType.GuideShow;\r\n        } else if (isHave === 1) {\r\n\r\n            state.submit = this.submitType.WrongFeed;\r\n\r\n            for (let i = 0; i < state.chooseCach.length; i++) {\r\n\r\n                if (state.chooseCach[i].selected && state.chooseCach[i].index === 0) {\r\n\r\n                    state.submit = this.submitType.RightFeed;\r\n                    break;\r\n                }\r\n            }\r\n\r\n        } else {\r\n            state.submit = this.submitType.WrongFeed;\r\n        }\r\n\r\n        this.updateState(state);\r\n    }\r\n\r\n    private _clickBox(evt: any) {\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n        state.boxPlay = true;\r\n        this.updateState(state);\r\n    }\r\n\r\n    private _clickTitle(evt: any) {\r\n        let state: any = globalThis._.cloneDeep(this._state);\r\n        state.title = true;\r\n        this.updateState(state);\r\n    }\r\n\r\n\r\n    // 获取状态\r\n    getState(data: any) {\r\n        this.updateState(data);\r\n    }\r\n\r\n    // 更新状态层\r\n    updateState(curState: any) {\r\n        if (globalThis._.isEqual(this._state, curState)) return;\r\n        this.state = curState;\r\n    }\r\n\r\n    // 更新ui层\r\n    updateUi(oldState: any, state: any) {\r\n\r\n        if (!globalThis._.isEqual(oldState.boxPlay, state.boxPlay)) {\r\n            if (state.boxPlay) {\r\n                this.playBoxSpeak(state.boxPlay);\r\n            } else {\r\n                this._box3D.animationName = 'sjq_idle';\r\n                this._c2.selectedIndex = 0;\r\n            }\r\n        }\r\n\r\n        if (!globalThis._.isEqual(oldState.chooseCach, state.chooseCach)) {\r\n\r\n            for (let i = 0; i < state.chooseCach.length; i++) {\r\n\r\n                for (let j = 0; j < this._selectIcons.length; j++) {\r\n                    if (state.chooseCach[i].index === j) {\r\n                        this._selectIcons[j].visible = state.chooseCach[i].selected;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!globalThis._.isEqual(oldState.submit, state.submit)) {\r\n\r\n            if (state.submit === this.submitType.RightFeed) {\r\n\r\n                this.answerFeedback(true);\r\n\r\n            } else if (state.submit === this.submitType.WrongFeed) {\r\n\r\n                this.answerFeedback(false);\r\n\r\n            } else if (state.submit === this.submitType.GuideShow) {\r\n\r\n                this.handTips2(this._chooseBtn[this._guidIndex]);\r\n            }\r\n        }\r\n\r\n        if (!globalThis._.isEqual(oldState.title, state.title)) {\r\n            this.playTitle(state.title);\r\n        }\r\n\r\n        if (!globalThis._.isEqual(oldState.canChoose, state.canChoose)) {\r\n            this._mask.visible = !state.canChoose;\r\n        }\r\n\r\n    }\r\n\r\n\r\n    async playTitle(bool: boolean) {\r\n        this._c1.selectedIndex = bool ? 1 : 0;\r\n        if (bool) {\r\n            cc.audioEngine.stopAll();\r\n            this.forbidHandle();\r\n            let item = fgui.UIPackage.getItemByURL(this._title[\"_sound\"]);\r\n            let audio: cc.AudioClip = await loadResource(item.file, cc.AudioClip);\r\n            let audioId = cc.audioEngine.play(audio, false, 1);\r\n            cc.audioEngine.setFinishCallback(audioId, () => {\r\n                let state: any = globalThis._.cloneDeep(this._state);\r\n                state.title = false;\r\n                this.updateState(state);\r\n            });\r\n        } else {\r\n            this.disableForbidHandle();\r\n        }\r\n    }\r\n\r\n    playBoxSpeak(bool: boolean) {\r\n        if (bool) {\r\n\r\n            this._box3D.animationName = 'sjq_idle1to2';\r\n\r\n            cc.tween(this._box3D)\r\n                .delay(0.3)\r\n                .call(() => {\r\n                    this._box3D.animationName = 'sjq_idle2';\r\n                })\r\n                .start()\r\n\r\n            cc.audioEngine.stopAll();\r\n            this.forbidHandle();\r\n            this.playBoxSound();\r\n\r\n        } else {\r\n            this._c2.selectedIndex = 0;\r\n            this.disableForbidHandle();\r\n        }\r\n    }\r\n\r\n    async playBoxSound() {\r\n\r\n        for (let i = 0; i < this._paoShow.length; i++) {\r\n            this._paoShow[i].alpha = 0;\r\n        }\r\n\r\n        cc.tween(this)\r\n            .delay(0.5)\r\n            .call(() => {\r\n\r\n                this._c2.selectedIndex = 1;\r\n                this.playPaoShowAnimate(0);\r\n            })\r\n            .start();\r\n\r\n        let audioId = cc.audioEngine.play(this._boxSound, false, 1);\r\n        cc.audioEngine.setFinishCallback(audioId, () => {\r\n            this._box3D.animationName = 'sjq_idle';\r\n            this.disableForbidHandle();\r\n            for (let i = 0; i < this._paoShow.length; i++) {\r\n                this._paoShow[i].alpha = 0;\r\n            }\r\n            this._c2.selectedIndex = 0;\r\n            let state: any = globalThis._.cloneDeep(this._state);\r\n            state.boxPlay = false;\r\n            state.canChoose = true;\r\n            this.updateState(state);\r\n\r\n        });\r\n    }\r\n\r\n    playPaoShowAnimate(index: number) {\r\n\r\n        cc.tween(this._paoShow[index])\r\n            .to(1.0, { alpha: 1 })\r\n            .call(() => {\r\n                index++;\r\n                if (index < this._paoShow.length) {\r\n                    this.playPaoShowAnimate(index);\r\n                }\r\n            })\r\n            .start()\r\n\r\n    }\r\n\r\n    answerFeedback(bool: boolean) {\r\n        if (!this.feedback) return;\r\n        let feedback: any = cc.instantiate(this.feedback);\r\n        feedback.x = 960;\r\n        feedback.y = 540;\r\n        let feedbackJs: any = feedback.getComponent(cc.Component);\r\n        feedbackJs.init(bool);\r\n        feedback.parent = cc.find(\"Canvas\").parent;\r\n\r\n        setTimeout(() => {\r\n            feedback.destroy();\r\n            let state: any = globalThis._.cloneDeep(this._state);\r\n            state.submit = this.submitType.No;\r\n            this.updateState(state);\r\n        }, 2000);\r\n    }\r\n\r\n\r\n    /**\r\n     * 点击指引\r\n     * @param obj 点击对象\r\n     */\r\n    handTips2(obj: fgui.GObject) {\r\n        let hand = fgui.UIPackage.createObject(this._package, 'hand');\r\n        this._view.addChild(hand);\r\n        let tempX = obj.x;\r\n        let tempY = obj.y;\r\n\r\n        hand.x = tempX;\r\n        hand.y = tempY;\r\n\r\n        cc.tween(hand).to(0.3, {\r\n            x: tempX - 30,\r\n            y: tempY - 30\r\n        }).to(0.3, {\r\n            x: tempX,\r\n            y: tempY\r\n        }).to(0.3, {\r\n            x: tempX - 30,\r\n            y: tempY - 30\r\n        }).to(0.3, {\r\n            x: tempX,\r\n            y: tempY\r\n        }).call(() => {\r\n            this._view.removeChild(hand);\r\n            hand = null;\r\n            let state: any = globalThis._.cloneDeep(this._state);\r\n            state.submit = this.submitType.No;\r\n            this.updateState(state)\r\n        }).start();\r\n    }\r\n\r\n    // 运行时 禁止操作\r\n    forbidHandle() {\r\n        console.log('===  运行时 禁止操作 =====');\r\n        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n        if (!handleMask) {\r\n            let handleMask = new cc.Node('handleMask');\r\n            handleMask.addComponent(cc.BlockInputEvents);\r\n            handleMask.parent = this._worldRoot;\r\n            handleMask.width = 1920;\r\n            handleMask.height = 1080;\r\n            handleMask.x = 960;\r\n            handleMask.y = 540;\r\n        }\r\n    }\r\n\r\n    // 消除禁止\r\n    disableForbidHandle() {\r\n        let handleMask = this._worldRoot.getChildByName('handleMask');\r\n        if (handleMask) handleMask.destroy();\r\n    }\r\n\r\n    // 注册状态，及获取状态的方法\r\n    registerState() {\r\n        if (window['GlobalData'].sample.registerState) window['GlobalData'].sample.registerState.call(this);\r\n    }\r\n\r\n    // 解除状态，及获取状态的方法\r\n    relieveState() {\r\n        if (window['GlobalData'].sample.relieveState) window['GlobalData'].sample.relieveState.call(this);\r\n    }\r\n\r\n    // 本组件状态合并到全局\r\n    mergeState() {\r\n        if (window['GlobalData'].sample.mergeState) window['GlobalData'].sample.mergeState.call(this);\r\n    }\r\n\r\n    onEnable() {\r\n        this.registerState();\r\n    }\r\n\r\n    onDisable() {\r\n        cc.tween(this._box3D).stop();\r\n        cc.tween(this).stop();\r\n        this.relieveState();\r\n        cc.audioEngine.stopAll();\r\n    }\r\n}\r\n"
        }
    ]
}