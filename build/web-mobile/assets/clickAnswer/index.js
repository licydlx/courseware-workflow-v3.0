window.__require=function t(e,i,n){function o(a,r){if(!i[a]){if(!e[a]){var l=a.split("/");if(l=l[l.length-1],!e[l]){var h="function"==typeof __require&&__require;if(!r&&h)return h(l,!0);if(s)return s(l,!0);throw new Error("Cannot find module '"+a+"'")}a=l}var c=i[a]={exports:{}};e[a][0].call(c.exports,function(t){return o(e[a][1][t]||t)},c,c.exports,t,e,i,n)}return i[a].exports}for(var s="function"==typeof __require&&__require,a=0;a<n.length;a++)o(n[a]);return o}({"clickAnswer-model01-v1":[function(t,e,i){"use strict";cc._RF.push(e,"5424aSAddlL8rVGcxjgry3C","clickAnswer-model01-v1");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=this&&this.__decorate||function(t,e,i,n){var o,s=arguments.length,a=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(o=t[r])&&(a=(s<3?o(a):s>3?o(e,i,a):o(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a},a=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,s){function a(t){try{l(n.next(t))}catch(e){s(e)}}function r(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,r)}l((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var i,n,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function r(t){return function(e){return l([t,e])}}function l(s){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(r){s=[6,r],n=0}finally{i=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var l=window.GlobalData.sample,h=l.loadBundle,c=l.loadPrefab,u=l.loadResource,p=cc._decorator,d=p.ccclass,f=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._grids=[],e._answer=0,e._state={},e}return o(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this.updateUi(this._state,t),this._state=t,this.mergeState()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._worldRoot=cc.find("Canvas").parent,this._view.y=(fgui.GRoot.inst.height-this._view.height)/2,this._view.x=(fgui.GRoot.inst.width-this._view.width)/2,fgui.GRoot.inst.addChild(this._view),this._c1=this._view.getController("c1"),this._c2=this._view.getController("c2"),this._c2&&(this._c2.selectedIndex=1,this._c2.selectedIndex=0),this._submit=this._view.getChild("submit").asButton,this._submit&&this._submit.on(fgui.Event.CLICK,this._clickSubmit,this),this._titleTrigger=this._view.getChild("titleTrigger").asLoader,this._titleTrigger&&this._titleTrigger.on(fgui.Event.CLICK,this._clickTitle,this),this._title=this._view.getChild("title").asButton,this._launchBtn=this._view.getChild("launchBtn").asButton,this._launchBtn.on(fgui.Event.CLICK,this._clickLaunch,this),this._btnBox=this._view.getChild("btnBox").asButton,this._btnBox.on(fgui.Event.CLICK,this._clickLibra,this),this._imgObj=this._view.getChild("imgObj").asLoader,this.catchObj=this._view.getChild("catchStone").asCom;for(var t=this._btnBox.getChild("grids").asGroup,e=this._btnBox.numChildren-1;e>-1;e--)if(this._btnBox.getChildAt(e).group==t){var i=this._btnBox.getChildAt(e).asLoader;this._grids.push(i)}this._state={drops:0,submit:!1,answer:!1,catch:!1,title:!1},this.disableForbidHandle()},e.prototype.init=function(t){return a(this,void 0,void 0,function(){var e,i,n,o,s,a,l,u,p,d,f,_,g,b,w,m;return r(this,function(r){switch(r.label){case 0:for(p in e=t.pathConfig,i=t.model,n=t.components,o=e.packageName,s=i.uiPath,a=i.config,l=a.answer,u=a.ae,this._view=fgui.UIPackage.createObject(o,s).asCom,u)u[p]&&(this[p]={},u[p].component&&(this[p].component=fgui.UIPackage.createObject(o,u[p].component).asCom),u[p].pos&&(this[p].pos=u[p].pos));if(l&&(this._answer=l),!n)return[3,5];for(f in d=[],n)d.push(f);_=0,r.label=1;case 1:return _<d.length?(g=d[_],b=""+e.remoteUrl+e.componentBundlePath+n[g].bundleName,[4,h(b)]):[3,5];case 2:return w=r.sent(),[4,c(w,n[g].prefabName)];case 3:m=r.sent(),this[g]=m,r.label=4;case 4:return _++,[3,1];case 5:return[2]}})})},e.prototype._clickTitle=function(){var t=globalThis._.cloneDeep(this._state);t.title=!0,this.updateState(t)},e.prototype._clickLibra=function(){var t=globalThis._.cloneDeep(this._state),e=this._grids.findIndex(function(t){return null===t.url});0!==e&&(this._grids[-1==e?this._grids.length-1:e-1].url=null,t.drops=t.drops-1,t.answer=t.drops===this._answer,this.updateState(t))},e.prototype._clickLaunch=function(){var t=globalThis._.cloneDeep(this._state);t.catch=!0,this.updateState(t)},e.prototype._clickSubmit=function(){var t=globalThis._.cloneDeep(this._state);t.answer=t.drops===this._answer,t.submit=!0,this.updateState(t)},e.prototype.getState=function(t){this.updateState(t)},e.prototype.updateState=function(t){globalThis._.isEqual(this._state,t)||(this.state=t)},e.prototype.updateUi=function(t,e){if(e.catch)this.onCatchObj();else{if(!globalThis._.isEqual(t.drops,e.drops)){for(var i=0;i<this._grids.length;i++){var n=this._grids[i];e.drops>i?n.url||(n.url=this._imgObj.url):n.url&&(n.url=null)}this._c1.selectedIndex=e.drops,e.answer||this.onLibraHint()}globalThis._.isEqual(t.title,e.title)||this.playTitle(e.title),globalThis._.isEqual(t.submit,e.submit)||e.submit&&(e.drops?this.answerFeedback(e.answer):this.onHandleGuide())}},e.prototype.playTitle=function(t){return a(this,void 0,void 0,function(){var e,i,n,o=this;return r(this,function(s){switch(s.label){case 0:return this._c2.selectedIndex=t?1:0,t?(cc.audioEngine.stopAll(),this.forbidHandle(),e=fgui.UIPackage.getItemByURL(this._title._sound),[4,u(e.file,cc.AudioClip)]):[3,2];case 1:return i=s.sent(),n=cc.audioEngine.play(i,!1,1),cc.audioEngine.setFinishCallback(n,function(){var t=globalThis._.cloneDeep(o._state);t.title=!1,o.updateState(t)}),[3,3];case 2:this.disableForbidHandle(),s.label=3;case 3:return[2]}})})},e.prototype.answerFeedback=function(t){var e=this;if(this.feedback){var i=globalThis._.cloneDeep(this._state),n=cc.instantiate(this.feedback);n.x=960,n.y=540,n.getComponent(cc.Component).init(t),n.parent=cc.find("Canvas").parent,setTimeout(function(){n.destroy(),i.submit=!1,e.updateState(i)},2e3)}},e.prototype.onLibraHint=function(){var t=this;this.lineBlink&&(fgui.GRoot.inst.addChild(this.lineBlink.component),this.lineBlink.pos?(this.lineBlink.component.x=(fgui.GRoot.inst.width-this.lineBlink.component.width)/2+this.lineBlink.pos.x,this.lineBlink.component.y=(fgui.GRoot.inst.height-this.lineBlink.component.height)/2+this.lineBlink.pos.y):this.lineBlink.component.y=(fgui.GRoot.inst.height-this.lineBlink.component.height)/2,this.lineBlink.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.lineBlink.component)}))},e.prototype.onHandleGuide=function(){var t=this;if(this.handleGuide){var e=globalThis._.cloneDeep(this._state);fgui.GRoot.inst.addChild(this.handleGuide.component),this.handleGuide.pos?(this.handleGuide.component.x=(fgui.GRoot.inst.width-this.handleGuide.component.width)/2+this.handleGuide.pos.x,this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2+this.handleGuide.pos.y):this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2,this.handleGuide.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.handleGuide.component),e.submit=!1,t.updateState(e)},2)}},e.prototype.onCatchObj=function(){var t=this;this.catchObj.getTransition("t0").play(function(){var e=globalThis._.cloneDeep(t._state);e.catch=!1,t._grids.find(function(t){return null===t.url})&&(e.drops=e.drops+1),e.answer=e.drops===t._answer,t.updateState(e),t.catchObj.getTransition("t1").play()},1)},e.prototype.forbidHandle=function(){if(!this._worldRoot.getChildByName("handleMask")){var t=new cc.Node("handleMask");t.addComponent(cc.BlockInputEvents),t.parent=this._worldRoot,t.width=1920,t.height=1080,t.x=960,t.y=540}},e.prototype.disableForbidHandle=function(){var t=this._worldRoot.getChildByName("handleMask");t&&t.destroy()},e.prototype.registerState=function(){window.GlobalData.sample.registerState&&window.GlobalData.sample.registerState.call(this)},e.prototype.relieveState=function(){window.GlobalData.sample.relieveState&&window.GlobalData.sample.relieveState.call(this)},e.prototype.mergeState=function(){window.GlobalData.sample.mergeState&&window.GlobalData.sample.mergeState.call(this)},e.prototype.onEnable=function(){this.registerState()},e.prototype.onDisable=function(){this.relieveState(),cc.audioEngine.stopAll()},s([d],e)}(cc.Component));i.default=f,cc._RF.pop()},{}]},{},["clickAnswer-model01-v1"]);