window.__require=function t(e,i,o){function n(l,a){if(!i[l]){if(!e[l]){var s=l.split("/");if(s=s[s.length-1],!e[s]){var c="function"==typeof __require&&__require;if(!a&&c)return c(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+l+"'")}l=s}var d=i[l]={exports:{}};e[l][0].call(d.exports,function(t){return n(e[l][1][t]||t)},d,d.exports,t,e,i,o)}return i[l].exports}for(var r="function"==typeof __require&&__require,l=0;l<o.length;l++)n(o[l]);return n}({DragAnswerModel03Base:[function(t,e,i){"use strict";cc._RF.push(e,"dc8acHicohNq5yBFFMirL0/","DragAnswerModel03Base");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,l=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(r<3?n(l):r>3?n(e,i,l):n(e,i))||l);return r>3&&l&&Object.defineProperty(e,i,l),l},l=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function l(t){try{s(o.next(t))}catch(e){r(e)}}function a(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(l,a)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,o,n,r,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(n=(n=l.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){l.label=r[1];break}if(6===r[0]&&l.label<n[1]){l.label=n[1],n=r;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(r);break}n[2]&&l.ops.pop(),l.trys.pop();continue}r=e.call(t,l)}catch(a){r=[6,a],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=window.GlobalData.sample,c=s.loadBundle,d=s.loadPrefab,h=(s.loadResource,cc._decorator),u=h.ccclass,p=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(t){return l(this,void 0,void 0,function(){var e,i,o,n,r,l,s,h,u,p,f,g,_,y,b,v;return a(this,function(a){switch(a.label){case 0:if((e=this).pageData=t,i=t.pathConfig,o=t.model,n=t.components,r=i.packageName,l=o.uiPath,(s=o.config).answer,h=s.ae,o.uiPath&&(l=o.uiPath,this._view=fgui.UIPackage.createObject(r,l).asCom),e._readTitleBtn=fgui.UIPackage.createObject("t4-trialClass-01","TitleCom").asCom,e._readTitleBtn.getChild("title").url=fgui.UIPackage.createObject("t4-trialClass-01","title_3").asImage.resourceURL,e._readTitleBtn.x=20,e._readTitleBtn.y=50,this._view.addChild(e._readTitleBtn),e._submitBtn=fgui.UIPackage.createObject("t4-trialClass-01","SubmitBtn").asCom,e._submitBtn.x=1676,e._submitBtn.y=806,this._view.addChild(e._submitBtn),o.config&&h)for(u in h)h[u]&&(this[u]={},h[u].component&&(this[u].component=fgui.UIPackage.createObject(r,h[u].component).asCom),h[u].pos&&(this[u].pos=h[u].pos));if(!n)return[3,5];for(f in p=[],n)p.push(f);g=0,a.label=1;case 1:return g<p.length?(_=p[g],y=""+i.remoteUrl+i.componentBundlePath+n[_].bundleName,[4,c(y)]):[3,5];case 2:return b=a.sent(),[4,d(b,n[_].prefabName)];case 3:v=a.sent(),this[_]=v,a.label=4;case 4:return g++,[3,1];case 5:return[2]}})})},r([u],e)}(cc.Component));i.default=p,cc._RF.pop()},{}],IDragAnswerModel03Base:[function(t,e,i){"use strict";cc._RF.push(e,"1736cyca9ZHNoOoWPutUzza","IDragAnswerModel03Base"),Object.defineProperty(i,"__esModule",{value:!0}),cc._RF.pop()},{}],"dragAnswer-model01-v1":[function(t,e,i){"use strict";cc._RF.push(e,"a13c8/eIVFLEpkoqHBFYILF","dragAnswer-model01-v1");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,l=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(r<3?n(l):r>3?n(e,i,l):n(e,i))||l);return r>3&&l&&Object.defineProperty(e,i,l),l},l=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function l(t){try{s(o.next(t))}catch(e){r(e)}}function a(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(l,a)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,o,n,r,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(n=(n=l.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){l.label=r[1];break}if(6===r[0]&&l.label<n[1]){l.label=n[1],n=r;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(r);break}n[2]&&l.ops.pop(),l.trys.pop();continue}r=e.call(t,l)}catch(a){r=[6,a],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=window.GlobalData.sample,c=s.loadBundle,d=s.loadPrefab,h=s.loadResource,u=window.GlobalData.utils.pointBelongArea,p=cc._decorator,f=p.ccclass,g=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._grids=[],e._cache={},e._scheduleTime=.3,e._dragging=!1,e._answer=0,e._state={},e}return n(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this.updateUi(this._state,t),this._state=t,this.mergeState()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._worldRoot=cc.find("Canvas").parent,this._view.y=(fgui.GRoot.inst.height-this._view.height)/2,this._view.x=(fgui.GRoot.inst.width-this._view.width)/2,fgui.GRoot.inst.addChild(this._view),this._c1=this._view.getController("c1"),this._c2=this._view.getController("c2"),this._c2&&(this._c2.selectedIndex=1,this._c2.selectedIndex=0),this._submit=this._view.getChild("submit").asButton,this._submit&&this._submit.on(fgui.Event.CLICK,this._clickSubmit,this),this._titleTrigger=this._view.getChild("titleTrigger").asLoader,this._titleTrigger&&this._titleTrigger.on(fgui.Event.CLICK,this._clickTitle,this),this._title=this._view.getChild("title").asButton,this._dragBtn=this._view.getChild("dragBtn").asButton,this._cache.dragOrigin=this.getOriginValue(this._dragBtn),this._dragBtn.draggable=!0,this._dragBtn.on(fgui.Event.TOUCH_BEGIN,this._onDragStart,this),this._dragBtn.on(fgui.Event.TOUCH_MOVE,this._onDragMove,this),this._dragBtn.on(fgui.Event.TOUCH_END,this._onDragEnd,this),this._btnBox=this._view.getChild("btnBox").asButton,this._btnBox&&this._btnBox.on(fgui.Event.CLICK,this._clickRemove,this);for(var t=this._btnBox.getChild("grids").asGroup,e=this._btnBox.numChildren-1;e>-1;e--)if(this._btnBox.getChildAt(e).group==t){var i=this._btnBox.getChildAt(e).asLoader;this._grids.push(i)}this._state={drag:"end",dragBtn:{x:this._dragBtn.x,y:this._dragBtn.y},title:!1,drops:0,submit:!1,answer:!1},this.disableForbidHandle()},e.prototype.init=function(t){return l(this,void 0,void 0,function(){var e,i,o,n,r,l,s,h,u,p,f,g,_,y,b,v;return a(this,function(a){switch(a.label){case 0:for(u in e=t.pathConfig,i=t.model,o=t.components,n=e.packageName,r=i.uiPath,l=i.config,s=l.answer,h=l.ae,this._view=fgui.UIPackage.createObject(n,r).asCom,h)h[u]&&(this[u]={},h[u].component&&(this[u].component=fgui.UIPackage.createObject(n,h[u].component).asCom),h[u].pos&&(this[u].pos=h[u].pos));if(s&&(this._answer=s),!o)return[3,5];for(f in p=[],o)p.push(f);g=0,a.label=1;case 1:return g<p.length?(_=p[g],y=""+e.remoteUrl+e.componentBundlePath+o[_].bundleName,[4,c(y)]):[3,5];case 2:return b=a.sent(),[4,d(b,o[_].prefabName)];case 3:v=a.sent(),this[_]=v,a.label=4;case 4:return g++,[3,1];case 5:return[2]}})})},e.prototype.getOriginValue=function(t){return{x:t.x,y:t.y}},e.prototype._onDragStart=function(t){t.captureTouch();var e=globalThis._.cloneDeep(this._state);e.drag="start",e.answer=e.drops===this._answer,this.updateState(e)},e.prototype._onDragMove=function(){this._dragging=!0},e.prototype._onDragEnd=function(){this._dragging=!1;var t=globalThis._.cloneDeep(this._state);u("rectangle",this._btnBox,this._dragBtn)&&(this._dragBtn.getChild("icon").asLoader,this._grids.find(function(t){return null===t.url})&&(t.drops=t.drops+1)),t.dragBtn={x:this._cache.dragOrigin.x,y:this._cache.dragOrigin.y},t.drag="end",t.answer=t.drops===this._answer,this.updateState(t)},e.prototype._clickRemove=function(){var t=globalThis._.cloneDeep(this._state);0!==this._grids.findIndex(function(t){return null===t.url})&&(t.drops=t.drops-1,t.answer=t.drops===this._answer,this.updateState(t))},e.prototype._clickTitle=function(){var t=globalThis._.cloneDeep(this._state);t.title=!0,this.updateState(t)},e.prototype._clickSubmit=function(){return l(this,void 0,void 0,function(){var t;return a(this,function(){return(t=globalThis._.cloneDeep(this._state)).answer=t.drops===this._answer,t.submit=!0,this.updateState(t),[2]})})},e.prototype.getState=function(t){this.updateState(t)},e.prototype.updateState=function(t){globalThis._.isEqual(this._state,t)||(this.state=t)},e.prototype.updateUi=function(t,e){if("move"==e.drag&&(this._dragBtn.x=e.dragBtn.x,this._dragBtn.y=e.dragBtn.y),"end"==e.drag){if(this._dragBtn.x=this._cache.dragOrigin.x,this._dragBtn.y=this._cache.dragOrigin.y,!globalThis._.isEqual(t.drops,e.drops)){for(var i=0;i<this._grids.length;i++){var o=this._grids[i];if(e.drops>i){if(!o.url){var n=this._dragBtn.getChild("icon").asLoader;o.url=n.url}}else o.url&&(o.url=null)}this._c1.selectedIndex=e.drops,e.answer||this.onLibraHint()}globalThis._.isEqual(t.submit,e.submit)||e.submit&&(e.drops?this.answerFeedback(e.answer):this.onHandleGuide()),globalThis._.isEqual(t.title,e.title)||this.playTitle(e.title)}},e.prototype.playTitle=function(t){return l(this,void 0,void 0,function(){var e,i,o,n=this;return a(this,function(r){switch(r.label){case 0:return this._c2.selectedIndex=t?1:0,t?(cc.audioEngine.stopAll(),this.forbidHandle(),e=fgui.UIPackage.getItemByURL(this._title._sound),[4,h(e.file,cc.AudioClip)]):[3,2];case 1:return i=r.sent(),o=cc.audioEngine.play(i,!1,1),cc.audioEngine.setFinishCallback(o,function(){var t=globalThis._.cloneDeep(n._state);t.title=!1,n.updateState(t)}),[3,3];case 2:this.disableForbidHandle(),r.label=3;case 3:return[2]}})})},e.prototype.answerFeedback=function(t){var e=this;if(this.feedback){var i=globalThis._.cloneDeep(this._state),o=cc.instantiate(this.feedback);o.x=960,o.y=540,o.getComponent(cc.Component).init(t),o.parent=cc.find("Canvas").parent,setTimeout(function(){o.destroy(),i.submit=!1,e.updateState(i)},2e3)}},e.prototype.onLibraHint=function(){var t=this;this.lineBlink&&(fgui.GRoot.inst.addChild(this.lineBlink.component),this.lineBlink.pos?(this.lineBlink.component.x=(fgui.GRoot.inst.width-this.lineBlink.component.width)/2+this.lineBlink.pos.x,this.lineBlink.component.y=(fgui.GRoot.inst.height-this.lineBlink.component.height)/2+this.lineBlink.pos.y):this.lineBlink.component.y=(fgui.GRoot.inst.height-this.lineBlink.component.height)/2,this.lineBlink.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.lineBlink.component)}))},e.prototype.onHandleGuide=function(){var t=this;if(this.handleGuide){var e=globalThis._.cloneDeep(this._state);fgui.GRoot.inst.addChild(this.handleGuide.component),this.handleGuide.pos?(this.handleGuide.component.x=(fgui.GRoot.inst.width-this.handleGuide.component.width)/2+this.handleGuide.pos.x,this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2+this.handleGuide.pos.y):this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2,this.handleGuide.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.handleGuide.component),e.submit=!1,t.updateState(e)},2)}},e.prototype.forbidHandle=function(){if(!this._worldRoot.getChildByName("handleMask")){var t=new cc.Node("handleMask");t.addComponent(cc.BlockInputEvents),t.parent=this._worldRoot,t.width=1920,t.height=1080,t.x=960,t.y=540}},e.prototype.disableForbidHandle=function(){var t=this._worldRoot.getChildByName("handleMask");t&&t.destroy()},e.prototype.dragSchedule=function(){if(this._dragging){var t=globalThis._.cloneDeep(this._state);t.drag="move",t.dragBtn={x:this._dragBtn.x,y:this._dragBtn.y},this.updateState(t)}},e.prototype.registerState=function(){window.GlobalData.sample.registerState&&window.GlobalData.sample.registerState.call(this)},e.prototype.relieveState=function(){window.GlobalData.sample.relieveState&&window.GlobalData.sample.relieveState.call(this)},e.prototype.mergeState=function(){window.GlobalData.sample.mergeState&&window.GlobalData.sample.mergeState.call(this)},e.prototype.onEnable=function(){this.registerState(),this.schedule(this.dragSchedule,this._scheduleTime)},e.prototype.onDisable=function(){this.relieveState(),cc.audioEngine.stopAll()},r([f],e)}(cc.Component));i.default=g,cc._RF.pop()},{}],"dragAnswer-model01-v2":[function(t,e,i){"use strict";cc._RF.push(e,"8f908Bl1PlGabQ0oWxCLVqT","dragAnswer-model01-v2");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,l=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(r<3?n(l):r>3?n(e,i,l):n(e,i))||l);return r>3&&l&&Object.defineProperty(e,i,l),l},l=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function l(t){try{s(o.next(t))}catch(e){r(e)}}function a(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(l,a)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,o,n,r,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(n=(n=l.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){l.label=r[1];break}if(6===r[0]&&l.label<n[1]){l.label=n[1],n=r;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(r);break}n[2]&&l.ops.pop(),l.trys.pop();continue}r=e.call(t,l)}catch(a){r=[6,a],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=window.GlobalData.sample,c=s.loadBundle,d=s.loadPrefab,h=s.loadResource,u=cc._decorator,p=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colliderBox=[],e._collideredBox=[],e._cache={},e._scheduleTime=.3,e._dragging=!1,e._answer=0,e._state={},e}return n(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this.updateUi(this._state,t),this._state=t,this.mergeState()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._worldRoot=cc.find("Canvas").parent,this._view.y=(fgui.GRoot.inst.height-this._view.height)/2,this._view.x=(fgui.GRoot.inst.width-this._view.width)/2,fgui.GRoot.inst.addChild(this._view),this._c1=this._view.getController("c1"),this._c2=this._view.getController("c2"),this._c2&&(this._c2.selectedIndex=1,this._c2.selectedIndex=0),this._submit=this._view.getChild("submit").asButton,this._submit&&this._submit.on(fgui.Event.CLICK,this._clickSubmit,this),this._title=this._view.getChild("title").asButton,this._titleTrigger=this._view.getChild("titleTrigger").asLoader,this._titleTrigger&&this._titleTrigger.on(fgui.Event.CLICK,this._clickTitle,this);var t=this._view.getChild("colliderBox").asGroup,e=this._view.getChild("collideredBox").asGroup;this._cache.colliderBox=[];for(var i=0;i<this._view.numChildren;i++)if(this._view.getChildAt(i).group==t){var o=this._view.getChildAt(i).asButton;this._cache.colliderBox.push({x:o.x,y:o.y,belong:null}),o.draggable=!0,o.on(fgui.Event.TOUCH_BEGIN,this._onDragStart,this),o.on(fgui.Event.TOUCH_MOVE,this._onDragMove,this),o.on(fgui.Event.TOUCH_END,this._onDragEnd,this),this._colliderBox.push(o)}for(i=0;i<this._view.numChildren;i++)this._view.getChildAt(i).group==e&&(o=this._view.getChildAt(i).asButton,this._collideredBox.push(o));this._state={drag:"end",collider:this._cache.colliderBox.map(function(t){return t}),colliderIndex:null,title:!1,submit:!1,answer:!1},this.disableForbidHandle()},e.prototype.init=function(t){return l(this,void 0,void 0,function(){var e,i,o,n,r,l,s,h,u,p,f,g,_,y,b,v;return a(this,function(a){switch(a.label){case 0:if(e=t.pathConfig,i=t.model,o=t.components,n=e.packageName,i.uiPath&&(r=i.uiPath,this._view=fgui.UIPackage.createObject(n,r).asCom),i.config&&(l=i.config,s=l.answer,h=l.ae,s&&(this._answer=s),h))for(u in h)h[u]&&(this[u]={},h[u].component&&(this[u].component=fgui.UIPackage.createObject(n,h[u].component).asCom),h[u].pos&&(this[u].pos=h[u].pos));if(!o)return[3,5];for(f in p=[],o)p.push(f);g=0,a.label=1;case 1:return g<p.length?(_=p[g],y=""+e.remoteUrl+e.componentBundlePath+o[_].bundleName,[4,c(y)]):[3,5];case 2:return b=a.sent(),[4,d(b,o[_].prefabName)];case 3:v=a.sent(),this[_]=v,a.label=4;case 4:return g++,[3,1];case 5:return[2]}})})},e.prototype.getOriginValue=function(t){return{x:t.x,y:t.y}},e.prototype._onDragStart=function(t){t.captureTouch();var e=globalThis._.cloneDeep(this._state),i=fgui.GObject.cast(t.currentTarget),o=this._colliderBox.findIndex(function(t){return t==i});e.colliderIndex=o,this.updateState(e)},e.prototype._onDragMove=function(){this._dragging=!0},e.prototype._onDragEnd=function(t){var e=this;if(this._dragging){this._dragging=!1;var i,o=fgui.GObject.cast(t.currentTarget),n=this._colliderBox.findIndex(function(t){return t==o}),r=[];this._collideredBox.forEach(function(t){1==e._belongArea(o,t,110)&&r.push(t)}),r.forEach(function(t,n){if(0==n)i=t;else{var l=e._getDistance(o,r[n-1]);e._getDistance(o,t)<l&&(i=t)}});var l=this._collideredBox.findIndex(function(t){return t==i}),a=globalThis._.cloneDeep(this._state);if(-1==l)a.collider[n]={x:this._cache.colliderBox[n].x,y:this._cache.colliderBox[n].y,belong:null};else{var s=this._collideredBox[l].x+this._collideredBox[l].width/2-this._colliderBox[n].width/2,c=this._collideredBox[l].y+this._collideredBox[l].height/2-this._colliderBox[n].height/2,d=a.collider.find(function(t){return t.x==s&&Math.abs(t.y-c)<55});a.collider[n]={x:d?this._cache.colliderBox[n].x:s,y:d?this._cache.colliderBox[n].y:c,belong:d?null:l}}a.submit=!1,a.drag="end",a.colliderIndex=n,this.updateState(a)}},e.prototype._clickTitle=function(){var t=globalThis._.cloneDeep(this._state);t.title=!0,this.updateState(t)},e.prototype._clickSubmit=function(){var t=globalThis._.cloneDeep(this._state),e=t.collider.map(function(t){return t.belong}).filter(function(t){return t||0===t}).join("");t.answer=e==this._answer,t.submit=!0,this.updateState(t)},e.prototype.getState=function(t){this.updateState(t)},e.prototype.updateState=function(t){globalThis._.isEqual(this._state,t)||(this.state=t)},e.prototype.updateUi=function(t,e){if("move"==e.drag&&(this._colliderBox[e.colliderIndex].x=e.collider[e.colliderIndex].x,this._colliderBox[e.colliderIndex].y=e.collider[e.colliderIndex].y),"end"==e.drag){if(!globalThis._.isEqual(t.collider,e.collider))for(var i=0;i<e.collider.length;i++)this._colliderBox[i].x=e.collider[i].x,this._colliderBox[i].y=e.collider[i].y;if(globalThis._.isEqual(t.title,e.title)||this.playTitle(e.title),!globalThis._.isEqual(t.submit,e.submit)&&e.submit){var o=this._colliderBox.map(function(t){return{x:t.x,y:t.y}});this._cache.colliderBox.every(function(t,e){return t.x==o[e].x&&t.y==o[e].y})?this.onHandleGuide():this.onFlicker(e.answer)}}},e.prototype.playTitle=function(t){return l(this,void 0,void 0,function(){var e,i,o,n=this;return a(this,function(r){switch(r.label){case 0:return this._c2.selectedIndex=t?1:0,t?(cc.audioEngine.stopAll(),this.forbidHandle(),e=fgui.UIPackage.getItemByURL(this._title._sound),[4,h(e.file,cc.AudioClip)]):[3,2];case 1:return i=r.sent(),o=cc.audioEngine.play(i,!1,1),cc.audioEngine.setFinishCallback(o,function(){var t=globalThis._.cloneDeep(n._state);t.title=!1,n.updateState(t)}),[3,3];case 2:this.disableForbidHandle(),r.label=3;case 3:return[2]}})})},e.prototype._getDistance=function(t,e){var i=t.x+t.width/2-(e.x+e.width/2),o=t.y+t.height/2-(e.y+e.height/2);return Math.sqrt(i*i+o*o)},e.prototype._belongArea=function(t,e,i){void 0===i&&(i=10);var o=t.x+t.width/2-(e.x+e.width/2),n=t.y+t.height/2-(e.y+e.height/2);return Math.sqrt(o*o+n*n)<i},e.prototype.answerFeedback=function(t){var e=this;if(this.feedback){var i=globalThis._.cloneDeep(this._state),o=cc.instantiate(this.feedback);o.x=960,o.y=540,o.getComponent(cc.Component).init(t),o.parent=cc.find("Canvas").parent,setTimeout(function(){e.disableForbidHandle(),o.destroy(),i.submit=!1,e.updateState(i)},2e3)}},e.prototype.onFlicker=function(t){var e=this;this._view.getTransition("t0").play(function(){e.answerFeedback(t)})},e.prototype.onHandleGuide=function(){var t=this;if(this.handleGuide){var e=globalThis._.cloneDeep(this._state);fgui.GRoot.inst.addChild(this.handleGuide.component),this.handleGuide.pos?(this.handleGuide.component.x=(fgui.GRoot.inst.width-this.handleGuide.component.width)/2+this.handleGuide.pos.x,this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2+this.handleGuide.pos.y):this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2,this.handleGuide.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.handleGuide.component),e.submit=!1,t.updateState(e)},2)}},e.prototype.forbidHandle=function(){if(!this._worldRoot.getChildByName("handleMask")){var t=new cc.Node("handleMask");t.addComponent(cc.BlockInputEvents),t.parent=this._worldRoot,t.width=1920,t.height=1080,t.x=960,t.y=540}},e.prototype.disableForbidHandle=function(){var t=this._worldRoot.getChildByName("handleMask");t&&t.destroy()},e.prototype.dragSchedule=function(){if(this._dragging){var t=globalThis._.cloneDeep(this._state);t.drag="move",t.collider[t.colliderIndex]={x:this._colliderBox[t.colliderIndex].x,y:this._colliderBox[t.colliderIndex].y},this.updateState(t)}},e.prototype.registerState=function(){window.GlobalData.sample.registerState&&window.GlobalData.sample.registerState.call(this)},e.prototype.relieveState=function(){window.GlobalData.sample.relieveState&&window.GlobalData.sample.relieveState.call(this)},e.prototype.mergeState=function(){window.GlobalData.sample.mergeState&&window.GlobalData.sample.mergeState.call(this)},e.prototype.onEnable=function(){this.registerState(),this.schedule(this.dragSchedule,this._scheduleTime)},e.prototype.onDisable=function(){this.relieveState(),cc.audioEngine.stopAll()},r([p],e)}(cc.Component));i.default=f,cc._RF.pop()},{}],"dragAnswer-model02-v1":[function(t,e,i){"use strict";cc._RF.push(e,"761b7tA1DZDbZlu/VVG4SVi","dragAnswer-model02-v1");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,l=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(r<3?n(l):r>3?n(e,i,l):n(e,i))||l);return r>3&&l&&Object.defineProperty(e,i,l),l},l=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function l(t){try{s(o.next(t))}catch(e){r(e)}}function a(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(l,a)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,o,n,r,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(n=(n=l.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){l.label=r[1];break}if(6===r[0]&&l.label<n[1]){l.label=n[1],n=r;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(r);break}n[2]&&l.ops.pop(),l.trys.pop();continue}r=e.call(t,l)}catch(a){r=[6,a],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=window.GlobalData.sample,c=s.loadBundle,d=s.loadPrefab,h=s.loadResource,u=cc._decorator,p=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colliderBox=[],e._collideredBox=[],e._cache={},e._scheduleTime=.3,e._dragging=!1,e._answer=0,e._state={},e}return n(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this.updateUi(this._state,t),this._state=t,this.mergeState()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._worldRoot=cc.find("Canvas").parent,this._view.y=(fgui.GRoot.inst.height-this._view.height)/2,this._view.x=(fgui.GRoot.inst.width-this._view.width)/2,fgui.GRoot.inst.addChild(this._view),this._c1=this._view.getController("c1"),this._c2=this._view.getController("c2"),this._c2&&(this._c2.selectedIndex=1,this._c2.selectedIndex=0),this._title=this._view.getChild("title").asButton,this._titleTrigger=this._view.getChild("titleTrigger").asLoader,this._titleTrigger&&this._titleTrigger.on(fgui.Event.CLICK,this._clickTitle,this),this._robot=this._view.getChild("robot").asLoader,this._dyUI=this._view.getChild("dyUI").asGroup,this._colliderGroup=this._view.getChild("colliderBox").asGroup,this._collideredGroup=this._view.getChild("collideredBox").asGroup,this._cache.colliderBox=[];for(var t=0;t<this._view.numChildren;t++)if(this._view.getChildAt(t).group==this._colliderGroup){var e=this._view.getChildAt(t).asButton;this._cache.colliderBox.push({x:e.x,y:e.y}),e.draggable=!0,e.on(fgui.Event.TOUCH_BEGIN,this._onDragStart,this),e.on(fgui.Event.TOUCH_MOVE,this._onDragMove,this),e.on(fgui.Event.TOUCH_END,this._onDragEnd,this),this._colliderBox.push(e)}for(t=0;t<this._view.numChildren;t++)this._view.getChildAt(t).group==this._collideredGroup&&(e=this._view.getChildAt(t).asButton,this._collideredBox.push(e));this._state={drag:"end",title:!1,collider:this._cache.colliderBox.map(function(t){return t}),colliderIndex:null,answer:!1,submit:!1},this.disableForbidHandle()},e.prototype.init=function(t){return l(this,void 0,void 0,function(){var e,i,o,n,r,l,s,h,u,p,f,g,_,y,b,v;return a(this,function(a){switch(a.label){case 0:if(e=t.pathConfig,i=t.model,o=t.components,n=e.packageName,i.uiPath&&(r=i.uiPath,this._view=fgui.UIPackage.createObject(n,r).asCom),i.config&&(l=i.config,s=l.answer,h=l.ae,s&&(this._answer=s),h))for(u in h)h[u]&&(this[u]={},h[u].component&&(this[u].component=fgui.UIPackage.createObject(n,h[u].component).asCom),h[u].pos&&(this[u].pos=h[u].pos));if(!o)return[3,5];for(f in p=[],o)p.push(f);g=0,a.label=1;case 1:return g<p.length?(_=p[g],y=""+e.remoteUrl+e.componentBundlePath+o[_].bundleName,[4,c(y)]):[3,5];case 2:return b=a.sent(),[4,d(b,o[_].prefabName)];case 3:v=a.sent(),this[_]=v,a.label=4;case 4:return g++,[3,1];case 5:return[2]}})})},e.prototype.getOriginValue=function(t){return{x:t.x,y:t.y}},e.prototype._onDragStart=function(t){t.captureTouch();var e=globalThis._.cloneDeep(this._state),i=fgui.GObject.cast(t.currentTarget),o=this._colliderBox.findIndex(function(t){return t==i});e.colliderIndex=o,this.updateState(e)},e.prototype._onDragMove=function(){this._dragging=!0},e.prototype._onDragEnd=function(t){var e=this;if(this._dragging){this._dragging=!1;var i=fgui.GObject.cast(t.currentTarget),o=this._colliderBox.findIndex(function(t){return t==i}),n=this._adsorb(i,o),r=globalThis._.cloneDeep(this._state);if(n.bool)r.collider[o]={x:n.pos.x,y:n.pos.y};else for(var l=0;l<this._colliderBox.length;l++)i==this._colliderBox[l]&&(r.collider[o]={x:this._cache.colliderBox[l].x,y:this._cache.colliderBox[l].y});r.drag="end",r.colliderIndex=o;var a=r.collider.every(function(t,i){return!globalThis._.isEqual(t,e._cache.colliderBox[i])});r.answer=a,a&&(r.submit=!0),this.updateState(r)}},e.prototype._adsorb=function(t,e){for(var i,o,n,r,l=0;l<this._collideredBox.length;l++)i=t.x-this._collideredBox[l].x,o=t.y-this._collideredBox[l].y,n?n>Math.sqrt(i*i+o*o)&&(n=Math.sqrt(i*i+o*o),r=l):(n=Math.sqrt(i*i+o*o),r=l);return{bool:n<65&&e==r,s:r,pos:{x:this._collideredBox[r].x,y:this._collideredBox[r].y}}},e.prototype._clickTitle=function(){var t=globalThis._.cloneDeep(this._state);t.title=!0,this.updateState(t)},e.prototype.getState=function(t){this.updateState(t)},e.prototype.updateState=function(t){globalThis._.isEqual(this._state,t)||(this.state=t)},e.prototype.updateUi=function(t,e){if("move"==e.drag&&(this._colliderBox[e.colliderIndex].x=e.collider[e.colliderIndex].x,this._colliderBox[e.colliderIndex].y=e.collider[e.colliderIndex].y),"end"==e.drag){if(!globalThis._.isEqual(t.collider,e.collider))for(var i=0;i<e.collider.length;i++)this._colliderBox[i].x=e.collider[i].x,this._colliderBox[i].y=e.collider[i].y;globalThis._.isEqual(t.title,e.title)||this.playTitle(e.title),globalThis._.isEqual(t.answer,e.answer)||e.answer&&this.transfer(e.answer)}},e.prototype.playTitle=function(t){return l(this,void 0,void 0,function(){var e,i,o,n=this;return a(this,function(r){switch(r.label){case 0:return this._c2.selectedIndex=t?1:0,t?(cc.audioEngine.stopAll(),this.forbidHandle(),e=fgui.UIPackage.getItemByURL(this._title._sound),[4,h(e.file,cc.AudioClip)]):[3,2];case 1:return i=r.sent(),o=cc.audioEngine.play(i,!1,1),cc.audioEngine.setFinishCallback(o,function(){var t=globalThis._.cloneDeep(n._state);t.title=!1,n.updateState(t)}),[3,3];case 2:this.disableForbidHandle(),r.label=3;case 3:return[2]}})})},e.prototype.transfer=function(t){var e=this;this.forbidHandle(),this._dyUI.visible=!1,this._colliderGroup.visible=!1,this._collideredGroup.visible=!1,this._robot.visible=!0,this._robot.playing=!0,setTimeout(function(){e._dyUI.visible=!0,e._colliderGroup.visible=!0,e._collideredGroup.visible=!0,e._robot.visible=!1,e._robot.playing=!1,e.answerFeedback(t)},3e3)},e.prototype.answerFeedback=function(t){var e=this;if(this.feedback){var i=globalThis._.cloneDeep(this._state),o=cc.instantiate(this.feedback);o.x=960,o.y=540,o.getComponent(cc.Component).init(t),o.parent=cc.find("Canvas").parent,setTimeout(function(){e.disableForbidHandle(),o.destroy(),i.submit=!1,e.updateState(i)},2e3)}},e.prototype.onLibraHint=function(){var t=this;this.lineBlink&&(fgui.GRoot.inst.addChild(this.lineBlink.component),this.lineBlink.pos?(this.lineBlink.component.x=(fgui.GRoot.inst.width-this.lineBlink.component.width)/2+this.lineBlink.pos.x,this.lineBlink.component.y=(fgui.GRoot.inst.height-this.lineBlink.component.height)/2+this.lineBlink.pos.y):this.lineBlink.component.y=(fgui.GRoot.inst.height-this.lineBlink.component.height)/2,this.lineBlink.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.lineBlink.component)}))},e.prototype.onHandleGuide=function(){var t=this;if(this.handleGuide){var e=globalThis._.cloneDeep(this._state);fgui.GRoot.inst.addChild(this.handleGuide.component),this.handleGuide.pos?(this.handleGuide.component.x=(fgui.GRoot.inst.width-this.handleGuide.component.width)/2+this.handleGuide.pos.x,this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2+this.handleGuide.pos.y):this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2,this.handleGuide.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.handleGuide.component),e.submit=!1,t.updateState(e)},2)}},e.prototype.forbidHandle=function(){if(!this._worldRoot.getChildByName("handleMask")){var t=new cc.Node("handleMask");t.addComponent(cc.BlockInputEvents),t.parent=this._worldRoot,t.width=1920,t.height=1080,t.x=960,t.y=540}},e.prototype.disableForbidHandle=function(){var t=this._worldRoot.getChildByName("handleMask");t&&t.destroy()},e.prototype.dragSchedule=function(){if(this._dragging){var t=globalThis._.cloneDeep(this._state);t.drag="move",t.collider[t.colliderIndex]={x:this._colliderBox[t.colliderIndex].x,y:this._colliderBox[t.colliderIndex].y},this.updateState(t)}},e.prototype.registerState=function(){window.GlobalData.sample.registerState&&window.GlobalData.sample.registerState.call(this)},e.prototype.relieveState=function(){window.GlobalData.sample.relieveState&&window.GlobalData.sample.relieveState.call(this)},e.prototype.mergeState=function(){window.GlobalData.sample.mergeState&&window.GlobalData.sample.mergeState.call(this)},e.prototype.onEnable=function(){this.registerState(),this.schedule(this.dragSchedule,this._scheduleTime)},e.prototype.onDisable=function(){this.relieveState(),cc.audioEngine.stopAll()},r([p],e)}(cc.Component));i.default=f,cc._RF.pop()},{}],"dragAnswer-model03-v1":[function(t,e,i){"use strict";cc._RF.push(e,"8f16fRyLKlMTrYGR9nh/Pf7","dragAnswer-model03-v1");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,l=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(r<3?n(l):r>3?n(e,i,l):n(e,i))||l);return r>3&&l&&Object.defineProperty(e,i,l),l},l=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function l(t){try{s(o.next(t))}catch(e){r(e)}}function a(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(l,a)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,o,n,r,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(n=(n=l.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){l.label=r[1];break}if(6===r[0]&&l.label<n[1]){l.label=n[1],n=r;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(r);break}n[2]&&l.ops.pop(),l.trys.pop();continue}r=e.call(t,l)}catch(a){r=[6,a],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=window.GlobalData.sample,c=s.loadBundle,d=s.loadPrefab,h=s.loadResource,u=(window.GlobalData.utils.pointBelongArea,cc._decorator),p=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colliderBox=[],e._collideredBox=[],e._cache={},e._scheduleTime=.3,e._dragging=!1,e._answer=0,e._dragIconArr=[],e._footNum=[],e._state={},e}return n(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this.updateUi(this._state,t),this._state=t,this.mergeState()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){var t=this;this._worldRoot=cc.find("Canvas").parent,this._view.y=(fgui.GRoot.inst.height-this._view.height)/2,this._view.x=(fgui.GRoot.inst.width-this._view.width)/2,fgui.GRoot.inst.addChild(this._view),this._c1=this._view.getController("c1"),this._c2=this._view.getController("c2"),this._c2&&(this._c2.selectedIndex=1,this._c2.selectedIndex=0),t.createUI(),t.addEvent(),this._state={drag:"end",getDropArr:[],collider:t._cache.colliderBox.map(function(t){return t}),colliderIndex:null,collidered:this._cache.collideredBox.map(function(t){return t}),dropArr:[],title:!1,submit:!1,answer:!1},this.disableForbidHandle()},e.prototype.createUI=function(){var t=this;this._submit=this._view.getChild("submit").asButton,this._submit&&this._submit.on(fgui.Event.CLICK,this._clickSubmit,this),this._title=this._view.getChild("title").asButton,this._titleTrigger=this._view.getChild("titleTrigger").asLoader,this._titleTrigger&&this._titleTrigger.on(fgui.Event.CLICK,this._clickTitle,this);var e=this._view.getChild("colliderBox").asGroup,i=this._view.getChild("collideredBox").asGroup;t._cache.colliderBox=[];for(var o=0;o<this._view.numChildren;o++)if(t._view.getChildAt(o).group==e){var n=this._view.getChildAt(o).asButton;t._cache.colliderBox.push({x:n.x,y:n.y,belong:null}),n.collideredIndex=-1,n.draggable=!0,n.on(fgui.Event.TOUCH_BEGIN,this._onDragStart,this),n.on(fgui.Event.TOUCH_MOVE,this._onDragMove,this),n.on(fgui.Event.TOUCH_END,this._onDragEnd,this),this._colliderBox.push(n)}for(t._cache.collideredBox=[],o=0;o<this._view.numChildren;o++)this._view.getChildAt(o).group==i&&(n=this._view.getChildAt(o).asImage,t._cache.collideredBox.push([]),this._collideredBox.push(n))},e.prototype.addEvent=function(){},e.prototype.init=function(t){return l(this,void 0,void 0,function(){var e,i,o,n,r,l,s,h,u,p,f,g,_,y,b,v,w,m;return a(this,function(a){switch(a.label){case 0:if((e=this).pageData=t,i=t.pathConfig,o=t.model,n=t.components,r=i.packageName,l=o.uiPath,s=o.config,h=s.answer,u=s.ae,p=s.dragIcon,o.uiPath&&(l=o.uiPath,this._view=fgui.UIPackage.createObject(r,l).asCom),o.config){if(u)for(f in u)u[f]&&(this[f]={},u[f].component&&(this[f].component=fgui.UIPackage.createObject(r,u[f].component).asCom),u[f].pos&&(this[f].pos=u[f].pos));if(h&&(e._answer=h),p)for(b in p)e._footNum.push(p[b].footNum)}if(!n)return[3,5];for(_ in g=[],n)g.push(_);y=0,a.label=1;case 1:return y<g.length?(b=g[y],v=""+i.remoteUrl+i.componentBundlePath+n[b].bundleName,[4,c(v)]):[3,5];case 2:return w=a.sent(),[4,d(w,n[b].prefabName)];case 3:m=a.sent(),this[b]=m,a.label=4;case 4:return y++,[3,1];case 5:return[2]}})})},e.prototype.getOriginValue=function(t){return{x:t.x,y:t.y}},e.prototype._onDragStart=function(t){var e=this,i=fgui.GObject.cast(t.currentTarget);e._view.setChildIndex(i,e._view.numChildren-1);var o=e._colliderBox.findIndex(function(t){return t==i}),n=globalThis._.cloneDeep(e._state);n.colliderIndex=o,e.updateState(n)},e.prototype._onDragMove=function(){this._dragging=!0},e.prototype._onDragEnd=function(t){var e=this,i=this;if(this._dragging){this._dragging=!1;var o,n=fgui.GObject.cast(t.currentTarget),r=this._colliderBox.findIndex(function(t){return t==n}),l=[];this._collideredBox.forEach(function(t){i.isCollisionWithRect(t,n)&&l.push(t)}),l.forEach(function(t,i){if(0==i)o=t;else{var r=e._getDistance(n,l[i-1]);e._getDistance(n,t)<r&&(o=t)}});var a=this._collideredBox.findIndex(function(t){return t==o}),s=globalThis._.cloneDeep(this._state),c=globalThis._.cloneDeep(s);console.log("origin state = ",this._state.dropArr),console.log("clone state = ",s.dropArr),console.log("sss = ",c.dropArr);var d=s.dropArr,h=n.name,u=d.findIndex(function(t){return t.name==h});console.warn("dropArrIndex = ",u),-1==a||6==d.length?(u>-1&&d.splice(u,1),s.collider[r]={x:i._cache.colliderBox[r].x,y:i._cache.colliderBox[r].y},a=n.collideredIndex>-1?n.collideredIndex:0):-1==u&&d.push({name:n.name});for(var p=0,f=function(t){var e=d[t],o=i._colliderBox.findIndex(function(t){return t.name==e.name}),n=new cc.Vec2,r=i._collideredBox[a],l=i._view.getChild(e.name);e.name.indexOf("left")>-1?p+=i._footNum[0]:e.name.indexOf("right")>-1&&(p+=i._footNum[1]),n.x=r.x+150+200*t,n.y=r.y+r.height-l.height,s.collider[o]={x:n.x,y:n.y,belong:a}},g=0;g<d.length;g++)f(g);n.collideredIndex=a,s.drag="end",s.submit=!1,s.colliderIndex=r,console.log("\u7ed9state\u8d4b\u503c\u524d\u7684",d),s.dropArr=d,console.warn("\u8d4b\u503c\u540e\u7684",s.dropArr),s.answer=p==i._answer,i.updateState(s),console.log("------------------------------------------------")}},e.prototype._getDistance=function(t,e){var i=t.x+t.width/2-(e.x+e.width/2),o=t.y+t.height/2-(e.y+e.height/2);return Math.sqrt(i*i+o*o)},e.prototype.isCollisionWithRect=function(t,e){return!(t.x>=e.x&&t.x>=e.x+e.width||t.x<=e.x&&t.x+t.width<=e.x||t.y>=e.y&&t.y>=e.y+e.height||t.y<=e.y&&t.y+t.height<=e.y)},e.prototype._belongArea=function(t,e,i){void 0===i&&(i=10);var o=t.x+t.width/2-(e.x+e.width/2),n=t.y+t.height/2-(e.y+e.height/2);return Math.sqrt(o*o+n*n)<i},e.prototype._clickTitle=function(){var t=globalThis._.cloneDeep(this._state);t.title=!0,this.updateState(t)},e.prototype._clickSubmit=function(){return l(this,void 0,void 0,function(){var t;return a(this,function(){return(t=globalThis._.cloneDeep(this._state)).submit=!0,this.updateState(t),[2]})})},e.prototype.getState=function(t){this.updateState(t)},e.prototype.updateState=function(t){globalThis._.isEqual(this._state,t)||(this.state=t)},e.prototype.updateUi=function(t,e){if("move"==e.drag&&(this._colliderBox[e.colliderIndex].x=e.collider[e.colliderIndex].x,this._colliderBox[e.colliderIndex].y=e.collider[e.colliderIndex].y),"end"==e.drag){if(!globalThis._.isEqual(t.collider,e.collider)){console.log("endddddddddd update ui",e);for(var i=0;i<e.collider.length;i++)this._colliderBox[i].x=e.collider[i].x,this._colliderBox[i].y=e.collider[i].y}globalThis._.isEqual(t.submit,e.submit)||(console.log("submittttttt"),e.submit&&this.answerFeedback(e.answer)),globalThis._.isEqual(t.title,e.title)||this.playTitle(e.title)}},e.prototype.playTitle=function(t){return l(this,void 0,void 0,function(){var e,i,o,n=this;return a(this,function(r){switch(r.label){case 0:return this._c2.selectedIndex=t?1:0,t?(cc.audioEngine.stopAll(),this.forbidHandle(),e=fgui.UIPackage.getItemByURL(this._title._sound),[4,h(e.file,cc.AudioClip)]):[3,2];case 1:return i=r.sent(),o=cc.audioEngine.play(i,!1,1),cc.audioEngine.setFinishCallback(o,function(){var t=globalThis._.cloneDeep(n._state);t.title=!1,n.updateState(t)}),[3,3];case 2:this.disableForbidHandle(),r.label=3;case 3:return[2]}})})},e.prototype.answerFeedback=function(t){var e=this;if(this.feedback){var i=globalThis._.cloneDeep(this._state),o=cc.instantiate(this.feedback);o.x=960,o.y=540,o.getComponent(cc.Component).init(t),o.parent=cc.find("Canvas").parent,setTimeout(function(){o.destroy(),i.submit=!1,e.updateState(i)},2e3)}},e.prototype.onHandleGuide=function(){var t=this;if(this.handleGuide){var e=globalThis._.cloneDeep(this._state);fgui.GRoot.inst.addChild(this.handleGuide.component),this.handleGuide.pos?(this.handleGuide.component.x=(fgui.GRoot.inst.width-this.handleGuide.component.width)/2+this.handleGuide.pos.x,this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2+this.handleGuide.pos.y):this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2,this.handleGuide.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.handleGuide.component),e.submit=!1,t.updateState(e)},2)}},e.prototype.forbidHandle=function(){if(!this._worldRoot.getChildByName("handleMask")){var t=new cc.Node("handleMask");t.addComponent(cc.BlockInputEvents),t.parent=this._worldRoot,t.width=1920,t.height=1080,t.x=960,t.y=540}},e.prototype.disableForbidHandle=function(){var t=this._worldRoot.getChildByName("handleMask");t&&t.destroy()},e.prototype.dragSchedule=function(){var t=this;if(t._dragging){var e=globalThis._.cloneDeep(t._state);e.drag="move",e.collider[e.colliderIndex]={x:this._colliderBox[e.colliderIndex].x,y:this._colliderBox[e.colliderIndex].y},t.updateState(e)}},e.prototype.registerState=function(){window.GlobalData.sample.registerState&&window.GlobalData.sample.registerState.call(this)},e.prototype.relieveState=function(){window.GlobalData.sample.relieveState&&window.GlobalData.sample.relieveState.call(this)},e.prototype.mergeState=function(){window.GlobalData.sample.mergeState&&window.GlobalData.sample.mergeState.call(this)},e.prototype.onEnable=function(){this.registerState(),this.schedule(this.dragSchedule,this._scheduleTime)},e.prototype.onDisable=function(){this.relieveState(),cc.audioEngine.stopAll()},r([p],e)}(cc.Component));i.default=f,cc._RF.pop()},{}],"dragAnswer-model03-v2":[function(t,e,i){"use strict";cc._RF.push(e,"80551sdOSRDM5dpZFjboMyK","dragAnswer-model03-v2");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,l=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(r<3?n(l):r>3?n(e,i,l):n(e,i))||l);return r>3&&l&&Object.defineProperty(e,i,l),l},l=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function l(t){try{s(o.next(t))}catch(e){r(e)}}function a(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(l,a)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,o,n,r,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(n=(n=l.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){l.label=r[1];break}if(6===r[0]&&l.label<n[1]){l.label=n[1],n=r;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(r);break}n[2]&&l.ops.pop(),l.trys.pop();continue}r=e.call(t,l)}catch(a){r=[6,a],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=window.GlobalData.sample,c=s.loadBundle,d=s.loadPrefab,h=s.loadResource,u=(window.GlobalData.utils.pointBelongArea,cc._decorator),p=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colliderBox=[],e._collideredBox=[],e._cache={},e._scheduleTime=.3,e._dragging=!1,e._gameType=0,e._roleCount=0,e._state={},e}return n(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this.updateUi(this._state,t),this._state=t,this.mergeState()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){var t=this;this._worldRoot=cc.find("Canvas").parent,this._view.y=(fgui.GRoot.inst.height-this._view.height)/2,this._view.x=(fgui.GRoot.inst.width-this._view.width)/2,fgui.GRoot.inst.addChild(this._view),this._c1=this._view.getController("c1"),this._c2=this._view.getController("c2"),this._c2&&(this._c2.selectedIndex=1,this._c2.selectedIndex=0),t.createUI(),t.addEvent(),this._state={drag:"end",getDropArr:[],collider:t._cache.colliderBox.map(function(t){return t}),colliderIndex:null,collidered:this._cache.collideredBox.map(function(t){return t}),dropArr:[],title:!1,submit:!1,answer:!1},this.disableForbidHandle()},e.prototype.createUI=function(){var t=this;this._submit=this._view.getChild("submit").asButton,this._submit&&this._submit.on(fgui.Event.CLICK,this._clickSubmit,this),this._title=this._view.getChild("title").asButton,this._titleTrigger=this._view.getChild("titleTrigger").asLoader,this._titleTrigger&&this._titleTrigger.on(fgui.Event.CLICK,this._clickTitle,this);var e=this._view.getChild("colliderBox").asGroup,i=this._view.getChild("collideredBox").asGroup;t._cache.colliderBox=[];for(var o=0;o<this._view.numChildren;o++)if(t._view.getChildAt(o).group==e){var n=this._view.getChildAt(o).asButton;t._cache.colliderBox.push({x:n.x,y:n.y,collideredIndex:-1,roleType:n.data}),n.collideredIndex=-1,n.draggable=!0,n.on(fgui.Event.TOUCH_BEGIN,this._onDragStart,this),n.on(fgui.Event.TOUCH_MOVE,this._onDragMove,this),n.on(fgui.Event.TOUCH_END,this._onDragEnd,this),this._colliderBox.push(n)}for(t._cache.collideredBox=[],o=0;o<this._view.numChildren;o++)this._view.getChildAt(o).group==i&&(n=this._view.getChildAt(o).asCom,t._cache.collideredBox.push([]),this._collideredBox.push(n))},e.prototype.addEvent=function(){},e.prototype.init=function(t){return l(this,void 0,void 0,function(){var e,i,o,n,r,l,s,h,u,p,f,g,_,y,b,v,w,m,x,B;return a(this,function(a){switch(a.label){case 0:if((e=this).pageData=t,i=t.pathConfig,o=t.model,n=t.components,r=i.packageName,l=o.uiPath,s=o.config,h=s.answer,u=s.roleUrl,p=s.ae,f=s.gameType,g=s.roleCount,o.uiPath&&(l=o.uiPath,this._view=fgui.UIPackage.createObject(r,l).asCom),o.config&&(h&&(e._answer=h),u&&(e._roleUrl=u),f&&(e._gameType=f),g&&(e._roleCount=g),p))for(_ in p)p[_]&&(this[_]={},p[_].component&&(this[_].component=fgui.UIPackage.createObject(r,p[_].component).asCom),p[_].pos&&(this[_].pos=p[_].pos));if(!n)return[3,5];for(b in y=[],n)y.push(b);v=0,a.label=1;case 1:return v<y.length?(w=y[v],m=""+i.remoteUrl+i.componentBundlePath+n[w].bundleName,[4,c(m)]):[3,5];case 2:return x=a.sent(),[4,d(x,n[w].prefabName)];case 3:B=a.sent(),this[w]=B,a.label=4;case 4:return v++,[3,1];case 5:return[2]}})})},e.prototype.getOriginValue=function(t){return{x:t.x,y:t.y}},e.prototype._onDragStart=function(t){var e=this;t.captureTouch(),e.playSound("ui://rokozlzwkxox11");var i=fgui.GObject.cast(t.currentTarget);e._view.setChildIndex(i,e._view.numChildren-1);var o=e._colliderBox.findIndex(function(t){return t==i}),n=globalThis._.cloneDeep(e._state),r=n.collider[o].collideredIndex;if(-1!=r){var l=n.collidered.findIndex(function(t){return t.name==i.name});n.collidered[r].splice(l,1)}n.colliderIndex=o,e.updateState(n),e.showTips(!0)},e.prototype._onDragMove=function(){this._dragging=!0},e.prototype._onDragEnd=function(t){var e=this,i=this;if(i.showTips(!1),i.playSound("ui://rokozlzwku3e2t"),this._dragging){this._dragging=!1;var o,n=fgui.GObject.cast(t.currentTarget),r=this._colliderBox.findIndex(function(t){return t==n}),l=[];this._collideredBox.forEach(function(t){i.isCollisionWithRect(t,n)&&l.push(t)}),l.forEach(function(t,i){if(0==i)o=t;else{var r=e._getDistance(n,l[i-1]);e._getDistance(n,t)<r&&(o=t)}});var a=this._collideredBox.findIndex(function(t){return t==o});console.log("collideredIndex = ",a);var s=globalThis._.cloneDeep(this._state),c=s.collidered[a],d=n.name;if(-1!=a){var h=o.name;console.log("colliderName = ",d),console.log("collideredName = ",h);var u,p=2==i._gameType||d.indexOf("head")>-1&&h.indexOf("dropBox1")>-1||d.indexOf("foot")>-1&&h.indexOf("dropBox2")>-1;u=a<i._roleCount?a+i._roleCount:a-i._roleCount;var f=s.collidered[u];1==i._gameType&&(!p||f.length>0&&f[0].roleType!=n.data)&&(a=-1)}if(n.collideredIndex=a,-1==a)s.collider[r]={x:i._cache.colliderBox[r].x,y:i._cache.colliderBox[r].y,collideredIndex:-1,roleType:s.collider[r].roleType};else{if(1==c.length){var g=c.splice(0,1);console.log(g[0]);var _=this._colliderBox.findIndex(function(t){return t.name==g[0].name});s.collider[_]={x:i._cache.colliderBox[_].x,y:i._cache.colliderBox[_].y,collideredIndex:-1,roleType:s.collider[_].roleType}}c.push({name:d,roleType:n.data,collideredIndex:a}),s.collider[r]={x:i._collideredBox[a].x,y:i._collideredBox[a].y,collideredIndex:a,roleType:s.collider[a].roleType},s.collidered[a]=c}s.drag="end",s.submit=!1,s.colliderIndex=r,console.log("\u7ed9state\u8d4b\u503c\u524d\u7684",c),console.warn("\u8d4b\u503c\u540e\u7684",s.dropArr),i.updateState(s),console.log("------------------------------------------------")}},e.prototype.showTips=function(t){var e,i=this,o=i._state.colliderIndex,n=i._colliderBox[o].name;t?(e=n.indexOf("head")>-1?"dropBox1":"dropBox2",i._collideredBox.forEach(function(t){t.name.indexOf(e)>-1?t.getController("c1").selectedIndex=1:t.getController("c1").selectedIndex=0})):i._collideredBox.forEach(function(t){t.getController("c1").selectedIndex=0})},e.prototype._getDistance=function(t,e){var i=t.x+t.width/2-(e.x+e.width/2),o=t.y+t.height/2-(e.y+e.height/2);return Math.sqrt(i*i+o*o)},e.prototype.isCollisionWithRect=function(t,e){return!(t.x>=e.x&&t.x>=e.x+e.width||t.x<=e.x&&t.x+t.width<=e.x||t.y>=e.y&&t.y>=e.y+e.height||t.y<=e.y&&t.y+t.height<=e.y)},e.prototype._belongArea=function(t,e,i){void 0===i&&(i=10);var o=t.x+t.width/2-(e.x+e.width/2),n=t.y+t.height/2-(e.y+e.height/2);return Math.sqrt(o*o+n*n)<i},e.prototype._clickTitle=function(){var t=globalThis._.cloneDeep(this._state);t.title=!0,this.updateState(t)},e.prototype._clickSubmit=function(){return l(this,void 0,void 0,function(){var t,e,i,o;return a(this,function(){return t=this,e=globalThis._.cloneDeep(this._state),i={role1:0,role2:0},o=0,e.collidered.forEach(function(n,r){if(n.length>0&&o++,r<e.collidered.length/2>>0){var l=e.collidered[r+t._roleCount];1==t._gameType?n.length>0&&l.length>0&&n[0].roleType==l[0].roleType&&i[n[0].roleType]++:2==t._gameType&&n.length>0&&l.length>0&&i[l[0].roleType]++}}),console.log(i),console.log(t._answer),e.answer=JSON.stringify(i)===JSON.stringify(t._answer)&&o==2*(t._answer.role1+t._answer.role2),e.submit=!0,this.updateState(e),[2]})})},e.prototype.showEndAnim=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=this;i.state.collider.forEach(function(t,e){-1==t.collideredIndex&&(i._colliderBox[e].visible=!1)}),i._view.touchable=!1,i.state.collidered.forEach(function(o,n){if(n<i.state.collidered.length/2>>0&&o.length>0){var r=i.state.collidered[n+i._roleCount],l=i._roleUrl[r[0].roleType];console.log(l);var a=fgui.UIPackage.createObjectFromURL(l);a.setPivot(.5,.5,!0),"Question4Page01"==i.pageData.model.uiPath&&(a.scaleX=a.scaleY=.7),a.x=i._collideredBox[n].x,a.y=i._collideredBox[n].y+100,a.alpha=0,i._view.addChild(a);var s="Question4Page01"==i.pageData.model.uiPath?220:350;cc.tween(a).to(1,{alpha:1}).delay(.5).to(1.5,{y:a.y+s}).call(function(){t&&t.call(e)}).start()}})},e.prototype.showRole=function(){},e.prototype.getState=function(t){this.updateState(t)},e.prototype.updateState=function(t){globalThis._.isEqual(this._state,t)||(this.state=t)},e.prototype.updateUi=function(t,e){var i=this;if("move"==e.drag&&(this._colliderBox[e.colliderIndex].x=e.collider[e.colliderIndex].x,this._colliderBox[e.colliderIndex].y=e.collider[e.colliderIndex].y),"end"==e.drag){if(!globalThis._.isEqual(t.collider,e.collider)){console.log("endddddddddd update ui",e);for(var o=0;o<e.collider.length;o++)this._colliderBox[o].x=e.collider[o].x,this._colliderBox[o].y=e.collider[o].y}globalThis._.isEqual(t.submit,e.submit)||(console.log("submittttttt"),e.submit&&(2==this._gameType&&e.answer?this.showEndAnim(function(){i.answerFeedback(e.answer)}):this.answerFeedback(e.answer))),globalThis._.isEqual(t.title,e.title)||this.playTitle(e.title)}},e.prototype.playTitle=function(t){return l(this,void 0,void 0,function(){var e,i,o,n=this;return a(this,function(r){switch(r.label){case 0:return this._c2.selectedIndex=t?1:0,t?(cc.audioEngine.stopAll(),this.forbidHandle(),console.log('this._title["_sound"]',this._title._sound),e=fgui.UIPackage.getItemByURL(this._title._sound),[4,h(e.file,cc.AudioClip)]):[3,2];case 1:return i=r.sent(),o=cc.audioEngine.play(i,!1,1),cc.audioEngine.setFinishCallback(o,function(){var t=globalThis._.cloneDeep(n._state);t.title=!1,n.updateState(t)}),[3,3];case 2:this.disableForbidHandle(),r.label=3;case 3:return[2]}})})},e.prototype.playSound=function(t){var e=fgui.UIPackage.getItemByURL(t);h(e.file,cc.AudioClip).then(function(t){cc.audioEngine.play(t,!1,1)})},e.prototype.answerFeedback=function(t){var e=this;if(this.feedback){var i=globalThis._.cloneDeep(this._state),o=cc.instantiate(this.feedback);o.x=960,o.y=540,o.getComponent(cc.Component).init(t),o.parent=cc.find("Canvas").parent,setTimeout(function(){o.destroy(),i.submit=!1,e.updateState(i)},2e3)}},e.prototype.onHandleGuide=function(){var t=this;if(this.handleGuide){var e=globalThis._.cloneDeep(this._state);fgui.GRoot.inst.addChild(this.handleGuide.component),this.handleGuide.pos?(this.handleGuide.component.x=(fgui.GRoot.inst.width-this.handleGuide.component.width)/2+this.handleGuide.pos.x,this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2+this.handleGuide.pos.y):this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2,this.handleGuide.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.handleGuide.component),e.submit=!1,t.updateState(e)},2)}},e.prototype.forbidHandle=function(){if(!this._worldRoot.getChildByName("handleMask")){var t=new cc.Node("handleMask");t.addComponent(cc.BlockInputEvents),t.parent=this._worldRoot,t.width=1920,t.height=1080,t.x=960,t.y=540}},e.prototype.disableForbidHandle=function(){var t=this._worldRoot.getChildByName("handleMask");t&&t.destroy()},e.prototype.dragSchedule=function(){var t=this;if(t._dragging){var e=globalThis._.cloneDeep(t._state);e.drag="move",e.collider[e.colliderIndex]={x:this._colliderBox[e.colliderIndex].x,y:this._colliderBox[e.colliderIndex].y,collideredIndex:e.collider[e.colliderIndex].collideredIndex,roleType:e.collider[e.colliderIndex].roleType},t.updateState(e)}},e.prototype.registerState=function(){window.GlobalData.sample.registerState&&window.GlobalData.sample.registerState.call(this)},e.prototype.relieveState=function(){window.GlobalData.sample.relieveState&&window.GlobalData.sample.relieveState.call(this)},e.prototype.mergeState=function(){window.GlobalData.sample.mergeState&&window.GlobalData.sample.mergeState.call(this)},e.prototype.onEnable=function(){this.registerState(),this.schedule(this.dragSchedule,this._scheduleTime)},e.prototype.onDisable=function(){this.relieveState(),cc.audioEngine.stopAll()},r([p],e)}(cc.Component));i.default=f,cc._RF.pop()},{}]},{},["DragAnswerModel03Base","IDragAnswerModel03Base","dragAnswer-model01-v1","dragAnswer-model01-v2","dragAnswer-model02-v1","dragAnswer-model03-v1","dragAnswer-model03-v2"]);