window.__require=function t(e,i,o){function n(a,l){if(!i[a]){if(!e[a]){var s=a.split("/");if(s=s[s.length-1],!e[s]){var c="function"==typeof __require&&__require;if(!l&&c)return c(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(t){return n(e[a][1][t]||t)},h,h.exports,t,e,i,o)}return i[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<o.length;a++)n(o[a]);return n}({DragAnswerModel03Base:[function(t,e,i){"use strict";cc._RF.push(e,"dc8acHicohNq5yBFFMirL0/","DragAnswerModel03Base");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},a=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function l(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var i,o,n,r,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){a.label=r[1];break}if(6===r[0]&&a.label<n[1]){a.label=n[1],n=r;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(r);break}n[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(l){r=[6,l],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=window.GlobalData.sample,c=s.loadBundle,h=s.loadPrefab,d=(s.loadResource,cc._decorator),u=d.ccclass,p=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(t){return a(this,void 0,void 0,function(){var e,i,o,n,r,a,s,d,u,p,f,g,_,y,b,v;return l(this,function(l){switch(l.label){case 0:if((e=this).pageData=t,i=t.pathConfig,o=t.model,n=t.components,r=i.packageName,a=o.uiPath,(s=o.config).answer,d=s.ae,o.uiPath&&(a=o.uiPath,this._view=fgui.UIPackage.createObject(r,a).asCom),e._readTitleBtn=fgui.UIPackage.createObject("t4-trialClass-01","TitleCom").asCom,e._readTitleBtn.getChild("title").url=fgui.UIPackage.createObject("t4-trialClass-01","title_3").asImage.resourceURL,e._readTitleBtn.x=20,e._readTitleBtn.y=50,this._view.addChild(e._readTitleBtn),e._submitBtn=fgui.UIPackage.createObject("t4-trialClass-01","SubmitBtn").asCom,e._submitBtn.x=1676,e._submitBtn.y=806,this._view.addChild(e._submitBtn),o.config&&d)for(u in d)d[u]&&(this[u]={},d[u].component&&(this[u].component=fgui.UIPackage.createObject(r,d[u].component).asCom),d[u].pos&&(this[u].pos=d[u].pos));if(!n)return[3,5];for(f in p=[],n)p.push(f);g=0,l.label=1;case 1:return g<p.length?(_=p[g],y=""+i.remoteUrl+i.componentBundlePath+n[_].bundleName,[4,c(y)]):[3,5];case 2:return b=l.sent(),[4,h(b,n[_].prefabName)];case 3:v=l.sent(),this[_]=v,l.label=4;case 4:return g++,[3,1];case 5:return[2]}})})},r([u],e)}(cc.Component));i.default=p,cc._RF.pop()},{}],IDragAnswerModel03Base:[function(t,e,i){"use strict";cc._RF.push(e,"1736cyca9ZHNoOoWPutUzza","IDragAnswerModel03Base"),Object.defineProperty(i,"__esModule",{value:!0}),cc._RF.pop()},{}],"dragAnswer-model01-v1":[function(t,e,i){"use strict";cc._RF.push(e,"a13c8/eIVFLEpkoqHBFYILF","dragAnswer-model01-v1");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},a=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function l(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var i,o,n,r,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){a.label=r[1];break}if(6===r[0]&&a.label<n[1]){a.label=n[1],n=r;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(r);break}n[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(l){r=[6,l],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=window.GlobalData.sample,c=s.loadBundle,h=s.loadPrefab,d=s.loadResource,u=window.GlobalData.utils.pointBelongArea,p=cc._decorator,f=p.ccclass,g=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._grids=[],e._cache={},e._scheduleTime=.3,e._dragging=!1,e._answer=0,e._state={},e}return n(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this.updateUi(this._state,t),this._state=t,this.mergeState()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._worldRoot=cc.find("Canvas").parent,this._view.y=(fgui.GRoot.inst.height-this._view.height)/2,this._view.x=(fgui.GRoot.inst.width-this._view.width)/2,fgui.GRoot.inst.addChild(this._view),this._c1=this._view.getController("c1"),this._c2=this._view.getController("c2"),this._c2&&(this._c2.selectedIndex=1,this._c2.selectedIndex=0),this._submit=this._view.getChild("submit").asButton,this._submit&&this._submit.on(fgui.Event.CLICK,this._clickSubmit,this),this._titleTrigger=this._view.getChild("titleTrigger").asLoader,this._titleTrigger&&this._titleTrigger.on(fgui.Event.CLICK,this._clickTitle,this),this._title=this._view.getChild("title").asButton,this._dragBtn=this._view.getChild("dragBtn").asButton,this._cache.dragOrigin=this.getOriginValue(this._dragBtn),this._dragBtn.draggable=!0,this._dragBtn.on(fgui.Event.TOUCH_BEGIN,this._onDragStart,this),this._dragBtn.on(fgui.Event.TOUCH_MOVE,this._onDragMove,this),this._dragBtn.on(fgui.Event.TOUCH_END,this._onDragEnd,this),this._btnBox=this._view.getChild("btnBox").asButton,this._btnBox&&this._btnBox.on(fgui.Event.CLICK,this._clickRemove,this);for(var t=this._btnBox.getChild("grids").asGroup,e=this._btnBox.numChildren-1;e>-1;e--)if(this._btnBox.getChildAt(e).group==t){var i=this._btnBox.getChildAt(e).asLoader;this._grids.push(i)}this._state={drag:"end",dragBtn:{x:this._dragBtn.x,y:this._dragBtn.y},title:!1,drops:0,submit:!1,answer:!1},this.disableForbidHandle()},e.prototype.init=function(t){return a(this,void 0,void 0,function(){var e,i,o,n,r,a,s,d,u,p,f,g,_,y,b,v;return l(this,function(l){switch(l.label){case 0:for(u in e=t.pathConfig,i=t.model,o=t.components,n=e.packageName,r=i.uiPath,a=i.config,s=a.answer,d=a.ae,this._view=fgui.UIPackage.createObject(n,r).asCom,d)d[u]&&(this[u]={},d[u].component&&(this[u].component=fgui.UIPackage.createObject(n,d[u].component).asCom),d[u].pos&&(this[u].pos=d[u].pos));if(s&&(this._answer=s),!o)return[3,5];for(f in p=[],o)p.push(f);g=0,l.label=1;case 1:return g<p.length?(_=p[g],y=""+e.remoteUrl+e.componentBundlePath+o[_].bundleName,[4,c(y)]):[3,5];case 2:return b=l.sent(),[4,h(b,o[_].prefabName)];case 3:v=l.sent(),this[_]=v,l.label=4;case 4:return g++,[3,1];case 5:return[2]}})})},e.prototype.getOriginValue=function(t){return{x:t.x,y:t.y}},e.prototype._onDragStart=function(t){t.captureTouch();var e=globalThis._.cloneDeep(this._state);e.drag="start",e.answer=e.drops===this._answer,this.updateState(e)},e.prototype._onDragMove=function(){this._dragging=!0},e.prototype._onDragEnd=function(){this._dragging=!1;var t=globalThis._.cloneDeep(this._state);u("rectangle",this._btnBox,this._dragBtn)&&(this._dragBtn.getChild("icon").asLoader,this._grids.find(function(t){return null===t.url})&&(t.drops=t.drops+1)),t.dragBtn={x:this._cache.dragOrigin.x,y:this._cache.dragOrigin.y},t.drag="end",t.answer=t.drops===this._answer,this.updateState(t)},e.prototype._clickRemove=function(){var t=globalThis._.cloneDeep(this._state);0!==this._grids.findIndex(function(t){return null===t.url})&&(t.drops=t.drops-1,t.answer=t.drops===this._answer,this.updateState(t))},e.prototype._clickTitle=function(){var t=globalThis._.cloneDeep(this._state);t.title=!0,this.updateState(t)},e.prototype._clickSubmit=function(){return a(this,void 0,void 0,function(){var t;return l(this,function(){return(t=globalThis._.cloneDeep(this._state)).answer=t.drops===this._answer,t.submit=!0,this.updateState(t),[2]})})},e.prototype.getState=function(t){this.updateState(t)},e.prototype.updateState=function(t){globalThis._.isEqual(this._state,t)||(this.state=t)},e.prototype.updateUi=function(t,e){if("move"==e.drag&&(this._dragBtn.x=e.dragBtn.x,this._dragBtn.y=e.dragBtn.y),"end"==e.drag){if(this._dragBtn.x=this._cache.dragOrigin.x,this._dragBtn.y=this._cache.dragOrigin.y,!globalThis._.isEqual(t.drops,e.drops)){for(var i=0;i<this._grids.length;i++){var o=this._grids[i];if(e.drops>i){if(!o.url){var n=this._dragBtn.getChild("icon").asLoader;o.url=n.url}}else o.url&&(o.url=null)}this._c1.selectedIndex=e.drops,e.answer||this.onLibraHint()}globalThis._.isEqual(t.submit,e.submit)||e.submit&&(e.drops?this.answerFeedback(e.answer):this.onHandleGuide()),globalThis._.isEqual(t.title,e.title)||this.playTitle(e.title)}},e.prototype.playTitle=function(t){return a(this,void 0,void 0,function(){var e,i,o,n=this;return l(this,function(r){switch(r.label){case 0:return this._c2.selectedIndex=t?1:0,t?(cc.audioEngine.stopAll(),this.forbidHandle(),e=fgui.UIPackage.getItemByURL(this._title._sound),[4,d(e.file,cc.AudioClip)]):[3,2];case 1:return i=r.sent(),o=cc.audioEngine.play(i,!1,1),cc.audioEngine.setFinishCallback(o,function(){var t=globalThis._.cloneDeep(n._state);t.title=!1,n.updateState(t)}),[3,3];case 2:this.disableForbidHandle(),r.label=3;case 3:return[2]}})})},e.prototype.answerFeedback=function(t){var e=this;if(this.feedback){var i=globalThis._.cloneDeep(this._state),o=cc.instantiate(this.feedback);o.x=960,o.y=540,o.getComponent(cc.Component).init(t),o.parent=cc.find("Canvas").parent,setTimeout(function(){o.destroy(),i.submit=!1,e.updateState(i)},2e3)}},e.prototype.onLibraHint=function(){var t=this;this.lineBlink&&(fgui.GRoot.inst.addChild(this.lineBlink.component),this.lineBlink.pos?(this.lineBlink.component.x=(fgui.GRoot.inst.width-this.lineBlink.component.width)/2+this.lineBlink.pos.x,this.lineBlink.component.y=(fgui.GRoot.inst.height-this.lineBlink.component.height)/2+this.lineBlink.pos.y):this.lineBlink.component.y=(fgui.GRoot.inst.height-this.lineBlink.component.height)/2,this.lineBlink.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.lineBlink.component)}))},e.prototype.onHandleGuide=function(){var t=this;if(this.handleGuide){var e=globalThis._.cloneDeep(this._state);fgui.GRoot.inst.addChild(this.handleGuide.component),this.handleGuide.pos?(this.handleGuide.component.x=(fgui.GRoot.inst.width-this.handleGuide.component.width)/2+this.handleGuide.pos.x,this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2+this.handleGuide.pos.y):this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2,this.handleGuide.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.handleGuide.component),e.submit=!1,t.updateState(e)},2)}},e.prototype.forbidHandle=function(){if(!this._worldRoot.getChildByName("handleMask")){var t=new cc.Node("handleMask");t.addComponent(cc.BlockInputEvents),t.parent=this._worldRoot,t.width=1920,t.height=1080,t.x=960,t.y=540}},e.prototype.disableForbidHandle=function(){var t=this._worldRoot.getChildByName("handleMask");t&&t.destroy()},e.prototype.dragSchedule=function(){if(this._dragging){var t=globalThis._.cloneDeep(this._state);t.drag="move",t.dragBtn={x:this._dragBtn.x,y:this._dragBtn.y},this.updateState(t)}},e.prototype.registerState=function(){window.GlobalData.sample.registerState&&window.GlobalData.sample.registerState.call(this)},e.prototype.relieveState=function(){window.GlobalData.sample.relieveState&&window.GlobalData.sample.relieveState.call(this)},e.prototype.mergeState=function(){window.GlobalData.sample.mergeState&&window.GlobalData.sample.mergeState.call(this)},e.prototype.onEnable=function(){this.registerState(),this.schedule(this.dragSchedule,this._scheduleTime)},e.prototype.onDisable=function(){this.relieveState(),cc.audioEngine.stopAll()},r([f],e)}(cc.Component));i.default=g,cc._RF.pop()},{}],"dragAnswer-model01-v2":[function(t,e,i){"use strict";cc._RF.push(e,"8f908Bl1PlGabQ0oWxCLVqT","dragAnswer-model01-v2");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},a=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function l(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var i,o,n,r,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){a.label=r[1];break}if(6===r[0]&&a.label<n[1]){a.label=n[1],n=r;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(r);break}n[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(l){r=[6,l],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=window.GlobalData.sample,c=s.loadBundle,h=s.loadPrefab,d=s.loadResource,u=cc._decorator,p=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colliderBox=[],e._collideredBox=[],e._cache={},e._scheduleTime=.3,e._dragging=!1,e._answer=0,e._state={},e}return n(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this.updateUi(this._state,t),this._state=t,this.mergeState()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._worldRoot=cc.find("Canvas").parent,this._view.y=(fgui.GRoot.inst.height-this._view.height)/2,this._view.x=(fgui.GRoot.inst.width-this._view.width)/2,fgui.GRoot.inst.addChild(this._view),this._c1=this._view.getController("c1"),this._c2=this._view.getController("c2"),this._c2&&(this._c2.selectedIndex=1,this._c2.selectedIndex=0),this._submit=this._view.getChild("submit").asButton,this._submit&&this._submit.on(fgui.Event.CLICK,this._clickSubmit,this),this._title=this._view.getChild("title").asButton,this._titleTrigger=this._view.getChild("titleTrigger").asLoader,this._titleTrigger&&this._titleTrigger.on(fgui.Event.CLICK,this._clickTitle,this);var t=this._view.getChild("colliderBox").asGroup,e=this._view.getChild("collideredBox").asGroup;this._cache.colliderBox=[];for(var i=0;i<this._view.numChildren;i++)if(this._view.getChildAt(i).group==t){var o=this._view.getChildAt(i).asButton;this._cache.colliderBox.push({x:o.x,y:o.y,belong:null}),o.draggable=!0,o.on(fgui.Event.TOUCH_BEGIN,this._onDragStart,this),o.on(fgui.Event.TOUCH_MOVE,this._onDragMove,this),o.on(fgui.Event.TOUCH_END,this._onDragEnd,this),this._colliderBox.push(o)}for(i=0;i<this._view.numChildren;i++)this._view.getChildAt(i).group==e&&(o=this._view.getChildAt(i).asButton,this._collideredBox.push(o));this._state={drag:"end",collider:this._cache.colliderBox.map(function(t){return t}),colliderIndex:null,title:!1,submit:!1,answer:!1},this.disableForbidHandle()},e.prototype.init=function(t){return a(this,void 0,void 0,function(){var e,i,o,n,r,a,s,d,u,p,f,g,_,y,b,v;return l(this,function(l){switch(l.label){case 0:if(e=t.pathConfig,i=t.model,o=t.components,n=e.packageName,i.uiPath&&(r=i.uiPath,this._view=fgui.UIPackage.createObject(n,r).asCom),i.config&&(a=i.config,s=a.answer,d=a.ae,s&&(this._answer=s),d))for(u in d)d[u]&&(this[u]={},d[u].component&&(this[u].component=fgui.UIPackage.createObject(n,d[u].component).asCom),d[u].pos&&(this[u].pos=d[u].pos));if(!o)return[3,5];for(f in p=[],o)p.push(f);g=0,l.label=1;case 1:return g<p.length?(_=p[g],y=""+e.remoteUrl+e.componentBundlePath+o[_].bundleName,[4,c(y)]):[3,5];case 2:return b=l.sent(),[4,h(b,o[_].prefabName)];case 3:v=l.sent(),this[_]=v,l.label=4;case 4:return g++,[3,1];case 5:return[2]}})})},e.prototype.getOriginValue=function(t){return{x:t.x,y:t.y}},e.prototype._onDragStart=function(t){t.captureTouch();var e=globalThis._.cloneDeep(this._state),i=fgui.GObject.cast(t.currentTarget),o=this._colliderBox.findIndex(function(t){return t==i});e.colliderIndex=o,this.updateState(e)},e.prototype._onDragMove=function(){this._dragging=!0},e.prototype._onDragEnd=function(t){var e=this;if(this._dragging){this._dragging=!1;var i,o=fgui.GObject.cast(t.currentTarget),n=this._colliderBox.findIndex(function(t){return t==o}),r=[];this._collideredBox.forEach(function(t){1==e._belongArea(o,t,110)&&r.push(t)}),r.forEach(function(t,n){if(0==n)i=t;else{var a=e._getDistance(o,r[n-1]);e._getDistance(o,t)<a&&(i=t)}});var a=this._collideredBox.findIndex(function(t){return t==i}),l=globalThis._.cloneDeep(this._state);if(-1==a)l.collider[n]={x:this._cache.colliderBox[n].x,y:this._cache.colliderBox[n].y,belong:null};else{var s=this._collideredBox[a].x+this._collideredBox[a].width/2-this._colliderBox[n].width/2,c=this._collideredBox[a].y+this._collideredBox[a].height/2-this._colliderBox[n].height/2,h=l.collider.find(function(t){return t.x==s&&Math.abs(t.y-c)<55});l.collider[n]={x:h?this._cache.colliderBox[n].x:s,y:h?this._cache.colliderBox[n].y:c,belong:h?null:a}}l.submit=!1,l.drag="end",l.colliderIndex=n,this.updateState(l)}},e.prototype._clickTitle=function(){var t=globalThis._.cloneDeep(this._state);t.title=!0,this.updateState(t)},e.prototype._clickSubmit=function(){var t=globalThis._.cloneDeep(this._state),e=t.collider.map(function(t){return t.belong}).filter(function(t){return t||0===t}).join("");t.answer=e==this._answer,t.submit=!0,this.updateState(t)},e.prototype.getState=function(t){this.updateState(t)},e.prototype.updateState=function(t){globalThis._.isEqual(this._state,t)||(this.state=t)},e.prototype.updateUi=function(t,e){if("move"==e.drag&&(this._colliderBox[e.colliderIndex].x=e.collider[e.colliderIndex].x,this._colliderBox[e.colliderIndex].y=e.collider[e.colliderIndex].y),"end"==e.drag){if(!globalThis._.isEqual(t.collider,e.collider))for(var i=0;i<e.collider.length;i++)this._colliderBox[i].x=e.collider[i].x,this._colliderBox[i].y=e.collider[i].y;if(globalThis._.isEqual(t.title,e.title)||this.playTitle(e.title),!globalThis._.isEqual(t.submit,e.submit)&&e.submit){var o=this._colliderBox.map(function(t){return{x:t.x,y:t.y}});this._cache.colliderBox.every(function(t,e){return t.x==o[e].x&&t.y==o[e].y})?this.onHandleGuide():this.onFlicker(e.answer)}}},e.prototype.playTitle=function(t){return a(this,void 0,void 0,function(){var e,i,o,n=this;return l(this,function(r){switch(r.label){case 0:return this._c2.selectedIndex=t?1:0,t?(cc.audioEngine.stopAll(),this.forbidHandle(),e=fgui.UIPackage.getItemByURL(this._title._sound),[4,d(e.file,cc.AudioClip)]):[3,2];case 1:return i=r.sent(),o=cc.audioEngine.play(i,!1,1),cc.audioEngine.setFinishCallback(o,function(){var t=globalThis._.cloneDeep(n._state);t.title=!1,n.updateState(t)}),[3,3];case 2:this.disableForbidHandle(),r.label=3;case 3:return[2]}})})},e.prototype._getDistance=function(t,e){var i=t.x+t.width/2-(e.x+e.width/2),o=t.y+t.height/2-(e.y+e.height/2);return Math.sqrt(i*i+o*o)},e.prototype._belongArea=function(t,e,i){void 0===i&&(i=10);var o=t.x+t.width/2-(e.x+e.width/2),n=t.y+t.height/2-(e.y+e.height/2);return Math.sqrt(o*o+n*n)<i},e.prototype.answerFeedback=function(t){var e=this;if(this.feedback){var i=globalThis._.cloneDeep(this._state),o=cc.instantiate(this.feedback);o.x=960,o.y=540,o.getComponent(cc.Component).init(t),o.parent=cc.find("Canvas").parent,setTimeout(function(){e.disableForbidHandle(),o.destroy(),i.submit=!1,e.updateState(i)},2e3)}},e.prototype.onFlicker=function(t){var e=this;this._view.getTransition("t0").play(function(){e.answerFeedback(t)})},e.prototype.onHandleGuide=function(){var t=this;if(this.handleGuide){var e=globalThis._.cloneDeep(this._state);fgui.GRoot.inst.addChild(this.handleGuide.component),this.handleGuide.pos?(this.handleGuide.component.x=(fgui.GRoot.inst.width-this.handleGuide.component.width)/2+this.handleGuide.pos.x,this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2+this.handleGuide.pos.y):this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2,this.handleGuide.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.handleGuide.component),e.submit=!1,t.updateState(e)},2)}},e.prototype.forbidHandle=function(){if(!this._worldRoot.getChildByName("handleMask")){var t=new cc.Node("handleMask");t.addComponent(cc.BlockInputEvents),t.parent=this._worldRoot,t.width=1920,t.height=1080,t.x=960,t.y=540}},e.prototype.disableForbidHandle=function(){var t=this._worldRoot.getChildByName("handleMask");t&&t.destroy()},e.prototype.dragSchedule=function(){if(this._dragging){var t=globalThis._.cloneDeep(this._state);t.drag="move",t.collider[t.colliderIndex]={x:this._colliderBox[t.colliderIndex].x,y:this._colliderBox[t.colliderIndex].y},this.updateState(t)}},e.prototype.registerState=function(){window.GlobalData.sample.registerState&&window.GlobalData.sample.registerState.call(this)},e.prototype.relieveState=function(){window.GlobalData.sample.relieveState&&window.GlobalData.sample.relieveState.call(this)},e.prototype.mergeState=function(){window.GlobalData.sample.mergeState&&window.GlobalData.sample.mergeState.call(this)},e.prototype.onEnable=function(){this.registerState(),this.schedule(this.dragSchedule,this._scheduleTime)},e.prototype.onDisable=function(){this.relieveState(),cc.audioEngine.stopAll()},r([p],e)}(cc.Component));i.default=f,cc._RF.pop()},{}],"dragAnswer-model02-v1":[function(t,e,i){"use strict";cc._RF.push(e,"761b7tA1DZDbZlu/VVG4SVi","dragAnswer-model02-v1");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},a=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function l(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var i,o,n,r,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){a.label=r[1];break}if(6===r[0]&&a.label<n[1]){a.label=n[1],n=r;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(r);break}n[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(l){r=[6,l],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=window.GlobalData.sample,c=s.loadBundle,h=s.loadPrefab,d=s.loadResource,u=cc._decorator,p=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colliderBox=[],e._collideredBox=[],e._cache={},e._scheduleTime=.3,e._dragging=!1,e._answer=0,e._state={},e}return n(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this.updateUi(this._state,t),this._state=t,this.mergeState()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._worldRoot=cc.find("Canvas").parent,this._view.y=(fgui.GRoot.inst.height-this._view.height)/2,this._view.x=(fgui.GRoot.inst.width-this._view.width)/2,fgui.GRoot.inst.addChild(this._view),this._c1=this._view.getController("c1"),this._c2=this._view.getController("c2"),this._c2&&(this._c2.selectedIndex=1,this._c2.selectedIndex=0),this._title=this._view.getChild("title").asButton,this._titleTrigger=this._view.getChild("titleTrigger").asLoader,this._titleTrigger&&this._titleTrigger.on(fgui.Event.CLICK,this._clickTitle,this);var t=this._view.getChild("colliderBox").asGroup,e=this._view.getChild("collideredBox").asGroup;this._cache.colliderBox=[];for(var i=0;i<this._view.numChildren;i++)if(this._view.getChildAt(i).group==t){var o=this._view.getChildAt(i).asButton;this._cache.colliderBox.push({x:o.x,y:o.y}),o.draggable=!0,o.on(fgui.Event.TOUCH_BEGIN,this._onDragStart,this),o.on(fgui.Event.TOUCH_MOVE,this._onDragMove,this),o.on(fgui.Event.TOUCH_END,this._onDragEnd,this),this._colliderBox.push(o)}for(i=0;i<this._view.numChildren;i++)this._view.getChildAt(i).group==e&&(o=this._view.getChildAt(i).asButton,this._collideredBox.push(o));this._state={drag:"end",title:!1,collider:this._cache.colliderBox.map(function(t){return t}),colliderIndex:null,answer:!1,submit:!1},this.disableForbidHandle()},e.prototype.init=function(t){return a(this,void 0,void 0,function(){var e,i,o,n,r,a,s,d,u,p,f,g,_,y,b,v;return l(this,function(l){switch(l.label){case 0:if(e=t.pathConfig,i=t.model,o=t.components,n=e.packageName,i.uiPath&&(r=i.uiPath,this._view=fgui.UIPackage.createObject(n,r).asCom),i.config&&(a=i.config,s=a.answer,d=a.ae,s&&(this._answer=s),d))for(u in d)d[u]&&(this[u]={},d[u].component&&(this[u].component=fgui.UIPackage.createObject(n,d[u].component).asCom),d[u].pos&&(this[u].pos=d[u].pos));if(!o)return[3,5];for(f in p=[],o)p.push(f);g=0,l.label=1;case 1:return g<p.length?(_=p[g],y=""+e.remoteUrl+e.componentBundlePath+o[_].bundleName,[4,c(y)]):[3,5];case 2:return b=l.sent(),[4,h(b,o[_].prefabName)];case 3:v=l.sent(),this[_]=v,l.label=4;case 4:return g++,[3,1];case 5:return[2]}})})},e.prototype.getOriginValue=function(t){return{x:t.x,y:t.y}},e.prototype._onDragStart=function(t){t.captureTouch();var e=globalThis._.cloneDeep(this._state),i=fgui.GObject.cast(t.currentTarget),o=this._colliderBox.findIndex(function(t){return t==i});e.colliderIndex=o,this.updateState(e)},e.prototype._onDragMove=function(){this._dragging=!0},e.prototype._onDragEnd=function(t){var e=this;if(this._dragging){this._dragging=!1;var i=fgui.GObject.cast(t.currentTarget),o=this._colliderBox.findIndex(function(t){return t==i}),n=this._adsorb(i,o),r=globalThis._.cloneDeep(this._state);if(n.bool)r.collider[o]={x:n.pos.x,y:n.pos.y};else for(var a=0;a<this._colliderBox.length;a++)i==this._colliderBox[a]&&(r.collider[o]={x:this._cache.colliderBox[a].x,y:this._cache.colliderBox[a].y});r.drag="end",r.colliderIndex=o;var l=r.collider.every(function(t,i){return!globalThis._.isEqual(t,e._cache.colliderBox[i])});r.answer=l,l&&(r.submit=!0),this.updateState(r)}},e.prototype._adsorb=function(t,e){for(var i,o,n,r,a=0;a<this._collideredBox.length;a++)i=t.x-this._collideredBox[a].x,o=t.y-this._collideredBox[a].y,n?n>Math.sqrt(i*i+o*o)&&(n=Math.sqrt(i*i+o*o),r=a):(n=Math.sqrt(i*i+o*o),r=a);return{bool:n<65&&e==r,s:r,pos:{x:this._collideredBox[r].x,y:this._collideredBox[r].y}}},e.prototype._clickTitle=function(){var t=globalThis._.cloneDeep(this._state);t.title=!0,this.updateState(t)},e.prototype.getState=function(t){this.updateState(t)},e.prototype.updateState=function(t){globalThis._.isEqual(this._state,t)||(this.state=t)},e.prototype.updateUi=function(t,e){if("move"==e.drag&&(this._colliderBox[e.colliderIndex].x=e.collider[e.colliderIndex].x,this._colliderBox[e.colliderIndex].y=e.collider[e.colliderIndex].y),"end"==e.drag){if(!globalThis._.isEqual(t.collider,e.collider))for(var i=0;i<e.collider.length;i++)this._colliderBox[i].x=e.collider[i].x,this._colliderBox[i].y=e.collider[i].y;globalThis._.isEqual(t.title,e.title)||this.playTitle(e.title),globalThis._.isEqual(t.answer,e.answer)||e.answer&&this.transfer(e.answer)}},e.prototype.playTitle=function(t){return a(this,void 0,void 0,function(){var e,i,o,n=this;return l(this,function(r){switch(r.label){case 0:return this._c2.selectedIndex=t?1:0,t?(cc.audioEngine.stopAll(),this.forbidHandle(),e=fgui.UIPackage.getItemByURL(this._title._sound),[4,d(e.file,cc.AudioClip)]):[3,2];case 1:return i=r.sent(),o=cc.audioEngine.play(i,!1,1),cc.audioEngine.setFinishCallback(o,function(){var t=globalThis._.cloneDeep(n._state);t.title=!1,n.updateState(t)}),[3,3];case 2:this.disableForbidHandle(),r.label=3;case 3:return[2]}})})},e.prototype.transfer=function(t){var e=this;this.forbidHandle(),setTimeout(function(){e.answerFeedback(t)},1e3)},e.prototype.answerFeedback=function(t){var e=this;if(this.feedback){var i=globalThis._.cloneDeep(this._state),o=cc.instantiate(this.feedback);o.x=960,o.y=540,o.getComponent(cc.Component).init(t),o.parent=cc.find("Canvas").parent,setTimeout(function(){e.disableForbidHandle(),o.destroy(),i.submit=!1,e.updateState(i)},2e3)}},e.prototype.onLibraHint=function(){var t=this;this.lineBlink&&(fgui.GRoot.inst.addChild(this.lineBlink.component),this.lineBlink.pos?(this.lineBlink.component.x=(fgui.GRoot.inst.width-this.lineBlink.component.width)/2+this.lineBlink.pos.x,this.lineBlink.component.y=(fgui.GRoot.inst.height-this.lineBlink.component.height)/2+this.lineBlink.pos.y):this.lineBlink.component.y=(fgui.GRoot.inst.height-this.lineBlink.component.height)/2,this.lineBlink.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.lineBlink.component)}))},e.prototype.onHandleGuide=function(){var t=this;if(this.handleGuide){var e=globalThis._.cloneDeep(this._state);fgui.GRoot.inst.addChild(this.handleGuide.component),this.handleGuide.pos?(this.handleGuide.component.x=(fgui.GRoot.inst.width-this.handleGuide.component.width)/2+this.handleGuide.pos.x,this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2+this.handleGuide.pos.y):this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2,this.handleGuide.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.handleGuide.component),e.submit=!1,t.updateState(e)},2)}},e.prototype.forbidHandle=function(){if(!this._worldRoot.getChildByName("handleMask")){var t=new cc.Node("handleMask");t.addComponent(cc.BlockInputEvents),t.parent=this._worldRoot,t.width=1920,t.height=1080,t.x=960,t.y=540}},e.prototype.disableForbidHandle=function(){var t=this._worldRoot.getChildByName("handleMask");t&&t.destroy()},e.prototype.dragSchedule=function(){if(this._dragging){var t=globalThis._.cloneDeep(this._state);t.drag="move",t.collider[t.colliderIndex]={x:this._colliderBox[t.colliderIndex].x,y:this._colliderBox[t.colliderIndex].y},this.updateState(t)}},e.prototype.registerState=function(){window.GlobalData.sample.registerState&&window.GlobalData.sample.registerState.call(this)},e.prototype.relieveState=function(){window.GlobalData.sample.relieveState&&window.GlobalData.sample.relieveState.call(this)},e.prototype.mergeState=function(){window.GlobalData.sample.mergeState&&window.GlobalData.sample.mergeState.call(this)},e.prototype.onEnable=function(){this.registerState(),this.schedule(this.dragSchedule,this._scheduleTime)},e.prototype.onDisable=function(){this.relieveState(),cc.audioEngine.stopAll()},r([p],e)}(cc.Component));i.default=f,cc._RF.pop()},{}],"dragAnswer-model03-v1 copy":[function(t,e,i){"use strict";cc._RF.push(e,"d8debFn7YVKtopE4Sjdzo8E","dragAnswer-model03-v1 copy");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},a=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function l(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var i,o,n,r,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){a.label=r[1];break}if(6===r[0]&&a.label<n[1]){a.label=n[1],n=r;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(r);break}n[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(l){r=[6,l],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=window.GlobalData.sample,c=s.loadBundle,h=s.loadPrefab,d=s.loadResource,u=(window.GlobalData.utils.pointBelongArea,cc._decorator),p=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colliderBox=[],e._collideredBox=[],e._cache={},e._scheduleTime=.3,e._dragging=!1,e._answer=0,e._dragIconArr=[],e._state={},e}return n(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this.updateUi(this._state,t),this._state=t},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){var t=this;this._worldRoot=cc.find("Canvas").parent,this._view.y=(fgui.GRoot.inst.height-this._view.height)/2,this._view.x=(fgui.GRoot.inst.width-this._view.width)/2,fgui.GRoot.inst.addChild(this._view),this._c1=this._view.getController("c1"),this._c2=this._view.getController("c2"),this._c2&&(this._c2.selectedIndex=1,this._c2.selectedIndex=0),t.createUI(),t.addEvent(),this._state={drag:"end",dragIconArr:t._dragIconArr.map(function(t){return t}),dragIconIndex:null,collider:this._cache.colliderBox.map(function(t){return t}),colliderIndex:null,title:!1,submit:!1,answer:!1},this.disableForbidHandle()},e.prototype.createUI=function(){this._submit=this._view.getChild("submit").asButton,this._submit&&this._submit.on(fgui.Event.CLICK,this._clickSubmit,this),this._title=this._view.getChild("title").asButton,this._titleTrigger=this._view.getChild("titleTrigger").asLoader,this._titleTrigger&&this._titleTrigger.on(fgui.Event.CLICK,this._clickTitle,this);var t=this._view.getChild("colliderBox").asGroup,e=this._view.getChild("collideredBox").asGroup;this._cache.colliderBox=[];for(var i=0;i<this._view.numChildren;i++)if(this._view.getChildAt(i).group==t){var o=this._view.getChildAt(i).asButton;this._cache.colliderBox.push({x:o.x,y:o.y,belong:null}),o.draggable=!0,o.on(fgui.Event.TOUCH_BEGIN,this._onDragStart,this),o.on(fgui.Event.TOUCH_MOVE,this._onDragMove,this),o.on(fgui.Event.TOUCH_END,this._onDragEnd,this),this._colliderBox.push(o)}for(i=0;i<this._view.numChildren;i++)this._view.getChildAt(i).group==e&&(o=this._view.getChildAt(i).asButton,this._collideredBox.push(o))},e.prototype.addEvent=function(){},e.prototype.init=function(t){return a(this,void 0,void 0,function(){var e,i,o,n,r,a,s,d,u,p,f,g,_,y,b;return l(this,function(l){switch(l.label){case 0:if(this.pageData=t,e=t.pathConfig,i=t.model,o=t.components,n=e.packageName,r=i.uiPath,(a=i.config).answer,s=a.ae,i.uiPath&&(r=i.uiPath,this._view=fgui.UIPackage.createObject(n,r).asCom),i.config&&s)for(d in s)s[d]&&(this[d]={},s[d].component&&(this[d].component=fgui.UIPackage.createObject(n,s[d].component).asCom),s[d].pos&&(this[d].pos=s[d].pos));if(!o)return[3,5];for(p in u=[],o)u.push(p);f=0,l.label=1;case 1:return f<u.length?(g=u[f],_=""+e.remoteUrl+e.componentBundlePath+o[g].bundleName,[4,c(_)]):[3,5];case 2:return y=l.sent(),[4,h(y,o[g].prefabName)];case 3:b=l.sent(),this[g]=b,l.label=4;case 4:return f++,[3,1];case 5:return[2]}})})},e.prototype.getOriginValue=function(t){return{x:t.x,y:t.y}},e.prototype._onDragStart=function(t){var e=this,i=fgui.GObject.cast(t.currentTarget),o=e._colliderBox.findIndex(function(t){return t==i}),n=globalThis._.cloneDeep(e._state);n.colliderIndex=o,e.updateState(n)},e.prototype._onDragMove=function(){this._dragging=!0},e.prototype._onDragEnd=function(t){var e=fgui.GObject.cast(t.currentTarget),i=this._colliderBox.findIndex(function(t){return t==e}),o=globalThis._.cloneDeep(this._state);o.drag="end",o.collider[i]={x:this._cache.colliderBox[i].x,y:this._cache.colliderBox[i].y},o.dragIconIndex=i,this.updateState(o)},e.prototype._clickTitle=function(){var t=globalThis._.cloneDeep(this._state);t.title=!0,this.updateState(t)},e.prototype._clickSubmit=function(){return a(this,void 0,void 0,function(){var t;return l(this,function(){return(t=globalThis._.cloneDeep(this._state)).answer=t.drops===this._answer,t.submit=!0,this.updateState(t),[2]})})},e.prototype.getState=function(t){this.updateState(t)},e.prototype.updateState=function(t){globalThis._.isEqual(this._state,t)||(this.state=t)},e.prototype.updateUi=function(t,e){if("move"==e.drag&&(console.log("move"),this._colliderBox[e.colliderIndex].x=e.collider[e.colliderIndex].x,this._colliderBox[e.colliderIndex].y=e.collider[e.colliderIndex].y),"end"==e.drag){if(console.log("end"),!globalThis._.isEqual(t.collider,e.collider))for(var i=0;i<e.collider.length;i++)this._colliderBox[i].x=e.collider[i].x,this._colliderBox[i].y=e.collider[i].y;globalThis._.isEqual(t.submit,e.submit)||e.submit&&(e.drops?this.answerFeedback(e.answer):this.onHandleGuide()),globalThis._.isEqual(t.title,e.title)||this.playTitle(e.title)}},e.prototype.playTitle=function(t){return a(this,void 0,void 0,function(){var e,i,o,n=this;return l(this,function(r){switch(r.label){case 0:return this._c2.selectedIndex=t?1:0,t?(cc.audioEngine.stopAll(),this.forbidHandle(),e=fgui.UIPackage.getItemByURL(this._title._sound),[4,d(e.file,cc.AudioClip)]):[3,2];case 1:return i=r.sent(),o=cc.audioEngine.play(i,!1,1),cc.audioEngine.setFinishCallback(o,function(){var t=globalThis._.cloneDeep(n._state);t.title=!1,n.updateState(t)}),[3,3];case 2:this.disableForbidHandle(),r.label=3;case 3:return[2]}})})},e.prototype.answerFeedback=function(t){var e=this;if(this.feedback){var i=globalThis._.cloneDeep(this._state),o=cc.instantiate(this.feedback);o.x=960,o.y=540,o.getComponent(cc.Component).init(t),o.parent=cc.find("Canvas").parent,setTimeout(function(){o.destroy(),i.submit=!1,e.updateState(i)},2e3)}},e.prototype.onLibraHint=function(){var t=this;this.lineBlink&&(fgui.GRoot.inst.addChild(this.lineBlink.component),this.lineBlink.pos?(this.lineBlink.component.x=(fgui.GRoot.inst.width-this.lineBlink.component.width)/2+this.lineBlink.pos.x,this.lineBlink.component.y=(fgui.GRoot.inst.height-this.lineBlink.component.height)/2+this.lineBlink.pos.y):this.lineBlink.component.y=(fgui.GRoot.inst.height-this.lineBlink.component.height)/2,this.lineBlink.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.lineBlink.component)}))},e.prototype.onHandleGuide=function(){var t=this;if(this.handleGuide){var e=globalThis._.cloneDeep(this._state);fgui.GRoot.inst.addChild(this.handleGuide.component),this.handleGuide.pos?(this.handleGuide.component.x=(fgui.GRoot.inst.width-this.handleGuide.component.width)/2+this.handleGuide.pos.x,this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2+this.handleGuide.pos.y):this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2,this.handleGuide.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.handleGuide.component),e.submit=!1,t.updateState(e)},2)}},e.prototype.forbidHandle=function(){if(!this._worldRoot.getChildByName("handleMask")){var t=new cc.Node("handleMask");t.addComponent(cc.BlockInputEvents),t.parent=this._worldRoot,t.width=1920,t.height=1080,t.x=960,t.y=540}},e.prototype.disableForbidHandle=function(){var t=this._worldRoot.getChildByName("handleMask");t&&t.destroy()},e.prototype.dragSchedule=function(){var t=this;if(t._dragging){var e=globalThis._.cloneDeep(t._state);e.drag="move",e.collider[e.colliderIndex]={x:this._colliderBox[e.colliderIndex].x,y:this._colliderBox[e.colliderIndex].y},t.updateState(e)}},e.prototype.registerState=function(){window.GlobalData.sample.registerState&&window.GlobalData.sample.registerState.call(this)},e.prototype.relieveState=function(){window.GlobalData.sample.relieveState&&window.GlobalData.sample.relieveState.call(this)},e.prototype.mergeState=function(){window.GlobalData.sample.mergeState&&window.GlobalData.sample.mergeState.call(this)},e.prototype.onEnable=function(){this.registerState(),this.schedule(this.dragSchedule,this._scheduleTime)},e.prototype.onDisable=function(){this.relieveState(),cc.audioEngine.stopAll()},r([p],e)}(cc.Component));i.default=f,cc._RF.pop()},{}],"dragAnswer-model03-v1":[function(t,e,i){"use strict";cc._RF.push(e,"8f16fRyLKlMTrYGR9nh/Pf7","dragAnswer-model03-v1");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},a=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function a(t){try{s(o.next(t))}catch(e){r(e)}}function l(t){try{s(o.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,l)}s((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var i,o,n,r,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(t){return function(e){return s([t,e])}}function s(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){a.label=r[1];break}if(6===r[0]&&a.label<n[1]){a.label=n[1],n=r;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(r);break}n[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(l){r=[6,l],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=window.GlobalData.sample,c=s.loadBundle,h=s.loadPrefab,d=s.loadResource,u=(window.GlobalData.utils.pointBelongArea,cc._decorator),p=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colliderBox=[],e._collideredBox=[],e._cache={},e._scheduleTime=.3,e._dragging=!1,e._answer=0,e._dragIconArr=[],e._footNum=[],e._state={},e}return n(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this.updateUi(this._state,t),this._state=t,this.mergeState()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._worldRoot=cc.find("Canvas").parent,this._view.y=(fgui.GRoot.inst.height-this._view.height)/2,this._view.x=(fgui.GRoot.inst.width-this._view.width)/2,fgui.GRoot.inst.addChild(this._view),this._c1=this._view.getController("c1"),this._c2=this._view.getController("c2"),this._c2&&(this._c2.selectedIndex=1,this._c2.selectedIndex=0),this.createUI(),this.addEvent(),this._state={drag:"end",getDropArr:[],collider:this._cache.colliderBox.map(function(t){return t}),colliderIndex:null,collidered:this._cache.collideredBox.map(function(t){return t}),dropArr:[],title:!1,submit:!1,answer:!1},this.disableForbidHandle()},e.prototype.createUI=function(){var t=this;this._submit=this._view.getChild("submit").asButton,this._submit&&this._submit.on(fgui.Event.CLICK,this._clickSubmit,this),this._title=this._view.getChild("title").asButton,this._titleTrigger=this._view.getChild("titleTrigger").asLoader,this._titleTrigger&&this._titleTrigger.on(fgui.Event.CLICK,this._clickTitle,this);var e=this._view.getChild("colliderBox").asGroup,i=this._view.getChild("collideredBox").asGroup;t._cache.colliderBox=[];for(var o=0;o<this._view.numChildren;o++)if(t._view.getChildAt(o).group==e){var n=this._view.getChildAt(o).asButton;t._cache.colliderBox.push({x:n.x,y:n.y,belong:null}),n.collideredIndex=-1,n.draggable=!0,n.on(fgui.Event.TOUCH_BEGIN,this._onDragStart,this),n.on(fgui.Event.TOUCH_MOVE,this._onDragMove,this),n.on(fgui.Event.TOUCH_END,this._onDragEnd,this),this._colliderBox.push(n)}for(t._cache.collideredBox=[],o=0;o<this._view.numChildren;o++)this._view.getChildAt(o).group==i&&(n=this._view.getChildAt(o).asImage,t._cache.collideredBox.push([]),this._collideredBox.push(n))},e.prototype.addEvent=function(){},e.prototype.init=function(t){return a(this,void 0,void 0,function(){var e,i,o,n,r,a,s,d,u,p,f,g,_,y,b,v,w,m;return l(this,function(l){switch(l.label){case 0:if((e=this).pageData=t,i=t.pathConfig,o=t.model,n=t.components,r=i.packageName,a=o.uiPath,s=o.config,d=s.answer,u=s.ae,p=s.dragIcon,o.uiPath&&(a=o.uiPath,this._view=fgui.UIPackage.createObject(r,a).asCom),o.config){if(u)for(f in u)u[f]&&(this[f]={},u[f].component&&(this[f].component=fgui.UIPackage.createObject(r,u[f].component).asCom),u[f].pos&&(this[f].pos=u[f].pos));if(d&&(e._answer=d),p)for(b in p)e._footNum.push(p[b].footNum)}if(!n)return[3,5];for(_ in g=[],n)g.push(_);y=0,l.label=1;case 1:return y<g.length?(b=g[y],v=""+i.remoteUrl+i.componentBundlePath+n[b].bundleName,[4,c(v)]):[3,5];case 2:return w=l.sent(),[4,h(w,n[b].prefabName)];case 3:m=l.sent(),this[b]=m,l.label=4;case 4:return y++,[3,1];case 5:return[2]}})})},e.prototype.getOriginValue=function(t){return{x:t.x,y:t.y}},e.prototype._onDragStart=function(t){var e=this,i=fgui.GObject.cast(t.currentTarget);e._view.setChildIndex(i,e._view.numChildren-1);var o=e._colliderBox.findIndex(function(t){return t==i}),n=globalThis._.cloneDeep(e._state);n.colliderIndex=o,e.updateState(n)},e.prototype._onDragMove=function(){this._dragging=!0},e.prototype._onDragEnd=function(t){var e=this,i=this;if(this._dragging){this._dragging=!1;var o,n=fgui.GObject.cast(t.currentTarget),r=this._colliderBox.findIndex(function(t){return t==n}),a=[];this._collideredBox.forEach(function(t){i.isCollisionWithRect(t,n)&&a.push(t)}),a.forEach(function(t,i){if(0==i)o=t;else{var r=e._getDistance(n,a[i-1]);e._getDistance(n,t)<r&&(o=t)}});var l=this._collideredBox.findIndex(function(t){return t==o}),s=globalThis._.cloneDeep(this._state),c=globalThis._.cloneDeep(s);console.log("origin state = ",this._state.dropArr),console.log("clone state = ",s.dropArr),console.log("sss = ",c.dropArr);var h=s.dropArr,d=n.name,u=h.findIndex(function(t){return t.name==d});console.warn("dropArrIndex = ",u),-1==l||6==h.length?(u>-1&&h.splice(u,1),s.collider[r]={x:this._cache.colliderBox[r].x,y:this._cache.colliderBox[r].y},l=n.collideredIndex>-1?n.collideredIndex:0):-1==u&&h.push({name:n.name});for(var p=0,f=function(t){var e=h[t],o=i._colliderBox.findIndex(function(t){return t.name==e.name}),n=new cc.Vec2;e.name.indexOf("left")>-1?(n.x=i._collideredBox[l].x+150+200*t,n.y=i._collideredBox[l].y+200+85,p+=i._footNum[0]):e.name.indexOf("right")>-1&&(n.x=i._collideredBox[l].x+150+200*t,n.y=i._collideredBox[l].y+200,p+=i._footNum[1]),s.collider[o]={x:n.x,y:n.y,belong:l}},g=0;g<h.length;g++)f(g);n.collideredIndex=l,s.drag="end",s.submit=!1,s.colliderIndex=r,console.log("\u7ed9state\u8d4b\u503c\u524d\u7684",h),s.dropArr=h,console.warn("\u8d4b\u503c\u540e\u7684",s.dropArr),s.answer=p==i._answer,i.updateState(s),console.log("------------------------------------------------")}},e.prototype._getDistance=function(t,e){var i=t.x+t.width/2-(e.x+e.width/2),o=t.y+t.height/2-(e.y+e.height/2);return Math.sqrt(i*i+o*o)},e.prototype.isCollisionWithRect=function(t,e){return!(t.x>=e.x&&t.x>=e.x+e.width||t.x<=e.x&&t.x+t.width<=e.x||t.y>=e.y&&t.y>=e.y+e.height||t.y<=e.y&&t.y+t.height<=e.y)},e.prototype._belongArea=function(t,e,i){void 0===i&&(i=10);var o=t.x+t.width/2-(e.x+e.width/2),n=t.y+t.height/2-(e.y+e.height/2);return Math.sqrt(o*o+n*n)<i},e.prototype._clickTitle=function(){var t=globalThis._.cloneDeep(this._state);t.title=!0,this.updateState(t)},e.prototype._clickSubmit=function(){return a(this,void 0,void 0,function(){var t;return l(this,function(){return(t=globalThis._.cloneDeep(this._state)).submit=!0,this.updateState(t),[2]})})},e.prototype.getState=function(t){this.updateState(t)},e.prototype.updateState=function(t){globalThis._.isEqual(this._state,t)||(this.state=t)},e.prototype.updateUi=function(t,e){if("move"==e.drag&&(this._colliderBox[e.colliderIndex].x=e.collider[e.colliderIndex].x,this._colliderBox[e.colliderIndex].y=e.collider[e.colliderIndex].y),"end"==e.drag){if(!globalThis._.isEqual(t.collider,e.collider)){console.log("endddddddddd update ui",e);for(var i=0;i<e.collider.length;i++)this._colliderBox[i].x=e.collider[i].x,this._colliderBox[i].y=e.collider[i].y}globalThis._.isEqual(t.submit,e.submit)||(console.log("submittttttt"),e.submit&&this.answerFeedback(e.answer)),globalThis._.isEqual(t.title,e.title)||this.playTitle(e.title)}},e.prototype.playTitle=function(t){return a(this,void 0,void 0,function(){var e,i,o,n=this;return l(this,function(r){switch(r.label){case 0:return this._c2.selectedIndex=t?1:0,t?(cc.audioEngine.stopAll(),this.forbidHandle(),e=fgui.UIPackage.getItemByURL(this._title._sound),[4,d(e.file,cc.AudioClip)]):[3,2];case 1:return i=r.sent(),o=cc.audioEngine.play(i,!1,1),cc.audioEngine.setFinishCallback(o,function(){var t=globalThis._.cloneDeep(n._state);t.title=!1,n.updateState(t)}),[3,3];case 2:this.disableForbidHandle(),r.label=3;case 3:return[2]}})})},e.prototype.answerFeedback=function(t){var e=this;if(this.feedback){var i=globalThis._.cloneDeep(this._state),o=cc.instantiate(this.feedback);o.x=960,o.y=540,o.getComponent(cc.Component).init(t),o.parent=cc.find("Canvas").parent,setTimeout(function(){o.destroy(),i.submit=!1,e.updateState(i)},2e3)}},e.prototype.onHandleGuide=function(){var t=this;if(this.handleGuide){var e=globalThis._.cloneDeep(this._state);fgui.GRoot.inst.addChild(this.handleGuide.component),this.handleGuide.pos?(this.handleGuide.component.x=(fgui.GRoot.inst.width-this.handleGuide.component.width)/2+this.handleGuide.pos.x,this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2+this.handleGuide.pos.y):this.handleGuide.component.y=(fgui.GRoot.inst.height-this.handleGuide.component.height)/2,this.handleGuide.component.getTransition("t0").play(function(){fgui.GRoot.inst.removeChild(t.handleGuide.component),e.submit=!1,t.updateState(e)},2)}},e.prototype.forbidHandle=function(){if(!this._worldRoot.getChildByName("handleMask")){var t=new cc.Node("handleMask");t.addComponent(cc.BlockInputEvents),t.parent=this._worldRoot,t.width=1920,t.height=1080,t.x=960,t.y=540}},e.prototype.disableForbidHandle=function(){var t=this._worldRoot.getChildByName("handleMask");t&&t.destroy()},e.prototype.dragSchedule=function(){var t=this;if(t._dragging){var e=globalThis._.cloneDeep(t._state);e.drag="move",e.collider[e.colliderIndex]={x:this._colliderBox[e.colliderIndex].x,y:this._colliderBox[e.colliderIndex].y},t.updateState(e)}},e.prototype.registerState=function(){window.GlobalData.sample.registerState&&window.GlobalData.sample.registerState.call(this)},e.prototype.relieveState=function(){window.GlobalData.sample.relieveState&&window.GlobalData.sample.relieveState.call(this)},e.prototype.mergeState=function(){window.GlobalData.sample.mergeState&&window.GlobalData.sample.mergeState.call(this)},e.prototype.onEnable=function(){this.registerState(),this.schedule(this.dragSchedule,this._scheduleTime)},e.prototype.onDisable=function(){this.relieveState(),cc.audioEngine.stopAll()},r([p],e)}(cc.Component));i.default=f,cc._RF.pop()},{}]},{},["DragAnswerModel03Base","IDragAnswerModel03Base","dragAnswer-model01-v1","dragAnswer-model01-v2","dragAnswer-model02-v1","dragAnswer-model03-v1 copy","dragAnswer-model03-v1"]);