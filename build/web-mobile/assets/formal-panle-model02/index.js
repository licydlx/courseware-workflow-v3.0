window.__require=function t(e,o,n){function a(r,l){if(!o[r]){if(!e[r]){var s=r.split("/");if(s=s[s.length-1],!e[s]){var c="function"==typeof __require&&__require;if(!l&&c)return c(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var u=o[r]={exports:{}};e[r][0].call(u.exports,function(t){return a(e[r][1][t]||t)},u,u.exports,t,e,o,n)}return o[r].exports}for(var i="function"==typeof __require&&__require,r=0;r<n.length;r++)a(n[r]);return a}({"formal-panle-model02-studentList":[function(t,e,o){"use strict";cc._RF.push(e,"e032bSegH1C+6Fjdc8INtab","formal-panle-model02-studentList");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var a,i=arguments.length,r=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(a=t[l])&&(r=(i<3?a(r):i>3?a(e,o,r):a(e,o))||r);return i>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,l=r.ccclass,s=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.onLoad=function(){},e.prototype.updateUi=function(t){for(var e=function(e){var n=o.node.children[e];if(t.studentList[e]){n.active=!0,n.getChildByName("head").getChildByName("name").getComponent(cc.Label).string=t.studentList[e].nickname;var a=n.getChildByName("body").getChildByName("monitored"),i=a.getChildByName("show"),r=a.getChildByName("hide");1==t.signalingModel&&(a.active=!1),2==t.signalingModel&&(a.active=!0),3==t.signalingModel&&(a.active=!1),t.monitored==t.studentList[e].id?(i.active=!0,r.active=!1):(i.active=!1,r.active=!0);var l=n.getChildByName("body").getChildByName("launch"),s=l.getChildByName("show"),c=l.getChildByName("hide");1==t.signalingModel&&(l.active=!1),2==t.signalingModel&&(l.active=!1),3==t.signalingModel&&(l.active=!0),t.launch==t.studentList[e].id?(s.active=!0,c.active=!1):(s.active=!1,c.active=!0);var u=n.getChildByName("head").getChildByName("rank").getComponent(cc.Label),p=t.ranking.findIndex(function(o){return t.studentList[e].id==o});u.string=-1==p?"":(p+1).toString()}else n.active=!1},o=this,n=0;n<this.node.children.length;n++)e(n)},e.prototype.updateData=function(){},i([l],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],"formal-panle-model02":[function(t,e,o){"use strict";cc._RF.push(e,"eabe68KfalDJrLug5SBSBFT","formal-panle-model02");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var a,i=arguments.length,r=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(a=t[l])&&(r=(i<3?a(r):i>3?a(e,o,r):a(e,o))||r);return i>3&&r&&Object.defineProperty(e,o,r),r},r=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(a,i){function r(t){try{s(n.next(t))}catch(e){i(e)}}function l(t){try{s(n.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(r,l)}s((n=n.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var o,n,a,i,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(e){return s([t,e])}}function s(i){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,n=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){r.label=i[1];break}if(6===i[0]&&r.label<a[1]){r.label=a[1],a=i;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(i);break}a[2]&&r.ops.pop(),r.trys.pop();continue}i=e.call(t,r)}catch(l){i=[6,l],n=0}finally{o=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.modelList=null,e.studentList=null,e.models=[],e._state={show:!1,signalingModel:1,monitored:null,monitoredName:null,launch:null,studentList:[],ranking:[],snapshoot:{}},e._stJs=null,e}return a(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this._state=t,this.updateUi(this._state),this._stJs.updateUi(this._state),this.mergeState()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){var t=this.node.getChildByName("studentList");this._stJs=t.getComponent(cc.Component)},e.prototype.init=function(){return r(this,void 0,void 0,function(){return l(this,function(){return[2]})})},e.prototype.reset=function(){var t=globalThis._.cloneDeep(this._state);t.signalingModel=1,t.snapshoot={},t.monitored=null,t.monitoredName=null,t.launch=null,t.ranking=[],this.state=t},e.prototype.registerState=function(){window.GlobalData.sample.registerState&&window.GlobalData.sample.registerState.call(this)},e.prototype.relieveState=function(){window.GlobalData.sample.relieveState&&window.GlobalData.sample.relieveState.call(this)},e.prototype.mergeState=function(){window.GlobalData.sample.mergeState&&window.GlobalData.sample.mergeState.call(this)},e.prototype.getState=function(t){this.updateState(t)},e.prototype.switchBox=function(){if(0==window.GlobalData.courseData.role){var t=globalThis._.cloneDeep(this._state);t.show=!t.show,this.updateState(t)}},e.prototype.changeSignalingModel=function(t,e){if(0==window.GlobalData.courseData.role&&e!=window.GlobalData.courseData.signalingModel){var o=globalThis._.cloneDeep(this._state);o.signalingModel=parseInt(e),1==e?(o.monitored=null,o.monitoredName=null,o.launch=null,o.ranking=[]):2==e?o.launch=null:3==e&&(o.monitored=null,o.monitoredName=null);var n=globalThis._.cloneDeep(window.GlobalData.stateProxy.state),a=window.GlobalData.courseData.stateShoot;a&&Object.keys(n).forEach(function(t){globalThis._.isEqual(n[t],a[t])||"formal-panle-model02"==t||(window.GlobalData.stateProxy[t]="",window.GlobalData.pubSub.emit(a[t],t))}),this.updateState(o)}},e.prototype.changeMonitored=function(t,e){if(0==window.GlobalData.courseData.role){var o,n=globalThis._.cloneDeep(this._state),a=n.studentList[parseInt(e)].id,i=encodeURIComponent(n.studentList[parseInt(e)].nickname),r=globalThis._.cloneDeep(window.GlobalData.stateProxy.state);n.monitored==a?(n.monitored=null,n.monitoredName=null,o=window.GlobalData.courseData.stateShoot):(n.monitored=a,n.monitoredName=i,n.snapshoot[a]?o=n.snapshoot[a]:n.snapshoot[i]&&(o=n.snapshoot[i])),o&&Object.keys(r).forEach(function(t){globalThis._.isEqual(r[t],o[t])||"formal-panle-model02"==t||(window.GlobalData.stateProxy[t]="",window.GlobalData.pubSub.emit(o[t],t))}),this.updateState(n)}},e.prototype.changeLaunch=function(t,e){if(0==window.GlobalData.courseData.role){var o,n=globalThis._.cloneDeep(this._state),a=n.studentList[parseInt(e)].id,i=encodeURIComponent(n.studentList[parseInt(e)].nickname),r=globalThis._.cloneDeep(window.GlobalData.stateProxy.state);n.launch==a?(n.launch=null,o=window.GlobalData.courseData.stateShoot):(n.launch=a,n.snapshoot[a]?o=n.snapshoot[a]:n.snapshoot[i]&&(o=n.snapshoot[i])),o&&Object.keys(r).forEach(function(t){globalThis._.isEqual(r[t],o[t])||"formal-panle-model02"==t||(window.GlobalData.stateProxy[t]="",window.GlobalData.pubSub.emit(o[t],t))}),this.updateState(n)}},e.prototype.changeStudentList=function(t){var e=globalThis._.cloneDeep(this._state);e.studentList=t,this.updateState(e)},e.prototype.changeRanking=function(t){var e=globalThis._.cloneDeep(this._state);-1==e.ranking.findIndex(function(e){return e==t})&&(e.ranking.push(t),this.updateState(e))},e.prototype.updateState=function(t){globalThis._.isEqual(this._state,t)||(this.state=t)},e.prototype.updateUi=function(t){this.modelList.stopAllActions(),this.studentList.stopAllActions(),cc.tween(this.modelList).to(.2,{x:t.show?-930:-990}).start(),cc.tween(this.studentList).to(.2,{y:t.show?540:640}).start();for(var e=0;e<this.models.length;e++){var o=this.models[e].getChildByName("bg"),n=this.models[e].getChildByName("text");o.color=e==t.signalingModel-1?cc.color(15,187,233,255):cc.color(255,255,255,255),n.color=e==t.signalingModel-1?cc.color(255,255,255,255):cc.color(59,59,59,255)}window.GlobalData.courseData.signalingModel=t.signalingModel,window.GlobalData.courseData.monitored=t.monitored,window.GlobalData.courseData.monitoredName=t.monitoredName},e.prototype.userCreate=function(t){return t.filter(function(t){return 2==t.role})},e.prototype.userJoin=function(t){var e=globalThis._.cloneDeep(this._state),o=e.studentList.map(function(t){return t}),n=e.studentList.findIndex(function(e){return e.id==t[0].id});return 2==t[0].role&&-1==n&&o.push(t[0]),o},e.prototype.userLeave=function(t){return globalThis._.cloneDeep(this._state).studentList.filter(function(e){return e.id!==t[0].id})},e.prototype.signalCallback=function(t){if(t&&t.type){var e=void 0;"create"==t.type&&(e=this.userCreate(t.users)),"leave"==t.type&&(e=this.userLeave(t.users)),"join"==t.type&&(e=this.userJoin(t.users)),this.changeStudentList(e)}},e.prototype.onEnable=function(){this.registerState()},e.prototype.onDisable=function(){this.relieveState()},i([u({type:cc.Node,displayName:"modelList \u8282\u70b9"})],e.prototype,"modelList",void 0),i([u({type:cc.Node,displayName:"studentList \u8282\u70b9"})],e.prototype,"studentList",void 0),i([u({type:[cc.Node],displayName:"\u6a21\u5f0f\u8282\u70b9"})],e.prototype,"models",void 0),i([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{}]},{},["formal-panle-model02-studentList","formal-panle-model02"]);